!function(){var e={25252:function(e,t,s){var i={"./access-restriction/content-restriction":66340,"./access-restriction/content-restriction.js":66340,"./access-restriction/page-redirect":25805,"./access-restriction/page-redirect-link":95070,"./access-restriction/page-redirect-link.js":95070,"./access-restriction/page-redirect.js":25805,"./assessment":4352,"./assessment-settings":69311,"./assessment-settings.js":69311,"./assessment.js":4352,"./available-settings":37184,"./available-settings.js":37184,"./base":84643,"./base-page":58052,"./base-page.js":58052,"./base.js":84643,"./certificate":60249,"./certificate.js":60249,"./chapter":20898,"./chapter.js":20898,"./complete-post":68110,"./complete-post.js":68110,"./course":59579,"./course.js":59579,"./course/item":62925,"./course/item.js":62925,"./customer":7750,"./customer.js":7750,"./drip/campaign":76419,"./drip/campaign.js":76419,"./drip/triggers/assessment":14859,"./drip/triggers/assessment.js":14859,"./drip/triggers/automator":86274,"./drip/triggers/automator.js":86274,"./drip/triggers/campaign":62538,"./drip/triggers/campaign.js":62538,"./drip/triggers/course-content":98348,"./drip/triggers/course-content.js":98348,"./drip/triggers/datetime":86048,"./drip/triggers/datetime.js":86048,"./drip/triggers/factory":19311,"./drip/triggers/factory.js":19311,"./drip/triggers/first-lesson":86604,"./drip/triggers/first-lesson.js":86604,"./drip/triggers/purchase":28626,"./drip/triggers/purchase.js":28626,"./drip/triggers/scheduled":23503,"./drip/triggers/scheduled.js":23503,"./drip/triggers/video-progress":10766,"./drip/triggers/video-progress.js":10766,"./drip/unlock-settings":42315,"./drip/unlock-settings.js":42315,"./email-template":10131,"./email-template.js":10131,"./filter":56298,"./filter.js":56298,"./integration/base":12656,"./integration/base.js":12656,"./integration/buy-now":19125,"./integration/buy-now.js":19125,"./integration/rule":8346,"./integration/rule.js":8346,"./integration/thrivecart":14493,"./integration/thrivecart.js":14493,"./label":93275,"./label.js":93275,"./labels/dynamic-settings":70108,"./labels/dynamic-settings.js":70108,"./lesson":88524,"./lesson.js":88524,"./media/audio-model":25936,"./media/audio-model.js":25936,"./media/base":26465,"./media/base.js":26465,"./media/video-model":38084,"./media/video-model.js":38084,"./module":87168,"./module.js":87168,"./product":95053,"./product-access-expiry":82554,"./product-access-expiry.js":82554,"./product.js":95053,"./protected-file":1978,"./protected-file.js":1978,"./resource":90046,"./resource.js":90046,"./sendowl-account-key":52697,"./sendowl-account-key.js":52697,"./setting-item":86171,"./setting-item.js":86171,"./skin":93249,"./skin-item-template":64006,"./skin-item-template.js":64006,"./skin.js":93249,"./slider-input":58846,"./slider-input.js":58846,"./student":94254,"./student.js":94254,"./token":51941,"./token.js":51941,"./topic":8426,"./topic.js":8426,"./video-progress-api":95296,"./video-progress-api.js":95296,"./wizard":50251,"./wizard.js":50251,"./wizard/const":17570,"./wizard/const.js":17570};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=25252},71180:function(e,t,s){var i={"./assessment":15623,"./assessment.js":15623,"./base":73500,"./base.js":73500,"./chapter":91975,"./chapter.js":91975,"./lesson":83094,"./lesson.js":83094,"./module":71537,"./module.js":71537};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=71180},71927:function(e,t,s){var i={"./":65653,"./advanced":58254,"./advanced.js":58254,"./base":75243,"./base.js":75243,"./font-manager":45849,"./font-manager.js":45849,"./fonts/google":47233,"./fonts/google.js":47233,"./fonts/safe":71318,"./fonts/safe.js":71318,"./index":65653,"./index.js":65653,"./preview":36441,"./preview.js":36441,"./skin/filters":53416,"./skin/filters.js":53416,"./skin/item":34500,"./skin/item.js":34500,"./skin/template":58849,"./skin/template.js":58849,"./skin/templates":98404,"./skin/templates.js":98404,"./template":31597,"./template.js":31597,"./utils":27012,"./utils.js":27012,"./wizard":57470,"./wizard.js":57470,"./wizard/color":10245,"./wizard/color.js":10245,"./wizard/logo":847,"./wizard/logo.js":847,"./wizard/menu":51616,"./wizard/menu.js":51616,"./wizard/sidebar":68478,"./wizard/sidebar.js":68478,"./wizard/templates-list-section":45795,"./wizard/templates-list-section.js":45795,"./wizard/top":17438,"./wizard/top.js":17438};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=71927},16216:function(e,t,s){var i={"./_abstract":70331,"./_abstract.js":70331,"./access-expiry":89474,"./access-expiry.js":89474,"./content":40483,"./content-item":53473,"./content-item.js":53473,"./content-sets/controls/search-input":20727,"./content-sets/controls/search-input.js":20727,"./content-sets/form":49438,"./content-sets/form.js":49438,"./content-sets/item":55738,"./content-sets/item.js":55738,"./content-sets/list":12009,"./content-sets/list.js":12009,"./content.js":40483,"./course-tab":99432,"./course-tab.js":99432,"./drip":65127,"./drip.js":65127,"./item":6906,"./item.js":6906,"./partials/add-content":26912,"./partials/add-content.js":26912,"./partials/add-courses":18952,"./partials/add-courses.js":18952,"./partials/add-form":74916,"./partials/add-form.js":74916,"./partials/content-store":15088,"./partials/content-store.js":15088,"./partials/rule-item":86152,"./partials/rule-item.js":86152,"./restricted-content":16273,"./restricted-content.js":16273,"./rules":62348,"./rules.js":62348};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=16216},28027:function(e,t,s){var i={"./redirect.js":7e4,"./static.js":67482};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=28027},67549:function(e,t,s){var i={"./base-student":2629,"./base-student.js":2629,"./course":1382,"./course.js":1382,"./courses":96282,"./courses-item":64618,"./courses-item.js":64618,"./courses.js":96282,"./item":21598,"./item.js":21598,"./lesson":11257,"./lesson.js":11257,"./module":91791,"./module.js":91791};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=67549},3264:function(e,t,s){var i={"./access-migration.js":72877,"./access-restriction.js":5235,"./access-restriction/content-restriction.js":88119,"./access-rule-condition.js":40504,"./add-new-course.js":38697,"./api-keys.js":88922,"./api-keys/item.js":41691,"./archives.js":63250,"./assessment-preview.js":58611,"./assessment-previews/external.js":70163,"./assessment-previews/tqb.js":69145,"./assessment-previews/upload.js":86108,"./assessment-previews/youtube.js":7188,"./assessment-settings.js":8098,"./assessment-settings/settings-dropbox.js":56560,"./assessment-settings/settings-google_drive.js":65692,"./assessments.js":1533,"./base.js":2921,"./checkbox-group.js":68338,"./confirm-action.js":18421,"./content-base.js":51135,"./course/access-tab-content.js":37020,"./course/assessment.js":39517,"./course/chapter.js":52583,"./course/completion-tab.js":90030,"./course/custom-payment-integration.js":2527,"./course/details-tab-content.js":92396,"./course/form.js":81181,"./course/forms/assessment.js":15623,"./course/forms/base.js":73500,"./course/forms/chapter.js":91975,"./course/forms/lesson.js":83094,"./course/forms/module.js":71537,"./course/header.js":61353,"./course/integration.js":43265,"./course/item.js":82951,"./course/items-tab-content.js":35691,"./course/lesson.js":1828,"./course/listItem.js":59297,"./course/module.js":96774,"./course/permalink.js":17520,"./course/stripe-integration.js":273,"./course/thrivcart-integration.js":5657,"./course/woocommerce-integration.js":78818,"./courses-reports.js":26711,"./courses.js":24633,"./datepicker.js":91359,"./design-legacy.js":85212,"./design-welcome.js":59339,"./design.js":99651,"./design/advanced.js":58254,"./design/base.js":75243,"./design/font-manager.js":45849,"./design/fonts/google.js":47233,"./design/fonts/safe.js":71318,"./design/index.js":65653,"./design/preview.js":36441,"./design/skin/filters.js":53416,"./design/skin/item.js":34500,"./design/skin/template.js":58849,"./design/skin/templates.js":98404,"./design/template.js":31597,"./design/utils.js":27012,"./design/wizard.js":57470,"./design/wizard/color.js":10245,"./design/wizard/logo.js":847,"./design/wizard/menu.js":51616,"./design/wizard/sidebar.js":68478,"./design/wizard/templates-list-section.js":45795,"./design/wizard/top.js":17438,"./drip/campaign/display.js":76719,"./drip/campaign/form-general.js":63181,"./drip/course-tab.js":85787,"./drip/modals/campaign-settings.js":5905,"./drip/modals/content-unlock-settings.js":57790,"./drip/schedule.js":41027,"./drip/triggers/assessment.js":59835,"./drip/triggers/course-content.js":40450,"./drip/triggers/datetime.js":615,"./drip/triggers/first-lesson.js":63502,"./drip/triggers/purchase.js":11572,"./drip/triggers/video-progress.js":39946,"./email-templates.js":61606,"./email-templates/item.js":75195,"./filters/badge.js":1621,"./filters/drop-down.js":95438,"./filters/text-input.js":27339,"./generate.js":1569,"./home.js":56766,"./inline-edit.js":83217,"./input-title.js":89166,"./item-state.js":96308,"./labels/button-label.js":25343,"./labels/course-structure.js":27643,"./labels/course-type-label.js":38563,"./labels/item.js":12386,"./labels/simple-label.js":95220,"./labels/textarea-warning-label.js":30873,"./labels/user-context-item.js":27863,"./logs.js":52875,"./logs/item.js":86662,"./media-settings.js":79389,"./members.js":5053,"./menu/menu-item.js":31721,"./menu/menu.js":50186,"./menu/submenu-dropdown.js":49089,"./menu/submenu-item.js":18156,"./menu/submenu.js":66740,"./modals/access-migration.js":55215,"./modals/api-key/base.js":27860,"./modals/assessment-item.js":25670,"./modals/base.js":39105,"./modals/certificate-tos.js":25033,"./modals/confirm-modal.js":49939,"./modals/course-access-restriction.js":91479,"./modals/course-item.js":47949,"./modals/course-items/chapters.js":73393,"./modals/course-items/content.js":54637,"./modals/course-items/grouping/chapter.js":94968,"./modals/course-items/grouping/module.js":17160,"./modals/course-items/lessons.js":68179,"./modals/course-items/modules.js":37653,"./modals/course-items/move.js":95231,"./modals/course-items/resources.js":95974,"./modals/course-items/resources/item.js":88732,"./modals/customer/access-items/base.js":68300,"./modals/customer/add.js":91960,"./modals/customer/base.js":26018,"./modals/customer/edit.js":77538,"./modals/customer/import.js":11316,"./modals/customer/lesson-unlock.js":57426,"./modals/design/hi-professor.js":95692,"./modals/help-corner.js":77431,"./modals/icons.js":896,"./modals/labels/confirm-delete.js":31779,"./modals/products/access-rules.js":35561,"./modals/products/add.js":92900,"./modals/products/content-sets.js":82546,"./modals/protected-files/add.js":81020,"./modals/protected-files/edit.js":553,"./modals/protected-files/help.js":11605,"./modals/protected-files/share.js":72540,"./modals/schedule.js":60929,"./modals/skins/cloud.js":58792,"./modals/skins/template.js":3063,"./modals/steps-modal.js":66795,"./modals/td-base.js":2707,"./modals/topics/confirm-delete.js":4136,"./modals/wizard/templates.js":79391,"./page-states-cloud/create.js":70164,"./page-states-cloud/delete.js":95251,"./page-states-cloud/normal.js":91503,"./page-states-cloud/search-link.js":8867,"./page-states-cloud/search.js":61918,"./page-states/create.js":87785,"./page-states/delete.js":12404,"./page-states/normal.js":46913,"./page-states/search-link.js":50413,"./page-states/search.js":98555,"./pagination.js":77003,"./product/_abstract.js":70331,"./product/access-expiry.js":89474,"./product/content-item.js":53473,"./product/content-sets/controls/search-input.js":20727,"./product/content-sets/form.js":49438,"./product/content-sets/item.js":55738,"./product/content-sets/list.js":12009,"./product/content.js":40483,"./product/course-tab.js":99432,"./product/drip.js":65127,"./product/item.js":6906,"./product/partials/add-content.js":26912,"./product/partials/add-courses.js":18952,"./product/partials/add-form.js":74916,"./product/partials/content-store.js":15088,"./product/partials/rule-item.js":86152,"./product/restricted-content.js":16273,"./product/rules.js":62348,"./products.js":85159,"./protected-files.js":43350,"./protected-files/auxiliary-upload-control.js":83524,"./protected-files/constants.js":16591,"./protected-files/item.js":48327,"./protected-files/main-upload-control.js":2948,"./quiz-reports.js":95967,"./reports.js":31357,"./select.js":76821,"./select2-checkboxes.js":26035,"./sendowl.js":21808,"./sendowl/checkout.js":40189,"./sendowl/create-product.js":66530,"./sendowl/integration.js":91657,"./sendowl/links.js":51705,"./sendowl/links/input-links.js":63891,"./sendowl/links/option.js":96014,"./sendowl/quick-start.js":21232,"./sendowl/tabs/checkout-states/register.js":23035,"./sendowl/tabs/checkout-states/thankyou.js":90598,"./sendowl/tabs/th-page-cards.js":7314,"./sendowl/tabs/thankyou-type/redirect.js":7e4,"./sendowl/tabs/thankyou-type/static.js":67482,"./sendowl/thankyou-states/redirect.js":74322,"./sendowl/thankyou-states/static.js":4091,"./settings.js":35673,"./slider-input.js":48410,"./stripe.js":7578,"./stripe/create-product.js":50201,"./student/base-student.js":2629,"./student/course.js":1382,"./student/courses-item.js":64618,"./student/courses.js":96282,"./student/item.js":21598,"./student/lesson.js":11257,"./student/module.js":91791,"./tabs.js":80201,"./topics.js":34470,"./topics/item.js":77494,"./translations/access-restrictions.js":8767,"./translations/call-to-action-buttons.js":33461,"./translations/course-content-types.js":47492,"./translations/course-navigation.js":63090,"./translations/course-progress.js":29848,"./translations/course-structure.js":37764,"./translations/labels.js":40377,"./wizard.js":25387,"./wp-media.js":4023};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=3264},22289:function(e,t,s){var i={"./access-migration":72877,"./access-migration.js":72877,"./access-restriction":5235,"./access-restriction.js":5235,"./access-restriction/content-restriction":88119,"./access-restriction/content-restriction.js":88119,"./access-rule-condition":40504,"./access-rule-condition.js":40504,"./add-new-course":38697,"./add-new-course.js":38697,"./api-keys":88922,"./api-keys.js":88922,"./api-keys/item":41691,"./api-keys/item.js":41691,"./archives":63250,"./archives.js":63250,"./assessment-preview":58611,"./assessment-preview.js":58611,"./assessment-previews/external":70163,"./assessment-previews/external.js":70163,"./assessment-previews/tqb":69145,"./assessment-previews/tqb.js":69145,"./assessment-previews/upload":86108,"./assessment-previews/upload.js":86108,"./assessment-previews/youtube":7188,"./assessment-previews/youtube.js":7188,"./assessment-settings":8098,"./assessment-settings.js":8098,"./assessment-settings/settings-dropbox":56560,"./assessment-settings/settings-dropbox.js":56560,"./assessment-settings/settings-google_drive":65692,"./assessment-settings/settings-google_drive.js":65692,"./assessments":1533,"./assessments.js":1533,"./base":2921,"./base.js":2921,"./checkbox-group":68338,"./checkbox-group.js":68338,"./confirm-action":18421,"./confirm-action.js":18421,"./content-base":51135,"./content-base.js":51135,"./course/access-tab-content":37020,"./course/access-tab-content.js":37020,"./course/assessment":39517,"./course/assessment.js":39517,"./course/chapter":52583,"./course/chapter.js":52583,"./course/completion-tab":90030,"./course/completion-tab.js":90030,"./course/custom-payment-integration":2527,"./course/custom-payment-integration.js":2527,"./course/details-tab-content":92396,"./course/details-tab-content.js":92396,"./course/form":81181,"./course/form.js":81181,"./course/forms/assessment":15623,"./course/forms/assessment.js":15623,"./course/forms/base":73500,"./course/forms/base.js":73500,"./course/forms/chapter":91975,"./course/forms/chapter.js":91975,"./course/forms/lesson":83094,"./course/forms/lesson.js":83094,"./course/forms/module":71537,"./course/forms/module.js":71537,"./course/header":61353,"./course/header.js":61353,"./course/integration":43265,"./course/integration.js":43265,"./course/item":82951,"./course/item.js":82951,"./course/items-tab-content":35691,"./course/items-tab-content.js":35691,"./course/lesson":1828,"./course/lesson.js":1828,"./course/listItem":59297,"./course/listItem.js":59297,"./course/module":96774,"./course/module.js":96774,"./course/permalink":17520,"./course/permalink.js":17520,"./course/stripe-integration":273,"./course/stripe-integration.js":273,"./course/thrivcart-integration":5657,"./course/thrivcart-integration.js":5657,"./course/woocommerce-integration":78818,"./course/woocommerce-integration.js":78818,"./courses":24633,"./courses-reports":26711,"./courses-reports.js":26711,"./courses.js":24633,"./datepicker":91359,"./datepicker.js":91359,"./design":99651,"./design-legacy":85212,"./design-legacy.js":85212,"./design-welcome":59339,"./design-welcome.js":59339,"./design.js":99651,"./design/":65653,"./design/advanced":58254,"./design/advanced.js":58254,"./design/base":75243,"./design/base.js":75243,"./design/font-manager":45849,"./design/font-manager.js":45849,"./design/fonts/google":47233,"./design/fonts/google.js":47233,"./design/fonts/safe":71318,"./design/fonts/safe.js":71318,"./design/index":65653,"./design/index.js":65653,"./design/preview":36441,"./design/preview.js":36441,"./design/skin/filters":53416,"./design/skin/filters.js":53416,"./design/skin/item":34500,"./design/skin/item.js":34500,"./design/skin/template":58849,"./design/skin/template.js":58849,"./design/skin/templates":98404,"./design/skin/templates.js":98404,"./design/template":31597,"./design/template.js":31597,"./design/utils":27012,"./design/utils.js":27012,"./design/wizard":57470,"./design/wizard.js":57470,"./design/wizard/color":10245,"./design/wizard/color.js":10245,"./design/wizard/logo":847,"./design/wizard/logo.js":847,"./design/wizard/menu":51616,"./design/wizard/menu.js":51616,"./design/wizard/sidebar":68478,"./design/wizard/sidebar.js":68478,"./design/wizard/templates-list-section":45795,"./design/wizard/templates-list-section.js":45795,"./design/wizard/top":17438,"./design/wizard/top.js":17438,"./drip/campaign/display":76719,"./drip/campaign/display.js":76719,"./drip/campaign/form-general":63181,"./drip/campaign/form-general.js":63181,"./drip/course-tab":85787,"./drip/course-tab.js":85787,"./drip/modals/campaign-settings":5905,"./drip/modals/campaign-settings.js":5905,"./drip/modals/content-unlock-settings":57790,"./drip/modals/content-unlock-settings.js":57790,"./drip/schedule":41027,"./drip/schedule.js":41027,"./drip/triggers/assessment":59835,"./drip/triggers/assessment.js":59835,"./drip/triggers/course-content":40450,"./drip/triggers/course-content.js":40450,"./drip/triggers/datetime":615,"./drip/triggers/datetime.js":615,"./drip/triggers/first-lesson":63502,"./drip/triggers/first-lesson.js":63502,"./drip/triggers/purchase":11572,"./drip/triggers/purchase.js":11572,"./drip/triggers/video-progress":39946,"./drip/triggers/video-progress.js":39946,"./email-templates":61606,"./email-templates.js":61606,"./email-templates/item":75195,"./email-templates/item.js":75195,"./filters/badge":1621,"./filters/badge.js":1621,"./filters/drop-down":95438,"./filters/drop-down.js":95438,"./filters/text-input":27339,"./filters/text-input.js":27339,"./generate":1569,"./generate.js":1569,"./home":56766,"./home.js":56766,"./inline-edit":83217,"./inline-edit.js":83217,"./input-title":89166,"./input-title.js":89166,"./item-state":96308,"./item-state.js":96308,"./labels/button-label":25343,"./labels/button-label.js":25343,"./labels/course-structure":27643,"./labels/course-structure.js":27643,"./labels/course-type-label":38563,"./labels/course-type-label.js":38563,"./labels/item":12386,"./labels/item.js":12386,"./labels/simple-label":95220,"./labels/simple-label.js":95220,"./labels/textarea-warning-label":30873,"./labels/textarea-warning-label.js":30873,"./labels/user-context-item":27863,"./labels/user-context-item.js":27863,"./logs":52875,"./logs.js":52875,"./logs/item":86662,"./logs/item.js":86662,"./media-settings":79389,"./media-settings.js":79389,"./members":5053,"./members.js":5053,"./menu/menu":50186,"./menu/menu-item":31721,"./menu/menu-item.js":31721,"./menu/menu.js":50186,"./menu/submenu":66740,"./menu/submenu-dropdown":49089,"./menu/submenu-dropdown.js":49089,"./menu/submenu-item":18156,"./menu/submenu-item.js":18156,"./menu/submenu.js":66740,"./modals/access-migration":55215,"./modals/access-migration.js":55215,"./modals/api-key/base":27860,"./modals/api-key/base.js":27860,"./modals/assessment-item":25670,"./modals/assessment-item.js":25670,"./modals/base":39105,"./modals/base.js":39105,"./modals/certificate-tos":25033,"./modals/certificate-tos.js":25033,"./modals/confirm-modal":49939,"./modals/confirm-modal.js":49939,"./modals/course-access-restriction":91479,"./modals/course-access-restriction.js":91479,"./modals/course-item":47949,"./modals/course-item.js":47949,"./modals/course-items/chapters":73393,"./modals/course-items/chapters.js":73393,"./modals/course-items/content":54637,"./modals/course-items/content.js":54637,"./modals/course-items/grouping/chapter":94968,"./modals/course-items/grouping/chapter.js":94968,"./modals/course-items/grouping/module":17160,"./modals/course-items/grouping/module.js":17160,"./modals/course-items/lessons":68179,"./modals/course-items/lessons.js":68179,"./modals/course-items/modules":37653,"./modals/course-items/modules.js":37653,"./modals/course-items/move":95231,"./modals/course-items/move.js":95231,"./modals/course-items/resources":95974,"./modals/course-items/resources.js":95974,"./modals/course-items/resources/item":88732,"./modals/course-items/resources/item.js":88732,"./modals/customer/access-items/base":68300,"./modals/customer/access-items/base.js":68300,"./modals/customer/add":91960,"./modals/customer/add.js":91960,"./modals/customer/base":26018,"./modals/customer/base.js":26018,"./modals/customer/edit":77538,"./modals/customer/edit.js":77538,"./modals/customer/import":11316,"./modals/customer/import.js":11316,"./modals/customer/lesson-unlock":57426,"./modals/customer/lesson-unlock.js":57426,"./modals/design/hi-professor":95692,"./modals/design/hi-professor.js":95692,"./modals/help-corner":77431,"./modals/help-corner.js":77431,"./modals/icons":896,"./modals/icons.js":896,"./modals/labels/confirm-delete":31779,"./modals/labels/confirm-delete.js":31779,"./modals/products/access-rules":35561,"./modals/products/access-rules.js":35561,"./modals/products/add":92900,"./modals/products/add.js":92900,"./modals/products/content-sets":82546,"./modals/products/content-sets.js":82546,"./modals/protected-files/add":81020,"./modals/protected-files/add.js":81020,"./modals/protected-files/edit":553,"./modals/protected-files/edit.js":553,"./modals/protected-files/help":11605,"./modals/protected-files/help.js":11605,"./modals/protected-files/share":72540,"./modals/protected-files/share.js":72540,"./modals/schedule":60929,"./modals/schedule.js":60929,"./modals/skins/cloud":58792,"./modals/skins/cloud.js":58792,"./modals/skins/template":3063,"./modals/skins/template.js":3063,"./modals/steps-modal":66795,"./modals/steps-modal.js":66795,"./modals/td-base":2707,"./modals/td-base.js":2707,"./modals/topics/confirm-delete":4136,"./modals/topics/confirm-delete.js":4136,"./modals/wizard/templates":79391,"./modals/wizard/templates.js":79391,"./page-states-cloud/create":70164,"./page-states-cloud/create.js":70164,"./page-states-cloud/delete":95251,"./page-states-cloud/delete.js":95251,"./page-states-cloud/normal":91503,"./page-states-cloud/normal.js":91503,"./page-states-cloud/search":61918,"./page-states-cloud/search-link":8867,"./page-states-cloud/search-link.js":8867,"./page-states-cloud/search.js":61918,"./page-states/create":87785,"./page-states/create.js":87785,"./page-states/delete":12404,"./page-states/delete.js":12404,"./page-states/normal":46913,"./page-states/normal.js":46913,"./page-states/search":98555,"./page-states/search-link":50413,"./page-states/search-link.js":50413,"./page-states/search.js":98555,"./pagination":77003,"./pagination.js":77003,"./product/_abstract":70331,"./product/_abstract.js":70331,"./product/access-expiry":89474,"./product/access-expiry.js":89474,"./product/content":40483,"./product/content-item":53473,"./product/content-item.js":53473,"./product/content-sets/controls/search-input":20727,"./product/content-sets/controls/search-input.js":20727,"./product/content-sets/form":49438,"./product/content-sets/form.js":49438,"./product/content-sets/item":55738,"./product/content-sets/item.js":55738,"./product/content-sets/list":12009,"./product/content-sets/list.js":12009,"./product/content.js":40483,"./product/course-tab":99432,"./product/course-tab.js":99432,"./product/drip":65127,"./product/drip.js":65127,"./product/item":6906,"./product/item.js":6906,"./product/partials/add-content":26912,"./product/partials/add-content.js":26912,"./product/partials/add-courses":18952,"./product/partials/add-courses.js":18952,"./product/partials/add-form":74916,"./product/partials/add-form.js":74916,"./product/partials/content-store":15088,"./product/partials/content-store.js":15088,"./product/partials/rule-item":86152,"./product/partials/rule-item.js":86152,"./product/restricted-content":16273,"./product/restricted-content.js":16273,"./product/rules":62348,"./product/rules.js":62348,"./products":85159,"./products.js":85159,"./protected-files":43350,"./protected-files.js":43350,"./protected-files/auxiliary-upload-control":83524,"./protected-files/auxiliary-upload-control.js":83524,"./protected-files/constants":16591,"./protected-files/constants.js":16591,"./protected-files/item":48327,"./protected-files/item.js":48327,"./protected-files/main-upload-control":2948,"./protected-files/main-upload-control.js":2948,"./quiz-reports":95967,"./quiz-reports.js":95967,"./reports":31357,"./reports.js":31357,"./select":76821,"./select.js":76821,"./select2-checkboxes":26035,"./select2-checkboxes.js":26035,"./sendowl":21808,"./sendowl.js":21808,"./sendowl/checkout":40189,"./sendowl/checkout.js":40189,"./sendowl/create-product":66530,"./sendowl/create-product.js":66530,"./sendowl/integration":91657,"./sendowl/integration.js":91657,"./sendowl/links":51705,"./sendowl/links.js":51705,"./sendowl/links/input-links":63891,"./sendowl/links/input-links.js":63891,"./sendowl/links/option":96014,"./sendowl/links/option.js":96014,"./sendowl/quick-start":21232,"./sendowl/quick-start.js":21232,"./sendowl/tabs/checkout-states/register":23035,"./sendowl/tabs/checkout-states/register.js":23035,"./sendowl/tabs/checkout-states/thankyou":90598,"./sendowl/tabs/checkout-states/thankyou.js":90598,"./sendowl/tabs/th-page-cards":7314,"./sendowl/tabs/th-page-cards.js":7314,"./sendowl/tabs/thankyou-type/redirect":7e4,"./sendowl/tabs/thankyou-type/redirect.js":7e4,"./sendowl/tabs/thankyou-type/static":67482,"./sendowl/tabs/thankyou-type/static.js":67482,"./sendowl/thankyou-states/redirect":74322,"./sendowl/thankyou-states/redirect.js":74322,"./sendowl/thankyou-states/static":4091,"./sendowl/thankyou-states/static.js":4091,"./settings":35673,"./settings.js":35673,"./slider-input":48410,"./slider-input.js":48410,"./stripe":7578,"./stripe.js":7578,"./stripe/create-product":50201,"./stripe/create-product.js":50201,"./student/base-student":2629,"./student/base-student.js":2629,"./student/course":1382,"./student/course.js":1382,"./student/courses":96282,"./student/courses-item":64618,"./student/courses-item.js":64618,"./student/courses.js":96282,"./student/item":21598,"./student/item.js":21598,"./student/lesson":11257,"./student/lesson.js":11257,"./student/module":91791,"./student/module.js":91791,"./tabs":80201,"./tabs.js":80201,"./topics":34470,"./topics.js":34470,"./topics/item":77494,"./topics/item.js":77494,"./translations/access-restrictions":8767,"./translations/access-restrictions.js":8767,"./translations/call-to-action-buttons":33461,"./translations/call-to-action-buttons.js":33461,"./translations/course-content-types":47492,"./translations/course-content-types.js":47492,"./translations/course-navigation":63090,"./translations/course-navigation.js":63090,"./translations/course-progress":29848,"./translations/course-progress.js":29848,"./translations/course-structure":37764,"./translations/course-structure.js":37764,"./translations/labels":40377,"./translations/labels.js":40377,"./wizard":25387,"./wizard.js":25387,"./wp-media":4023,"./wp-media.js":4023};function n(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=22289},69362:function(e,t,s){const i=s(12656),n=s(14493);e.exports=s(71195).extend({model:function(e,t){return e||(e={slug:null}),"thrivecart"===e.slug?new n(e,t):new i.model(e,t)},getItems:function(e){const t=this.findWhere({slug:e});return t instanceof i.model?t.getItems():new i.items_collection},getIntegration:function(e){const t=this.findWhere({slug:e});return t instanceof i.model?t:new i.model}})},67925:function(e,t,s){const i=s(66340);e.exports=s(71195).extend({model:i,comparator:function(e,t){return parseInt(e.get("order"))-parseInt(t.get("order"))}})},71195:function(e){var t;t=jQuery,e.exports=Backbone.Collection.extend({sync:function(e,t,s){return s.beforeSend=function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)},Backbone.Collection.prototype.sync.apply(this,arguments)},replace:function(e){const t=this.findWhere({id:e.get("id")});if(!t)return!1;const s=this.indexOf(t);return this.remove(t),this.add(e,{at:s}),!0},updateModels:function(e){this.each((t=>{t.set(e)}))},findById:function(e,t="ID"){let s=this.findWhere({[t]:parseInt(e)});return s||(s=new this.model),s},fetchOnce:function(e={}){let s;if(this.$$fetched){const e=t.Deferred();s=e.promise(),e.resolve(this.toJSON())}else this.$$fetched=!0,this.trigger("fetch"),s=this.fetch(e);return s}})},46168:function(e,t,s){const i=s(19125);e.exports=Backbone.Collection.extend({model:i})},65773:function(e,t,s){const i=s(71195).extend({url:function(){return TVA.Utils.buildUrl(TVA.routes.skins+"/cloud",{})},filterByName:function(e){const t=e.toLowerCase().trim();return t?this.filter((e=>e.get("name").toLowerCase().includes(t)))||[]:this.models}});e.exports=i},30739:function(e,t,s){const i=s(59579);e.exports=s(3711).extend({model:i,limit:1e4,url:function(){return this.getUrl(`${TVA.apiSettings.root}${TVA.apiSettings.v2}/courses`,jQuery.param({offset:this.offset,limit:this.limit,filter:this._filter}))},getSendOwlItems:function(){const e=[];return this.each((t=>{t.hasSendOwlIntegration()&&e.push(t)})),e},newItemOrder:function(){return 0===this.length?0:parseInt(this.first().get("order"))+1},comparator:function(e,t){return parseInt(t.get("order"))-parseInt(e.get("order"))}})},46498:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r;r=jQuery,e.exports=s(3711).extend({model:s(94254),limit:parseInt(TVA.items_per_page),offset:0,currentPage:1,ordering:{enrolled:"desc"},filters:{},search:function(e){this.currentPage=1,this.offset=0,this.filter=n(n({},this.filter),e),this.fetch()},url:function(){return this.filter=n(n({},this.filter),{offset:this.offset,limit:this.limit}),this.getUrl(TVA.routes.customer,r.param(_.pick(this.filter,(e=>!!e))))},next:function(){this.currentPage++,this.fetchStudents()},prev:function(){this.currentPage--,this.fetchStudents()},fetchStudents:function(){this.offset=(this.currentPage-1)*this.limit,this.trigger("fetching"),this.fetchWithData({offset:this.offset}).success((e=>{this.reset(e.items,{total:e.total,ordering:this.ordering}),this.trigger("fetched")}))},resetPagination:function(){return this.currentPage=1,this.offset=0,this},resetIndividualStudentViews:function(){this.invoke("set",{courses:[]})},fetchWithData:function(e={}){return(e=n(n({},e),this.filters)).limit=this.limit,e.ordering=this.ordering,wp.apiRequest({url:`${TVA.routes.customer}`,data:e})}})},72177:function(e,t,s){const i=s(76419),n=s(71195).extend({model:i,url:function(){return TVA.routes.campaigns},newWeeklyLogic:function(){this.each((e=>{e.set({new_weekly_logic:1},{silent:!0})})),wp.apiRequest({type:"POST",url:`${this.url()}/new_weekly_logic`,data:{}})},massApplySettings:function(e){const t=new n(this.filter((e=>e.isRepeating())));return t.length?(t.each((t=>{t.applySettings(e,!1)})),t.sync("update",t,{}),this):this},getTitleFromLabel:function(e){let t=1,s=this.where({post_title:e});for(;0!==s.length;)t++,s=this.where({post_title:e+" "+t});return 1===t?e:e+" "+t}});e.exports=n},99051:function(e,t,s){const i=s(19311);e.exports=s(71195).extend({model:i})},43388:function(e,t,s){const i=s(10131);e.exports=Backbone.Collection.extend({model:i})},86355:function(e,t,s){e.exports=s(30739).extend({comparator:function(e){return-1*new Date(e.get("last_edit_date")).getTime()}})},84716:function(e,t,s){e.exports=s(84531).extend({model:s(93275),comparator:function(e,t){return e.get("ID")-t.get("ID")}})},44938:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){let i={};e.exports=s(3711).extend({search:function(e){this.currentPage=1,this.offset=0,i=n(n({},i),e),this.fetch()},url:function(){return i=n(n({},i),{offset:this.offset,limit:this.limit}),this.getUrl(TVA.routes.logs,t.param(_.pick(i,(e=>!!e))))}})}(jQuery)},5413:function(e,t,s){const i=s(84643).extend({defaults:{selected:!1},initialize:function(e){const t=e&&e.items?Object.values(e.items):[];this.set("items",new n(t)),this.set("sections",new Backbone.Collection(e.sections||[]))}}),n=s(71195).extend({model:i,updateItem:function(e,t){const s=this.findWhere(e);s&&s.set(t)}});e.exports=n},3711:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}e.exports=s(71195).extend({offset:0,limit:parseInt(TVA.items_per_page),total:0,currentPage:1,_filter:{},fetchOptions:{},addFilter:function(e,t=null){return this.resetPagination(),"string"==typeof e&&(e={[e]:t}),this._filter=n(n({},this._filter),e),this.fetch(this.fetchOptions)},getFilter:function(e,t=null){return void 0===e?this._filter:void 0===this._filter[e]?t:this._filter[e]},resetPagination:function(){return this.currentPage=1,this.offset=0,this},hasFilters:function(){const e=this._filter;return e.topic&&-1===parseInt(e.topic)&&delete e.topic,Object.keys(e).length>0},resetFilters:function(){return this._filter={},this},initialize:function(e,t){if(!t||void 0===t.total)throw new Error("This collection cannot be initialized without total count of items");this.total=parseInt(t.total)},fetch:function(e={}){return this.trigger("fetching"),e.success=()=>{this.trigger("fetched",this),!this.length&&this.currentPage>1&&this.prev()},Backbone.Collection.prototype.fetch.call(this,e)},parse:function(e){return e&&void 0!==e.total&&(this.total=e.total),e&&e.items},next:function(){return this.currentPage++,this.offset=(this.currentPage-1)*this.limit,this.fetch(this.fetchOptions),this},prev:function(){return this.currentPage--,this.offset=(this.currentPage-1)*this.limit,this.fetch(this.fetchOptions),this},pageInfo:function(){return{currentPage:this.currentPage,totalPages:Math.ceil(this.total/this.limit),page:this.currentPage,prev:this.offset>0,next:this.currentPage*this.limit<this.total}},getUrl:function(e,t){return`${e}${e.includes("?")?"&":"?"}${t}`}})},65035:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(95053),o=s(3711),r=new Map;e.exports=o.extend({model:i,fetchOptions:{remove:!1},url:function(){return this._filter=n(n({},this._filter),{offset:this.offset,number:this.limit}),this.getUrl(TVA.routes.products,t.param(_.pick(this._filter,(e=>!!e))))},hasFilters:function(){const e=this._filter;return delete e.offset,delete e.number,Object.keys(e).length>0},resetFilters:function(){return this.offset=0,this.currentPage=1,o.prototype.resetFilters.apply(this,arguments)},resetAndFetch:function(){return this.resetFilters().fetch({reset:!0})},fetchAll:function(){return this.currentPage=this.pageInfo().totalPages,this.fetch({reset:!0,data:{offset:0,number:1e5}})},getAll:function(){return new Promise((e=>{this.length<this.total?this.fetchAll().done((()=>e(this))):e(this)}))},search:function(e){return this.currentPage=1,this.offset=0,this._filter=n(n({},this._filter),e),this.fetch({reset:!0}),this},getByName:function(e="",t=!1){const s=e.toLowerCase().trim(),i=this.filter((e=>{let i=e.get("name").toLowerCase().trim()===s;return t&&e.get("id")===t&&(i=!1),i}));return!!Array.isArray(i)&&i[0]},newItemOrder:function(){return TVA.products.total||0},changeTotal:function(e){this.total=this.total+parseInt(e),this.trigger("total-changed")},comparator:function(e,t){return parseInt(t.get("order"))-parseInt(e.get("order"))},cacheModel:function(e){r.set(Number(e.get("id")),e)},get:function(e){return o.prototype.get.call(this,e)||r.get(Number(e))||void 0}})}(jQuery)},8125:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(3711);e.exports=i.extend({model:s(1978),url:function(){return this._filter=n(n({},this._filter),{offset:this.offset,number:this.limit}),this.getUrl(TVA.routes.protected_files,t.param(_.pick(this._filter,(e=>!!e))))},search:function(e){return this.currentPage=1,this.offset=0,this._filter=n(n({},this._filter),e),this.fetch({reset:!0}),this},resetFilters:function(){return this.offset=0,this.currentPage=1,i.prototype.resetFilters.apply(this,arguments)},hasFilters:function(){const e=this._filter;return delete e.offset,delete e.number,Object.keys(e).length>0},resetAndFetch:function(){return this.resetFilters().fetch({reset:!0})}})}(jQuery)},49406:function(e,t,s){const i=s(90046),n=s(71195).extend({model:i,url:function(){return TVA.Utils.buildUrl(TVA.routes.resources,{lesson_id:this.lessonID})},setLessonId:function(e){return this.lessonID=Number(e),this},comparator:function(e,t){return e.get("order")-t.get("order")},buildOrder:function(){return this.each(((e,t)=>e.set("order",t,{silent:!0}))),this},getAutoIncrement:function(){if(!this.length)return 1;let e=this.length+1;return this.each((t=>{if(t.hasDefaultTitle()){const s=Number(t.get("title").replace("Resource ",""));!isNaN(s)&&s>=e&&(e=s+1)}})),e}});e.exports=new class{constructor(){this.collections=new Map}get(e){if(e=Number(e),!this.collections.has(e)){const t=new n;t.setLessonId(e),this.collections.set(e,t)}return this.collections.get(e)}save(e,t){const s=TVA.routes.resources+"/mass-update";return wp.apiRequest({url:s,type:"POST",data:{lesson_id:e.lessonID,resources:e.toJSON(),removed_ids:t}}).done((t=>e.reset(t)))}}},64661:function(e,t,s){const i=s(8346);e.exports=Backbone.Collection.extend({model:i,hasIntegration:function(e){return this.findWhere({integration:e})instanceof i},hasEmptyRules:function(){let e=!0;return this.each((t=>{if("thrivecart"===t.get("integration"))return e=!1,e;e&&t.get("items").length&&(e=!1)})),e},resetRules:function(){this.hasIntegration("thrivecart")&&this.remove(this.findWhere({integration:"thrivecart"})),this.each((e=>e.resetItems()))}})},73799:function(e,t,s){e.exports=s(71195).extend({idAttribute:"id",model:s(84643),getSelectedItem:function(){return this.findWhere({selected:!0})},setSelected:function(e){return this.setSelectedId(e.get(this.idAttribute))},setSelectedId:function(e,t=0){e=parseInt(e);let s=this.findWhere({[this.idAttribute]:e});return s||(s=this.findWhere({[this.idAttribute]:t})),s&&(this.each((e=>e.set("selected",!1))),s.set("selected",!0),this.trigger("selectionchange",s)),this}})},45722:function(e,t,s){const i=s(64006),n=s(71195);e.exports=n.extend({model:i,initialize:function(e,t){if(!t||void 0===t.skin_id)throw new Error("This collection cannot be initialized without a skin_id");this.skin_id=parseInt(t.skin_id)},filterItems:function(e){return this.filter((t=>{switch(e){case"core":return t.isDefault();case"homepage":return t.isHomepage();case"lesson":return t.isLesson()||t.isAssessment();case"module":return t.isModule();case"course":return t.isCourse();case"course_completed":return t.isCompleted()}return!0}))},comparator:function(e){return e.id},filterByType:function(e,t=null){return this.filter((s=>{let i=s.primary()===e;return null!==t&&i&&(i=i&&s.secondary()===t),i}))}})},37816:function(e,t,s){const i=s(71195),n=s(93249),o=s(50251),r=new Map,a=i.extend({model:n,url:function(){return TVA.Utils.buildUrl(TVA.routes.skins,{})},comparator:function(e,t){return t.getId()-e.getId()},getActiveSkin:function(){return this.findWhere({is_active:!0})},skin:function(e){return e instanceof n?e:this.get(Number(e))},post:function(e="",t={}){return this.trigger("fetch"),wp.apiRequest({url:this.url()+(e?"/"+e.replace(/^\//,""):""),type:"POST",data:t}).done((e=>{this.reset(e),this.trigger("sync")}))},setDefaultSkin:function(e){const t=this.skin(e);return TVA.visualEditingEnabled=!t.isLegacy(),TVA.visualEditingEnabled&&(TVA.settings.load_scripts.value=1),this.post("set-default",{id:t.getId()})},duplicateSkin:function(e){return this.post("duplicate",{id:this.skin(e).getId()})},getWizard:function(e){const t=this.skin(e).getId();if(!r.get(t)){const e=new o({skin_id:t});r.set(t,e),TVA.$eventBus.on("courses_changed",(()=>delete e.$$fetched))}return r.get(t)},getByName:function(e=""){const t=e.toLowerCase().trim();return this.find((e=>e.get("name").toLowerCase().trim()===t))}});e.exports=a},23150:function(e,t,s){const i=s(71195),n=s(87168),o=s(20898),r=s(88524),a=s(4352);e.exports=i.extend({model:function(e={},t={}){switch(e.post_type){case"tva_module":return new n(e,t);case"tva_chapter":return new o(e,t);case"tva_lesson":return new r(e,t);case"tva_assessment":return new a(e,t);default:return new Backbone.Model(e,t)}},save:function(){const e=[];this.each((function(t){e.push(t.toJSON())}));const t=new l(e);return t.save.apply(t,arguments)},getIndex:function(e=0){const t=this.findItem(e);let s=null;return t instanceof Backbone.Model&&t.collection instanceof Backbone.Collection&&(s=t.collection.indexOf(t)),s},updateChildrenCommentStatus:function(e,t,s=""){const i=new l({});"boolean"==typeof t&&(t=t?"open":"closed"),i.updateChildrenCommentStatus(e,t,s,this.findItemsIDsByOptions()).success((e=>{e.update&&this.findItemsByOptions().forEach((e=>e.set("comment_status",t)))})).error((()=>{console.warn("Invalid Payload when updating the children comments status")}))},getType:function(){let e="content";if(0===this.length)return e;const t=this.first();if(!(t instanceof Backbone.Model))return e;switch(t.getType()){case"module":e="modules";break;case"chapter":e="chapters";break;case"lesson":e="lessons";break;case"assessment":e="assessments"}return e},getSingularType:function(){return this.first()instanceof Backbone.Model?this.first().getType():"content"},findItem:function(e){if(e=parseInt(e),isNaN(e))return null;let t=this.findWhere({id:e});return t instanceof Backbone.Model||this.some((s=>!!s.get("structure").length&&(t=this.findItem.call(s.get("structure"),e),t))),t},countChildren:function(e){if(e===parseInt(this.at(0).get("post_parent")))return this.length;const t=this.findItem(e);return t&&t.get("structure")&&t.get("structure").length||0},findItemsByOptions:function(e){let t=this.where(e);return this.forEach((s=>{if(s.get("structure").length){s.get("structure")instanceof this.constructor||s.set("structure",new this.constructor(s.get("structure")));const i=this.findItemsByOptions.call(s.get("structure"),e);t=t.concat(i)}})),t},findItems:function(e){let t=[];return this.each((s=>{e(s)&&t.push(s),s.get("structure").length&&(s.get("structure")instanceof this.constructor||s.set("structure",new this.constructor(s.get("structure"))),t=t.concat(s.get("structure").findItems(e)))})),t},findItemsIDsByOptions:function(e){return _.map(this.findItemsByOptions(e),(e=>e.get("ID")))},getOrderForNewItem:function(){const e=this.pluck("order");return 0===e.length&&e.push(-1),parseInt(_.last(e))+1},comparator:function(e,t){return parseInt(e.get("order"))-parseInt(t.get("order"))}});const l=s(84643).extend({url:function(){return`${TVA.apiSettings.root}${TVA.apiSettings.v1}/structure`},updateChildrenCommentStatus:function(e,t,s="",i=[]){return wp.apiRequest({type:"POST",url:`${this.url()}/update_children_comment_status`,data:{parent_id:e,parent_type:s,current_value:t,ids:i}})}})},74703:function(e,t,s){e.exports=s(71195).extend({model:s(51941)})},84531:function(e,t,s){const i=s(8426);e.exports=s(71195).extend({model:i,comparator:function(e,t){return t.get("ID")-e.get("ID")}})},72567:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(e){const t=s(83217);e.fn.tvaToggleLoader=function(t=20,s=null,i={}){"number"==typeof t&&(t+="px"),i=n(n({},{position:"center",background:"rgba(255, 255, 255, .8)",fadeDuration:100,wrapperCss:{}}),i);const{position:o,background:r,padding:a}=i;return!1===t&&(s=!1),this.each((function(){const l=e(this),c=l.data("tva-loader")||!!l.find(".tvd-card-preloader.tva-element-loader").length;if(null==s&&(s=!c),c===s)return;l.data("tva-loader",s);let d=l.find(".tvd-card-preloader.tva-element-loader");if(!s)return d.fadeOut(i.fadeDuration,(function(){d.remove(),l.removeClass("tva-disabled tva-element-loading").css("position","")})),void(d.length||l.removeClass("tva-disabled tva-element-loading").css("position",""));const h=!d.length;d.length?d.stop():d=e('<div class="tvd-card-preloader tva-element-loader"><div class="tvd-preloader-wrapper tvd-active"><div class="tvd-spinner-layer tvd-spinner-blue-only"><div class="tvd-circle-clipper tvd-left"><div class="tvd-circle"></div></div><div class="tvd-gap-patch"><div class="tvd-circle"></div></div><div class="tvd-circle-clipper tvd-right"><div class="tvd-circle"></div></div></div></div></div>').hide(),l.addClass("tva-disabled tva-element-loading"),["","static"].includes(l.css("position"))&&l.css("position","relative");const u={"align-items":"center","justify-content":"center"},p=o.includes("outside")?`-${parseInt(t)+5}px`:"",m={};o.includes("top")&&(u["align-items"]="flex-start"),o.includes("bottom")&&(u["align-items"]="flex-end"),o.includes("left")&&(u["justify-content"]="flex-start",m["margin-left"]=p),o.includes("right")&&(u["justify-content"]="flex-end",m["margin-right"]=p),d.css(n(n({},u),{},{background:r,padding:a},i.wrapperCss)),d.find(".tvd-preloader-wrapper").css(n({width:t,height:t},m)),h&&l.append(d),d.css("display","flex").fadeIn(i.fadeDuration)}))},e.fn.tvaInlineEdit=function(s){const i=n({required:!0},s||{});return this.each((function(){const s=e(this);if(s.data("tva-inline-edit"))return void s.data("tva-inline-edit").editing();s.data("tva-inline-edit-orig-html",s.html());const o=new t(n({$element:s},i));s.html(o.render().$el),s.data("tva-inline-edit",o)}))}}(jQuery)},66340:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(84643).extend({defaults:function(){return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({course_id:"",scope:"",conditions:{products:[],roles:[]}},o.extend(!0,{},TVA.accessRestriction.defaults))},url:function(){const e={scope:this.get("scope"),course:this.get("course_id")};return"undefined"!==this.get("id")&&(e.id=this.get("id")),TVA.Utils.buildUrl(TVA.routes.access_restriction,e)},ensureDataExists:function(e=null){return new Promise((t=>{"content"!==this.get("option")||this._dataEnsured||(this._dataEnsured=!0,wp.apiRequest({type:"POST",url:`${TVA.routes.access_restriction}/ensure-data`,data:{course:this.get("course_id"),scope:this.get("scope"),content:this.get("content"),option:"content",custom_id:e}}).done((e=>{this.deepSet("content.post",e.content.post),this.deepSet("content.post_id",e.content.post_id)})).always((()=>t()))),t()}))},validateOptions:function(){return"redirect_custom"!==this.get("option")||this.deepGet("redirect_custom.title")?"content"!==this.get("option")||this.deepGet("content.title")?!("buy_action"===this.get("option")&&!this.deepGet("buy_action.provider"))||TVA.t.selectProvider:TVA.t.EmptyTitle:TVA.t.RedirectPageRequired},validateConditions:function(){if(!this.get("conditions"))return!1;let e=this.get("index");return Object.values(this.get("conditions")).forEach((t=>{t.length&&e--})),0===e},isDuplicatedTitle:function(e){let t=!1;return e.length&&e.each((e=>{e.get("custom_id")!==this.get("custom_id")&&e.get("title")===this.get("title")&&(t=!0)})),t},validateCustomSettings:function(e){return this.validateConditions()?this.get("title")?!this.isDuplicatedTitle(e)||TVA.t.access_rule_invalid_name:TVA.t.EmptyTitle:1===this.get("index")?TVA.t.access_rule_conditions_empty:TVA.t.access_rule_conditions_invalid},ensureDefaultMessage:function(){this.get("message")||this.set("message",TVA.t.AccessRestrictionMessage[this.get("scope")])},getConditionCount:function(){return Object.entries(this.get("conditions")).filter((function(e){return e[1].length>0})).length}})},95070:function(e,t,s){e.exports=s(25805).extend({initialize:function(){let e="search-link";(parseInt(this.get("value"))||this.get("custom_link"))&&(e="normal"),this.attributes.state=e}})},25805:function(e,t,s){e.exports=s(58052).extend({url:function(){return TVA.Utils.buildUrl(TVA.routes.access_restriction+"/redirect-page",{op:this.get("state")})}})},69311:function(e,t,s){e.exports=s(84643).extend({url:function(){return`${TVA.routes.assessments}/settings`},validURL:function(e){const t=(e=e.replace(/\?(.*)$/,"")).match(/^(?:https?:\/\/)?(?:drive\.google\.com\/drive\/(?:u\/\d\/)?(?:folders\/))((\w|-){33})$/);return!!t&&t[1]},validate:function(e){var t;const s=[];if(e.upload_connection_key||s.push(this.validation_error("upload_connection_key",TVA.t.SettingsNoUploadService)),(null===(t=e.folder_id)||void 0===t?void 0:t.trim())||s.push(this.validation_error("folder_id",TVA.t.SettingsEmptyFolderId)),e.folder_full_link&&!this.validURL(e.folder_full_link)&&s.push(this.validation_error("folder_full_link",TVA.t.SettingsInvalidDriveLink)),e.upload_filename.trim()||s.push(this.validation_error("upload_filename",TVA.t.SettingsEmptyFilename)),s.length)return s}})},4352:function(e,t,s){e.exports=s(88524).extend({defaults:{comment_status:"closed",post_excerpt:"",post_type:"tva_assessment",order:0,cover_image:"",freemium:"inherit",grading_method:"pass_fail",grading_manually_mark:1,upload_max_file_size:TVA.max_upload_size,upload_max_files:1,upload_allowed_files:["documents"],has_submission:!1},initialize:function(){},url:function(){return`${TVA.routes.assessments}/${this.get("id")?this.get("id"):""}`},parse:function(e){return e},validate:function(e={}){const t=[],s=`validate${TVA.Utils.camelCaseFuncName(e.grading_method)}`,i=`validate${TVA.Utils.camelCaseFuncName(e.assessment_type)}`;if("function"==typeof this[i]){const s=this[i](e);s.length&&t.push(...s)}if("function"==typeof this[s]){const i=this[s](e);i.length&&t.push(...i)}if(e.post_title||t.push(this.validation_error("post_title",TVA.t.EmptyTitle)),t.length)return t},validateCategory:function(e){const t=[],s=e.grading_method_data.pass,i=e.grading_method_data.fail;return s.length&&i.length||t.push(this.validation_error("grading_method_data",TVA.t.categoryNotSelected)),t},validatePercentage:function(e){const t=[];return(isNaN(parseInt(e.passing_percentage))||e.passing_percentage<0||e.passing_percentage>100)&&t.push(this.validation_error("passing_percentage",TVA.t.invalidPercentage)),t},validateScore:function(e){const t=[];return isNaN(parseInt(e.passing_score))&&t.push(this.validation_error("passing_score",TVA.t.invalidScore)),t},validateTqb:function(e){const t=[];return e.quiz_id||t.push(this.validation_error("quiz_id",TVA.t.quizNotSelected)),t},validateUpload:function(e){var t;const s=[];return e.upload_allowed_files.length||s.push(this.validation_error("upload_allowed_files",TVA.t.noFileTypesSelected)),e.upload_allowed_files.includes("custom")&&!(null===(t=e.upload_custom_extensions)||void 0===t?void 0:t.length)&&s.push(this.validation_error("upload_custom_extensions",TVA.t.noCustomFileTypes)),e.upload_max_file_size&&!isNaN(parseInt(e.upload_max_file_size))||s.push(this.validation_error("upload_max_file_size",TVA.t.invalidFileSize)),e.upload_max_files&&!isNaN(parseInt(e.upload_max_files))||s.push(this.validation_error("upload_max_files",TVA.t.invalidMaxFiles)),s},isGradingMethodCategory:function(){return"category"===this.get("grading_method")}})},37184:function(e,t,s){e.exports=s(84643).extend({defaults:{tooltip:`data-position="top" data-tooltip="${TVA.t.OptionUnavailable}"`},url:function(){return`${TVA.routes.settings}/get_available_settings/`}})},58052:function(e,t,s){e.exports=s(84643).extend({defaults:function(){return{preview_url:"",title:"",edit_url:"",value:""}},initialize:function(){let e="search";parseInt(this.get("value"))&&(e="normal"),this.attributes.state=e},url:function(){return"search"===this.get("state")?`${TVA.routes.settings_v2}/core-page/update`:`${TVA.routes.settings_v2}/core-page/${this.get("state")}`},validate:function(e){const t=[];if("create"===e.state&&!e.title)return t.push(this.validation_error("title","")),t},previewUrl:function(e={}){const t=this.get("preview_url");return t?0===Object.keys(e).length?t:`${t}${t.includes("?")?"&":"?"}${jQuery.param(e)}`:""}})},84643:function(e){var t;t=jQuery,Backbone.emulateHTTP=!0,e.exports=Backbone.Model.extend({sync:function(e,t,s){const i=s.beforeSend;return s.beforeSend=function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce),"function"==typeof i&&i.apply(this,arguments)},this.saveState(),Backbone.Model.prototype.sync.apply(this,arguments)},validation_error:function(e,t){return{field:e,message:t=TVE_Dash.escapeHTML(t)}},getValidationError:function(){return this.validationError&&this.validationError[0]?this.validationError[0].message:""},saveState:function(){return this.__saved_state={},jQuery.extend(!0,this.__saved_state,this.attributes),this},restoreState:function(e=!1){return this.__saved_state?(this.set(this.__saved_state,{silent:e}),this):this},deepGet:function(e,t=null,s=this.attributes){if(!e)return t;const i=e.split(".");let n=s;for(;i.length>1;){const e=i.shift();if(n=n instanceof Backbone.Model?n.get(e):n[e],void 0===n)return t}return void 0===n[i[0]]?t:n[i[0]]},deepSet:function(e,s,i){if(!e.includes("."))return this.set(e,s,i),this;const n=e.split(".");let o=n.shift();const r=o;let a=t.extend(!0,{},this.get(o)||{});const l=a;for(;n.length>1;)o=n.shift(),a=a[o]||(a[o]={});return a[n[0]]=s,this.set(r,l,i),this},deepUnset:function(e,t=!1){const s=e.split(".");let i=this.attributes;for(;s.length>1;){const e=s.shift();if(i=i instanceof Backbone.Model?i.get(e):i[e],void 0===i)break}return void 0!==i&&void 0!==i[s[0]]&&(delete i[s[0]],t&&this.trigger("change")),this},toDeepJSON:function(){const e=t.extend(!0,{},this.attributes);return _.each(_.keys(e),(function(t){e[t]&&(_.isFunction(e[t].toDeepJSON)?e[t]=e[t].toDeepJSON():_.isFunction(e[t].toJSON)&&(e[t]=e[t].toJSON()))})),e},deepClone:function(){return new this.constructor(this.toDeepJSON())}})},60249:function(e,t,s){const i=s(84643);e.exports=i.extend({idAttribute:"ID",defaults:{title:"",course_id:0,edit_url:"",preview_url:""},url:function(){return`${TVA.apiSettings.root}${TVA.apiSettings.v1}/certificate/${this.get("ID")?this.get("ID"):""}`}})},20898:function(e,t,s){const i=s(62925);e.exports=i.extend({defaults:{post_type:"tva_chapter"},validate:function(e={}){const t=[];if((!e.post_title||e.post_title.length<=0)&&t.push(this.validation_error("post_title",TVA.t.EmptyTitle)),t.length)return t},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+`/chapters/${this.get("id")?this.get("id"):""}`}})},68110:function(e,t,s){const i=s(84643);e.exports=i.extend({idAttribute:"ID",defaults:{title:"",course_id:0,edit_url:"",preview_url:"",type:"completed",extra_id:0,allow_comments:0,post_name:""},url:function(){return`${TVA.apiSettings.root}${TVA.apiSettings.v1}/completed_post/${this.get("ID")?this.get("ID"):""}`},changeType:function(e){return this.set("type",e),new Promise((e=>{wp.apiRequest({type:"POST",url:`${this.url()}/change_type`,data:{course_id:this.get("course_id"),type:this.get("type")}}).done((t=>{this.set({post_name:t.post_name,title:t.title,edit_url:t.edit_url,preview_url:t.preview_url,extra_id:t.extra_id},{silent:!0}),e(t)})).always((t=>e(t)))}))},getTitle:function(){let e=!1;return this.get("title")&&(e=this.get("title")),e||(e=this.get("preview_url"),e&&"//"===e.substring(0,2)&&(e=e.substring(2))),e||""}})},59579:function(e,t,s){const i=s(64661),n=s(8426),o=s(38084),r=s(72177),a=s(65035),l=s(84643),c=s(23150),d=s(60249),h=s(68110);e.exports=l.extend({idAttribute:"id",defaults:{topic:0,level:0,label:-1,message:"",description:"",allows_comments:"open"===TVA.settings.comment_status.value,products:[],last_edit_date:""},initialize:function(e){if(this.on("tva.structure.status.changed tva.structure.modified",_.debounce((()=>{this.get("fetched")?this.getDripCampaigns().massApplySettings(this):this.fetch().done((()=>this.getDripCampaigns().massApplySettings(this))),this.refreshLastEditDate()}),400)),this.set("author",new Backbone.Model(e&&e.author||TVA.defaultAuthor)),"object"!=typeof e){const t=parseInt(e);if(isNaN(t))return void this.set({video:new o({options:[],source:"",type:"youtube"}),allows_comments:"open"===TVA.settings.comment_status.value,has_video:!1,excluded:0,protect_overview:0,rules:new i,order:TVA.courses.newItemOrder(),overview_post:new Backbone.Model,has_certificate:0,has_completed_post:0,certificate:new d,completed_post:new h});this.set("id",t),this.fetch({success:()=>{this.set("fetched",!0,{silent:!0}),this.fetchedWithSuccess.apply(this,arguments),this.saveState()},error:()=>{this.fetchedWithError.apply(this,arguments)}})}else this.set("rules",new i(e.rules||[])),this.set("overview_post",new Backbone.Model(e.overview_post||{})),this.set("certificate",new d(e.certificate||{})),this.set("completed_post",new h(e.completed_post||{}))},refreshLastEditDate:function(){wp.apiRequest({url:`${this.url()}/refreshLastEditDate`}).done((e=>{this.set({last_edit_date:e},{silent:!0})}))},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+`/courses/${this.get("id")?this.get("id"):""}`},parse:function(e={}){return e.video=this.get("video")instanceof o?this.get("video"):new o(e.video),e.author=this.get("author")instanceof Backbone.Model?this.get("author").set(e.author||{}):new Backbone.Model(e.author||{}),e.rules=new i(JSON.parse(JSON.stringify(e.rules||[]))),this.get("overview_post")instanceof Backbone.Model?e.overview_post=this.get("overview_post").set(e.overview_post||{}):e.overview_post=new Backbone.Model(e.overview_post||{}),this.get("certificate")instanceof l?e.certificate=this.get("certificate").set(e.certificate||{}):e.certificate=new d(e.certificate||{}),this.get("completed_post")instanceof l?e.completed_post=this.get("completed_post").set(e.completed_post||{}):e.completed_post=new h(e.completed_post||{}),e},fetchedWithSuccess:function(){this.trigger("tva.course.fetch.success",this)},fetchedWithError:function(){this.trigger("tva.course.fetch.error",this)},validate:function(e){let t=[];if(e.name||t.push(this.validation_error("name",TVA.t.InvalidName)),e.id&&!e.slug&&(TVE_Dash.err(TVA.t.InvalidSlug),t.push(this.validation_error("slug",TVA.t.InvalidSlug))),e.has_video&&e.video instanceof o){const s=e.video.validate(e.video.attributes);s&&(e.video.trigger("invalid",e.video,s),t=[...t,...s])}if(t.length)return t},hasSendOwlIntegration:function(){const e=this.get("rules");return e instanceof i?e.hasIntegration("sendowl_product")||e.hasIntegration("sendowl_bundle"):!!Array.isArray(e)&&e.filter((e=>["sendowl_product","sendowl_bundle"].includes(e.integration))).length},getTopic:function(){return new n(TVA.topics.findById(this.get("topic")).toJSON())},getItemsCount:function(){const e=this.get("count_lessons")?TVA.Utils._n(this.get("count_lessons"),"Lesson"):"",t=this.get("count_assessments")?TVA.Utils._n(this.get("count_assessments"),"Assessment"):"";return e&&t?`${e}, ${t}`:e||t},recountItems:function(){const e=this.get("structure");e&&e instanceof Backbone.Collection&&(this.set("count_lessons",e.findItemsByOptions({post_type:"tva_lesson"}).length,{silent:!0}),this.set("count_assessments",e.findItemsByOptions({post_type:"tva_assessment"}).length,{silent:!0}),this.saveState())},hasModules:function(){const e=this.get("structure");if(!e)return!1;let t;return t=e instanceof Backbone.Collection?e.at(0):e[0],!!t&&(t instanceof Backbone.Model?"module"===t.getType():"tva_module"===t.post_type)},getRestrictionSummary:function(e="not_logged"){return TVA.accessRestriction.options[this.getAccessRestrictionSettings(e).option].replace("(deprecated)","").trim()},getAccessRestrictionSettings:function(e){let t=this.deepGet(`access_restrictions.${e}`,!1);if(!1===t||!t.option){const e=this.get("message");t={option:e?"message":"inherit"},e&&(t.message=this.get("message"))}return t},restoreState:function(e=!1){return this.__saved_state?(delete this.__saved_state.last_edit_date,this.set(this.__saved_state,{silent:e}),this):this},getModulesAndLessons:function(e=!1,t=!0){let s=this.getStructure().findItems((e=>(e=>!t||"publish"===e.get("post_status"))(e)&&["module","lesson"].includes(e.getType())));if(e){const e=s;s=[];let i=!1;e.forEach((e=>{"module"===e.getType()?(i=!0,e.set("lessons",t?e.getPublishedLessons():e.getLessons()),s.push(e)):i||s.push(e)}))}return s},getLessons:function(){return this.get("structure").findItemsByOptions({post_type:"tva_lesson"})},getLessonsByType:function(e){return this.getLessons().filter((t=>t.get("lesson_type")===e))},getAssessments:function(){return this.get("structure").findItemsByOptions({post_type:"tva_assessment"})},hasPublishedContent:function(){return!!this.getModulesAndLessons(!1,!0).length},getDripCampaigns:function(){return this.dripCampaigns||(this.dripCampaigns=new r(this.get("drip_campaigns")),this.dripCampaigns.each((e=>e.set("course_id",this.get("id"),{silent:!0}))),this.dripCampaigns.course=this),this.dripCampaigns},fetchProducts:function(){return new Promise((e=>{wp.apiRequest({url:`${this.url()}/products`}).done((e=>{this.set({products:e}||[],{silent:!0})})).always((()=>e()))}))},getProducts:function(){return this.productsCollection||(this.productsCollection=new a(this.get("products"),{total:this.get("products").length})),this.productsCollection},hasContentId:function(e){return!!this.getModulesAndLessons().some((t=>t.get("ID")===e))},hasFreeLesson:function(){return this.getModulesAndLessons().some((e=>e.isFree()))},getStructure:function(){let e=this.get("structure");return e instanceof c||(e=new c(e)),e}})},62925:function(e,t,s){const i=s(84643);e.exports=i.extend({initialize:function(e){!e.structure||e.structure instanceof Backbone.Collection||this.set("structure",new this.collection.constructor(e.structure),{silent:!0})},getType:function(){return this.get("post_type").replace("tva_","")},isFree:function(){return["free-for-logged","free"].includes(this.get("freemium"))},isPublished:function(){return"publish"===this.get("post_status")},getParent:function(){return this.get("post_parent")?this.collection.parent:null},getParents:function(){let e=this.getParent();if(!e)return[];const t=[];do{t.push(e),e=e.getParent()}while(e);return t},getLessons:function(){return this.get("structure").findItemsByOptions({post_type:"tva_lesson"})},getPublishedLessons:function(){return this.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"publish"})},getModule:function(){const e=this.getHighestParent();return"module"===e.getType()?e:null},getHighestParent:function(){let e=this;for(;e.get("post_parent")>0&&e.collection&&e.collection.parent;)e=e.collection.parent;return e},set:function(){return"structure"===arguments[0]&&arguments[1]instanceof Backbone.Collection&&(arguments[1].parent=this),i.prototype.set.apply(this,arguments)},getCountSummary:function(e="tva-empty"){const t=this.get("structure");if(!t.length)return`<span class="${e}">(${TVA.t.empty})</span>`;const s=[];let i=0,n=0;return"chapter"===t.at(0).getType()?(s.push(TVA.Utils._n(t.length,TVA.t.chapter)),t.each((e=>{e.get("structure")&&(i+=e.get("structure").where({post_type:"tva_lesson"}).length,n+=e.get("structure").where({post_type:"tva_assessment"}).length)}))):(i=t.where({post_type:"tva_lesson"}).length,n=t.where({post_type:"tva_assessment"}).length),i&&s.push(TVA.Utils._n(i,"lesson")),n&&s.push(TVA.Utils._n(n,"assessmentItem")),`(${s.join(", ")})`},expand:function(){this.trigger("expand",this),this.get("post_parent")&&this.getParent().expand()},destroy:function(){return this.get("post_parent")&&this.getParents().forEach((e=>{const t=e.getPublishedLessons().filter((e=>e!==this&&e.getParent()!==this)).length>0;e.set("post_status",t?"publish":"draft",{silent:!0})})),i.prototype.destroy.apply(this,arguments)},isFirst:function(){return this.collection instanceof Backbone.Collection&&this.collection.at(0).get("ID")===this.get("ID")}})},7750:function(e,t,s){const i=s(71195);e.exports=s(84643).extend({idAttribute:"ID",defaults:{display_name:"",user_email:"",user_login:"",services:{},notify:0,edit_url:""},initialize:function(){this.set("services",{})},url:function(){let e=TVA.routes.customer;return this.get("ID")&&(e+=`/${this.get("ID")}`),e},validate:function(e){const t=[];if(e.user_login||t.push(this.validation_error("user_login",TVA.t.MissingUserLogin)),e.user_email||t.push(this.validation_error("user_email",TVA.t.MissingEmail)),TVA.Utils.isEmail(e.user_email)||t.push(this.validation_error("user_email",TVA.t.InvalidCustomerEmail)),t.length)return t},hasServices:function(){const e=this.get("services"),t=Object.keys(e);let s=!1;for(const i of t)if(Array.isArray(e[i])&&e[i].length>0){s=!0;break}return s},removeServices:function(){this.set("services",{})},getPurchasedItems:function(){return new Promise((e=>{if(this.get("purchasedItems")instanceof Backbone.Collection)return void e(this.get("purchasedItems"));const t=new i;t.url=this.url()+"/purchased-items",t.fetch({success:t=>{t instanceof Backbone.Collection&&this.set("purchasedItems",t),e(this.get("purchasedItems"))}})}))},getAccessCourses:function(){return new Promise((e=>{if(this.get("courses")instanceof Backbone.Collection)return e(this.get("courses"));const t=new i;t.url=`${this.url()}/products`,t.fetch({success:t=>(t instanceof i&&this.set("courses",t),e(this.get("courses")))})}))},getCoursesData:function(){return wp.apiRequest({url:`${TVA.routes.customer}/${this.id}/courses_data`})}})},76419:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(84643),a=s(42315),l=r.extend({defaults:function(){return jQuery.extend(!0,{},{post_title:"",type:"",content_type:"tva_lesson",trigger:"",lock_from:"",lock_from_id:"",schedule_type:"",schedule:{},unlock_date:window.moment().add(7,"days").format("Y-MM-DD 12:00"),unlock:{},display_locked:!0,force_unlock_order:!1})},isValid:function(){return void 0===this.validate()},validate:function(){const e=void 0!==this.collection?this.collection.course:TVA.courses.findWhere({id:this.get("course_id")}),t=[],s=this.get("id");if(0!==e.dripCampaigns.where({post_title:this.get("post_title").trim()}).filter((function(e){return e.get("id")!==s})).length&&t.push({field:"post_title",message:TVA.t.drip_campaign_name_taken}),this.get("post_title").trim()||t.push({field:"post_title",message:"Campaign name is required"}),this.isRepeating()&&!this.get("lock_from")&&t.push({field:"lock_from",message:"Choose a module / course"}),t.length)return t},getTypeLabel:function(){const e=l.getTemplateInfo(l.getTypeForCampaign(this))||{};return e.details_label||e.label||"Custom"},getIcon:function(){const e=l.getTypeForCampaign(this);let t=`drip-campaign-${e}`;return"automator"===e&&(t="drip-automator"),TVA.Utils.icon(t)},getUnlockSettingsForContentId:function(e,t=!1){e=parseInt(e);let s=jQuery.extend(!0,{},this.deepGet(`unlock.${e}`,!1));return t&&(s=new a(s||{},{campaign:this})),s},setUnlockSettingsForContentId:function(e,t,s={}){var i;return e=parseInt(e),t.inherit_from||(null===(i=t.triggers)||void 0===i?void 0:i.length)||"inherited"!==t.visibility||"inherited"!==t.forced_unlock?this.deepSet(`unlock.${e}`,jQuery.extend(!0,{},t),s):this.unsetUnlockConditionsForContentId(e)},unsetUnlockConditionsForContentId:function(e){return this.deepUnset(`unlock.${e}`)},getUnlockSummaryForContentId:function(e){var t;e=parseInt(e);const s=this.collection.course.get("structure").models[0];let i=[];if(void 0!==s.get("lessons")){const e=s.get("lessons")[0];i=[s.id,e.id]}else i="tva_chapter"===s.get("post_type")?[s.get("structure").first().get("id")]:[s.id];const n=this.getUnlockSettingsForContentId(e,!0);if(!(null===(t=n.get("triggers"))||void 0===t?void 0:t.length)&&!n.hasInherited())return n.isForcedUnlockOn()&&!i.includes(e)?{locked:!1,forced_unlock:!0}:{locked:!1};const o=n.getSummary();return i.includes(e)&&(o.forced_unlock=!1),o},applySettings:function(e,t=!1){const s=e.getModulesAndLessons(),i=this.isRepeating(),n=this.isAutomator();let o=parseInt(this.get("lock_from"));const r=s[o];if(r&&r.get("post_type")!==this.get("content_type")){const e=parseInt(this.get("lock_from_id")),t=_.findIndex(s,(t=>t.get("ID")===e));-1!==t&&(this.set("lock_from",t,{silent:!0}),o=t)}let a=!1;t?this.set("unlock",{},{silent:!0}):Object.keys(this.attributes.unlock).forEach((e=>{if(t=e,t=parseInt(t),!s.some((e=>e.get("ID")===t)))return void delete this.attributes.unlock[e];var t;const i=this.getUnlockSettingsForContentId(e,!0).removeTrigger("scheduled");this.setUnlockSettingsForContentId(e,i.toJSON(),{silent:!0})}));let l=1;return s.forEach(((e,t)=>{if((n||i)&&a&&e.get("post_type")===this.get("content_type")){const t=this.getUnlockSettingsForContentId(e.get("ID"),!0),s={id:i?"scheduled":"automator",schedule:{}};t.addTrigger(s,"first"),i&&t.set("content_index",l++),this.setUnlockSettingsForContentId(e.get("ID"),t.toJSON())}"module"===e.getType()&&this.ensureInheritedSettings(e),t===o&&(a=!0)})),this},ensureInheritedSettings:function(e=null){if(!e||"module"!==e.getType())return this;const t=!!this.getUnlockSettingsForContentId(e.get("ID"),!0).get("triggers").length;return e.getLessons().forEach((s=>{const i=this.getUnlockSettingsForContentId(s.get("ID"),!0);t?i.setInheritFrom(e.get("ID")):i.unsetInheritFrom(),this.setUnlockSettingsForContentId(s.get("ID"),i.toJSON())})),this},url:function(){return TVA.routes.campaigns+`/${this.get("id")||""}`},prepopulate:function(){let e={};_.some(l.typeScheduleMap,((t,s)=>{if(this.get("type")===t){const[t,i]=s.split("+");return e={schedule_type:t,trigger:i,schedule:n({},TVA.drip.schedule_defaults[t])},!0}return!1})),"day-of-week"===this.get("type")&&(e=n(n({},e),{},{schedule_type:"repeating",trigger:"purchase",schedule:{interval:"months",interval_number:"1",monthly_type:"day",monthly_day_order:"first",weekday:"1"}})),e&&this.set(e)},prefillLockFrom:function(e){let t=!1;switch(this.get("content_type")){case"tva_lesson":case"tva_module":t=_.findIndex(e.getModulesAndLessons(),(e=>e.get("post_type")===this.get("content_type")))}!1!==t&&t>-1&&this.set("lock_from",String(t),{silent:!0})},updateTemplateType:function(e={}){return this.set("type",l.getTypeForCampaign(this),e),this},determineType:function(){return l.getTypeForCampaign(this)},isEvergreen:function(){return["first-lesson","purchase"].includes(this.get("trigger"))},isRepeating:function(){return"repeating"===this.get("schedule_type")},isAutomator:function(){return"automator"===this.get("schedule_type")},getRepeatingIntervalNumber:function(){return this.isRepeating()?this.deepGet("schedule.interval_number"):0},getRepeatingIntervalName:function(e=null,t=!1){if(!this.isRepeating())return"-";const s=this.getRepeatingIntervalNumber();if(["weekday","weekend"].includes(s))return TVA.Utils._n(e||1,s,s+"s",!1);const i=this.deepGet("schedule.interval"),n=this.deepGet("schedule.weekday"),o=i.replace(/s$/,"");let r="";return t&&"weeks"===i&&n>=0&&(r+=" "+TVA.t.drip_campaign_settings.on_a+" "+TVA.drip.weekdays[n]),TVA.Utils._n(e||parseInt(s),o,i,!1)+r},getScheduleDetails:function(e=!0,t=TVA.t.drip_campaign_settings.content_unlocked){let s;if(this.isRepeating()){let i="",n=this.getRepeatingIntervalNumber();"weekday"===n?i=TVA.t.drip_campaign_settings.on_weekdays:"weekend"===n?i=TVA.t.drip_campaign_settings.on_weekends:(i=TVA.t.drip_campaign_settings.every+" ",n=parseInt(n),1!==n&&(i+=n+" "),i+=this.getRepeatingIntervalName(n,e)),s=t+" "+i}else s=TVA.t.drip_campaign_settings.content_unlocked_custom;return s},getScheduleSummary:function(){return this.isAutomator()?TVA.t.drip_campaign_settings.automator_unlock:this.isRepeating()?this.getScheduleDetails(!1,TVA.t.drip_campaign_settings.unlock):TVA.t.drip_campaign_settings.at_custom_intervals},getTriggerSummary:function(){var e;return null===(e=l.getTriggerInfo(this.get("trigger")))||void 0===e?void 0:e.summary},ensureValidSettings:function(e){if(""===this.get("lock_from"))return;const t={},s=e.getModulesAndLessons();if(this.get("lock_from_id")&&!this.isRepeating()){const e=parseInt(this.get("lock_from_id"));let i=-1;s.some(((t,s)=>t.get("ID")===e&&(i=s,!0))),-1===i?(t.lock_from_id="",t.lock_from=""):t.lock_from=String(i)}this.set(t,{silent:!0})},getLongDescription:function(){const e=l.getTypeForCampaign(this);return l.getTemplateInfo(e).longdesc},getModalTitle:function(){const e=l.getTypeForCampaign(this);return l.getTemplateInfo(e).label},getTriggerIcon:function(e="tva-main-color tva-s-icon mr-15"){const t=this.get("trigger");let s=`drip-trigger-${t}`;return"datetime"===t&&(s="drip-calendar"),TVA.Utils.icon(s,"ta-",e)},getScheduleIcon:function(e="tva-main-color tva-s-icon mr-15"){let t;return t="repeating"===this.get("schedule_type")?"drip-icon-repeat":"drip-icon-non-repeat",TVA.Utils.icon(t,"ta-",e)},getUnlockedLabel:function(){return TVA.t["drip_"+("datetime"===this.get("trigger")?"day_zero":"unlocked")]},getUnlockedTooltip:function(){switch(this.get("trigger")){case"datetime":return TVA.t.drip_campaign_settings.content_unlocked_on+" "+this.get("unlock_date");case"purchase":return TVA.t.drip_campaign_settings.content_unlocked_on_purchase;case"first-lesson":return TVA.t.drip_campaign_settings.content_unlocked_on_first_access;default:return""}}},{typeScheduleMap:{"repeating+datetime":"scheduled-repeating","repeating+purchase":"evergreen-repeating","repeating+first-lesson":"evergreen-repeating","non_repeating+datetime":"live-launch","automator+datetime":"automator","automator+purchase":"automator","automator+first-lesson":"automator","non_repeating+first-lesson":"sequential","+":"custom"},getTypeForCampaign:function(e){const t=`${e.get("schedule_type")}+${e.get("trigger")}`,s=e.isRepeating(),i="weeks"===e.deepGet("schedule.interval"),n="months"===e.deepGet("schedule.interval"),o=i&&"-1"!==e.deepGet("schedule.weekday")||n&&"any"!==e.deepGet("schedule.monthly_type");return s&&o?"day-of-week":l.typeScheduleMap[t]||"custom"},getTemplateInfo:function(e,t="custom"){let s=!1,i={};return TVA.drip.campaign_types.some((n=>n.type===e?(s=n,!0):(n.type===t&&(i=n),!1))),s||i},getTriggerInfo:function(e){return _.findWhere(TVA.drip.content_triggers,{id:e})}});e.exports=l},14859:function(e,t,s){const i=s(84643).extend({defaults:function(){return jQuery.extend(!0,{},{id:"assessment",object_id:0})},getLabel:function(){return"User has to "+this.get("when")+" assessment "+this.get("object_name")},canEdit:function(){return this.canRemove()},canRemove:function(){return!0},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:"Assessment",tooltip:this.getLabel()}},icon:function(){return"drip-assessment"}});e.exports=i},86274:function(e,t,s){const i=_.findWhere(TVA.drip.content_triggers,{id:"automator"}),n=s(62538).extend({scheduleType:"automator",defaults:function(){return jQuery.extend(!0,{},{id:"automator",schedule:{}})},getLabel:function(){return i.name},canRemove:function(){return!0},canEdit:function(){return!1},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:i.summary,tooltip:this.getLabel()}},icon:function(){return"drip-automator"}});e.exports=n},62538:function(e,t,s){const i=s(23503).extend({scheduleType:"non_repeating",defaults:function(){return jQuery.extend(!0,{},{id:"campaign",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return this.getInterval()+" "+TVA.t.drip_after_campaign_start},canRemove:function(){return!0},getInterval:function(){const e=this.deepGet("schedule.interval"),t=this.deepGet("schedule.interval_number");return TVA.Utils._n(parseInt(t),e.replace(/s$/,""),e,!0)},getSummary:function(){const e=this.getInterval();return{id:this.get("id"),icon:this.icon(),text:`+${e}`,tooltip:this.getLabel()}},icon:function(){return"drip-time-after"}});e.exports=i},98348:function(e,t,s){const i=s(84643).extend({defaults:function(){return jQuery.extend(!0,{},{id:"course-content",objects:[],uneditedObjects:[]})},getLabel:function(){if(1===this.get("objects").length){let e="User has to complete %s %s";return e=TVE_Dash.sprintf(e,[this.get("objects")[0].type,this.get("objects")[0].text]),e}return"User has to complete multiple content"},canEdit:function(){return this.canRemove()},canRemove:function(){return!0},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:"Progress",tooltip:this.getLabel()}},icon:function(){return"drip-content"}});e.exports=i},86048:function(e,t,s){const i=s(84643).extend({scheduleType:"specific",defaults:function(){return jQuery.extend(!0,{},{id:"datetime",occurrence:"after",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return TVE_Dash.sprintf(TVA.t.trigger_datetime_label,this.get("occurrence"),this.deepGet("schedule.datetime"))},canEdit:function(){return this.canRemove()},canRemove:function(){return!0},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:this.deepGet("schedule.datetime","").split` `.shift(),tooltip:this.getLabel()}},icon:function(){return"drip-calendar"}});e.exports=i},19311:function(e,t,s){const i=s(86048),n=s(28626),o=s(86604),r=s(23503),a=s(62538),l=s(86274),c=s(98348),d=s(15492),h=s(14859),u=s(10766);e.exports=function(e){const t=Array.prototype.slice.call(arguments,0);switch(e.id){case"datetime":return new i(...t);case"purchase":return new n(...t);case"first-lesson":return new o(...t);case"scheduled":return new r(...t);case"campaign":return new a(...t);case"automator":return new l(...t);case"course-content":return new c(...t);case"tqb_result":return new d(...t);case"assessment":return new h(...t);case"video-progress":return new u(...t);default:throw new Error("unknown trigger type: "+e.id)}}},86604:function(e,t,s){const i=s(28626).extend({scheduleType:"non_repeating",defaults:function(){return jQuery.extend(!0,{},{id:"first-lesson",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return this.getInterval()+" "+TVA.t.drip_first_lesson},getSummary:function(){const e=this.getInterval();return{id:this.get("id"),icon:this.icon(),text:`+${e}`,tooltip:this.getLabel()}},icon:function(){return"drip-trigger-first-lesson"}});e.exports=i},28626:function(e,t,s){const i=s(86048).extend({scheduleType:"non_repeating",defaults:function(){return jQuery.extend(!0,{},{id:"purchase",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return this.getInterval()+" "+TVA.t.drip_after_purchase},getInterval:function(){const e=this.deepGet("schedule.interval"),t=this.deepGet("schedule.interval_number");return TVA.Utils._n(parseInt(t),e.replace(/s$/,""),e,!0)},getSummary:function(){const e=this.getInterval();return{id:this.get("id"),icon:this.icon(),text:`+${e}`,tooltip:this.getLabel()}},icon:function(){return"shopping-cart_light"}});e.exports=i},23503:function(e,t,s){const i=s(86048).extend({getCampaign:function(){return this.collection.campaign},getUnlockSettings:function(){return this.collection.unlockSettings},defaults:function(){return jQuery.extend(!0,{},{id:"scheduled",schedule:{}})},getLabel:function(){return this.getCampaign().getScheduleDetails()},canRemove:function(){return!1},getSummary:function(){const e=this.getUnlockSettings().get("content_index");let t=this.getCampaign().getRepeatingIntervalNumber();["weekday","weekend"].includes(t)&&(t=1);const s=(e||1)*t;return{id:this.get("id"),icon:this.icon(),text:`+${s} ${this.getCampaign().getRepeatingIntervalName(s)}`,tooltip:this.getLabel()}},icon:function(){return"drip-icon-repeat"}});e.exports=i},10766:function(e,t,s){const i=s(84643).extend({defaults:function(){return jQuery.extend(!0,{},{id:"video-progress",object_id:0})},getLabel:function(){return"User has to watch the featured video of "+this.get("object_name")+" to completion"},canEdit:function(){return this.canRemove()},canRemove:function(){return!0},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:"Video",tooltip:this.getLabel()}},icon:function(){return"lesson-video"}});e.exports=i},42315:function(e,t,s){const i=s(99051),n=Backbone.Model.extend({defaults:function(){return jQuery.extend(!0,{},{inherit_from:0,content_index:-1,condition:"and",triggers:[],forced_unlock:"inherited",visibility:"inherited"})},initialize:function(e,t){if(!t||!t.campaign)throw new Error("Missing `campaign` option in unlock settings constructor call");this.campaign=t.campaign,this.parse(e)},parse:function(e){e.triggers instanceof i||(e.triggers=new i(e.triggers||[]),this.set("triggers",e.triggers),e.triggers.campaign=this.campaign,e.triggers.unlockSettings=this)},toJSON:function(){const e=Backbone.Model.prototype.toJSON.call(this);return e.triggers=e.triggers.toJSON(),e},getSummary:function(){return{inherited:this.hasInherited(),locked:!0,forced_unlock:this.isForcedUnlockOn(),condition:this.get("condition"),items:this.get("triggers").map((e=>e.getSummary()))}},addTrigger:function(e,t="end"){this.removeTrigger(e),"automator"===e.id?this.get("triggers").reset([],{silent:!0}):this.removeTrigger("automator");let s="add";const i={};switch(!0){case["end","last"].includes(t):s="push";break;case["start","first",0,"0"].includes(t):case parseInt(t)<0:s="unshift";break;default:t=parseInt(t),i.at=t>this.get("triggers").length?this.get("triggers").length:i.at}return this.get("triggers")[s](e,i),this},getTriggerCount:function(){return this.get("triggers").length},getTrigger:function(e){return this.get("triggers").get(e)},hasTrigger:function(e){return!!this.get("triggers").get(e)},removeTrigger:function(...e){return e.forEach((e=>{let t=e;e instanceof Backbone.Model?t=e.get("id"):e.id&&(t=e.id),this.get("triggers").remove(t)})),this},setInheritFrom:function(e){this.set("inherit_from",e)},unsetInheritFrom:function(){this.set("inherit_from",0)},hasInherited:function(){const e=parseInt(this.get("inherit_from"));return!isNaN(e)&&e>0},isForcedUnlockOn:function(){const e="inherited"===this.get("forced_unlock")&&this.campaign.get("force_unlock_order");return"yes"===this.get("forced_unlock")||e}});e.exports=n},10131:function(e,t,s){e.exports=s(84643).extend({url:function(){return TVA.routes.email_template}})},56298:function(e,t,s){e.exports=s(84643).extend({defaults:()=>({title:"core",template:"core",name:"",counter:0}),setOptions:function(e,t=!1){this.set(e),t||this.trigger("tva_dash:filter")}})},12656:function(e){const t=Backbone.Model.extend({getId:function(){return this.get("id")},getName:function(){return this.get("name")}}),s=Backbone.Collection.extend({model:t});e.exports={itemsCollection:s,model:Backbone.Model.extend({initialize:function(e){let t=[];e.items&&(e.items instanceof s?t=e.items:Array.isArray(e.items)&&(t=new s(e.items))),this.set("items",t)},getItems:function(){return this.get("items")},getText:function(){let e="T: Give access if user has any of the following:";const t=TVA.t.integrations[this.get("slug")];return t&&(e=t.rule_text),e}})}},19125:function(e){e.exports=Backbone.Model.extend({})},8346:function(e,t,s){const i=s(12656),n=s(12656);e.exports=i.model.extend({resetItems:function(e={}){return this.set("items",e instanceof Backbone.Collection?e:new Backbone.Collection),this},contains:function(e){return e instanceof Backbone.Model&&this.getItems().findWhere({id:e.getId()})instanceof Backbone.Model},getItemsToString:function(e){let t=[];return e instanceof n.model?this.get("items").each((function(s){const i=s.get("id"),n=e.get("items").findWhere({id:i});n instanceof Backbone.Model&&t.push(n.getName())})):t=this.get("items").pluck("name"),0===t.length&&t.push(TVA.t.NoProducts),t=t.join(", "),t}})},14493:function(e,t,s){e.exports=s(12656).model.extend({getText:function(){return TVA.t.integrations.thrivecart.rule_text}})},93275:function(e,t,s){const i=s(8426);e.exports=i.extend({savedMessage:TVA.t.label_saved,defaults:function(){return{title:"New Label",color:"#58a545",label_color:"#58a545"}},url:function(){return this.urlWithId(TVA.routes.labels)},persist:function(e){return e.color&&(e.label_color=e.color),i.prototype.persist.apply(this,arguments)}})},70108:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(84643),a=s(93275),l=a.extend({savedMessage:TVA.t.settingsSaved,save:function(){return this.settings.save()},defaults:function(){return n(n({},a.prototype.defaults.call(this)),{},{opt:"show"})},toJSON:function(){return this.pick(Object.keys(this.defaults()))}}),c=l.extend({defaults:function(){return{title:""}}}),d=l.extend({defaults:function(){return{singular:"",plural:""}}}),h=r.extend({initialize:function(e){this.set("labels",this.initLabels(e.labels||{},"labels",l)),this.set("buttons",this.initLabels(e.buttons||{},"buttons",c)),this.set("course_labels",this.initLabels(e.course_labels||{},"course_labels",c)),this.set("course_navigation",this.initLabels(e.course_navigation||{},"course_navigation",c)),this.set("course_structure",this.initLabels(e.course_structure||{},"course_structure",d)),this.set("course_progress",this.initLabels(e.course_progress||{},"course_progress",c))},initLabels:function(e,t,s){const i={},n=this.get(t)||{};return _.each(e||{},((e,t)=>{i[t]=n[t]instanceof s?n[t]:new s,i[t].set(e,{silent:!0}),i[t].settings=this})),i},getUserContextLabel:function(e){return this.get("labels")[e]},getCTAButtonLabel:function(e){return this.get("buttons")[e]},getCourseTypeLabel:function(e){return this.get("course_labels")[e]},getCourseNavigationLabel:function(e){return this.get("course_navigation")[e]},getCourseStructureLabel:function(e){return this.get("course_structure")[e]},getCourseProgressLabel:function(e){return this.get("course_progress")[e]},parse:function(e){e.labels=this.initLabels(e.labels,"labels",l)},toJSON:function(){return n(n({},r.prototype.toJSON.call(this)),{},{switch_labels:this.get("switch_labels"),labels:_.mapObject(this.get("labels"),(e=>e.toJSON()))})},url:function(){return TVA.routes.labels+"/dynamic-settings"}});e.exports=new h(TVA.dynamicLabelSetup.settings)},88524:function(e,t,s){const i=s(62925),n=s(38084),o=s(25936);e.exports=i.extend({defaults:{comment_status:"closed",post_excerpt:"",post_type:"tva_lesson",order:0,cover_image:"",lesson_type:"text",freemium:"inherit"},initialize:function(e={}){this.set({video:new n(e.video),audio:new o(e.audio)})},validate:function(e={}){let t,s,i=[];if(e.audio&&(t=e.audio.validate(e.audio.attributes)),e.video&&(s=e.video.validate(e.video.attributes)),e.post_title||i.push(this.validation_error("post_title",TVA.t.EmptyTitle)),"audio"===e.lesson_type&&t&&t.length&&(e.audio.trigger("invalid",e.audio,t),i=[...i,...t]),"video"===e.lesson_type&&s&&s.length&&(e.video.trigger("invalid",e.video,s),i=[...i,...s]),i.length)return i},parse:function(e={}){return e.video=new n(e.video),e.audio=new o(e.audio),e},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+`/lessons/${this.get("id")?this.get("id"):""}`},getResourceCount:function(){const e=parseInt(this.get("resource_count"));return isNaN(e)?0:e},formatResourceCount:function(e=""){const t=this.getResourceCount();return t?e+TVA.Utils._n(t,"resource_singular","resource_plural"):""},getPrevious:function(e,t=""){if(this.isFirst(e))return null;const s=e.getLessons(),i=s.findIndex((e=>e.get("ID")===this.get("ID")));return t?e.getLessonsByType(t).filter((e=>e.get("order")<i)).pop():s[i-1]},isFirst:function(e){return 0===e.getLessons().findIndex((e=>e.get("ID")===this.get("ID")))}})},25936:function(e,t,s){e.exports=s(26465).extend({defaults:{options:[],source:"",type:"soundcloud"},setDefaultOptions:function(){this.set("options",[])},getRegexes:function(e){const t=[];switch(e){case"soundcloud":t.push("soundcloud");break;case"custom":t.push(".");break;default:t.push(e)}return t}})},26465:function(e,t,s){e.exports=s(84643).extend({defaults:{options:[],source:"",type:""},initialize:function(e){e&&e.source&&"string"==typeof e.source&&(e.source=_.unescape(e.source),this.set({source:e.source},{silent:!0}))},getRegexes:function(e){const t=[];return"custom"===e?t.push("."):t.push("w+"),t},validate:function(e={}){const t=[];if(e.source||t.push(this.validation_error("source","custom"===e.type?TVA.t.NoEmbedCode:TVA.t.NoURL)),"custom"!==e.type)try{const{hostname:s,pathname:i}=new URL(e.source),n=this.getRegexes(e.type);let o=!1;n.forEach((e=>{o=o||null!==s.match(e)})),o?"bunnynet"!==e.type||i.match("play\\/\\d+\\/[A-Za-z0-9]+")||t.push(this.validation_error("source",TVA.t.invalidDirectPlayUrl)):t.push(this.validation_error("source",TVA.t.invalidDomainUrl))}catch(e){t.push(this.validation_error("source",TVA.t.NoURL))}if(t.length)return t},valid_bind_source:function(e){return"custom"!==this.get("type")||(this.set("source",_.escape(e)),!1)}})},38084:function(e,t,s){const i=s(26465);e.exports=i.extend({defaults:{options:[],source:"",type:"youtube"},setDefaultOptions:function(e){e||(e=this.get("type")),"bunnynet"===e?this.set("options",{responsive:1,autoplay:1,preload:1}):this.set("options",[])},getRegexes:function(e){const t=[];switch(e){case"youtube":t.push("youtube"),t.push("(youtu.be)");break;case"bunnynet":t.push("video.bunnycdn"),t.push("iframe.mediadelivery");break;case"vimeo":t.push("vimeo");break;case"wistia":t.push("wistia");break;case"custom":t.push(".");break;default:t.push(e)}return t}})},87168:function(e,t,s){const i=s(62925);e.exports=i.extend({defaults:{comment_status:"closed",post_excerpt:"",post_type:"tva_module",order:0,post_status:"draft",freemium:"inherit"},validate:function(e={}){const t=[];if(e.post_title||t.push(this.validation_error("post_title",TVA.t.EmptyTitle)),t.length)return t},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+`/modules/${this.get("id")?this.get("id"):""}`},getPrevious:function(){if(this.isFirst())return null;const e=this.collection.indexOf(this);return this.collection.at(e-1)},getLastLesson:function(){const e=this.getLessons();return _.last(e)},getPreviousLesson:function(){const e=this.getPrevious();return e instanceof i?e.getLastLesson():null}})},82554:function(e,t,s){const i=s(84643);e.exports=i.extend({defaults:{enabled:0,expiry:new i({cond:"after_purchase",cond_purchase:{number:"7",unit:"d"},cond_datetime:""}),reminder:{enabled:0,number:"7",unit:"d"},redirect:{enabled:0,value:""}},initialize:function(e){e.expiry&&this.set("expiry",new i(e.expiry))},isEnabled:function(){return!!this.get("enabled")},toggleReminder:function(e){this.get("reminder").enabled=Number(e)},shouldSendReminder:function(){return!!this.get("reminder").enabled},toggleRedirect:function(e){this.get("redirect").enabled=Number(e)},shouldRedirect:function(){return!!this.get("redirect").enabled},validate:function(){if(this.isEnabled()&&this.shouldSendReminder()){const e=this.get("expiry").get("cond"),t=this.get("reminder").number,s=this.get("reminder").unit;if("after_purchase"===e){const e=this.get("expiry").get("cond_purchase").number,i=this.get("expiry").get("cond_purchase").unit,n=window.moment().add(e,"d"===i?i:i.toUpperCase()).subtract(t,"d"===s?s:s.toUpperCase());if(window.moment().isAfter(n))return["The expiry date can not be higher than the reminder date"]}else if("specific_time"===e){const e=window.moment(this.get("expiry").get("cond_datetime")).subtract(t,"d"===s?s:s.toUpperCase());if(window.moment().isAfter(e))return["With the current settings the reminder date is in the past compared to today"]}}}})},95053:function(e,t,s){const i=s(64661),n=s(71195),o=s(46168),r=s(84643),a=s(67925),l=s(82554);e.exports=r.extend({idAttribute:"id",defaults:{name:""},initialize:function(e){var t;e=e||{},this.get("id")||this.set({order:TVA.products.newItemOrder()||0}),e.sets instanceof Backbone.Collection&&(e.sets=e.sets.toJSON()),e.rules instanceof Backbone.Collection&&(e.rules=e.rules.toJSON()),e.buy_now_links instanceof Backbone.Collection&&(e.buy_now_links=e.buy_now_links.toJSON()),this.set({rules:new i(e.rules||[]),buy_now_links:new o(e.buy_now_links||[]),sets:new TD_SETS.Collections.Sets(e.sets||[]),access_expiry:new l(e.access_expiry||{})});let s=null===(t=this.get("access_restrictions"))||void 0===t?void 0:t.custom;s instanceof Backbone.Collection&&(s=s.toJSON()),this.get("access_restrictions")&&(this.get("access_restrictions").custom=new a(s||[]),this.get("access_restrictions").custom.invoke("set",{course_id:this.get("id"),scope:"custom"}))},parse:function(e={}){var t,s;return e.sets instanceof Backbone.Collection&&(e.sets=e.sets.toJSON()),e.rules instanceof Backbone.Collection&&(e.rules=e.rules.toJSON()),e.rules instanceof l&&(e.access_expiry=e.access_expiry.toJSON()),e.buy_now_links instanceof Backbone.Collection&&(e.buy_now_links=e.buy_now_links.toJSON()),e.sets=new TD_SETS.Collections.Sets(JSON.parse(JSON.stringify(e.sets||[]))),e.rules=new i(JSON.parse(JSON.stringify(e.rules||[]))),e.access_expiry=new l(e.access_expiry||{}),e.order=parseInt(e.order),e.customers_count=parseInt(e.customers_count),e.buy_now_links=new o(JSON.parse(JSON.stringify(e.buy_now_links||[]))),e.access_restrictions&&(void 0!==this.get("access_restrictions")&&(null===(t=this.get("access_restrictions"))||void 0===t?void 0:t.custom)instanceof Backbone.Collection?(null===(s=this.get("access_restrictions"))||void 0===s?void 0:s.custom)instanceof Backbone.Collection&&(e.access_restrictions.custom=this.get("access_restrictions").custom):(e.access_restrictions.custom=new a(e.access_restrictions.custom||[]),e.access_restrictions.custom.invoke("set",{course_id:e.id,scope:"custom"}))),delete TVA.allProducts,e},url:function(){const e=this.get("id");return`${TVA.routes.products}/${e||""}`},getRestrictionSummary:function(e="not_logged"){return TVA.accessRestriction.options[this.getAccessRestrictionSettings(e).option].replace("(deprecated)","").trim()},getAccessRestrictionSettings:function(e){let t=this.deepGet(`access_restrictions.${e}`,!1);if(!1===t||!t.option){const e=this.get("message");t={option:e?"message":"inherit"},e&&(t.message=this.get("message"))}return t},getDefaultSet:function(){return this.get("sets").length||this.get("sets").add(new TD_SETS.Models.Set),this.get("sets").first()},saveSets:function(){return this.save({wait:!0},{url:`${this.url()}/sets`})},fetchCourses:function(){return new Promise(((e,t)=>{const s=new n;s.url=`${TVA.routes.products}/${this.get("id")}/courses`,TVE_Dash.showLoader(),s.fetch({success:t=>{this.set("courses",t),e(t),TVE_Dash.hideLoader()},error:()=>{t()}})}))},getContent:function(){const e=[];return this.getDefaultSet()?(this.getDefaultSet().getRules().each((t=>{t.get("value").forEach((t=>{e.push(t.id)}))})),e):[]},hasAccessExpiryEnabled:function(){return this.get("access_expiry")instanceof l&&this.get("access_expiry").isEnabled()},assignDripCampaign:function(e,t){const s=new r({campaign_id:e,course_id:t});s.url=`${this.url()}/assign-campaign`,s.save({},{patch:!0})},validateIdentifier:function(){const e=this.get("identifier");return""===e||e&&e.trim().length>3?null:TVA.t.invalid_identifier}})},1978:function(e,t,s){e.exports=s(84643).extend({idAttribute:"ID",defaults:{post_title:"",download_counter:0},url:function(){return`${TVA.routes.protected_files}/${this.get("ID")?this.get("ID"):""}`},getNumberOfProducts:function(){return this.get("products").length}})},90046:function(e,t,s){const i=s(84643),n={txt:"text",odt:"text",pdf:"pdf",doc:"doc",docx:"doc",xls:"xls",xlsx:"xls",zip:"zip",tar:"zip",rar:"zip",gzip:"zip",ppt:"ppt",pptx:"ppt",pps:"ppt",ppsx:"ppt",mp4:"video",m4v:"video",mov:"video",wmv:"video",avi:"video",mpg:"video",ogv:"video","3gp":"video","3g2":"video",psd:"image",jpg:"image",jpeg:"image",png:"image",bmp:"image",gif:"image",ico:"image",mp3:"audio",m4a:"audio",ogg:"audio",wav:"audio"},o=i.extend({defaults:function(){return{title:"",content:"",type:"url",order:1e3,icon:o.icons.file,config:{}}},hasDefaultTitle:function(){return!!this.get("title").match(/^Resource (\d+)$/)},initialize:function(){this.on("change",this.onChange.bind(this))},onChange:function(){const e=Object.keys(this.changed),t=this.deepGet("config.url");t&&t!==TVA.Utils.ensureUrlProtocol(t)?this.deepSet("config.url",TVA.Utils.ensureUrlProtocol(t)):_.intersection(e,["config","type"]).length&&this.updateIcon(),this.hasError()&&!e.includes("error")&&this.validateConfig()},updateIcon:function(){let e="default";const t=this.get("config")||{};let s="";switch(this.get("type")){case"content":t.post&&(e=o.icons[t.post.post_type]?t.post.post_type:"page");break;case"url":s=t.url||!1,s&&(o.isExternalVideo(s)?(e="video",s=!1):this.getExtension(s)||(s=!1,e="url"));break;case"file":s=t.attachment&&t.attachment.url}s&&(e=n[this.getExtension(s)]||"default"),this.set({icon:e})},validateConfig:function(){const e=this.get("config")||{};let t;switch(this.get("type")){case"url":t=!(!e.url||!e.url.trim())||{field:"config.url",message:TVA.t.resources.required_url_missing};break;case"file":t=!(!e.attachment||!e.attachment.id)||{field:"config.attachment",message:TVA.t.resources.required_file_missing};break;case"content":t=!(!e.post||!e.post.id)||{field:"config.post",message:TVA.t.resources.required_content_missing};break;case"protected_file":t=!(!e.post||!e.post.id)||{field:"config.post",message:TVA.t.resources.required_p_file_missing}}return!0!==t?this.set("error",t):this.set("error",!1),t},getIcon:function(){let e=this.get("icon");return this.get("extension")&&(e=n[this.get("extension")]||"default"),e.startsWith("<")?e:o.icons[e]||o.icons.default},getSummaryIcon:function(){return o.admin_icons[this.get("type")]},getExtension:function(e){let t="";try{t=new URL(e).pathname}catch(s){t=e}return t.includes(".")?t.split(".").pop().toLowerCase():null},getSummary:function(){if(this.hasError())return this.deepGet("error.message");let e,t,s;switch(this.get("type")){case"url":s=this.deepGet("config.url","").trim(),s?(e=this.getExtension(s),t=e?TVA.t.resources.external_x_file.replace("{ext}",e):o.isExternalVideo(s)?TVA.t.resources.external_video_link:TVA.t.resources.external_link):t=TVA.t.resources.enter_url;break;case"file":const i=this.deepGet("config.attachment");i&&i.id?(e=this.getExtension(i.url),t=e?TVA.t.resources.uploaded_x_file.replace("{ext}",e):TVA.t.resources.uploaded_link):t=TVA.t.resources.select_file;break;case"content":const n=this.deepGet("config.post");t=n&&n.id?TVA.t.resources.content_x.replace("{type}",n.type_label):TVA.t.resources.choose_content;break;case"protected_file":const r=this.deepGet("config.post");t=r&&r.id?"Protected file":"Select a protected file";break;default:t=""}return t},hasError:function(){return!!this.deepGet("error.field")}},{isExternalVideo:function(e){const t=e.toLowerCase();return["youtube.com","youtu.be","vimeo.com","vooplayer","wistia.com"].some((e=>t.includes(e)))},admin_icons:{file:'<svg class="tva-icon" viewBox="0 0 12 13"><g fill="none" fill-rule="evenodd"><g fill="#B0BBC3" fill-rule="nonzero"><g><g><path d="M87.945 44.383c.594-.156 1.117-.461 1.57-.914l4.57-4.594c.063-.047.095-.11.095-.187 0-.079-.032-.149-.094-.211l-.399-.399c-.046-.047-.109-.07-.187-.07s-.148.023-.211.07l-4.57 4.594c-.469.469-1.028.703-1.676.703-.648 0-1.203-.23-1.664-.691-.461-.461-.692-1.016-.692-1.664 0-.649.227-1.207.68-1.676l5.274-5.274c.312-.297.683-.445 1.113-.445.43 0 .797.152 1.101.457.305.305.457.672.457 1.102 0 .43-.148.793-.445 1.09l-4.453 4.453c-.14.14-.316.21-.527.21-.211 0-.395-.074-.551-.222-.156-.149-.234-.328-.234-.54 0-.21.078-.386.234-.527l3.75-3.773c.062-.047.094-.11.094-.187 0-.079-.032-.149-.094-.211l-.399-.399c-.046-.047-.109-.07-.187-.07s-.14.023-.188.07l-3.773 3.774c-.375.375-.562.82-.562 1.336 0 .515.187.957.562 1.324.375.367.82.55 1.336.55.516 0 .96-.18 1.336-.539l4.43-4.453c.343-.343.578-.746.703-1.207.125-.46.125-.922 0-1.383-.125-.46-.36-.859-.703-1.195-.344-.336-.746-.566-1.207-.691-.461-.125-.922-.125-1.383 0-.461.125-.856.351-1.184.68l-5.273 5.296c-.453.438-.758.953-.914 1.547-.157.594-.157 1.192 0 1.793.156.602.46 1.121.914 1.559.437.453.957.758 1.558.914.602.156 1.2.156 1.793 0z" transform="translate(-5507 -180) translate(5384 78) translate(40 70)"/></g></g></g></g></svg>',protected_file:'<svg class="tva-icon" viewBox="0 0 448 512"><path d="M400 192h-32v-46.6C368 65.8 304 .2 224.4 0 144.8-.2 80 64.5 80 144v48H48c-26.5 0-48 21.5-48 48v224c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V240c0-26.5-21.5-48-48-48zm-272-48c0-52.9 43.1-96 96-96s96 43.1 96 96v48H128v-48zm272 320H48V240h352v224z"/></svg>',url:'<svg class="tva-icon" viewBox="0 0 14 13"><g fill="none" fill-rule="evenodd"><g fill="#B0BBC3" fill-rule="nonzero"><g><path d="M130.32 249.5c.078 0 .149-.031.211-.094l6.516-6.515.047.047-.047 1.71c0 .094.031.176.094.247.062.07.14.105.234.105h.773c.094 0 .176-.031.246-.094.07-.062.106-.14.106-.234v-3.844c0-.094-.031-.172-.094-.234-.062-.063-.14-.094-.234-.094h-3.844c-.094 0-.172.035-.234.105-.063.07-.094.153-.094.247v.773c0 .094.035.172.105.234.07.063.153.094.247.094l1.71-.047.047.047-6.515 6.516c-.063.062-.094.133-.094.21 0 .079.031.141.094.188l.539.54c.047.062.11.093.187.093zm4.055 3c.312 0 .578-.11.797-.328.219-.219.328-.485.328-.797v-5.203c0-.125-.059-.211-.176-.258-.117-.047-.215-.023-.293.07l-.562.563c-.063.047-.094.11-.094.187v4.5c0 .032-.016.063-.047.094s-.062.047-.094.047h-7.968c-.032 0-.063-.016-.094-.047s-.047-.062-.047-.094v-7.968c0-.032.016-.063.047-.094s.062-.047.094-.047h7.078c.125 0 .21-.059.258-.176.046-.117.023-.215-.07-.293l-.563-.562c-.047-.063-.11-.094-.188-.094h-6.656c-.313 0-.578.11-.797.328-.219.219-.328.485-.328.797v8.25c0 .312.11.578.328.797.219.219.484.328.797.328h8.25z" transform="translate(-5509 -318) translate(5384 78)"/></g></g></g></svg>',content:'<svg class="tva-icon" viewBox="0 0 12 13"><g fill="none" fill-rule="evenodd"><g fill="#B0BBC3" fill-rule="nonzero"><g><g><path d="M90 326.5c.203 0 .383-.07.539-.21l5.25-5.25c.14-.157.211-.337.211-.54s-.07-.383-.211-.539l-5.25-5.25c-.156-.14-.336-.211-.539-.211s-.383.07-.54.211l-5.25 5.25c-.14.156-.21.336-.21.539s.07.383.21.54l5.25 5.25c.157.14.337.21.54.21zm0-1.29l-4.71-4.71 4.71-4.71 4.71 4.71-4.71 4.71zm-1.313-2.835c.047 0 .09-.02.13-.059.038-.039.058-.082.058-.128v-1.5h1.875v1.265c0 .047.02.09.059.129.039.04.082.059.128.059.047 0 .086-.016.118-.047l1.992-1.828c.031-.032.047-.078.047-.141 0-.062-.016-.11-.047-.14l-1.992-1.829c-.032-.031-.07-.047-.118-.047-.046 0-.09.02-.128.059-.04.039-.059.082-.059.129v1.266H88.5c-.203 0-.379.074-.527.222-.149.149-.223.324-.223.528v1.875c0 .046.02.09.059.128.039.04.082.059.128.059h.75z" transform="translate(-5508 -462) translate(5384 78) translate(40 70)"/></g></g></g></g></svg>'},icons:TVA.resourceIcons});e.exports=o},52697:function(e,t,s){e.exports=s(84643).extend({defaults:{key:"",secret:""},validate:function(e){const t=[];if(e.key.trim()||t.push(this.validation_error("key",TVA.t.emptyKey)),e.secret.trim()||t.push(this.validation_error("secret",TVA.t.emptySecret)),e.key.trim()===e.secret.trim()&&t.push(this.validation_error("key&secret",TVA.t.identicalKeys)),t.length)return t},url:function(){return`${TVA.routes.sendowl}/save_account_keys`}})},86171:function(e,t,s){e.exports=s(84643).extend({defaults:{key:"",value:null},validate:function(e){if(!e.key||null===e.value||"string"!=typeof e.key)return this.validation_error("invalid_payload","The payload is invalid")},url:function(){return TVA.routes.settings_v2},setValue:function(e){const t=this.get("key");return t&&(TVA.settings[t].value=e,this.set("value",e)),this}})},64006:function(e,t,s){const i=s(84643);e.exports=i.extend({idAttribute:"ID",urlRoot:TVA.routes.templates,labels:{tva_lesson:"Lesson",tva_module:"Module",tva_courses:"Course Overview",home:"School homepage",tva_no_access:"Restricted Course",tva_post_no_access:"Restricted Site Content",tva_course_completed:"Course Completion",tva_assessment:"Assessment",tva_post_certificate_validation:"Certificate Verification"},defaults:()=>({post_title:"",thumbnail:"",edit_url:"",preview_url:"",meta_input:{primary_template:"",secondary_template:"",format:""}}),url:function(){return TVA.Utils.buildUrl(i.prototype.url.apply(this,arguments),{tva_skin_id:this.skin_id||this.collection.skin_id})},getThumbnailUrl:function(){return this.hasThumbnail()?`${this.get("thumbnail").url}?_=${(new Date).getTime()}`:""},hasThumbnail:function(){return"object"==typeof this.get("thumbnail")},getThumbnailCss:function(){return`background: linear-gradient(rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0) 80%, rgb(255, 255, 255) 100%), url( ${this.getThumbnailUrl()} ) top center no-repeat;`},meta:function(e,t){const s=this.get("meta_input");return void 0!==t&&(s[e]=t,this.set("meta_input",s)),s[e]},primary:function(){return this.meta("primary_template")},secondary:function(){return this.meta("secondary_template")},format:function(){const e=this.meta("format");return void 0===e||0===e.length?"standard":e},isDefault:function(){return 1===parseInt(this.meta("default"))},isSingular:function(){return"singular"===this.primary()},isHomepage:function(){return"home"===this.primary()},isArchive:function(){return"archive"===this.primary()},isLesson:function(){return"tva_lesson"===this.secondary()},isVideoLesson:function(){return this.isLesson()&&"video"===this.format()},isAudioLesson:function(){return this.isLesson()&&"audio"===this.format()},isModule:function(){return"tva_module"===this.secondary()},isNoAccess:function(){return"tva_no_access"===this.secondary()},isCompleted:function(){return"tva_course_completed"===this.secondary()},isAssessment:function(){return"tva_assessment"===this.secondary()},isPostNoAccess:function(){return"tva_post_no_access"===this.secondary()},isCourse:function(){return"tva_courses"===this.secondary()},isCertificateValidation:function(){return"tva_post_certificate_validation"===this.secondary()},canPreview:function(){return!this.isNoAccess()&&!this.isPostNoAccess()},canDelete:function(){return!this.isDefault()},canMakeDefault:function(){return!this.isDefault()},setDefault:function(){this.canMakeDefault()&&(this.collection.filterByType(this.primary(),this.secondary()).forEach((e=>e.meta("default",0))),this.meta("default",1))},getContentType:function(){let e="";return this.isSingular()?this.isLesson()?(e="Lesson",this.isVideoLesson()?e="Video Lesson":this.isAudioLesson()&&(e="Audio Lesson")):this.isModule()?e="Module":this.isNoAccess()?e="Restricted lessons, modules and overview page":this.isPostNoAccess()?e="Restricted pages and posts":this.isCompleted()?e="Course Completion":this.isAssessment()?e="Course Assessment":this.isCertificateValidation()&&(e="Certificate Verification"):this.isHomepage()?e="Homepage":this.isArchive()&&this.isCourse()&&(e="Course Overview"),e},getDefaultLabel:function(){let e="",t="";return this.isSingular()||this.isArchive()?(e=this.secondary(),this.isLesson()&&(this.isVideoLesson()?t="Video ":this.isAudioLesson()&&(t="Audio "))):this.isHomepage()&&(e=this.primary()),`Default ${t}${this.labels[e]}`},icon:function(){const e=["ta"];return this.isSingular()?this.isLesson()?(e.push("lesson"),this.isVideoLesson()?e.push("video"):this.isAudioLesson()&&e.push("audio")):this.isModule()?e.push("module"):this.isNoAccess()||this.isPostNoAccess()?e.push("no-access"):this.isCompleted()?e.push("certificates"):this.isAssessment()&&e.push("assessments"):this.isHomepage()?e.push("homepage"):this.isArchive()&&this.isCourse()&&e.push("overview"),e.length>1?`<svg class="tva-icon"><use xlink:href="#${e.join("-")}"></use></svg>`:""},extraItemClass:function(){let e="";return this.isSingular()&&(this.isNoAccess()||this.isPostNoAccess())?e="tva-red-dark":this.isCertificateValidation()?e="tva-certificate-validation":this.isHomepage()&&(e="tva-blue-dark"),` ${e}`},createTemplate:function(e,t,s,i="standard"){return this.set({post_title:e}),this.meta("primary_template",t),this.meta("secondary_template",s),this.isLesson()||(i="standard"),this.meta("format",i),this},isJustAdded:function(){return this.get("just_added")},getOrder:function(){let e=0;return this.isDefault()?e+=13:e-=1,this.isLesson()?(e+=8,this.isAudioLesson()?e-=2:this.isVideoLesson()&&(e-=1)):this.isModule()?e+=5:this.isCourse()||this.isCompleted()||this.isAssessment()?e+=4:this.isHomepage()&&(e+=3),-1*e}})},93249:function(e,t,s){const i=s(84643),n=s(45722),o=i.extend({idAttribute:"term_id",initialize:function(e={}){this.set("templates",new n(e.templates||[],{skin_id:e.term_id||""}))},parse:function(e){return e.templates&&e.templates instanceof n||(e.templates=new n(e.templates||[],{skin_id:e.term_id})),e},url:function(e="",t={}){return TVA.Utils.buildUrl([TVA.routes.skins,this.getId(),e].filter((e=>e)).join("/"),t)},defaults:function(){return{name:"",description:"",default:0}},isLegacy:function(){return 1===this.get("legacy")},isAssessmentReady:function(){return 1===this.get("is_assessment_ready")},isJustAdded:function(){return!!this.get("just_added")},isActive:function(){return!0===this.get("is_active")},getId:function(){return this.get(this.idAttribute)},destroy:function(){const e=this.collection;return e.trigger("ajax"),i.prototype.destroy.apply(this.deepClone(),arguments).then((()=>e.remove(this))).always((()=>e.trigger("ajaxdone")))},inheritTypography:function(){return!!this.get("inherit_typography")},getTypographyPreviewUrl:function(){return this.deepGet("typography.preview_url")+`&admin_preview_id=${this.deepGet("typography.ID")}&tva_skin_id=${this.getId()}`},patch:function(e,t={}){return wp.apiRequest({url:this.url("patch",{patch:e}),type:"PUT",data:t})},getTemplates:function(){let e=this.get("templates");return e&&e instanceof n||(e=new n(e||[],{skin_id:this.getId()})),e},refreshTemplates:function(){wp.apiRequest({url:TVA.routes.templates,data:{tva_skin_id:this.getId()}}).done((e=>{this.set("templates",new n(e||[],{skin_id:this.getId()},{silent:!0}))}))}});e.exports=o},58846:function(e,t,s){e.exports=s(84643).extend({defaults:function(){return{label:"",value:0,min:0,max:100}}})},94254:function(e,t,s){const i=s(30739);e.exports=s(7750).extend({defaults:{display_name:"",user_email:"",user_login:"",services:{},notify:0,edit_url:"",lessons_completed:[],items_bypassed:[],locked_status:[],courses_progress:[],user_registered:"",modules_and_lessons_status:[],last_seen:"",enrollment_dates:[],activity:[],courses_certificates:[]},initialize:function(e={}){var t;!Array.isArray(e.courses)||e.courses instanceof Backbone.Collection||this.set("courses",new i(e.courses,{total:null===(t=e.courses)||void 0===t?void 0:t.length}),{silent:!0})},getCourseData:function(e,t){return this.get(e)&&this.get(e)[t]?this.get(e)[t]:null},getCourseProgress:function(e){return this.get("courses_progress")[e]?this.get("courses_progress")[e].progress:0},getModuleProgress:function(e,t){if(this.get("courses_progress")[e]){const s=this.get("courses_progress")[e];if(s.modules[t])return s.modules[t]}return 0},isCourseLocked:function(e){return!!this.get("locked_status")[e]&&this.get("locked_status")[e].course_locked},getCourseCertificate:function(e){return this.get("courses_certificates")&&this.get("courses_certificates")[e]?this.get("courses_certificates")[e]:null}})},51941:function(e,t,s){var i;i=jQuery,e.exports=s(84643).extend({idAttribute:"id",defaults:{name:"",key:"",status:1},initialize:function(e){e&&e.key||this.generateKey()},generateKey:function(){i.ajax({beforeSend:e=>{TVE_Dash.showLoader(),e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)},url:`${this.url()}/generate`}).success((e=>{delete e.id,this.set(e)})).always((()=>{TVE_Dash.hideLoader()}))},validate:function(){const e=[];if(this.get("name")||e.push(this.validation_error("name",TVA.t.name_is_required)),e.length)return e},url:function(){let e=TVA.routes.token;return this.get("id")&&(e+=`/${this.get("id")}`),e}})},8426:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(84643).extend({savedMessage:TVA.t.topic_saved,idAttribute:"ID",defaults:function(){return{title:"New Topic",icon:"",color:"#00c1ef",checked:1,default_icon:TVA.defaults.course_topic_icon,overview_icon_color:"#ffffff",layout_icon_color:"#000000",icon_type:"svg_icon",svg_icon:'<svg class="tva-icon" viewBox="0 0 576 512" data-id="icon-file-signature-light"><path d="M560.83 135.96l-24.79-24.79c-20.23-20.24-53-20.26-73.26 0L384 189.72v-57.75c0-12.7-5.1-25-14.1-33.99L286.02 14.1c-9-9-21.2-14.1-33.89-14.1H47.99C21.5.1 0 21.6 0 48.09v415.92C0 490.5 21.5 512 47.99 512h288.02c26.49 0 47.99-21.5 47.99-47.99v-80.54c6.29-4.68 12.62-9.35 18.18-14.95l158.64-159.3c9.79-9.78 15.17-22.79 15.17-36.63s-5.38-26.84-15.16-36.63zM256.03 32.59c2.8.7 5.3 2.1 7.4 4.2l83.88 83.88c2.1 2.1 3.5 4.6 4.2 7.4h-95.48V32.59zm95.98 431.42c0 8.8-7.2 16-16 16H47.99c-8.8 0-16-7.2-16-16V48.09c0-8.8 7.2-16.09 16-16.09h176.04v104.07c0 13.3 10.7 23.93 24 23.93h103.98v61.53l-48.51 48.24c-30.14 29.96-47.42 71.51-47.47 114-3.93-.29-7.47-2.42-9.36-6.27-11.97-23.86-46.25-30.34-66-14.17l-13.88-41.62c-3.28-9.81-12.44-16.41-22.78-16.41s-19.5 6.59-22.78 16.41L103 376.36c-1.5 4.58-5.78 7.64-10.59 7.64H80c-8.84 0-16 7.16-16 16s7.16 16 16 16h12.41c18.62 0 35.09-11.88 40.97-29.53L144 354.58l16.81 50.48c4.54 13.51 23.14 14.83 29.5 2.08l7.66-15.33c4.01-8.07 15.8-8.59 20.22.34C225.44 406.61 239.9 415.7 256 416h32c22.05-.01 43.95-4.9 64.01-13.6v61.61zm27.48-118.05A129.012 129.012 0 0 1 288 384v-.03c0-34.35 13.7-67.29 38.06-91.51l120.55-119.87 52.8 52.8-119.92 120.57zM538.2 186.6l-21.19 21.19-52.8-52.8 21.2-21.19c7.73-7.73 20.27-7.74 28.01 0l24.79 24.79c7.72 7.73 7.72 20.27-.01 28.01z"></path></svg>'}},url:function(){return this.urlWithId(TVA.routes.topics)},getPreviewImage:function(e=null){const t=this.get("icon_type"),s=this.get(t);let i;switch(t){case"svg_icon":i=o(s);break;case"icon":i=o(`<div class="tva-icon-image" style="background-image: url('${s}');"></div>`)}return e&&i.filter("svg,.tva-custom-icon").css({color:this.get(`${e}_icon_color`)}),i[0].outerHTML},persist:function(e,t={loader:!0,showSuccess:!0}){return this.set(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e),{silent:!0}),this.hasChanged()?(t.loader?this.set("loading",!0):this.trigger("change"),this.save().always((()=>{this.set({editing:!1,loading:!1,id:this.get("ID")}),t.showSuccess&&TVE_Dash.success(this.savedMessage)}))):o.Deferred()},isDeletable:function(){return 0!==parseInt(this.get("ID"))},urlWithId:function(e){const t=this.get("ID");return e+(void 0!==t?"/"+t:"")}})},95296:function(e){!function(){class t{static fetchVideoInformation(e,s){return new Promise((i=>{setTimeout((()=>{const n=t.getRequestUrl(s,e),o=t.getHandlerFn(s);n&&jQuery.getJSON(n).done((e=>i(o(e)))).fail((()=>i(!1)))}))}))}static getRequestUrl(e,t){let s="";switch(e){case"youtube":s=`https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails&id=${t}&key=AIzaSyDpi07JtIdicPoLfgp1qbEfRM6kYFsseb4`;break;case"vimeo":s=`https://vimeo.com/api/oembed.json?url=https://vimeo.com/${t}`;break;case"wistia":s=`https://fast.wistia.com/oembed?url=https://home.wistia.com/medias/${t}`}return s}static getHandlerFn(e){let s;switch(e){case"youtube":s=t.youtubeHandlerFn;break;case"vimeo":case"wistia":s=t.oEmbedHandler;break;default:console.warn(`no handler implemented for this provider (${e})`)}return s}static oEmbedHandler(e){return!!e&&{title:e.title,duration:parseInt(e.duration)}}static youtubeHandlerFn(e){if(!(e&&e.items&&e.items.length&&e.items[0].snippet&&e.items[0].snippet.title))return!1;const s=e.items[0].snippet.title,i=e.items[0].contentDetails.duration;return{title:s,duration:t.iso8601ToSeconds(i)}}static iso8601ToSeconds(e){let t=0,s=0,i=0;const n=e.match(/PT(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?/);return n&&(n[1]&&(t=parseInt(n[1])),n[2]&&(s=parseInt(n[2])),n[3]&&(i=parseInt(n[3]))),3600*t+60*s+i}}e.exports=t}(jQuery)},50251:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const{STEPS:r,SECTIONS:a}=s(17570),l=s(84643),c=s(84643).extend({wizard:null,promises:{},defaults:function(){const e={};return Object.values(r).forEach((t=>e[t.id]=null)),e.template_instances={},e},load:function(e){return this.promises[e]||(this.promises[e]=new Promise(((t,s)=>{null===this.attributes[e]?this.fetch(e).done((s=>{s&&s.data&&(this.set(e,Object.values(s.data)),t(s.data))})).fail(s):t(this.attributes[e])}))),this.promises[e].finally((()=>{delete this.promises[e]})),this.promises[e]},updateTemplate:function(e,t,s){const i=this.get(e);if(i){const e=i.find((e=>String(e.id)===String(t)));if(e)for(const t in s)e[t]=s[t]}return this},loadTemplate:function(e,t,s,i){const n=e+"--"+t,o=this.get("template_instances");return new Promise(((r,a)=>{if(o[n])return r(o[n]);this.fetchInstance(e,t,s,i).done((e=>{const t=e.data||e;o[n]=t,this.set({instances:o}),r(t)})).fail(a)}))},clearCache:function(e){const t=this.get("template_instances");Object.keys(t).forEach((s=>{s.startsWith(e+"--")&&delete t[s]})),this.set(e,null)},fetch:function(e){return wp.apiRequest({url:TVA.Utils.buildUrl(this.wizard.url(),{},"/templates"),data:{type:e}}).fail((t=>{var s;TVE_Dash.err((null===(s=t.responseJSON)||void 0===s?void 0:s.message)||"An error occurred while fetching templates",3e3),this.attributes[e]=null}))},fetchInstance:function(e,t,s="cloud",i=TVA.Utils.buildUrl(this.wizard.url(),{},`/templates/${t}`)){return wp.apiRequest({url:i,data:{type:e,source:s}})},indexOf:function(e,t){return this.get(e)?this.get(e).findIndex((e=>String(e.id)===t)):-1},count:function(e){return this.get(e)?this.get(e).length:0},getNextTemplateId:function(e,t){return(this.get(e)[this.indexOf(e,t)+1]||{id:""}).id},getPrevTemplateId:function(e,t){return(this.get(e)[this.indexOf(e,t)-1]||{id:""}).id},getNextTemplateSource:function(e,t){return(this.get(e)[this.indexOf(e,t)+1]||{source:""}).source},getPrevTemplateSource:function(e,t){return(this.get(e)[this.indexOf(e,t)-1]||{source:""}).source},getTemplate:function(e,t){const s=this.indexOf(e,t);return s>-1?this.get(e)[s]:null}}),d=l.extend({SKIN_ID:null,sections:a,url:function(){return TVA.Utils.buildUrl(TVA.routes.wizard,{tva_skin_id:this.SKIN_ID})},iframeData:{headerHeight:"",footerHeight:"",templateId:"",scrollWidth:"",nextPage:{},prevPage:{}},isNew:function(){return!0},defaults:function(){return{activeIndex:-1,active:"",done:[],settings:{}}},parse:function(e){return this.globals=jQuery.extend(!0,{},e),TVA.wizard.urls=e.urls||{},e.wizard_data?e.wizard_data:e},initialize:function(e){this.templates=new c,this.templates.wizard=this,e&&e.skin_id&&(this.SKIN_ID=parseInt(e.skin_id),delete this.attributes.skin_id),e&&e.active&&(-1===this.indexOf(e.active)?this.set("active",""):this.loadStepTemplates())},fetch:function(){if(this.$$fetched){const e=jQuery.Deferred();return e.resolve(),e.promise()}return l.prototype.fetch.apply(this,arguments).always((()=>this.$$fetched=!0))},getSteps:function(e){return r.filter((t=>t.section===e)).map((e=>(e.active=this.get("active")===e.id,e.done=this.get("done").includes(e.id),e.disabled=!this.canAccessStep(e.id),e)))},loadStepTemplates:function(e=!0){const t=this.getStepKey("hasTemplates")?this.templates.load(this.get("active")):Promise.resolve([]);return e&&t.then((e=>{this.trigger("templates-loaded",e)})),t},_id:function(e=""){return e?"string"==typeof e?e:e.id:""},_step:function(e=""){return e?"string"==typeof e?r[e]:e:{}},indexOf:function(e){return e=this._id(e),_.findIndex(r,(t=>t.id===e))},canAccessStep:function(e){return!0},markComplete:function(e){Array.isArray(e)||(e=[e]);const t=new Set(this.get("done").concat(e));return this.set({done:Array.from(t).map(this._id)},{silent:!0}),this},getStep:function(e){return r[e]},gotoStep:function(e="header"){if(e=this._id(e),this.canAccessStep(e)&&e!==this.get("active")){const t=this.getCurrentStep();this.set({active:e,activeIndex:this.indexOf(e)}),this.triggerStepChange(t)}return this},triggerStepChange:function(e){e&&e.id===this.get("active")||this.loadStepTemplates(),e||(e=r[this.get("activeIndex")]);const t=r[this.get("activeIndex")];this.trigger("step-change",t,e)},getCurrentStep:function(){return r[this.get("activeIndex")]},getStepKey:function(e,t=this.getCurrentStep()){return t&&t[e]},setOriginalData:function(){return TVA.wizardOriginal=jQuery.extend(!0,{},this.attributes),this},getOriginalStepData:function(e){return this.deepGet(`settings.${this.get("active")}.${e}`,null,TVA.wizardOriginal)},hasActiveStep:function(){return this.get("activeIndex")>=0&&r[this.get("activeIndex")]},previous:function(){let e=this.get("activeIndex")-1;for(;r[e]&&r[e].comingSoon;)e--;return r[e]&&this.gotoStep(r[e].id),this},hasNextStep:function(){return-1!==this.getNextAvailableStepIndex()},hasPreviousStep:function(){return-1!==this.getPrevAvailableStepIndex()},next:function(){if(this.isFinished(!1))return this.set({active:"",activeIndex:-1}),this.trigger("finished"),this;const e=this.getNextAvailableStep();return e&&this.gotoStep(e.id),this},getStepBaseURL:function(){const e=this.getCurrentStep();let t;const s=this._id(e);switch(s){case"logo":case"color":case"header":case"footer":case"lesson":case"menu":case"sidebar":case"":t="lesson";break;default:t=s}return TVA.wizard.urls[t]},getFrameURL:function(e={}){const t=this.getCurrentStep()||this.getNextAvailableStep(),s=new URL(this.getStepBaseURL());let i={};return this.isFinished()||!t?i.step="__welcome":i=n(n({step:t.id},this.getFramePreviewParams(t)),e),h(s,i,{tva_skin_id:this.SKIN_ID,"force-flat":"1"})},getFramePreviewParams:function(e){let t={};switch((e=this._step(e)).id){case"logo":case"color":t.step="logo";break;case"sidebar":t={step:e.id};break;default:t={step:e.id,template_id:this.deepGet(`settings.${e.id}.template_id`,"")}}return t},isStarted:function(){return this.get("done").length>0||this.get("active")},isFinished:function(e=!0){return!(e&&this.get("active"))&&this.get("done").length>=r.filter((e=>!e.comingSoon)).length},getNextAvailableStep:function(){return r[this.getNextAvailableStepIndex()]||null},getNextAvailableStepIndex:function(){const e=r.map(((e,t)=>t)).filter((e=>!r[e].comingSoon&&!this.get("done").includes(r[e].id)));if(0===e.length)return-1;let t=e[0];const s=Number(this.get("activeIndex"));return e.some((e=>e>s&&(t=e,!0))),t!==s?t:-1},getPrevAvailableStepIndex:function(){const e=r.map(((e,t)=>t)).filter((e=>!r[e].comingSoon&&!this.get("done").includes(r[e].id))).reverse();if(0===e.length)return-1;let t=e[0];const s=Number(this.get("activeIndex"));return e.some((e=>e<s&&(t=e,!0))),t!==s?t:-1},start:function(){return this.gotoStep(this.getNextAvailableStep())},setStepData:function(e,t=!1,s=!1,i=this.get("active")){const o=this.get("settings");return s&&delete o[i],o[i]=n(n({},o[i]||{}),e),this.set({settings:o},{silent:t}),this},completeStep:function(e=!(null===(t=this.getCurrentStep())||void 0===t?void 0:t.delayNextStep)){var t;const s=this.get("active"),i=this.get("activeIndex"),n=this.getNextAvailableStep();"logo"===s?(this.templates.clearCache("header"),this.templates.clearCache("footer")):"lesson"===s?this.templates.clearCache("sidebar"):["header","footer","sidebar"].includes(s)&&this.templates.clearCache(s),this.trigger("ajax-send",s),this.markComplete(s),e&&this.next();const o={beforeSend:function(e,t){const i=new URL(t.url);i.searchParams.append("step",s),i.searchParams.append("next",n?n.id:""),i.searchParams.append("nextIndex",r.indexOf(n)),t.url=i.toString()},silent:!0};return this.save(void 0,o).done((t=>{t.skin&&t.skin.templates&&TVA.skins.get(this.SKIN_ID).get("templates").reset(t.skin.templates),this.setOriginalData(),t.step_templates&&t.step_templates.errors&&t.step_templates.errors.tcb_api_error?TVE_Dash.err(t.step_templates.errors.tcb_api_error[0],3e3):t.step_templates&&this.templates.set(n.id,t.step_templates),e||(this.set({active:s,activeIndex:i},{silent:!0}),this.next())})).fail((e=>{var t;return TVE_Dash.err((null===(t=e.responseJSON)||void 0===t?void 0:t.message)||"Something went wrong",3e3)})).always((()=>{this.trigger("ajax-done",s)}))},canContinue:function(){return!!this.getPreviewTemplateId()},getPreviewTemplateId:function(e=this.get("active")){return String(this.deepGet(`settings.${e}.template_id`,""))},getPreviewTemplateSource:function(e=this.get("active")){return String(this.deepGet(`settings.${e}.source`,""))},getAdjacentTemplateId:function(e="next"){return this.templates["next"===e?"getNextTemplateId":"getPrevTemplateId"](this.get("active"),this.getPreviewTemplateId())},getAdjacentTemplateSource:function(e="next"){return this.templates["next"===e?"getNextTemplateSource":"getPrevTemplateSource"](this.get("active"),this.getPreviewTemplateId())},getPreviewTemplateTitle:function(){const e=this.getPreviewTemplateId(),t=this.templates.getTemplate(this.get("active"),e),s=this.getCurrentStep();return t&&t.post_title||s&&s.selector&&s.selector.label},hasAdjacentTemplate:function(e="next",t=this.get("active")){let s=!1;if("homepage"===t&&"page"===this.homepageState.get("type"))s=!!this.iframeData[`${e}Page`];else{const i=this.templates.indexOf(t,this.getPreviewTemplateId(t));"prev"===e?s=i>0:"next"===e&&(s=i<this.templates.count(t)-1)}return s},selectTemplate:async function(e){const t={template_id:e.id};let s;if("iframe"===this.getStepKey("previewMode")){this.setStepData(t);const i=this.get("active");"cloud"===e.source&&(e=await new Promise((t=>{this.templates.fetchInstance(i,e.id).done((s=>{this.templates.updateTemplate(i,e.id,{id:s.id,source:"local"}),t({id:s.id,source:"local"})}))})),t.template_id=e.id,this.setStepData({template_id:e.id,source:"local"})),s=Promise.resolve({id:e.id}),this.triggerStepChange()}else s=this.templates.loadTemplate(this.get("active"),e.id,e.source);return s.finally((()=>{e.source&&(t.source=e.source),this.setStepData(t),this.trigger("template-selected")})),s},getTemplateDefaultIcon:function(e=this.getCurrentStep()){let t="";switch(this._id(e)){case"post":t="singular-post-standard";break;case"blog":t="archive-general-template";break;case"homepage":case"page":t="singular-page"}return t?TVA.Utils.icon(t):""},hasTopBar:function(){return this.getCurrentStep()&&this.getStepKey("hasTopMenu")},hasTemplateSelector:function(){return!!this.get("active")&&("homepage"===this.get("active")?this.homepageState.data().hasTemplateSelector:!!this.getStepKey("selector"))},hasSelectorDropdown:function(){return"homepage"!==this.get("active")||this.homepageState.data().hasTemplateDropdown},getContinueLabel:function(){const e=this.isFinished(!1);return"homepage"===this.get("active")&&"blog"===this.homepageState.get("type")?e?"Choose":"Continue":e?"Choose":"Choose and continue"},isStepCompleted:function(e=this.get("active")){return this.get("done").includes(this._id(e))},getPopupMessage:function(){if(this.hasActiveStep()){const e=this.getCurrentStep();return"homepage"===e.id?this.homepageState.data().popupMessage:(this.isStepCompleted()?e.completedPopupMessage:e.popupMessage)||""}return""},getStepTitle:function(){const e=this.getCurrentStep();return e?this.isStepCompleted()?e.sidebarLabel:"homepage"===e.id?this.homepageState.data().title:e.title:""},hasStepChanges:function(){const e=this.get("active");if(!e)return!1;const t=this.deepGet(`settings.${e}`);return Object.keys(t).some((e=>String(this.getOriginalStepData(e))!==String(t[e])))},hasPreviousStepLink:function(){return!this.isStepCompleted()&&this.get("activeIndex")>0}}),h=(e,t={},s={})=>(e instanceof URL||(e=new URL(e)),_.each(t,((t,s)=>{e.searchParams.append(`tva-wizard[${s}]`,t||"")})),e.searchParams.append("_preview","1"),TVA.Utils.buildUrl(String(e),s)+"#obj=TVA/localize=ThriveAppFront");e.exports=d},17570:function(e){e.exports={STEPS:TVA.wizard.structure.steps,SECTIONS:TVA.wizard.structure.sections}},36832:function(e){var t;t=jQuery,e.exports=function(e,s){if(!e.length)return;function i(){const t=e.data("allow-regex");return!!t&&e.val().match(new RegExp(t))}(s=s||{}).no_value_callback=s.no_value_callback||jQuery.noop,s.change_callback=s.change_callback||jQuery.noop;const n={url:`${TVA.routes.settings}/search_pages/`,type:"POST",appendTo:e.parent(),minLength:2,delay:200,change:function(t,n){n.item||e.data("value-filled")||i()||(e.val(""),s.no_value_callback.apply(e,arguments)),e.data("value-filled",null),i()&&s.change_callback.apply(e,arguments)}};(s=t.extend(!0,n,s)).source||(s.source=s.url),t.ajaxSetup({headers:{"X-WP-Nonce":TVA.apiSettings.nonce}}),e.autocomplete(s).data("ui-autocomplete")._renderItem=s.renderItem||function(e,i){let n="";return s.collection&&s.collection.length&&s.collection.findWhere({id:i.id})&&(n="tva-selected-post"),t(`<li class="${n}">`).append(`<span class="tva-ps-result-title">${i.label}</span><span class="tva-ps-result-email"> (${i.type})</span>`).appendTo(e)},e.on("blur",(function(){t.trim(this.value).length||s.no_value_callback.apply(e,arguments)})),_.isNumber(s.minLength)&&0===parseInt(s.minLength)&&e.on("focus",(function(){t.trim(this.value).length||t(this).autocomplete("search","")}))}},25679:function(e,t,s){!function(t){const i=s(51135),n=s(50186),o=s(66740),r=s(5413),a=s(31357);e.exports=Backbone.Router.extend({$el:t("#tva-app"),$body:t("body"),$content:t("#tva-content"),contentView:null,menuItems:null,submenuItems:null,submenuView:null,routes:{home:"renderView",assessments:"renderView","courses(/:submenu)(/:sub_option)":"renderView","protected-files":"renderView","members(/:id)(/:sub_option)(/:course_id)":"renderView","reports(/:dashboard)(/:report)":"renderReportsView","products(/:id)(/:section)(/:back_term)":"renderView","settings(/:submenu)(/:sub_option)":"renderView",wizard:"renderView","design(/:submenu)(/:sub_option)":"renderView","design(/:submenu)/:templates":"renderView","design-legacy(/:submenu)":"renderView","design-welcome":"renderView",generate:"renderView"},menu:null,submenu:null,subOption:"",initialize:function(){this.menuItems=new r(Object.values(TVA.menuItems)),this.submenuItems=new Backbone.Collection,this.menuView=new n({el:this.$el.find(".tva-menu")[0],collection:this.menuItems}).render(),this.submenuView=new o({el:this.$el.find(".tva-submenu")[0],collection:this.submenuItems})},setActiveMenu:function(e){this.$body.removeClass(((e,t)=>(t.match(/(^|\s)tva-active-tab-\S+/g)||[]).join(" "))).addClass(`tva-active-tab-${e}`),this.menuItems.each((t=>t.set("selected",e.includes(t.get("slug")))))},renderView:function(e,t){this.subOption=t;const s=Backbone.history.getFragment().split("/");this.menu=s[0],this.setActiveMenu(this.menu);const i=this.menuItems.findWhere({selected:!0});if(i){if(this.submenuView.menuItem=i,this.submenuItems.reset(i.get("items").models),0===i.get("items").length&&!i.get("dynamic_items")||this.menu.includes("design-legacy"))return this.loadContent(this.menu,t);this.submenu=e||this.menu,i.get("items").each((e=>{e.set("selected",e.get("slug")===this.submenu),e.get("slug")===this.submenu&&e.get("items").length?(e.set("collapsed",!1),e.get("items").each((e=>{e.set("selected",e.get("slug")===t)}))):e.set("collapsed",!0)})),this.loadContent(this.submenu,t,s)}},renderReportsView:function(e,t){this.setActiveMenu("reports");const s=this.menuItems.findWhere({selected:!0});this.submenuView.menuItem=s,this.submenuItems.reset(s.get("items").models),s.get("items").each((s=>{s.set("selected",s.get("slug")===(e||"reports")),s.get("slug")===e&&s.get("items").length?(s.set("collapsed",!1),s.get("items").each((e=>{e.set("selected",e.get("slug")===t)}))):s.set("collapsed",!0)})),this.contentView&&this.contentView.destroy();let i=`reports/${e||"main"}`;t?i=`${i}/${t}`:e&&(i=`${i}/main`),this.contentView=new a({template:i,scope:`${e}-${t}`}),this.$content.html(this.contentView.render().$el),this.contentView.afterInsert()},loadContent:async function(e,t="",s=[]){this.contentView&&await this.contentView.destroy(),this.contentView=this.factoryView(e,t,s),this.contentView instanceof i&&(await this.contentView.ensureData(),this.$content.html(this.contentView.render().$el),this.contentView.afterInsert()),!TVA.license.gp||!TVA.license.show_lightbox||TVE_Dash_Const.shown_license_lightbox&&TVE_Dash_Const.shown_license_lightbox.includes("tva")?TVA.license.exp&&!TVA.license.gp&&(TVE_Dash.modal(TVE_Dash.views.LicenseModal,{model:{title:"Thrive Apprentice",license_class:"expired",product_class:"tva",license_link:TVA.license.link},className:"tvd-modal tvd-license-modal tvd-modal-expired",no_close:!0,dismissible:!1,width:"950px","max-width":"950px"}),jQuery("#tva-content").replaceWith(jQuery("#tva-content").clone())):TVE_Dash.modal(TVE_Dash.views.LicenseModal,{model:{title:"Thrive Apprentice",license_class:"grace-period",product_class:"tva",license_link:TVA.license.link,grace_time:TVA.license.grace_time},className:"tvd-modal tvd-license-modal tvd-modal-grace-period",width:"950px","max-width":"950px"})},factoryView:function(e,t="",i=[]){let n;const o=parseInt(e);try{n=isNaN(o)?s(22289)(`./${e}${t&&!["add-new-course"].includes(e)?"/"+t:""}`):(()=>{switch(this.menu){case"products":return s(16216)(`./${t}`);case"members":return i[3]?s(1382):s(67549)(`./${t}`);case"courses":return s(81181);case"design":return t=t?t.replace("-","/"):"skin/item",s(71927)(`./${t}`);case"generate":return s(1569);default:return s(51135)}})()}catch(t){console.log(t),console.error(e+" view is not yet implemented. Please do so !"),n=s(51135)}return this.currentView&&this.currentView.destroy(),this.currentView=new n({id:parseInt(e),subID:parseInt(i[3])}),this.currentView}})}(jQuery)},29171:function(e){const t={setItem:function(e,t){},getItem:function(e){},removeItem:function(e){}};function s(){this.api=window.localStorage||t,this.listening=!1,this.listeners={}}s.prototype.set=function(e,t){if(!e||null==t)return this;"object"==typeof t&&(t=JSON.stringify(t));try{this.api.setItem(e,t)}catch(e){}return this},s.prototype.get=function(e){if(!e)return;const t=this.api.getItem(e);if(!t)return t;try{return JSON.parse(t)}catch(e){return t}},s.prototype.unset=function(e){if(!e)return this;try{this.api.removeItem(e)}catch(e){}return this},s.prototype._listen=function(){const e=this;jQuery(window).on("storage",(function(t){t||(t=window.event);const s=e.listeners[t.key];s&&s.length&&s.forEach((function(e){e(JSON.parse(t.newValue),JSON.parse(t.oldValue))}))}))},s.prototype.on=function(e,t){this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t],!1===this.listening&&(this._listen(),this.listening=!0)},s.prototype.off=function(e,t){const s=this.listeners[e];s.length>1?s.splice(s.indexOf(t),1):this.listeners[e]=[]},s.prototype.setComponentMeta=function(e,t,s){const i=this.get("tcb-components-display")||{};i[e]=i[e]||{},i[e][t]=s,this.set("tcb-components-display",i)},s.instance=function(){return this._instance||(this._instance=new s),this._instance},e.exports=s},69129:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}window.tinymce=window.tinymce||void 0,window.tinyMCEPreInit=window.tinyMCEPreInit||void 0;const r=s(49939);var a;a=jQuery,e.exports={icon:function(e,t="ta-",s=""){return e?(s=" "+s,TVE_Dash.tpl("utils/icon",{icon:t+e,cls:s})):""},isEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},renderMCE:function(e,t,s,i=!1){return new Promise((n=>{setTimeout((()=>{this.clearMCEEditor(e),this.editorInit(e,t,s,i).then((e=>n(Array.isArray(e)?e[0]:null)))}))}))},editorInit:function(e,t,s,i=!1){if("undefined"==typeof tinymce||!tinymce)return Promise.resolve(null);const n=this.buildMCEInit({mce:window.tinyMCEPreInit.mceInit.tve_tinymce_tpl,qt:window.tinyMCEPreInit.qtInit.tve_tinymce_tpl},e);return window.tinyMCEPreInit.mceInit=a.extend(tinyMCEPreInit.mceInit,n.mce_init),window.tinyMCEPreInit.mceInit[e].setup=function(n){n.on("init",(function(){n.setContent(t.get(s)||"")})),n.on("change",(function(){const n=tinymce.get(e);t.set(s,n.getContent(),{silent:i})})),n.on("blur",(function(){const i=window.tinymce.get(e);t.get(s)!==i.getContent()&&t.set(s,i.getContent()),t.trigger("tva_tinymce_blur")}))},window.tinymce.init(tinyMCEPreInit.mceInit[e])},clearMCEEditor:function(e,t){void 0!==window.tinymce&&tinymce&&("string"==typeof e&&(e=[e]),e.forEach((function(e){t!==e&&function(e){try{window.tinymce.get(e).destroy(),window.tinymce.execCommand("mceRemoveControl",!0,e)}catch(e){}}(e)})))},buildMCEInit:function(e,t){const s={},i={};return s[t]=jQuery.extend(!0,{},e.mce),i[t]=jQuery.extend(!0,{},e.qt),i[t].id=t,s[t].selector="#"+t,s[t].body_class=s[t].body_class.replace("tve_tinymce_tpl",t),{mce_init:s,qt_init:i}},wpMedia:function(e={},t,s){const i={id:`tva-media-frame-${s}`,title:"Select or upload an image",button:{text:"Use this Image"},library:{type:"image"},multiple:!1},n=wp.media(a.extend(i,e));n.on("select",e.select||(()=>{const e=n.state().get("selection").first().toJSON();t.set(s,e.url)})),n.open()},rebindWistiaFancyBoxes:function(){window.rebindWistiaFancyBoxes&&window.rebindWistiaFancyBoxes()},pluckFields:function(e,t){return e instanceof Backbone.Collection&&(e=e.toJSON()),e.map((e=>((e,t)=>{const s={};return t.forEach((t=>s[t]=e instanceof Backbone.Model?e.get(t):e[t])),s})(e,t)))},ucFirst:function(e){return e.charAt(0).toUpperCase()+e.substring(1)},camelCaseFuncName:function(e){return e.split("_").map((e=>TVA.Utils.ucFirst(e))).join("")},_n:function(e,t,s=t+"s",i=!0){return(i?e+" ":"")+TVA.t[1===e?t:s]},getPreviewUrl:function(){const e=TVA.courses.findWhere({status:"publish"});return TVA.settings.preview_option.value&&e?e.get("preview_url"):Array.isArray(TVA.design.demo_courses)&&TVA.design.demo_courses.length>0?TVA.design.demo_courses[0].preview_url:TVA.courses.first()?TVA.courses.first().get("preview_url"):""},getCourseLabel:function(e){const t=TVA.courses.findWhere({id:e});return t?t.get("name"):""},addUrlFragment:function(e,t){return[e.replace(/\/$/,""),t.replace(/^\//,"")].join("/")},buildUrl:function(e,t={},s=""){const i=new URL(e);return _.each(t,((e,t)=>{i.searchParams.append(t,e)})),s&&(e.includes("?rest_route")?i.searchParams.set("rest_route",this.addUrlFragment(i.searchParams.get("rest_route"),s)):i.pathname=this.addUrlFragment(i.pathname,s)),i.toString()},ensureUrlProtocol:function(e){if(!e.trim())return"";let t=e;return e.match(/^(http:|https:|ftp:)?\/\//)||(t=`http://${e}`),t},confirmation:function(e={}){const t=n({title:"Are you sure?",description:"","max-width":"calc(100% - 40px)",width:"550px",in_duration:200,out_duration:300,className:"tvd-modal tva-modal-create tva-modal-confirm tva-modal-design",dismissible:!0,template:"confirmation",yesClass:"tva-modal-btn-red",noClass:""},e);return new Promise((e=>{TVE_Dash.modal(r,n(n({},t),{},{model:new Backbone.Model(t),confirm:function(){this.close(),e()},cancel:function(){this.close()}}))}))},is_in_viewport:function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},dateFormat:function(e){return window.moment(e).format("MMM DD, YYYY hh:mma")},debugIcons:function(){let e=a("#wpbody-content #ta-icons");e.length||(e=a('<div id="ta-icons" style="position:absolute; top: 100px; left: 100px;"></div>').prependTo(a("#wpbody-content")),e.css({boxShadow:"1px 1px 3px rgba(0,0,0,.5)",zIndex:"99999",background:"#fff",padding:"10px",fontSize:"30px",width:"990px",display:"grid",columnGap:"20px",gridTemplateColumns:"repeat(auto-fit, 90px)"}));let t="<style>.tva-debug-icon svg { width: 30px !important; height: 30px !important;}.tva-debug-icon { box-shadow: 0 0 1px rgba(0,0,0,.3); padding: 3px} </style>";a("#tva-admin-icons [viewBox]").each(((e,s)=>{s.id&&(t+=`<span class="tva-debug-icon tva-flex tva-flex-mid tva-flex-column" title="${s.id}">${this.icon(s.id.replace("ta-",""))}<span style="font-size:8px;border-top:1px solid #dedede">${s.id}</span></span>`)})),e.html(t)},pageLoader:function(e,t=140){TVA.keepLoader=!0,this.$loaderContainer=this.$loaderContainer||a("#tva-app"),this.$loaderContainer.tvaToggleLoader(t,e,{background:"#eaefef",wrapperCss:{position:"fixed",left:"36px",top:"32px"}})},saveTooltips:function(e){e&&(TVA.dismissedTooltips=Array.from(new Set(TVA.dismissedTooltips.concat(e))),wp.apiRequest({type:"post",url:`${TVA.routes.settings_v2}/user-meta`,data:{meta_key:"tva_dismissed_tooltips",meta_value:TVA.dismissedTooltips.filter((e=>e))}}))},stripeConnect:function(){TVE_Dash.showLoader(),wp.apiRequest({url:`${TVA.routes.stripe}/connect_account`,method:"POST",data:{url:window.location.href}}).then((e=>{e.success&&(window.location=e.url),TVE_Dash.hideLoader()})).fail((e=>{var t;const s=(null===(t=e.responseJSON)||void 0===t?void 0:t.message)||e.statusText||e.message;TVE_Dash.err(s,3e3,null,"top"),TVE_Dash.hideLoader()}))},displayStripeError:function(){const e=new URLSearchParams(location.search),t=e.get("tve_stripe_connect_error"),s=e.get("err_message");"1"===t&&s&&TVE_Dash.err(s,1e4,null,"top")},isTooltipViewed:function(e){return TVA.dismissedTooltips.includes(e)},bindModalSelect2:function(e,t={}){e.each(((e,s)=>{const i=n({},t);Object.keys(s.dataset).forEach((e=>i[e]=s.dataset[e]));const o=a(s).select2(n({minimumResultsForSearch:(null==i?void 0:i.minimumResultsForSearch)?i.minimumResultsForSearch:1/0,templateResult:function(e,t){if(!e.element)return null;if(!e.element.dataset.icon)return e.text;const s=TVA.Utils.icon(e.element.dataset.icon);return t.classList.add("tva-with-icon"),a(s+'<span class="item-text">'+e.text+"</span>")}},i)).on("select2:opening",(e=>{e.currentTarget.parentNode.classList.add("select2--open");const t=String(e.currentTarget.className+(null==i?void 0:i.withSearch)?"":" no-search").replace("select2-hidden-accessible",""),s=a(e.currentTarget).data("select2").$dropdown;s.addClass(("tva-modal-dropdown "+t).trim()),i.fitParent&&s.find(".select2-dropdown").css("min-width",`${jQuery(e.currentTarget.parentNode).outerWidth()}px`)})).on("select2:closing",(e=>e.currentTarget.parentNode.classList.remove("select2--open")));o.data("select2").$container.addClass(i.containerClass||""),o.data("select2").$dropdown.addClass(i.dropdownClass||"")}))}}},72877:function(e,t,s){const i=s(55215),n=s(2921).extend({initialize:function(){TVA.migrate_access&&1===parseInt(TVA.migrate_access.should_migrate)&&this.fetchProducts().then((e=>{e&&1===parseInt(e.open_modal)&&this.openModal(i,{model:new Backbone.Model({items:e.items,spinnerURL:e.spinner_url}),no_close:!0,className:"tvd-modal",dismissible:!1})})).catch((e=>{TVE_Dash.err("Error during the migration process. Please contact Thrive Support!"),console.error(e)}))},fetchProducts:function(){return new Promise(((e,t)=>{wp.apiRequest({url:TVA.migrate_access.route,type:"GET"}).done((t=>{e(t)})).fail((e=>t(e)))}))}},{getInstance:function(){return new n}});e.exports=n},5235:function(e,t,s){const i=s(58052),n=s(96308),o=s(88119),r=s(91479);e.exports=s(51135).extend({template:TVE_Dash.tpl("access-restriction/index"),initialize:function(){this.model=new i(TVA.settings.login_page),this.listenTo(this.model,"value-changed",(()=>{TVE_Dash.LocalStorage.set("tva-login-page-id",String(this.model.get("value")))}))},render:function(){return this.$el.html(this.template()),this.renderLoginRegistrationSettings(),this.renderContentRestrictions(),this},renderLoginRegistrationSettings:function(){const e=new n({el:this.$(".tva-login-states-container"),model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your login & registration page"},normal:{title:"Login & registration page"},delete:{title:"Are you sure you want to remove this login & registration page?"}}});e.render(),this.addChild(e)},renderContentRestrictions:function(){[this.notLogged,this.notPurchased,this.locked].forEach((e=>{e&&e.destroy()})),this.notLogged=new o({scope:"not_logged",settings:TVA.accessRestriction.settings.not_logged,global_settings:!0}),this.notPurchased=new o({scope:"not_purchased",settings:TVA.accessRestriction.settings.not_purchased,global_settings:!0}),this.locked=new o({scope:"locked",settings:TVA.accessRestriction.settings.locked,global_settings:!0}),[this.notLogged,this.notPurchased,this.locked].forEach((e=>{e.off("model.sync").on("model.sync",((e,t)=>{TVA.accessRestriction.settings[e.scope]=t}))}))},openRestrictionsModal:function(e){this.renderContentRestrictions();let t=this.notLogged;switch(e.currentTarget.dataset.scope){case"not_purchased":t=this.notPurchased;break;case"locked":t=this.locked}return this.openModal(r,{accessTab:this,scope:e.currentTarget.dataset.scope,course:this.model,width:"670px",top:"40px",className:"tvd-modal tvd-modal-small",contentRestriction:t}),!1}})},88119:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const o=s(2921),r=s(66340),a=s(95070),l=s(96308);e.exports=o.extend({className:"tva-restricted-content",template:TVE_Dash.tpl("access-restriction/content-restriction"),title:"",autoSave:!1,availableOptions:Object.keys(TVA.accessRestriction.options),afterInitialize:function(e){if(e.scope=e.scope||"not_logged",t.extend(this,e),e.settings instanceof r)this.model=e.settings;else{let t=e.course?e.course.get("id"):"";!t&&e.course_id&&(t=e.course_id),this.model=new r(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({scope:e.scope,course_id:t,custom_id:e.custom_id},e.settings))}switch(this.customPageModel=new a(this.model.deepGet("redirect_custom.post",void 0)),this.listenTo(this.model,"change",(()=>{(this.model.changed.option||"message"!==this.model.get("option"))&&this.render()})),this.listenTo(this.customPageModel,"change:value",(()=>{this.model.deepSet("redirect_custom.post_id",this.customPageModel.get("value"),{silent:!0}),this.model.deepSet("redirect_custom.title",this.customPageModel.get("title"),{silent:!0}),this.model.deepSet("redirect_custom.custom_link",this.customPageModel.get("custom_link"),{silent:!0}),this.persist(!0)})),this.scope){case"not_logged":this.global_settings?this.availableOptions=this.availableOptions.filter((e=>!["message","inherit","buy_action","call_to_action"].includes(e))):this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","buy_action","call_to_action"].includes(e))),this.title=TVA.t.access_not_logged;break;case"not_purchased":this.global_settings?this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","message","inherit","redirect_login","buy_action","call_to_action"].includes(e))):this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","redirect_login","buy_action","call_to_action"].includes(e))),this.title=TVA.t.access_not_purchased;break;case"locked":this.global_settings?this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","redirect_login","message","inherit","buy_action","call_to_action"].includes(e))):this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","redirect_login","message","buy_action","call_to_action"].includes(e))),this.title=TVA.t.access_locked;break;case"custom":this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","redirect_login","inherit","message","buy_action","call_to_action"].includes(e))),this.title=TVA.t.access_custom;break;case"action_button_display":this.availableOptions=this.availableOptions.filter((e=>!["show_login_form","redirect_login","inherit","message","content","redirect_custom"].includes(e))),this.title=TVA.t.access_not_purchased_button}e.title&&(this.title=e.title),t(window).off("storage.tva_settings").on("storage.tva_settings",(()=>{const e=localStorage.getItem("tva-login-page-id");null!==e&&(TVA.settings.login_page.value=e?Number(e):0,this.render())}))},afterRender:function(){this.$loader=this.$(".tva-loader"),"redirect_custom"===this.model.get("option")&&this.addChild(new l({el:this.$(".tva-custom-redirect"),model:this.customPageModel,states_views_path:"./page-states/",labels:{search:{title:"Search for a page to use"},normal:{title:""},delete:{title:"Are you sure you want to remove this page?"}}}).render()),"message"===this.model.get("option")&&(this.model.ensureDefaultMessage(),TVA.Utils.renderMCE(`tva-restriction-${this.scope}`,this.model,"message",!0)),TVE_Dash.materialize(this.$el)},options:function(){return _.pick(TVA.accessRestriction.options,this.availableOptions)},fieldChanged:function(e){const t=e.currentTarget.dataset.field;let s=e.currentTarget.dataset.value||e.currentTarget.value;"checkbox"===e.currentTarget.type&&(s=e.currentTarget.checked),this.model.deepSet(t,s),this.persist(!0)},persist:function(e=!1,s=!0){if(e&&!this.autoSave){this.$loader.tvaToggleLoader(20,!0,{position:"top-right",background:"transparent"}),this.model.ensureDataExists(this.model.get("custom_id")).then((()=>this.$loader.tvaToggleLoader(!1)));const e=t.Deferred();return e.resolve(),e.promise()}s&&this.$loader.tvaToggleLoader(20,!0);const i="content"===this.model.get("option")&&!this.model.deepGet("content.post.preview_url");return this.model.save(null,{silent:!i}).done((e=>this.trigger("model.sync",this,e))).always((()=>{this.$loader.tvaToggleLoader(!1)})).fail((e=>TVE_Dash.err("Something went wrong: "+e.responseText)))},hasLoginRegistrationPage:function(){return!!TVA.settings.login_page.value}})}(jQuery)},40504:function(e,t,s){const i=s(2921),n=s(84643);var o;o=jQuery,e.exports=i.extend({template:TVE_Dash.tpl("products/access-rules/access-rule-condition"),className:"tva-rule-container tva-relative",productItemTpl:TVE_Dash.tpl("modals/customer/product-item"),userRoles:TVA.access_integrations.findWhere({slug:"wordpress"}).get("items"),products:TVA.products,defaults:["not_logged","not_purchased","locked"],afterInitialize:function(e){TVA.products.getAll(),this.ruleModel=e.ruleModel,this.parentWrapper=e.parentWrapper,this.disabled=this.defaults.includes(this.model.get("scope"))?"disabled":""},afterRender:function(){if(!this.disabled){this.$el.find("select").val(this.model.get("type"));const e=this.$el.find(".tva-condition-checkbox-list").empty();let t=[];this.model.get("type")&&(t="products"===this.model.get("type")?this.products:this.userRoles,t.each((t=>{let s="";this.model.get("selected")&&(s=this.model.get("selected").includes(t.get("id"))?"checked":""),e.append(this.productItemTpl({model:new n({id:t.get("id"),name:t.get("name"),checked:s})}))})))}setTimeout((()=>{TVE_Dash.materialize(this.$el),this.handleOptions()}),0)},fieldChanged:function(e){const t=e.currentTarget.dataset.value||e.currentTarget.value,s=this.$el.find(".tva-condition-checkbox-list").empty();this.$el.find(".tva-delete-condition-wrapper a").attr("data-type",t),"products"===t?(this.products.each((e=>s.append(this.productItemTpl({model:e})))),0===this.model.get("index")&&this.ruleModel.deepSet("conditions.roles",[])):"roles"===t&&(this.userRoles.each((e=>s.append(this.productItemTpl({model:e})))),0===this.model.get("index")&&this.ruleModel.deepSet("conditions.products",[])),this.parentWrapper.find("select").each((function(s,i){i.isSameNode(e.currentTarget)||(o(i).find(`option[value="${t}"]`).attr("disabled","disabled"),o(i).select2())})),this.handleOptions()},handleOptions:function(){const e=this.ruleModel.get("conditions");e&&Object.keys(e).forEach((t=>{e[t].length&&this.parentWrapper.find(`option[value="${t}"]`).prop("disabled","disabled")}))}})},38697:function(e,t,s){const i=s(81181),n=s(59579);e.exports=i.extend({initialize:function(){this.model=new n;const e=Backbone.history.getFragment().split("/");if(3===e.length){const t=parseInt(e[2]);TVA.topics.findWhere({id:t})instanceof Backbone.Model&&this.model.set("topic",t)}this.listenTo(this.model.get("author"),"change",this.onAuthorChanged)},afterRender:function(){this.renderForm(),this.$('[data-fn="editTitle"]').trigger("click"),setTimeout((()=>this.$(".title-box input")[0].focus()),100)},saveCourse:function(){return!!this.model.isValid()&&(TVE_Dash.showLoader(),this.model.attributes.order=TVA.courses.newItemOrder(),this.model.save(null,{success:e=>{TVA.courses.add(e),this.changeView(`#courses/${e.get("id")}/new`),TVE_Dash.hideLoader()},error:function(e,t){TVE_Dash.hideLoader(),TVE_Dash.err(t.responseJSON.message)}}))}})},88922:function(e,t,s){!function(){const t=s(74703),i=s(51941),n=s(27860),o=s(41691);e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/api-keys"),initialize:function(){this.collection=new t(TVA.tokens),this.listenTo(this.collection,"add",this.renderOne),this.listenTo(this.collection,"add",this.toggleTable),this.listenTo(this.collection,"toggleTable",this.toggleTable)},afterRender:function(){this.$apiWrapper=this.$("#tva-api-keys-wrapper"),this.$noApiKeysWrapper=this.$("#tva-no-api-keys"),this.toggleTable(),this.collection.each(this.renderOne,this)},toggleTable:function(){const e=this.collection.length;this.$apiWrapper.toggle(e>0),this.$noApiKeysWrapper.toggle(0===e)},renderOne:function(e){this.$el.append(new o({model:e,collection:this.collection}).render().$el)},addKey:function(){this.openModal(n,{model:new i,collection:this.collection,width:"550px",className:"tvd-modal tva-api-modal"})}})}(jQuery)},41691:function(e,t,s){const i=s(2921),n=s(27860);e.exports=i.extend({template:TVE_Dash.tpl("settings/api-key-item"),className:"tva-card tva-card-small tva-api-key-card",initialize:function(){i.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"sync",this.render)},afterRender:function(){this.$normalState=this.$(".tva-api-key-details"),this.$deletelState=this.$(".tva-api-key-delete")},editToken:function(){this.openModal(n,{model:this.model,collection:this.collection,top:"40px",className:"tvd-modal tvd-modal-big"})},deleteToken:function(){this.$normalState.hide(),this.$deletelState.show()},delete:function(){TVE_Dash.showLoader(),this.model.destroy({success:e=>{this.remove(),this.collection.remove(e),this.collection.trigger("toggleTable");const t=TVE_Dash.sprintf(TVA.t.token_deleted,e.get("name"));TVE_Dash.success(t)},error:(e,t)=>{t&&t.responseJSON&&TVE_Dash.err(t.responseJSON.message)},complete:()=>{TVE_Dash.hideLoader()}})},cancel:function(){this.$normalState.show(),this.$deletelState.hide()},changeField:function(e,t){const s=t.getAttribute("data-field");this._save(s,Number(t.checked))},_save:function(e,t){const s={};s[e]=t,this.model.set(s),this.model.save(),TVE_Dash.success(TVA.t.SuccessfulSave)}})},63250:function(e,t,s){!function(t){const i=s(24633);e.exports=i.extend({status:["archived"],afterRender:function(){this.$(".tva-main-heading").html(TVA.t.courseStatusText.archived)},renderBadgerFilters:t.noop})}(jQuery)},58611:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(51135),a=s(70163),l=s(7188),c=s(69145),d=s(86108);e.exports=r.extend({template:TVE_Dash.tpl("assessments/preview"),className:"tva-assessment-preview-wrapper tva-flex tva-flex-column",history:[],historyCache:{},showGrading:!1,assessmentGraded:!1,afterInitialize:function(e){this.parentView=e.parentView,this.historyCache={}},afterRender:function(){this.$assessmentPreview=this.$(".tva-assessment-submission"),this.$assessmentHistoryList=this.$(".tva-assessment-history-list"),this.$grade=this.$(".tva-assessment-grade"),this.$openGrade=this.$("#tva-assessment-open-grading"),this.$closeGrade=this.$(".tva-ag-close"),this.$submission=this.$(".tva-current-submission"),this.$historySection=this.$(".tva-assessment-history-section"),this.$gradingSummary=this.$(".tva-assessment-grading-summary")},initAssessmentPreview:function(e){this.userAssessment=e,this.updatePreviewUI(),this.renderTopSection(),this.renderPreview(),this.getHistory(),this.handleAssessmentGrading(),this.$submission.removeClass("tva-hide"),this.$historySection.addClass("tva-hide")},updatePreviewUI:function(e=this.userAssessment){const t=e.assessment;let s=e.grade;if(t&&""!==s)if("category"===t.grading_method){var i,n;const e=((null===(i=t.grading_method_data)||void 0===i?void 0:i.pass)||[]).concat((null===(n=t.grading_method_data)||void 0===n?void 0:n.fail)||[]);s=e.find((e=>parseInt(e.ID)===parseInt(s))).name}else"percentage"===t.grading_method&&(s+="%");const o=e.status;this.$(".tva-date").html(e.date),this.$(".tva-assessment-gs-grade").html(s),this.$(".tva-assessment-gs-feedback").html(e.notes),this.$(".tva-submission-status-wrapper .tva-assessment-status").attr("class",`tva-assessment-status tva-assessment-${TVA.t.assessments.status[o].toLowerCase()}`).html(TVA.t.assessments.status[o]),this.$(".tva-assessment-notes").val(e.notes)},handleAssessmentGrading:function(e=this.userAssessment){this.showGrading=!1,this.toggleGrading(),this.renderGradingMenu();const t=void 0!==e.displayIndex&&e.displayIndex!==e.user_submission_counter;e.grade?(this.$(".tva-assessment-grade-button")[t?"addClass":"removeClass"]("tva-hide"),this.assessmentGraded=!0,this.$openGrade.addClass("tva-hide"),this.$gradingSummary.removeClass("tva-hide")):(this.$openGrade[t?"addClass":"removeClass"]("tva-hide"),this.$gradingSummary.addClass("tva-hide"))},getCacheKey:function(){return`${this.userAssessment.assessment.ID}_${this.userAssessment.author_id}`},getHistory:function(){const e=this.getCacheKey();this.historyCache[e]?(this.history=this.historyCache[e],this.renderHistory()):(TVE_Dash.showLoader(),wp.apiRequest({url:`${TVA.routes.assessments}/get_data`,data:{student_ids:[this.userAssessment.author_id],assessment_ids:[this.userAssessment.assessment.ID],outdated:1}}).done((t=>{this.history=t,this.historyCache[e]=t,this.renderHistory()})).always((()=>{TVE_Dash.hideLoader()})))},renderHistory:function(){let e=this.history.length+1;this.$(".tva-assessment-attempts-number").text(`(${e})`),this.$assessmentHistoryList.empty(),this.userAssessment.displayIndex=e,this.$assessmentHistoryList.append(TVE_Dash.tpl("assessments/history-item")(this.userAssessment)),e--,this.history.forEach((t=>{t.displayIndex=e,"pending_assessment"===t.status&&(t.status="replaced_assessment"),this.$assessmentHistoryList.append(TVE_Dash.tpl("assessments/history-item")(t)),e--})),this.$(".tva-assessment-attempts").toggleClass("tva-hide",!this.history.length)},previewItem:function(e,t){const s=t.dataset.id,i=s===this.userAssessment.ID?this.userAssessment:this.history.find((e=>parseInt(e.ID)===parseInt(s)));this.renderPreview(i),this.updatePreviewUI(i),this.handleAssessmentGrading(i),this.$submission.removeClass("tva-hide"),this.$historySection.addClass("tva-hide"),this.$(".tva-assessment-attempts").removeClass("tva-hide")},renderPreview:function(e=this.userAssessment){let t;switch(e.type){case"external_link":t=new a(e);break;case"youtube_link":t=new l(e);break;case"tqb":t=new c(e);break;case"upload":t=new d(e)}this.$assessmentPreview.html(t.$el)},showHistory:function(){this.$submission.addClass("tva-hide"),this.$historySection.removeClass("tva-hide"),this.$(".tva-assessment-attempts").addClass("tva-hide")},renderTopSection:function(){const e=TVE_Dash.tpl("assessments/history-top-header")(n({},this.userAssessment));this.$(".tva-submission-data").html(e)},renderGradingMenu:function(){const e=TVE_Dash.tpl("assessments/grade-label")({tooltip:this.getGradingTooltip()}),t=TVE_Dash.tpl(`assessments/grade/${this.userAssessment.assessment.grading_method}`)(n({},this.userAssessment)),s=TVE_Dash.tpl("assessments/grade-button")();this.$(".tva-assessment-grade-input").html(e+t+s),this.$("select.tva-assessment-grade-value").select2()},getGradingTooltip:function(){let e=TVA.t.passingGrade;switch(this.userAssessment.assessment.grading_method){case"percentage":e+=` ${this.userAssessment.assessment.passing_percentage}%`;break;case"score":e+=` ${this.userAssessment.assessment.passing_score}`;break;case"category":e+=` ${this.userAssessment.assessment.grading_method_data.pass.map((e=>e.name)).join(", ")}`;break;default:e+=" Pass"}return e},toggleGrading:function(){this.assessmentGraded?this.$gradingSummary.toggleClass("tva-hide",this.showGrading):this.$openGrade.toggleClass("tva-hide",this.showGrading),this.$closeGrade.toggleClass("tva-hide",!this.showGrading),this.$grade.toggleClass("tva-hide",!this.showGrading),this.showGrading=!this.showGrading},saveGrade:function(){const e=this.$(".tva-assessment-grade-value").val(),t=!!isNaN(e)||e>=0;e.length>0&&t?(TVE_Dash.showLoader(),wp.apiRequest({type:"POST",url:`${TVA.routes.assessments}/save_grade`,data:{id:this.userAssessment.ID,assessment_id:this.userAssessment.assessment.ID,grade:e,notes:this.$(".tva-assessment-notes").val()}}).success((e=>{this.userAssessment=n(n({},this.userAssessment),e),TVE_Dash.success(TVA.t.assessments.graded),this.parentView.afterAssessmentGraded(this.userAssessment)})).fail((e=>{TVE_Dash.err(e.statusText)})).always((()=>{TVE_Dash.hideLoader()}))):TVE_Dash.err(TVA.t.invalidGrade)}})},70163:function(e,t,s){const i=s(2921).extend({className:"tva-assessment-external-link",initialize:function(e){this.previewLink(e.value)},previewLink:function(e){this.$el.append("<p>"+e+'</p><a target="_blank" href="'+e+'">'+TVA.Utils.icon("link-symbol")+TVA.t.new_tab+"</a>")}});e.exports=i},69145:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(2921).extend({className:"tva-assessment-tqb",initialize:function(e){this.quizResults(e.value)},quizResults:function(e){wp.apiRequest({type:"POST",url:`${TVA.routes.assessments}/quiz_result_data`,data:{user_id:e}}).success((e=>{this.previewUserAnswers(e)})).fail((e=>{this.$el.append(`<p>${e.responseJSON.message}</p>`)})).always((()=>{TVE_Dash.hideLoader()}))},previewUserAnswers:function(e){const s=e.questions,i=e.completion_data,o=Math.round((new Date(i.date_finished)-new Date(i.date_started))/6e4);this.$el.append(TVE_Dash.tpl("assessments/tqb/header")(n(n({},i),{},{completionTime:o}))),s.forEach((e=>{const s=t(TVE_Dash.tpl("assessments/tqb/question")({text:e.text}));e.answers.forEach((n=>{const o=t('<div class="tva-assessment-answer">');switch(parseInt(e.q_type)){case 1:s.addClass("tva-assessment-answer-text"),o.append(`<p>${n.text}</p>`);break;case 2:s.addClass("tva-assessment-answer-image"),o.append(`<img height="130px" width="200px" src="${n.image.url}">`);break;case 3:s.addClass("tva-assessment-answer-open-ended"),o.append(`<p>${n.answer_text}</p>`)}if(3!==parseInt(e.q_type))switch(i.quiz_type){case"personality":const e=i.quiz_results.find((e=>e.id===n.result_id));o.addClass("is_category").append(TVE_Dash.tpl("assessments/tqb/category")({text:e.text}));break;case"number":case"percentage":o.addClass("is_number").append(`<span>${n.points}</span>`);break;case"right_wrong":parseInt(n.is_right)&&o.addClass("is_right").append(TVA.Utils.icon("square-check")),!0===n.chosen&&(parseInt(n.is_right)?o.addClass("right_selected"):o.addClass("wrong_selected").append(TVA.Utils.icon("x-symbol")))}!0===n.chosen&&o.addClass("tva-assessment-selected"),s.find(".tva-assessment-answers-container").append(o)})),this.$el.append(s)}))}});e.exports=i}(jQuery)},86108:function(e,t,s){const i=s(2921).extend({className:"tva-upload-preview",cache:{},initialize:function(e){const t=e.config.service;this.files=e.value,Array.isArray(this.files)?(this.type=t,this.prepareFile(0)):console.warn("Invalid User assessment ID")},prepareFile:function(e){this.$el.append(TVE_Dash.tpl("assessments/upload")),this.$previewContainer=this.$el.find(".tva-preview-container");const t=this.files[e];switch(this.files.length>1&&this.renderMultipleFiles(e),this.type){case"dropbox":this.getDropboxLink(t),this.bindIframeListeners();break;case"google_drive":this.buildIframe(`https://docs.google.com/file/d/${t}/preview`)}},bindIframeListeners:function(){new MutationObserver((()=>{this.cleanUp()})).observe(this.el,{childList:!0})},cleanUp:function(){const e=this.$el.find("iframe");e.removeAttr("style"),e.attr({height:650,width:690})},getDropboxLink:function(e){this.cache[e]?this.buildIframe(this.cache[e]):(TVE_Dash.showLoader(),wp.apiRequest({type:"POST",url:`${TVA.routes.assessments}/dropbox_file_data`,data:{file_id:e}}).success((t=>{t.error&&"string"==typeof t.error&&TVE_Dash.err(`There was an error fetchling file URL: ${t.error}`),this.buildIframe(t.url),this.cache[e]=t.url})).always((()=>{TVE_Dash.hideLoader()})))},buildIframe:function(e){"dropbox"===this.type&&window.Dropbox?(window.Dropbox.embed({link:e,file:{zoom:"best"}},this.$previewContainer[0]),this.cleanUp()):this.$previewContainer.append(`<iframe src="${e}" height="650" width="690"></iframe>`)},renderMultipleFiles:function(e){const t=this.$el.find(".tva-assessment-items-counter").removeClass("tva-hide"),s=this.$el.find(".tva-assessment-previous-file").removeClass("tva-hide"),i=this.$el.find(".tva-assessment-next-file").removeClass("tva-hide");t.text(TVE_Dash.sprintf(TVA.t.assessments_multiple_files,e+1,this.files.length)),i.on("click",(()=>{const t=e<this.files.length-1?e+1:0;this.$el.empty(),this.prepareFile(t)})),s.on("click",(()=>{const t=e>0?e-1:this.files.length-1;this.$el.empty(),this.prepareFile(t)}))}});e.exports=i},7188:function(e,t,s){const i=s(2921).extend({initialize:function(e){this.isValid(e.value)},isValid:function(e){const t=e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/),s=!!t&&"https://www.youtube.com/embed/"+t[1],i=!1===s?"<p>Invalid link</p>":'<iframe src="'+s+'" width="690" height="480" allowfullscreen>';this.$el.append(i)}});e.exports=i},8098:function(e,t,s){!function(t){const i=s(69311),n={dropbox:s(56560),google_drive:s(65692)};e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/assessment-settings"),initialize:function(){this.model=new i(TVA.assessments.settings),this.listenTo(this.model,"change:upload_connection_key",(()=>{this.handleConnectionChange(),TVE_Dash.data_binder(this)}))},afterRender:function(){this.$saveButton=this.$(".tva-settings-save-button"),this.$select=this.$("#assessment-upload-to");for(const[e,s]of Object.entries(TVA.assessments.upload_connections))this.$select.append(t("<option/>").text(s.name).val(e).attr("data-image",`${TVE_Dash_Const.dash_url}/inc/auto-responder/views/images/${e}.png`));this.renderConnectionOptions(),TVE_Dash.data_binder(this),this.$select.select2({templateResult:this.select2ImageItemRenderer,templateSelection:this.select2ImageItemRenderer}).data("select2").$dropdown.addClass("tva-assessment-upload-select-dropdown")},select2ImageItemRenderer:function(e){return e.element&&e.element.dataset.image?t(`<span><span class="opt-image" style="background-image: url('${e.element.dataset.image}')"></span><span>${e.text}</span></span>`):e.text},handleConnectionChange:function(){this.model.set({folder_id:"",folder_name:"",folder_full_link:""}),this.renderConnectionOptions()},renderConnectionOptions:function(){const e=this.model.get("upload_connection_key");this.$(".service-chooser").html(""),n[e]&&this.$(".service-chooser").html(new n[e]({model:this.model}).render().$el)},save:function(){if(!this.model.isValid())return TVE_Dash.err(this.model.getValidationError());TVE_Dash.showLoader(),this.$saveButton.attr("disabled","true"),this.model.save().done((()=>{TVE_Dash.hideLoader(),this.$saveButton.removeAttr("disabled"),TVE_Dash.success(TVA.t.settingsSaved)}))}})}(jQuery)},56560:function(e,t,s){const i=window.ThriveDropBoxPicker;e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/assessments/service-dropbox"),afterRender:function(){this.initializeDropbox()},initializeDropbox:function(){const e=setInterval((()=>{"function"==typeof window.Dropbox.createChooseButton&&(i.chooser(this.$(".dropbox-chooser"),{},this.model.get("folder_name")||this.model.get("folder_id"),(e=>{this.model.set({folder_name:e[0].name,folder_id:e[0].id})})),clearInterval(e))}),300)}})},65692:function(e,t,s){e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/assessments/service-google_drive"),afterRender:function(){this.$("#upload-folder-url").on("change",(()=>this.getFolderId()))},getFolderId:function(){const e=this.$("#upload-folder-url").val().trim();let t;t=e.replace(/\?(.*)$/,""),t=t.split("/").pop(),this.model.set("folder_full_link",e),this.model.set("folder_id",t)}})},1533:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(51135),a=s(39105),l=s(26035),c=s(58611),d=s(16591),h=a.extend({template:TVE_Dash.tpl("assessments/help")});e.exports=r.extend({template:TVE_Dash.tpl("assessments/dashboard"),className:"tva-assessments-inbox tva-flex tva-flex-column",currentTab:"pending",tooltipKey:"assessments-intro",page:1,limit:10,isLoading:!1,assessmentsCache:{},selectFirst:!1,submissions:{failed:[],passed:[],pending:[],all:[]},counters:{pending:0,passed:0,failed:0,all:0},filters:{courseIds:[],studentIds:[],assessmentIds:[]},searchItems:{courses:[],students:[],assessments:[]},search:"",ensureData:async function(){return this.invalidateCache(),new Promise((e=>{TVA.assessments.has_submissions?(TVE_Dash.showLoader(),this.getDataRequest({assessment_status:TVA.assessments.statuses.pending}).then((t=>{this.submissions.pending=t,e(),this.handleCounters()}))):e()}))},afterRender:function(){TVA.assessments.has_submissions?(this.assessmentPreview=new c({$parentElement:this.$el,parentView:this}),this.$inboxContent=this.$(".tva-inbox-content"),this.$tabs=this.$(".tva-tab"),this.$tabContents=this.$(".tva-tab-content"),this.$assessmentHistory=this.$(".tva-assessment-history"),this.$assessmentHistory.html(this.assessmentPreview.render().$el),this.$filters=this.$(".tva-assessment-filters"),this.$noStatusAssessments=this.$(".tva-no-status-assessments"),this.renderFilters(),this.switchTab(null,this.$tabs[0]),this.$(".tva-inbox-content .tva-tab-content").on("scroll",this.onListScroll.bind(this))):this.$el.addClass("tva-no-submissions"),TVA.Utils.isTooltipViewed(this.tooltipKey)||(requestAnimationFrame((()=>this.openHelpLightbox())),TVA.Utils.saveTooltips(this.tooltipKey))},onListScroll:function(e){if(this.submissions[this.currentTab].length<this.counters[this.currentTab]){const t=e.currentTarget;!this.isLoading&&t.scrollTop+t.clientHeight+250>t.scrollHeight&&(this.page++,this.isLoading=!0,this.ensureTabData(this.currentTab,!1))}},switchTab:function(e,t){const s=t.dataset.tab;TVE_Dash.showLoader(),this.page=1,this.currentTab=s,this.$tabs.removeClass("tva-tab-selected"),this.$tabContents.addClass("tva-hide"),t.classList.add("tva-tab-selected"),this.$tabContents.filter(`[data-tab="${s}"]`).removeClass("tva-hide"),this.$inboxContent.removeClass("tva-with-preview"),this.selectFirst=!0,this.ensureTabData()},ensureTabData:function(e=this.currentTab,t=!0){this.getDataRequest({assessment_status:TVA.assessments.statuses[e]}).then((s=>{this.submissions[e]=[...new Set([...this.submissions[e],...s])],this.renderSubmissions(s,t)}))},renderSubmissions:function(e,t=!0){const s=this.$tabContents.filter(`[data-tab="${this.currentTab}"]`);t&&s.empty(),e.length?(e.forEach((e=>{s.append(TVE_Dash.tpl("assessments/item")(n({},e)))})),this.selectFirst&&(this.selectFirst=!1,this.selectFirstAssessment()),this.$noStatusAssessments.addClass("tva-hide"),this.$assessmentHistory.removeClass("tva-hide")):(this.$noStatusAssessments.removeClass("tva-hide"),this.$assessmentHistory.addClass("tva-hide"),this.$noStatusAssessments.find("p").text(TVA.t.assessments.no_entries[this.currentTab])),TVE_Dash.hideLoader(),this.isLoading=!1},selectFirstAssessment:function(){const e=this.$tabContents.filter(`[data-tab="${this.currentTab}"]`);this.$(e.children()[0]).trigger("click")},getDataRequest:function(e={}){e=n(n({},{course_ids:this.filters.courseIds.length?this.filters.courseIds:this.searchItems.courses,student_ids:this.filters.studentIds.length?this.filters.studentIds:this.searchItems.students,assessment_ids:this.filters.assessmentIds.length?this.filters.assessmentIds:this.searchItems.assessments,assessment_status:TVA.assessments.statuses[this.currentTab],page:this.page,limit:this.limit}),e);const t=this.getCacheKey(e);return new Promise((s=>{this.assessmentsCache.hasOwnProperty(t)?s(this.assessmentsCache[t]):wp.apiRequest({url:`${TVA.routes.assessments}/get_data`,data:e}).then((e=>{this.assessmentsCache[t]=e,s(e)}))}))},previewSubmission:function(e,t){const s=parseInt(t.dataset.id),i=this.submissions[this.currentTab].find((e=>e.ID===s));this.$(".tva-assessment-submission-card:visible").removeClass("tva-submission-active"),t.classList.add("tva-submission-active"),this.$inboxContent.addClass("tva-with-preview"),this.assessmentPreview.initAssessmentPreview(i)},filterList:function(){this.getDataRequest({page:1,limit:this.limit*this.page}).then((e=>{this.submissions[this.currentTab]=e,this.selectFirst=!0,this.renderSubmissions(this.submissions[this.currentTab])})),this.handleCounters()},handleCounters:function(){const e=[];Object.keys(TVA.assessments.statuses).forEach((t=>{e.push(this.getDataRequest({assessment_status:TVA.assessments.statuses[t],limit:0,count:1}).then((e=>{isNaN(parseInt(e))&&(e=0),this.$(`.tva-counter-${t}`).text(e),this.counters[t]=e})))})),Promise.allSettled(e).then((()=>{this.counters.all=this.counters.pending+this.counters.passed+this.counters.failed,this.$(".tva-counter-all").text(this.counters.all)}))},afterAssessmentGraded:function(e){const t=Object.keys(TVA.assessments.statuses).find((t=>TVA.assessments.statuses[t]===e.status));this.assessmentsCache={},"all"!==this.currentTab&&this.currentTab!==t&&(this.counters[this.currentTab]--,this.counters[t]++),this.$(`.tva-counter-${this.currentTab}`).text(this.counters[this.currentTab]),this.$(`.tva-counter-${t}`).text(this.counters[t]),this.submissions[t]=[],this.$inboxContent.removeClass("tva-with-preview"),TVE_Dash.showLoader(),this.getDataRequest({page:1,limit:this.page*this.limit}).then((e=>{this.selectFirst=!0,this.submissions[this.currentTab]=e,this.renderSubmissions(this.submissions[this.currentTab]),TVE_Dash.hideLoader()}))},getCacheKey:function(e={}){return`assessments-${JSON.stringify(e)}`},onSearch:_.debounce((function(e){this.search=e.target.value.toLowerCase(),this.search.length?(this.searchItems.courses=TVA.courses.filter((e=>e.get("name").toLowerCase().includes(this.search))).map((e=>e.get("id"))),this.searchItems.assessments=this.allAssessments.filter((e=>e.text.toLowerCase().includes(this.search))).map((e=>e.id)),this.searchItems.students=this.users.filter((e=>e.name.toLowerCase().includes(this.search))).map((e=>e.id))):this.searchItems={courses:[],assessments:[],students:[]},this.filterList()}),250),invalidateCache:function(){this.assessmentsCache={},this.searchItems={courses:[],assessments:[],students:[]},this.submissions={all:[],pending:[],passed:[],failed:[]},this.filters={courseIds:[],assessmentIds:[],studentIds:[]}},openHelpLightbox:function(){this.openModal(h,{width:d.ModalWidth})},renderFilters:function(){this.$filters.append(new l({dropdownClass:"tva-assessment-course-filter-dropdown tva-select-tags-filter-dropdown",containerClass:"tva-assessment-course-filter-container tva-select-tags-filter-container",withCounterTags:!0,selectOptions:{closeOnSelect:!1,placeholder:"All courses"},selectData:[...TVA.courses.map((e=>({id:e.get("id"),text:e.get("name")})))],change:e=>{this.filters.courseIds=e,this.filterList()}}).render().$el),wp.apiRequest({url:`${TVA.routes.assessments}/localize`}).then((e=>{this.allAssessments=e,this.$filters.append(new l({className:"tva-select-with-checkboxes tva-af-select-assessments",dropdownClass:"tva-assessments-filter-dropdown tva-select-tags-filter-dropdown",containerClass:"tva-assessments-filter-container tva-select-tags-filter-container",withCounterTags:!0,selectOptions:{closeOnSelect:!1,placeholder:"All assessments"},selectData:this.allAssessments,change:e=>{this.filters.assessmentIds=e,this.filterList()}}).render().$el)})),wp.apiRequest({url:`${TVA.routes.assessments}/users`}).then((e=>{this.users=e,this.$filters.append(new l({className:"tva-select-with-checkboxes tva-af-select-students",dropdownClass:"tva-assessment-user-filter-dropdown tva-select-tags-filter-dropdown",containerClass:"tva-assessment-user-filter-container tva-select-tags-filter-container",withCounterTags:!0,selectOptions:{closeOnSelect:!1,placeholder:"All students"},selectData:[...e.map((e=>({id:e.id,text:e.name})))],change:e=>{this.filters.studentIds=e,this.filterList()}}).render().$el)}))}})},2921:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){Backbone.View.prototype.tvaClearError=function(){return this.$(".tvd-invalid").removeClass("tvd-invalid"),this.$("select").trigger("tvaclear"),this},Backbone.View.prototype.tvaShowErrors=function(e){if(!(e=e||this.model))return;const s=e instanceof Backbone.Model?e.validationError:e,i=this;let n=t();function o(e){if("string"==typeof e)return TVE_Dash.err(e);n=n.add(i.$("[data-field="+e.field+"]").addClass("tvd-invalid").each((function(){const s=t(this);s.is("select")?s.trigger("tvderror",e.message):s.next("label").attr("data-error",e.message)})))}return t.isArray(s)?_.each(s,(function(e){o(e)})):o(s),n.not(".tvd-no-focus").first().focus(),this.scrollFirstError(n.first()),this},Backbone.View.prototype.scrollFirstError=function(e){if(!(this instanceof TVE_Dash.views.Modal&&e.length))return this;const t=e.offset().top,s=this.$_content.offset().top,i=this.$_content.outerHeight();if(t>=s&&t<i+s-50)return this;const n=this.$_content.scrollTop();this.$_content.animate({scrollTop:n+t-s-40},200,"swing")};const i=s(39105);e.exports=Backbone.View.extend({zClipCopiedClass:"tva-copied",$$childViews:[],initialize:function(e){e&&e.template&&(this.template=e.template),this.afterInitialize(e)},events:{"click .click":"_call","mousedown .mousedown":"_call","mouseover .mouseover":"_call","mouseenter .mouseenter":"_call","change .change":"_call","input .input":"_call"},_call:function(e){const t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)},getRenderParams:function(){return{model:this.model}},render:function(){return"string"==typeof this.template&&(this.template=TVE_Dash.tpl(this.template)),"function"==typeof this.template&&this.$el.html(this.template(this.getRenderParams())),setTimeout((()=>this.bindZclip()),200),this.afterRender(),this},openModal:function(e,t={}){if(_.isObject(e)&&(e.prototype instanceof i||e.prototype instanceof TVE_Dash.views.ModalSteps||e.prototype instanceof TVE_Dash.views.Modal))return t=n(n({},{"max-width":"calc(100% - 40px)",width:"850px",in_duration:200,out_duration:300,className:"tvd-modal tva-modal-create",dismissible:!0}),t),TVE_Dash.modal(e,t);console.warn("Invalid type of modal view")},changeView:function(e){TVA.Router.navigate(e,{trigger:!0})},bindZclip:function(){this.$el.find(".tva-zclip").each(((e,s)=>{const i=t(s),n=i.prev().on("click",(function(e){this.select(),e.preventDefault(),e.stopPropagation()}));try{i.zclip({path:TVE_Dash_Const.dash_url+"/js/util/jquery.zclip.1.1.1/ZeroClipboard.swf",copy:()=>i.prev().val(),afterCopy:()=>{n[0].select(),i.removeClass(this.zClipCopiedClass).addClass(this.zClipCopiedClass),setTimeout((()=>{i.removeClass(this.zClipCopiedClass)}),2e3)}})}catch(e){}}))},afterRender:t.noop,afterInsert:t.noop,afterInitialize:t.noop,addChild:function(...e){return Array.isArray(e[0])&&(e=e[0]),this.$$childViews=this.$$childViews.concat(e),this},destroy:function(){return this.stopListening(),this.undelegateEvents(),this.$el.removeData().off(),this.$$childViews.filter((e=>e)).forEach((e=>{"function"==typeof(null==e?void 0:e.destroy)&&e.destroy()})),this}})}(jQuery)},68338:function(e,t,s){var i;i=jQuery,e.exports=s(2921).extend({template:_.template(""),className:"tva-grid tva-grid-row-gap-5",inputs:[],afterInitialize:function(e){i.extend(!0,this,e),this.inputs=this.inputs||[]},afterRender:function(){this.inputs.forEach((e=>{const t=`tva_checkbox_group_${e.value}`,s=e.checked?"checked":"";this.$el.append(`<div><input type="checkbox" id="${t}" value="${e.value}" class="change" data-fn="checkboxChanged" ${s}/><label class="normal-label" style="cursor: pointer;" for="${t}">${e.label}</label></div>`)}))},checkboxChanged:function(){const e=[];this.$("input").each(((t,s)=>{s.checked&&e.push(s.value)})),this.change(e)},change:i.noop})},18421:function(e,t,s){var i;i=jQuery,e.exports=s(2921).extend({afterInitialize:function(e){i.extend(!0,this,e)},cancel:function(){this.remove()},confirm:function(){this.remove()}})},51135:function(e,t,s){e.exports=s(2921).extend({ensureData:async function(){return new Promise((e=>{e()}))}})},37020:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const o=s(2921),r=s(76821),a=s(43265),l=s(5657),c=s(78818),d=s(73799),h=s(93275),u=s(91479),p=r.extend({renderThumbs:!0,label:"",initialize:function(e){const t=new d(TVA.labels.toJSON());return t.idAttribute="ID",this.collection=t,r.prototype.initialize.call(this,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({collection:t},e))}});e.exports=o.extend({template:TVE_Dash.tpl("courses/access-tab"),integrations:null,integrationsViews:[],$integrationsWrapper:null,$rulesCountMessage:null,labelDropdown:null,initialize:function(e){t.extend(!0,this,e),this.integrations=TVA.access_integrations,this.labelDropdown=new p({add_item:{str:{title:TVA.t.addNewLabel,save:TVA.t.saveLabel},inputTemplate:TVE_Dash.tpl("labels/add-inline"),spectrum:function(e){const s=this,i=e.currentTarget,n=t(i).find("input").spectrum({containerClassName:"tva-color-picker",showPalette:!1,allowEmpty:!1,showInitial:!1,showButtons:!0,chooseText:"Apply",cancelText:"Cancel",showInput:!0,preferredFormat:"hex",hide:function(e){i.style.setProperty("--thumb-color",e.toString()),s.focusInput()}});return requestAnimationFrame((()=>n.spectrum("show"))),!1},getModelForSave:function(){const e=this.$(".tva-colorpicker").val();return new h({title:this.$input.val(),label_color:e,color:e})},afterSave:function(e){TVA.labels.push(e)},addToCollection:function(e){this.dropdown.collection.push(e)}}}),this.labelDropdown.on("tva.dropdown.item.selected",this.onLabelChange.bind(this)),this.listenTo(this.model.get("rules"),"add",this.renderRulesCount),this.listenTo(this.model.get("rules"),"remove",this.renderRulesCount),this.listenTo(this.model,"change",this.changeModel),this.listenTo(this.model,"change:is_private",(e=>this.togglePrivateContent(e.get("is_private"))))},afterRender:function(){this.$("#tva-course-is-private").prop("checked",this.model.get("is_private")),this.$integrationsWrapper=this.$("#tva-course-integrations-wrapper"),this.$rulesCountMessage=this.$("#tva-rules-count-message"),this.$privateContent=this.$(".tva-restrictions-card-state"),this.renderLabelDropdown(),this.togglePrivateContent(this.model.get("is_private")),TVE_Dash.data_binder(this)},renderRulesCount:function(){const e=this.model.get("rules").filter((e=>e.getItems().length||"thrivecart"===e.get("integration")));0===e.length?this.$rulesCountMessage.text(TVA.t.noAccessRulesSet):1===e.length?this.$rulesCountMessage.text(TVA.t.oneAccessRuleSet):this.$rulesCountMessage.text(TVE_Dash.sprintf(TVA.t.accessRulesSet,e.length))},renderIntegrations:function(e){if(e||(e=this.integrations),this.$integrationsWrapper.empty(),!(e instanceof Backbone.Collection))return null;e.each((e=>{const t={model:e,rules:this.model.get("rules")},s=(()=>{let s;switch(e.get("slug")){case"woocommerce":s=new c(t);break;case"thrivecart":s=new l(t);break;default:s=new a(t)}return s})();this.$integrationsWrapper.append(s.render().$el),this.integrationsViews.push(s)})),this.renderRulesCount()},togglePrivateContent:function(e=!1){e?this.renderIntegrations(this.integrations):(this.integrationsViews.forEach((e=>{e.remove(),e.destroy()})),this.integrationsViews=[]),this.$privateContent.hide().filter(`[data-state="${e?1:0}"]`).show()},renderLabelDropdown:function(){this.labelDropdown.collection.setSelectedId(this.model.get("label")),this.$("#tva-course-label").append(this.labelDropdown.render().$el)},onLabelChange:function(e){if(this.model.set("label",parseInt(e.get("ID"))),this.model.hasChanged("label")&&!this.model.get("is_private")){this.labelDropdown.$el.tvaToggleLoader();const e=this.model.get("structure");this.model.save().done((()=>{this.model.set("structure",e),TVE_Dash.success(TVA.t.label_saved),this.labelDropdown.$el.tvaToggleLoader()}))}},openRestrictionsModal:function(e){return this.openModal(u,{accessTab:this,scope:e.currentTarget.dataset.scope,course:this.model,width:"670px",top:"40px",className:"tvd-modal tvd-modal-small"}),!1},renderRestrictionSummary:function(){this.$(".course-restriction-summary").each(((e,t)=>{t.textContent=this.model.getRestrictionSummary(t.dataset.scope)}))},changeModel:t.noop})}(jQuery)},39517:function(e,t,s){const i=s(1828),n=s(4352);e.exports=i.extend({template:TVE_Dash.tpl("courses/assessment"),duplicateItem:function(e,t){e.stopPropagation();const s=parseInt(t.dataset.id),i=this.course.get("structure"),o=i.findItem(s).get("order");wp.apiRequest({url:`${TVA.apiSettings.root}${TVA.apiSettings.v2}/assessments/duplicate`,type:"POST",data:{id:s}}).done((e=>{const t=new n(e);t.newly_added=!0,0===e.post_parent?this.shiftStructure(i,o,t):this.shiftStructure(i.findItem(e.post_parent).get("structure"),o,t),this.course.trigger("tva.structure.modified",t)})).fail((e=>{TVE_Dash.err(e.responseJSON.message)}))}})},52583:function(e,t,s){const i=s(82951),n=s(1828),o=s(39517),r=s(23150);e.exports=i.extend({template:TVE_Dash.tpl("courses/chapter"),renderStructure:function(e,t){e.each(((e,s)=>{e.get("structure")instanceof r||e.set("structure",new r(e.get("structure")));const i={model:e,numberInList:s+1,expanded:this.expanded,course:this.course};let a;a="assessment"===e.getType()?new o(i):new n(i),a&&(t.append(a.render().$el),this.addChild(a))}));const s=this.$("> .tva-cm-box .tva-cm-status"),i=this.model.get("structure").findItemsByOptions({post_status:"draft"}),a=this.model.get("structure").findItemsByOptions({post_status:"future"});this.model.isPublished()&&(i.length||a.length)?s.attr("data-tooltip",TVE_Dash.sprintf(TVA.t.ContentNotPublished,TVA.t.Chapter)).addClass("yellow"):"publish"===this.model.get("post_status")?s.attr("data-tooltip",TVA.t.ChapterPublished):s.attr("data-tooltip",TVA.t.ChapterNotPublished)}})},90030:function(e,t,s){const i=s(2921),n=s(25033),o=s(96308),r=s(58052),a=s(58052).extend({completedPostModel:null,initialize:function(){let e="search-link";(parseInt(this.get("value"))||this.get("custom_link"))&&(e="normal"),this.attributes.state=e,this.on("change:custom_link",this.onChange.bind(this)),this.listenTo(this,"sync",(e=>{this.completedPostModel.set({preview_url:e.get("preview_url"),title:e.get("title"),extra_id:e.get("extra_id"),edit_url:e.get("edit_url")},{silent:!0})}))},setCompletedPostModel:function(e){this.completedPostModel=e},onChange:function(){this.save().done((e=>{e.preview_url||(TVE_Dash.err("Invalid link"),this.set({state:"search-link",custom_link:""}))}))},url:function(){return`${TVA.apiSettings.root}${TVA.apiSettings.v1}/completed_post/custom-page`}}),l=i.extend({template:TVE_Dash.tpl("courses/completion/certificate-download-url"),className:"tva-download-link-label",afterRender:function(){this.$(".tva-certificate-download-url").val(this.model.get("download_url"))}}),c=i.extend({template:TVE_Dash.tpl("courses/completion/settings"),className:"tva-details-card",afterRender:function(){this.$title=this.$("#tva-completed-title"),this.$slug=this.$("#tva-completed-slug"),this.$checkbox=this.$("#tva-completed-allow-comments"),this.$title.val(this.model.get("title")),this.$slug.val(this.model.get("post_name")),this.$checkbox.prop("checked",parseInt(this.model.get("allow_comments"))),TVE_Dash.data_binder(this)},inputChanged:function(e,t){const s=t.getAttribute("type"),i={};"text"!==s||0!==t.value.trim().length?(i[t.getAttribute("data-field")]="text"===s?t.value.trim():Number(t.checked),this.model.set(i).save()):TVE_Dash.err("Field cannot be empty")}});e.exports=i.extend({template:TVE_Dash.tpl("courses/completion-tab"),completedSettings:null,itemStateCompletedView:null,afterInitialize:function(){this.certificate=this.model.get("certificate"),this.completedPost=this.model.get("completed_post"),this.listenTo(this.model,"change:has_certificate",(()=>{TVE_Dash.showLoader(),this.model.get("has_certificate")?this.certificate.save().done((e=>{parseInt(e.tpm_not_connected)?(TVA.tpm_connected=1,this.tpmNotConnected()):this.renderCertificatePDF(),this.model.save(null,{complete:()=>{TVE_Dash.hideLoader()}})})):this.certificate.destroy().done((()=>{this.certificate.unset("ID"),this.model.save(null,{complete:()=>{TVE_Dash.hideLoader()}})}))})),this.listenTo(this.model,"change:has_completed_post",(()=>{TVE_Dash.showLoader(),this.model.get("has_completed_post")?this.completedPost.save().done((()=>{this.renderCourseCompleted(),this.model.save(null,{complete:()=>{TVE_Dash.hideLoader()}})})):this.completedPost.destroy().done((()=>{this.completedPost.unset("ID"),this.model.save(null,{complete:()=>{TVE_Dash.hideLoader()}})}))})),this.listenTo(this.completedPost,"change:title",(e=>{this.$completedPostOptions.find("span.tva-login-name").html(e.get("title"))}))},tpmNotOK:function(){this.$("#tva-certificate-column").addClass("tva-disabled"),this.model.set({has_certificate:0},{silent:!0}),this.$certificateDropdown.hide(),this.$("#tva-certificate-button").prop("checked",!1)},tpmNotConnected:function(){this.tpmNotOK(),this.$tpmWarning.show()},tpmLicenseAccess:function(){this.tpmNotOK(),this.$tpmActiveLicenseWarning.show()},afterRender:function(){this.$completedSettingsWrapper=this.$(".tva-completed-settings"),this.$completedPostOptions=this.$(".tva-completed-post-options"),this.$completedTypeSelect=this.$("#tva-completed-post-type-select"),this.$completedDropdown=this.$(".tva-completed-post-dropdown"),this.$certificateDropdown=this.$(".tva-certificate-dropdown"),this.$tpmWarning=this.$("#tva-tpm-warning").hide(),this.$tpmActiveLicenseWarning=this.$("#tva-tpm-active-license-warning").hide(),TVA.tpm_connected?parseInt(TVA.tpm_access_ok)||this.tpmLicenseAccess():this.tpmNotConnected(),this.model.get("has_certificate")?this.renderCertificatePDF():this.$certificateDropdown.hide(),this.model.get("has_completed_post")?(this.$completedTypeSelect.val(this.completedPost.get("type")),this.renderCourseCompleted()):this.$completedDropdown.hide(),this.$completedTypeSelect.select2()},renderCertificatePDF:function(){this.$(".tva-certificate-download-url").html(new l({model:this.certificate}).render().$el),new o({el:this.$(".tva-certificate-edit-with-tar"),model:new r({preview_url:this.certificate.get("preview_url"),title:this.certificate.get("title"),edit_url:this.certificate.get("edit_url"),value:this.certificate.get("ID")}),afterRender:function(){this.$(".tva-page-option.click").remove()},states_views_path:"./page-states/"}).render()},renderCourseCompleted:function(){var e;if(null===(e=this.$("#tva-custom-page-warning"))||void 0===e||e["completed"===this.completedPost.get("type")?"hide":"show"](),this.$completedSettingsWrapper["completed"===this.completedPost.get("type")?"show":"hide"](),this.itemStateCompletedView instanceof Backbone.View&&this.itemStateCompletedView.destroy(),"completed"===this.completedPost.get("type"))this.itemStateCompletedView=new o({el:this.$completedPostOptions,model:new r({preview_url:this.completedPost.get("preview_url"),title:this.completedPost.get("title"),edit_url:this.completedPost.get("edit_url"),value:this.completedPost.get("ID")}),afterRender:function(){this.$(".tva-page-option.click").remove()},states_views_path:"./page-states/"}).render(),this.$completedSettingsWrapper.html(new c({model:this.completedPost}).render().$el);else{const e=this.completedPost.get("extra_id"),t=new a({name:"custom_redirect",course_id:this.completedPost.get("course_id"),preview_url:this.completedPost.get("preview_url")||"",title:this.completedPost.getTitle(),edit_url:this.completedPost.get("edit_url")||"",value:parseInt(e)?parseInt(e):0,category:!_.isNumber(e)&&"custom_link",custom_link:!_.isNumber(e)&&e});t.setCompletedPostModel(this.completedPost),this.itemStateCompletedView=new o({el:this.$completedPostOptions,model:t,states_views_path:"./page-states/"}).render()}},issueCompletionCertificate:function(e,t){const s=t.checked;s&&!sessionStorage.getItem("certificateTOS")?this.openModal(n,{model:this.model,className:"tvd-modal tva-certificates-tos-modal",toggle:e.currentTarget,dropdown:this.$certificateDropdown}):(this.$certificateDropdown[s?"show":"hide"](),this.model.set("has_certificate",Number(s)))},hasCompletedPost:function(e,t){this.$completedDropdown[t.checked?"show":"hide"](),t.checked&&this.$completedTypeSelect.val("completed").trigger("change.select2"),this.model.set("has_completed_post",Number(t.checked))},completedPostTypeChange:function(e,t){this.model.get("has_completed_post")&&(this.$completedSettingsWrapper.empty(),TVE_Dash.showLoader(),this.completedPost.changeType(t.value).then((()=>{this.renderCourseCompleted(),TVE_Dash.hideLoader()})))}})},2527:function(e,t,s){const i=s(43265);e.exports=i.extend({template:TVE_Dash.tpl("courses/integration-custom-payment"),initialize:function(){i.prototype.initialize.apply(this,arguments),this.buy_now_link=this.buy_now_links.findWhere({integration:this.model.get("slug")}),this.buy_now_link||(this.buy_now_link=new Backbone.Model({integration:this.model.get("slug")}),this.buy_now_links.add(this.buy_now_link)),this.payment_link=this.buy_now_link.get("url")},afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.$urlInput=this.$("#tva-custom-payment-url"),this.$urlInput.val(this.payment_link)},changeUrl:function(){const e=this.$urlInput.val();e&&!new RegExp(/(http(s)?:\/\/.)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g).test(e)?this.$urlInput.addClass("tvd-invalid"):(this.payment_link=e,this.$urlInput.removeClass("tvd-invalid"),this.buy_now_link.set("url",this.payment_link))},renderStatus:function(){}})},92396:function(e,t,s){!function(t){const i=s(2921),n=s(4023),o=s(79389),r=s(17520);function a(){this.model.get("overview_post").get("post_id")||this.$("#tva-course-description").html(TVE_Dash.tpl("courses/no-course-overview")())}function l(){return!1===this.model.get("has_video")?this.$videoSettings.empty().hide():new o({types:["youtube","vimeo","wistia","bunnynet","custom"],model:this.model.get("video"),el:this.$videoSettings}).render().$el.show()}e.exports=i.extend({$videoSettings:null,$authorSettings:null,$authorAvatar:null,$authorCustomBioWrapper:null,$courseImage:null,template:TVE_Dash.tpl("courses/details-tab"),events:function(){return t.extend(i.prototype.events,{})},initialize:function(){this.listenTo(this.model,"change:has_video",_.bind(l,this)),this.listenTo(this.model,"change:author",(()=>this.changeAuthorBio(this.model.get("author").get("biography_type"),!0))),this.listenTo(this.model,"change:author",(()=>{this.authorImage&&(this.authorImage.destroy(),delete this.authorImage),this.handleAuthorAvatar(this.$authorAvatar)}))},initCustomBioTinyMCE:function(){TVA.Utils.renderMCE("tva-course-author-description",this.model.get("author"),"custom_biography").then((e=>{e&&"function"==typeof e.setContent&&(this.authorMCE=e)}))},render:function(){i.prototype.render.apply(this,arguments),this.initCustomBioTinyMCE(),this.$videoSettings=this.$("#tva-course-video-settings"),this.$authorSettings=this.$("#tva-author-settings"),this.$authorCustomBioWrapper=this.$("#tva-course-author-description-wrapper"),this.$authorAvatar=this.$("#tva-author-avatar"),this.$courseImage=this.$("#tva-course-image"),new n({model:this.model,el:this.$courseImage,template:TVE_Dash.tpl("courses/cover-image"),prop:"cover_image"}).render(),this.authorImage=this.handleAuthorAvatar(this.$authorAvatar),this.model.get("author")&&"custom_bio"===this.model.get("author").get("biography_type")&&(this.$("#tva-course-author-bio").val("custom_bio"),this.$authorCustomBioWrapper.show());const e=new r({model:this.model});return this.addChild(e),this.$("#tva-course-details-slug").append(e.render().$el),TVE_Dash.data_binder(this),l.apply(this),a.apply(this),this},handleAuthorAvatar:function(e){if(!this.authorImage)return this.imageView&&(this.imageView.destroy(),delete this.imageView),this.imageView=new n({model:this.model.get("author"),el:e,prop:"avatar_url"}),this.imageView.render();this.authorImage.setImage(this.model.get("author").get("avatar_url"))},onAuthorDropdownChange:function(e,t){this.changeAuthorBio(t.value),e.stopPropagation()},changeAuthorBio:function(e,t=!1){this.model.get("author").set("biography_type",e);const s="custom_bio"===e?"show":"hide";this.$authorCustomBioWrapper[s](),"hide"===s&&t&&(this.$authorCustomBioWrapper.val("").trigger("change"),this.authorMCE&&"function"==typeof this.authorMCE.setContent&&this.authorMCE.setContent("")),this.$("#tva-course-author-bio").val(e),this.initCustomBioTinyMCE()}})}(jQuery)},81181:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const o=s(59579),r=s(76821),a=s(73799),l=s(36832),c=s(80201),d=s(23150),h=s(51135),u=s(84643),p=s(60929),m=s(61353),g=s(93275),f=s(49939),v=r.extend({renderThumbs:!0,label:TVA.t.label,initialize:function(e){const t=new a(TVA.labels.toJSON());return t.idAttribute="ID",this.collection=t,r.prototype.initialize.call(this,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({collection:t},e))}}),b=r.extend({renderThumbs:!0,label:TVA.t.topic}),y=r.extend({renderThumbs:!0,label:TVA.t.author,initialize:function(){r.prototype.initialize.apply(this,arguments),this.on("tva.display.list",this.renderSearchInput),this.listenTo(this.model,"change:avatar_url",this.render)},renderSearchInput:function(e){const s=t('<input type="text"/>').attr("placeholder",TVA.t.search_uses);e.empty().append(s),requestAnimationFrame((()=>s.focus())),new l(s,{url:TVA.apiSettings.root+TVA.apiSettings.v1+"/courses/search_users/",type:"POST",renderItem:function(e,s){return t("<li class='tvd-truncate'/>").append("<span class='tva-ps-result-title'>"+s.name+"</span><span class='tva-ps-result-email ml-5'> ("+s.email+")</span>").appendTo(e)},select:(e,t)=>{const s=t.item;s.biography_type="wordpress_bio";const i=new Backbone.Model(s);this.collection.push(i),this.collection.setSelected(i),this.model=i,this.listenTo(this.model,"change:avatar_url",this.render),this.render(),this.displayList(),this.trigger("tva.course.author.changed",i)}})}}),w=r.extend({label:TVA.t.difficulty}),T=[];e.exports=h.extend({className:"tva-course-form",$dropdowns:null,labelDropdown:null,template:TVE_Dash.tpl("courses/form"),selectedIndex:0,confirmationModalStatuses:["draft","hidden","archived"],initialize:function(e){if(this.$el.on("click",(()=>{this.closeDropdowns()})),e&&!e.model&&e.id){const t=TVA.courses.findWhere({id:parseInt(e.id)});if(t&&t.get("fetched"))return this.model=t,this.listenTo(this.model,"tva.structure.status.changed",this.onStructureStatusChanged),this.listenTo(this.model,"tva.course.permalink.modified",this.onPermalinkChanged),this.renderForm();TVA.lazyLoading?TVA.keepLoader=!0:TVE_Dash.showLoader(),this.model=new o(parseInt(e.id)),this.listenTo(this.model,"tva.course.fetch.success",(()=>{this.renderForm()})),this.listenTo(this.model,"tva.course.fetch.error",(()=>{this.$el.html("course could not be loaded"),TVE_Dash.hideLoader()})),this.listenTo(this.model,"tva.structure.status.changed",this.onStructureStatusChanged),this.listenTo(this.model,"tva.course.permalink.modified",this.onPermalinkChanged)}t.extend(!0,this,e)},destroy:function(){this.model.restoreState(!0),h.prototype.destroy.apply(this,arguments)},render:function(){return this.afterRender(),this},constructLabelDropdown:function(){return new v({add_item:{str:{title:TVA.t.addNewLabel,save:TVA.t.saveLabel},inputTemplate:TVE_Dash.tpl("labels/add-inline"),spectrum:function(e){const s=this,i=e.currentTarget,n=t(i).find("input").spectrum({containerClassName:"tva-color-picker",showPalette:!1,allowEmpty:!1,showInitial:!1,showButtons:!0,chooseText:"Apply",cancelText:"Cancel",showInput:!0,preferredFormat:"hex",hide:function(e){i.style.setProperty("--thumb-color",e.toString()),s.focusInput()}});return requestAnimationFrame((()=>n.spectrum("show"))),!1},getModelForSave:function(){const e=this.$(".tva-colorpicker").val();return new g({title:this.$input.val(),label_color:e,color:e})},afterSave:function(e){TVA.labels.push(e)},addToCollection:function(e){this.dropdown.collection.push(e)}}})},handleLabel:function(){return this.labelDropdown||(this.labelDropdown=this.constructLabelDropdown(),this.labelDropdown.on("tva.dropdown.item.selected",this.onLabelChange.bind(this))),this.labelDropdown.collection.setSelectedId(this.model.get("label")),this.$("#tva-course-label").append(this.labelDropdown.render().$el),this.labelDropdown},onLabelChange:function(e){this.model.set({label:parseInt(e.get("ID"))},{silent:!0}),this.model.get("id")&&(this.model.save(),TVE_Dash.success(TVA.t.label_saved))},renderForm:function(){TVA.courses.replace(this.model),this.$el.html(this.template({model:this.model})),this.renderHeader(),TVE_Dash.data_binder(this),this.$dropdowns=this.$("#tva-course-dropdowns"),T.push(this.handleTopics()),T.push(this.handleAuthor()),T.push(this.handleLevels()),T.push(this.handleLabel()),this.addChild(T),this.renderTabs(),TVE_Dash.hideLoader(),TVA.$app.tvaToggleLoader(!1),t("html, body").animate({scrollTop:0},300),s(32643)()},renderHeader:function(){new m({model:this.model,el:this.$(".course-form-header")}).render()},closeDropdowns:function(){T.forEach((e=>{e.closeSelect()}))},handleAuthor:function(){const e=new y({collection:new a([this.model.get("author").set("selected",!0)])});return e.on("tva.course.author.changed",(t=>{if(this.model.set("author",t),!this.model.get("id"))return;e.$el.tvaToggleLoader();const s=this.model.get("structure");this.model.save(null,{success:()=>{this.model.set("structure",s),e.closeSelect()}}).done((()=>{e.$el.tvaToggleLoader(),TVE_Dash.success(TVA.t.author_saved)}))})),e.on("tva.before.display.list",this.closeDropdowns),this.$dropdowns.append(e.render().$el),e},handleLevels:function(){const e=new w({add_item:{str:{title:TVA.t.addDifficultyLevel,save:TVA.t.saveLevel,err:TVA.t.EmptyName},getModelForSave:function(){const e=new u({name:this.$input.val()});return e.url=`${TVA.apiSettings.root}${TVA.apiSettings.v1}/levels`,e},afterSave:function(e){TVA.levels.push(e)},addToCollection:function(e){this.dropdown.collection.add(e)}},deletable:!0,editable:!0,collection:function(e){const t=new a(TVA.levels);let s=t.findWhere({id:e});return s||(s=t.first()),t.setSelected(s),t}(parseInt(this.model.get("level"))),deleteItem:function(e,t){e.stopPropagation();const s=parseInt(t.dataset.id);if(isNaN(s))return this;const i=this.collection.findWhere({id:s});if(!(i instanceof u))return this;if(i.url=`${TVA.apiSettings.root}${TVA.apiSettings.v1}/levels/${s}`,1===this.collection.length)return TVE_Dash.err(TVA.t.lastItemDelete);const n=this.$(`.${this.listItemCssClass}[data-id="${i.get("id")}"]`).tvaToggleLoader();i.destroy({success:e=>{TVA.levels.splice(TVA.levels.findIndex((e=>e.id===s)),1),e.get("selected")&&this.selectItem(this.collection.first(),!0),n.remove(),TVE_Dash.success(TVA.t.level_deleted)}})}});return e.on("tva.dropdown.item.selected",((t,s,i)=>{if(parseInt(t.get("id"))===parseInt(this.model.get("level")))return;if(this.model.set("level",parseInt(t.get("id"))),!this.model.get("id"))return;e.$el.tvaToggleLoader();const n=this.model.get("structure");this.model.save(null,{success:()=>this.model.set("structure",n)}).done((()=>{e.$el.tvaToggleLoader(!1),i||TVE_Dash.success(TVA.t.level_saved)}))})),e.on("tva.before.display.list",this.closeDropdowns),this.$dropdowns.append(e.render().$el),e},handleTopics:function(){const e=new b({add_item:{str:{title:TVA.t.addNewTopic},template:_.template(`<div><a class="tva-add-topic" href="#courses/topics">${TVA.Utils.icon("plus-circle")+TVA.t.addNewTopic}</a></div>`)},collection:function(e){const t=new a(TVA.topics.toJSON());return t.setSelectedId(e),t}(parseInt(this.model.get("topic")))});return e.on("tva.dropdown.item.selected",(t=>{if(parseInt(this.model.get("topic"))!==parseInt(t.get("id"))&&(this.model.set("topic",parseInt(t.get("id"))),this.model.get("id"))){e.$el.tvaToggleLoader();const t=this.model.get("structure");this.model.save(null,{success:()=>this.model.set("structure",t)}).done((()=>{TVE_Dash.success(TVA.t.topic_saved),e.$el.tvaToggleLoader()}))}})),e.on("tva.before.display.list",this.closeDropdowns),this.$dropdowns.append(e.render().$el),e},editTitle:function(e,s){const i=t(s).hide(),n=i.prev().hide(),o=i.next().show(),r=o.find("label"),a=o.find("> input").val(this.model.get("name")).focus().select(),l=this.model.get("structure");function c(){this.model.get("id")&&this.saveCourse(null,null,{success:e=>{TVE_Dash.hideLoader(),n.html(e.get("name")).show(),o.hide(),i.css({display:"inline-block"}),r.text(""),this.model.set("structure",l)}})}a.off("keyup").on("keyup",(e=>{13===e.which&&c.call(this)})).off("blur").on("blur",_.bind(c,this))},renderTabs:function(){this.model.get("structure")instanceof d||this.model.set("structure",new d(this.model.get("structure")));const e=[{slug:"details",name:TVA.t.courseDetails,icon:"info-circle_light",view:new(s(92396))({model:this.model})},{slug:"new",name:TVA.t.content,icon:"list_light",view:new(s(35691))({model:this.model,collection:this.model.get("structure")})},{slug:"access",name:TVA.t.accessRestrictions,counter:this.model.getProducts().length,icon:"lock-alt_light",view:new(s(99432))({model:this.model,collection:this.model.getProducts()})},{slug:"drip",name:TVA.t.drip,icon:"drip-main",view:new(s(85787))({model:this.model,collection:this.model.getDripCampaigns()})},{slug:"completion",name:TVA.t.courseCompletion,icon:"certificates",view:new(s(90030))({model:this.model})}],t=Backbone.history.getFragment().split("/");3===t.length&&t[2]&&e.some(((e,s)=>!!t[2].startsWith(e.slug)&&(this.selectedIndex=s,!0)));const i=new c({course:this.model,selectedIndex:this.selectedIndex||0,collection:new Backbone.Collection(e)});i.on("tab.selected.index",(t=>{const s=e[t];this.$('[data-fn="saveCourse"]').parents(".tva-course-save").css({display:["access","drip","new","completion"].includes(s.slug)?"none":""})})),this.$el.append(i.render().$el),this.addChild(i)},saveCourse:function(e,s,i={}){if(!this.model.isValid())return!1;const n=this.model.changedAttributes();!1!==n&&Object.keys(n).includes("allows_comments")&&this.model.get("structure").updateChildrenCommentStatus(this.model.get("id"),this.model.get("allows_comments"),"course"),TVE_Dash.showLoader();const o=this.model.get("structure");this.model.get("is_private")||this.model.get("rules").resetRules();const r={success:()=>{TVE_Dash.hideLoader(),this.$("#tva-course-preview").attr("href",this.model.get("preview_url")),this.model.set("structure",o),TVE_Dash.success(TVA.t.courseSaved)},error:(e,t)=>{if(TVE_Dash.hideLoader(),t&&t.responseJSON&&403===t.responseJSON.data.status)return TVE_Dash.err(TVA.t.courseNotSavedSessionExpired);let s="";t&&t.responseJSON&&(s=t.responseJSON.message),TVE_Dash.err(`${TVA.t.courseNotSaved} ${s}`)}};return this.model.save(null,t.extend(r,i))},changeStatus:function(e,t){const s=t.dataset.status;if("future"===s)return void this.openModal(p,{model:this.model,width:"400px",className:"tvd-modal tva-schedule-modal",statusProp:"status"});if(this.confirmationModalStatuses.includes(s)){const e=this.model,t=this;return void this.openModal(f,{template:TVE_Dash.tpl(`modals/course-${s}`),className:"tvd-modal tva-confirmation-new",width:"550px",confirm:function(){TVE_Dash.showLoader(),e.set("status",s),t.saveCourse(null,null,{success:()=>{TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t[`course_${s}`]),this.close()}})}})}const i=this.model.get("structure");this.model.set("status",s),TVE_Dash.showLoader(),this.model.save(null,{success:()=>{this.model.set("structure",i),TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t[`course_${s}`])}})},onStructureStatusChanged:function(){const e=this.model.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"publish"}).length,t=this.model.get("structure").findItemsByOptions({post_type:"tva_assessment",post_status:"publish"}).length;if(0===e&&0===t){TVE_Dash.showLoader();const e=this.model.get("structure");this.model.set("status","draft").save(null,{success:()=>{this.model.set("structure",e),TVE_Dash.hideLoader()}})}TVA.$eventBus.trigger("courses_changed")},onAuthorChanged:function(e){const t=T[1],s=e instanceof Backbone.Model?e:this.model.get("author");t instanceof Backbone.View&&void 0!==t.model.get("avatar_url")&&(t.model.set(s.toJSON(),{silent:!0}),t.render())},onPermalinkChanged:function(e){this.$("#tva-course-preview").attr("href",e),TVA.$eventBus.trigger("courses_changed")}})}(jQuery)},15623:function(e,t,s){!function(t){const i=s(4023),n=s(83094);e.exports=n.extend({template:TVE_Dash.tpl("courses/forms/assessment"),afterInitialize:function(){this.listenTo(this.model,"change:assessment_type",(function(e,t){this.toggleOptions(t)}))},afterRender:function(){var e,s;this.$types=this.$("#tva-assessment-type"),(e=this.$types,s=TVA.assessmentTypes,Object.keys(s).forEach((function(i){const n=t("<option/>").val(i).text(`${TVE_Dash.upperFirst(s[i])} type`);e.append(n)})),e).val(this.model.get("assessment_type")),this.$("#tva-comment-status").val(this.model.get("comment_status")),this.$("#tva-freemium").val(this.model.get("freemium")),this.toggleOptions(this.model.get("assessment_type")),new i({el:this.$("#tva-assessment-image"),model:this.model,prop:"cover_image"}).render(),TVE_Dash.data_binder(this)}})}(jQuery)},73500:function(e,t,s){const i=s(2921);e.exports=i.extend({render:function(){return i.prototype.render.apply(this,arguments),this.model.get("id")&&this.$("h3.tvd-modal-title").text(`Edit ${this.model.getType()}`),this.$("select").select2(),this}})},91975:function(e,t,s){e.exports=s(73500).extend({template:TVE_Dash.tpl("courses/forms/chapter"),afterRender:function(){TVE_Dash.data_binder(this)}})},83094:function(e,t,s){!function(t){const i=s(4023),n=s(79389),o=s(73500);e.exports=o.extend({template:TVE_Dash.tpl("courses/forms/lesson"),$types:null,afterInitialize:function(){this.listenTo(this.model,"change:lesson_type",(function(e,t){this.toggleOptions(t)}))},afterRender:function(){var e,s;this.$types=this.$("#tva-lesson-type"),(e=this.$types,s=TVA.lessonTypes,s.forEach((function(s){const i=t("<option/>").val(s).text(`${TVE_Dash.upperFirst(s)} lesson`);e.append(i)})),e).val(this.model.get("lesson_type")),this.$("#tva-comment-status").val(this.model.get("comment_status")),this.$("#tva-freemium").val(this.model.get("freemium")),this.toggleOptions(this.model.get("lesson_type")),new i({el:this.$("#tva-lesson-image"),model:this.model,prop:"cover_image"}).render(),TVE_Dash.data_binder(this),new n({types:["youtube","vimeo","wistia","bunnynet","custom"],model:this.model.get("video"),el:this.$("#tva-lesson-video-options")}).render(),new n({types:["soundcloud","custom"],model:this.model.get("audio"),el:this.$("#tva-lesson-audio-options")}).render()},toggleOptions:function(e){this.$("#tva-lesson-options >").hide(),this.$(`#tva-lesson-${e}-options`).show()}})}(jQuery)},71537:function(e,t,s){const i=s(4023);e.exports=s(73500).extend({template:TVE_Dash.tpl("courses/forms/module"),afterRender:function(){this.$("#tva-comment-status").val(this.model.get("comment_status")),this.$("#tva-freemium").val(this.model.get("freemium")),TVE_Dash.data_binder(this),new i({el:this.$("#tva-module-image"),model:this.model,prop:"cover_image"}).render()}})},61353:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}TVA.globals.courseButtonOptions={publish:["draft","archived","hidden"],draft:["publish","future","archived","hidden"],future:["publish","future","draft"],hidden:["publish","draft","archived"],archived:["publish","hidden"]};const o=s(23150);e.exports=s(2921).extend({template:TVE_Dash.tpl("courses/header"),afterInitialize:function(){this.listenTo(this.model,"change:status",this.render),this.listenTo(this.model,"tva.structure.status.changed",this.render)},afterRender:function(){TVE_Dash.data_binder(this),this.$publishOptions=this.$(".tva-options-drop-ul"),this.$publishIcon=this.$(".ta-angle-down"),this.$publishButton=this.$("#tva-course-publish"),this.$courseDate=this.$(".tva-course-date"),this.$tooltip=this.$(".tvd-c-tooltip"),this.model.get("structure")instanceof o||this.model.set("structure",new o(this.model.get("structure"))),this.handleAvailableOptions()},handleAvailableOptions:function(){const e=this.model.get("structure").findItemsByOptions({post_status:"publish"}).length,t=this.model.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"future"}).length,s=this.model.get("structure").findItemsByOptions({post_type:"tva_assessment",post_status:"publish"}).length,o=this.model.get("structure").findItemsByOptions({post_type:"tva_assessment",post_status:"future"}).length,r=this.model.get("status"),a={publish:"publish",future:"immediately",draft:"unpublish",archived:"archive_light",hidden:"eye-slash"};e||s?(this.$publishOptions.show(),this.$publishIcon.show(),this.$tooltip.hide()):(this.$publishOptions.hide(),this.$publishIcon.hide(),this.$tooltip.show()),"future"===this.model.get("status")&&(e||t||s||o?this.$courseDate.show():this.$courseDate.hide()),void 0!==r&&TVA.globals.courseButtonOptions[r].forEach((e=>{const t={status:e,text:TVA.t.courseStatusItems[e],icon:TVA.Utils.icon(a[e])};this.$(".tva-course-status-drop").append(TVE_Dash.tpl("courses/header-status-option",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},t)))})),this.$("#tva-course-publish").addClass(`tva-btn-${{publish:"green",future:"yellow",draft:"red",archived:"archived",hidden:"hidden"}[r]}`),this.$publishButton.toggleClass("disabled",0===s&&0===e).find("span").text(TVA.t.courseStatusText[r])}})},43265:function(e,t,s){!function(t){const i=s(8346),n=s(2921);e.exports=n.extend({className:"tva-restrictions-rule",template:TVE_Dash.tpl("courses/integration"),rules:null,rule:null,$label:null,$items:null,$status:null,$clearButton:null,isOpened:!1,initialize:function(e){t.extend(!0,this,e),this.rule=this.rules.findWhere({integration:this.model.get("slug")}),this.rule||(this.rule=new i({integration:this.model.get("slug")}),this.rules.add(this.rule.resetItems(void 0))),this.listenTo(this.rule.getItems(),"update",(()=>{this.renderLabel(),this.renderStatus(),this.toggleClearSelection()})),this.listenTo(this.rule.getItems(),"reset",(()=>{this.renderLabel(),this.renderStatus(),this.toggleClearSelection()}))},afterRender:function(){this.$label=this.$(".tva-course-integration-label, .tva-rule-label"),this.$rulesItem=this.$(".tva-rule-items"),this.$items=this.$(".tva-course-integration-items-wrapper"),this.$status=this.$(".tva-integration-status"),this.$clearButton=this.$(".tva-rule-items-clear"),this.model.get("allow")?this.renderItems(this.model.getItems()):this.renderRestricted(),this.renderLabel(),this.renderStatus(),this.toggleClearSelection(),this.$el.attr("data-integration",this.model.get("slug"))},toggleClearSelection:function(){this.rule&&this.$clearButton.toggleClass("tva-disabled",!this.rule.getItems().length)},renderStatus:function(){const e=0===this.rule.getItems().length?TVA.t.not_set:"&nbsp;";this.$status.html(e)},renderLabel:function(){this.rule.getItems().length>0&&this.model.get("allow")?this.$label.html(`${this.model.getText()} - ${this.rule.getItemsToString(this.model)}`):(this.$label.first().html(""),this.$label.eq(1).html(this.model.getText()))},renderItems:function(e){const s=TVE_Dash.tpl("courses/integration-item"),i=this.$items.find(".tva-rule-items-wrapper").empty();e.each((e=>{i.append((()=>{const i=t(s({id:`${this.model.get("slug")}-${e.getId()}`,integration:this.model,model:e}));return i.find("input").prop("checked",this.rule.contains(e)),i})())}))},renderRestricted:function(){const e=TVE_Dash.tpl(`courses/restrict-integration/${this.model.get("slug")}`);this.$rulesItem.html(e())},toggleItem:function(e,t){const s=this.model.getItems().findWhere({id:"wordpress"===this.model.get("slug")?t.dataset.id:parseInt(t.dataset.id)});t.checked?(this.rule.getItems().add(s),this.rule.collection.trigger("add")):(this.rule.getItems().remove(s),this.rule.collection.trigger("remove"))},toggleItemsList:function(e,s){const i=t(s);this.$items.toggle(!this.$items.is(":visible")),this.$label.first().toggle(),i.find("span").toggleClass("i-visible",this.$items.is(":visible")),this.isOpened=this.$items.is(":visible")},clearSelectedItems:function(){this.rule.getItems().reset(null),this.rule.collection.trigger("remove"),this.renderItems(this.model.getItems())}})}(jQuery)},82951:function(e,t,s){!function(t){const i=s(2921),n=s(23150),o=s(89166);e.exports=i.extend({className:"tva-box tva-collapsed tva-course-item",numberInList:0,childrenItemsSelector:"",connectWith:!1,expanded:null,initialize:function(e){t.extend(!0,this,e),this.$el.addClass(this.model.get("post_type")),this.$el.toggleClass("tva-collapsed",!this.expanded.has(this.model.get("id"))),this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"expand",this.expand),this.listenTo(this.model,"render",this.render)},afterRender:function(){this.$el.attr({"data-id":this.model.get("ID"),"data-type":this.model.getType(),"data-parent-id":this.model.get("post_parent")}),this.model.get("structure")instanceof n&&this.renderStructure(this.model.get("structure"),this.getItemsList())},editItemTitle:function(e,s){const i=t(s).closest(".tva-title-holder");i.prepend(new o({model:new Backbone.Model({title:this.model.get("post_title")}),titleTextHolder:i.find(".tva-items-tab-title"),save:(e="")=>{this.model.set("post_title",e);const t=this.model.get("structure");this.model.save().done((()=>{this.model.set({structure:t},{silent:!0})}))}}).render().$el),e.stopPropagation()},copyID:function(){return TVE_Dash.copyToClipboard(this.model.get("ID"),"Copied to Clipboard"),!1},renderStructure:function(e,t){},getItemsList:function(){let e=this.model.get("structure").getType();return"assessments"===e&&(e="lessons"),this.$(`.tva-${e}-list`)},expand:function(){this.$el.removeClass("tva-collapsed"),this.expanded.add(this.model.get("id"))},getFreemiumLabel:function(){return{free:TVA.t.free_for_all,"free-for-logged":TVA.t.free_for_logged}[this.model.get("freemium")]}})}(jQuery)},35691:function(e,t,s){!function(t){const i=s(2921),n=s(96774),o=s(52583),r=s(1828),a=s(39517),l=s(23150),c=s(49939),d=s(60929),h={chapterGroup:s(94968),moduleGroup:s(17160),move:s(95231),resources:s(95974),courseItem:s(47949),assessment:s(25670)};function u(e,t="draft"){const s=this.collection.findItem(e),i=window.moment;let n={post_status:t,post_date:i().utc().format(),post_date_gmt:i().utc().format()};const o=this.collection.findItem(s.get("post_parent"));return"future"===t&&(n=null),new Promise(((e,i)=>{s.save(n,{patch:!0,success:()=>{if("publish"===t&&o&&"draft"===o.get("post_status"))return e(o.get("id"));let s=0;if("draft"===t&&o){s=o.get("structure").where({post_status:"future"}).length;const t=o.get("structure").where({post_status:"draft"}).length;if(o.get("structure").length-s===t)return e(o.get("id"))}i()},error:()=>{i()}})}))}e.exports=i.extend({template:TVE_Dash.tpl("courses/items-tab"),addItemButtonTemplate:TVE_Dash.tpl("courses/buttons/add-course-level-item"),$addItemButton:null,selected:[],expanded:null,events:function(){return t.extend(i.prototype.events,{"click .tva-course-item":"toggleItem","change .tva-section-select":"onItemSelect","change #tva-check-all":"toggleSelectAll"})},initialize:function(){this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"destroy",this.render),this.expanded=new Set,this.listenTo(this.model,"tva.structure.modified",(()=>{this.render()})),this.listenTo(this.model,"tva.item.status.changed",(e=>{this.onItemStatusChanged(e.id,e.status)})),this.listenTo(this.model,"structure.rendered",(()=>{this.model.recountItems()}))},afterRender:function(){this.$selectAll=this.$("#tva-check-all"),this.$massActions=this.$(".tva-mass-action").hide(),this.$massActionsWrapper=this.$(".tva-mass-actions"),this.renderAddItemButtons(this.$("#tva-add-course-level-item-buttons")),this.$massActionsWrapper[this.collection.length>=1?"show":"hide"]();const e=this.$(".tva-course-items-wrapper");let s=!1;const i=this;function n(e,t){t.placeholder.css({height:t.item.outerHeight()})}function o(){!1===s&&t(this).find("> .tva-course-item").length>1&&r.apply(this,arguments)}function r(){const e=t(this).find("> .tva-course-item"),n=new l;return e.each((function(e,t){n.push(new Backbone.Model({id:parseInt(t.dataset.id),order:parseInt(e),parent:parseInt(t.dataset.parentId)}))})),n.save(null,{success:function(e,t){i.collection.reset(t),s=!1,i.model.trigger("tva.structure.modified")},error:function(){TVE_Dash.err("Something went wrong!")}})}this.renderCourseStructure(this.collection,e.addClass(`tva-${this.collection.getType()}-list`)),this.$(".tva-modules-list").sortable({items:".tva_module",handle:".tva-drag-handle",placeholder:"tva-drag-placeholder",over:n,stop:o});const a={items:".tva_chapter",connectWith:".tva-chapters-list",handle:".tva-drag-handle",placeholder:"tva-drag-placeholder",over:n,stop:o,remove:function(){const e=t(this),i=e.find("> .tva-course-item"),n=e.parent();if(0===i.length&&n.is(".tva_module")){const e=t("<div/>").addClass("tva-course-items-wrapper tva-lessons-list").sortable(c);n.append(e)}i.length&&(s=!0,r.apply(this,arguments))},receive:function(e,n){const o=t(this),a=o.parent(),l=o.find("> .tva_chapter");a.is(".tva_module")&&1===l.length&&a.find("> .tva-lessons-list").sortable("destroy").remove(),n.item.attr("data-parent-id",a.data("id")),i.expandItems(a),s=!0,r.apply(this,arguments)}};this.$(".tva-chapters-list").sortable(a);const c={items:".tva_lesson, .tva_assessment",connectWith:".tva-lessons-list",handle:".tva-drag-handle",placeholder:"tva-drag-placeholder",over:n,start:function(){t(document).find(".tvd-material-tooltip").hide()},stop:o,remove:function(){const e=t(this),i=e.parent(),n=e.find("> .tva-course-item");if(0===n.length&&i.is(".tva_module")){const e=t("<div/>").addClass("tva-course-items-wrapper tva-chapters-list").sortable(a);i.append(e)}n.length&&(s=!0,r.apply(this,arguments))},receive:function(e,n){const o=t(this),a=o.find("> .tva-course-item"),l=o.parent();l.is(".tva_module")&&1===a.length&&l.find("> .tva-chapters-list").sortable("destroy").remove(),n.item.attr("data-parent-id",l.data("id")),i.expandItems(l.add(l.parents(".tva-course-item"))),s=!0,r.apply(this,arguments)}};this.$(".tva-lessons-list, .tva-assessments-list").sortable(c),this.$(".tva_module").droppable({accept:".tva_chapter, .tva_lesson, .tva_assessment",tolerance:"touch",over:(e,s)=>{const i=t(e.target),n=t(s.draggable);n.parents(".tva_module").data("id")!==i.data("id")&&(i.removeClass("tva-collapsed"),i.find(".tva_chapter").removeClass("tva-collapsed"),n.is(".tva_chapter")?(this.$(".tva-chapters-list").css({"min-height":n.height()}),this.$(".tva-chapters-list").sortable("refresh")):n.is(".tva_lesson")&&(this.$(".tva-lessons-list").css({"min-height":n.height()}),this.$(".tva-lessons-list").sortable("refresh")))}}),this.$(".tva_chapter").droppable({accept:".tva_lesson, .tva_assessment",over:(e,s)=>{const i=t(e.target),n=t(s.draggable);n.parents(".tva_chapter").data("id")!==i.data("id")&&(i.removeClass("tva-collapsed"),i.find(".tva-lessons-list").css({"min-height":n.outerHeight()}),this.$(".tva-lessons-list").sortable("refresh"))}}),this.model.trigger("structure.rendered")},expandItems:function(e){e.each(((e,t)=>{this.expanded.add(parseInt(t.dataset.id)),t.classList.remove("tva-collapsed")}))},toggleItem:function(e){this.$("input").trigger("blur");const s=t(e.currentTarget);if(s.is(".tva_lesson")||"INPUT"===e.target.tagName)return e.stopPropagation();const i=parseInt(e.currentTarget.dataset.id);s.toggleClass("tva-collapsed"),s.hasClass("tva-collapsed")?this.expanded.delete(i):this.expanded.add(i),e.stopPropagation()},renderCourseStructure:function(e,t){this.$$childViews.forEach((e=>e.destroy())),this.$$childViews=[],e.each(((e,s)=>{let i;e.get("structure")instanceof l||e.set("structure",new l(e.get("structure")));const c={model:e,numberInList:s+1,expanded:this.expanded,course:this.model};switch(e.get("post_type")){case"tva_module":i=new n(c);break;case"tva_chapter":i=new o(c);break;case"tva_lesson":i=new r(c);break;case"tva_assessment":i=new a(c);break;default:i=new Backbone.View}t.append(i.render().$el),this.addChild(i)}))},updateAddItemButton:function(e){let t="";switch(e){case"module":t=TVA.t.AddModule;break;case"chapter":t=TVA.t.AddChapter;break;case"lesson":t=TVA.t.AddLesson;break;case"assessment":t=TVA.t.AddAssessment;break;default:t=TVA.t.AddContent}return t},openAddItemModal:function(e,t){let i="content",n=0,o=this.collection,r=null;const a=parseInt(t.dataset.postParent),l=parseInt(t.dataset.id);if(t.dataset.type&&(i=t.dataset.type),!isNaN(a)&&a&&(n=this.collection.findItem(a),o=n.get("structure")),!isNaN(l)&&l&&(r=this.collection.findItem(l)),!r&&-1!==["lesson","assessment","module","chapter"].indexOf(i)){const e=s(25252)(`./${i}`),t=this.model.get("allows_comments")?"open":"closed";r=new e({course_id:this.model.get("id"),post_parent:n?n.get("id"):n,comment_status:n?n.get("comment_status"):t,order:o.getOrderForNewItem()})}this.openModal("assessment"===i?h.assessment:h.courseItem,{course:this.model,model:r,structure:o}),e.stopPropagation()},deleteItem:function(e,t){e.stopPropagation();const s=this.collection.findItem(parseInt(t.dataset.id)),i=this.model;s instanceof Backbone.Model&&this.openModal(c,{template:TVE_Dash.tpl(`modals/delete-${s.getType()}`),confirm:function(){let e;s.get("post_parent")>0&&(e=s.getHighestParent()),s.destroy(),e&&e.collection.trigger("destroy",new Backbone.Model),i.trigger("tva.structure.status.changed"),this.close()}})},updateItemStatus:function(e,t){let s=t.dataset.status;if(-1===TVA.postAcceptedStatuses.indexOf(s))s="publish";else if("future"===s)return this.openModal(d,{model:this.collection.findItem(t.dataset.id),courseModel:this.model,width:"400px",className:"tvd-modal tva-schedule-modal",statusProp:"post_status"});return this.onItemStatusChanged(parseInt(t.dataset.id),s)},onItemStatusChanged:function(e,t){TVE_Dash.showLoader(),u.call(this,parseInt(e),t).then((e=>u.call(this,e,t))).then((e=>u.call(this,e,t))).catch((()=>{this.model.trigger("tva.structure.status.changed"),this.render(),TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t[`success_item_${t}`])}))},onItemSelect:function(e){const s=e.currentTarget,i=t(s.closest(".tva-course-item"));i.find("input.tva-section-select").not(s).prop("checked",s.checked),s.checked||i.parents(".tva-course-item").find("> .tva-cm-box input.tva-section-select").prop("checked",!1),this.onSelectionChange()},toggleSelectAll:function(e){this.$("input.tva-section-select").prop("checked",e.currentTarget.checked),this.onSelectionChange()},onSelectionChange:function(){if(this.selected=[],this.$("input.tva-section-select:checked").each(((e,t)=>this.selected.push(this.collection.findItem(t.dataset.itemId)))),this.$selectAll.prop("checked",this.selected.length&&this.selected.length===this.$("input.tva-section-select").length),!this.selected.length)return void this.$massActions.fadeOut(100);this.$massActions.filter('[data-fn="massAction"]').fadeIn(100);const e=this.selected.filter((e=>"module"===e.getType())),t=this.selected.filter((e=>"chapter"===e.getType())),s=this.selected.filter((e=>"lesson"===e.getType())),i=this.selected.filter((e=>"assessment"===e.getType())),n=this.selected.filter((e=>"future"===e.get("post_status"))),o=this.selected.filter((e=>"future"===e.get("post_status"))),r=this.selected[0].getHighestParent();let a=!1;s.length&&s.length===n.length&&(a=!0),i.length&&i.length===o.length&&(a=!0);const l=s.every((e=>e===e.getHighestParent()||e.getHighestParent()===r));let c=!1,d=!1,h=!1,u=!1,p=!1;0===e.length&&(0===e.length&&0===t.length&&l&&(c=!0),0===t.length&&(s.length||i.length)?d=!0:t.length&&(d=t.every((e=>e.get("structure").every((e=>s.includes(e)||i.includes(e))))),d&&(d=s.every((e=>t.includes(e.getParent()))),d&&(d=i.every((e=>t.includes(e.getParent()))))))),h=c||d,!h&&e.length&&(h=this.selected.every((t=>e.includes(t.getModule())))),u=p=s.length>0||i.length>0,this.$massActions.filter(".chapter-group")[c?"fadeIn":"fadeOut"](100),this.$massActions.filter(".module-group")[d?"fadeIn":"fadeOut"](100),this.$massActions.filter(".mass-move")[h?"fadeIn":"fadeOut"](100),this.$massActions.filter(".publish-group")[u?"show":"hide"](),this.$massActions.filter(".unpublish-group")[p?"show":"hide"](),this.$massActions.filter(".reschedule-group")[a?"show":"hide"](),this.$massActions.filter(".schedule-group")[a?"hide":"show"]()},massAction:function(e){if(!this.selected||!this.selected.length)return!1;const t=e.currentTarget.dataset.action,s=TVA.t[`success_items_${t}`],i={course_id:this.model.get("id"),items:["publish","unpublish"].includes(t)?this.getSelectedIdsForPublish():this.getSelectedIds(),action:t},n=()=>{const e=this.$(".tva-course-items-wrapper").first().tvaToggleLoader(60);return wp.apiRequest({url:`${TVA.routes.courses}/bulk_action`,type:"post",data:i}).done((i=>{switch(t){case"publish":case"unpublish":i.forEach((e=>{const s=this.collection.findItem(e);s&&s.set("post_status","publish"===t?t:"draft")}))}e.tvaToggleLoader(!1),TVE_Dash.success(s),requestAnimationFrame(this.onSelectionChange.bind(this)),this.model.trigger("tva.structure.status.changed"),this.render()}))},o=this;switch(t){case"delete":this.openModal(c,{template:TVE_Dash.tpl("modals/delete-confirmation"),confirm:function(){this.close(),requestAnimationFrame((()=>{n().done((e=>{o.model.get("structure").reset(e.structure),o.model.trigger("tva.structure.status.changed")}))}))}});break;case"schedule":this.openModal(d,{model:new Backbone.Model({publish_date:window.moment().format("Y-MM-DD HH:mm")}),width:"400px",className:"tvd-modal tva-schedule-modal",saveSchedule:function(){i.publish_date=this.model.get("publish_date"),this.close(),requestAnimationFrame((()=>{n().done((e=>{o.model.get("structure").reset(e.structure),o.model.trigger("tva.structure.status.changed")}))}))}});break;default:n()}return!1},structureAction:function(e){this.openModal(h[e.currentTarget.dataset.action],{parent:this})},getSelectedIds:function(){return this.selected.map((e=>e.get("ID")))},getSelectedIdsForPublish:function(){return this.selected.map((e=>{const t=e.get("post_type"),s=["tva_lesson","tva_assessment"].includes(t),i=s||e.get("structure").findItemsByOptions({post_type:"tva_lesson"}).length>0,n=i||e.get("structure").findItemsByOptions({post_type:"tva_assessment"}).length>0;return!(!s&&!n&&!i)&&e.get("ID")})).filter((e=>e))},openResourcesModal:function(e,t){return this.openModal(h.resources,{parent:this,lessonID:t.dataset.id,lesson:this.model.get("structure").findItem(parseInt(t.dataset.id)),width:"1000px",top:"40px",dismissible:!1}),!1},renderAddItemButtons:function(e){const t=[];let s=["lesson","chapter","module"];TVA.visualEditingEnabled&&(s=["lesson","assessment","chapter","module"]);for(const e of s)t.push(this.addItemButtonTemplate({courseItemType:e,label:this.updateAddItemButton(e)}));e.append(t)}})}(jQuery)},1828:function(e,t,s){!function(t){const i=s(82951),n=s(18421),o=s(88524);e.exports=i.extend({template:TVE_Dash.tpl("courses/lesson"),className:"tva-box tva-course-item",afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.model.newly_added&&!this.className.includes("tva-highlight-lesson")&&(this.$el.addClass("tva-highlight-lesson"),setTimeout((()=>{this.$el.removeClass("tva-highlight-lesson"),this.model.newly_added=!1}),2e3))},deleteItem:function(e,s){e.stopPropagation();const i=new n({template:TVE_Dash.tpl("courses/delete-lesson"),className:"tva-delete-simple",confirm:()=>{let e;this.model.get("post_parent")>0&&(e=this.model.getHighestParent()),this.model.destroy(),e&&e.collection.trigger("destroy",new Backbone.Model),this.course.trigger("tva.structure.status.changed")},cancel:function(){this.$el.siblings(".tva_lesson-right").removeClass("tvd-hide"),this.remove()}}).render();t(s).parents(".tva-course-item").first().append(i.$el).find(".tva_lesson-right").addClass("tvd-hide")},duplicateItem:function(e,t){e.stopPropagation();const s=parseInt(t.dataset.id),i=this.course.get("structure"),n=i.findItem(s).get("order");wp.apiRequest({url:`${TVA.apiSettings.root}${TVA.apiSettings.v2}/lessons/duplicate`,type:"POST",data:{id:s}}).done((e=>{const t=new o(e);t.newly_added=!0,0===e.post_parent?this.shiftStructure(i,n,t):this.shiftStructure(i.findItem(e.post_parent).get("structure"),n,t),this.course.trigger("tva.structure.modified",t)})).fail((e=>{TVE_Dash.err(e.responseJSON.message)}))},shiftStructure:function(e,t,s){e.forEach((e=>{const s=e.get("order");s>t&&e.set("order",s+1)})),e.add(s)}})}(jQuery)},59297:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=s(2921),r=s(76821),a=s(73799),l=r.extend({renderThumbs:!0,label:"",initialize:function(e){const t=[{id:0,title:"Publish",presentation:"Published",key:"publish",color:"#4bb35e",label_color:"#58a545"},{id:1,title:"Unpublish",presentation:"Unpublished",key:"draft",color:"#fa5c55",label_color:"#58a545"},{id:2,title:"Hide",presentation:"Hidden",key:"hidden",color:"#7281d9",label_color:"#58a545"},{id:3,title:"Archive",presentation:"Archived",key:"archived",color:"#434648",label_color:"#58a545"}],s=t.findIndex((t=>t.key===e.model.get("status")));-1!==s&&(t[s].selected=!0);const o=new a(t);return this.collection=o,this.$el.on("mouseleave",(()=>{this.$(".tva-dropdown-list").length&&this.$(".tva-dropdown-list").remove()})),r.prototype.initialize.call(this,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({collection:o},e))}});e.exports=o.extend({template:TVE_Dash.tpl("courses/item"),afterInitialize:function(e){this.model=e.model,this.courseView=e.courseView},render:function(){this.setElement(this.template({course:this.model,topic:this.model.getTopic()}));const e=new l({model:this.model}),t=this;return this.$el.find(".tva-course-status-select").append(e.render().$el),e.on("tva.dropdown.item.selected",(e=>{"archived"===e.get("key")?this.openModal(s(49939),{template:TVE_Dash.tpl("modals/archive-this-course"),className:"tvd-modal tva-confirmation-new",width:"550px",confirm:function(){this.close(),t.changeCourseStatus(t.model.get("id"),e.get("key"))},cancel:function(){t.courseView.collection.trigger("course-status-changed"),this.close()}}):t.changeCourseStatus(t.model.get("id"),e.get("key"))})),this},changeCourseStatus:function(e,t){this.courseView.toggleCourseStatus(e,t)}})},96774:function(e,t,s){const i=s(82951),n=s(52583),o=s(1828),r=s(39517),a=s(23150);e.exports=i.extend({template:TVE_Dash.tpl("courses/module"),afterRender:function(){if(i.prototype.afterRender.apply(this,arguments),this.model.get("structure")instanceof Backbone.Collection)switch(this.model.get("structure").getType()){case"chapters":this.$(".tva-add-lesson").remove(),this.$("> .tva-lessons-list").remove();break;case"lessons":this.$("> .tva-chapters-list").remove()}},editWithTar:function(e){e.stopPropagation()},renderStructure:function(e,t){e.each(((e,s)=>{let i;e.get("structure")instanceof a||e.set("structure",new a(e.get("structure")));const l={model:e,numberInList:s+1,expanded:this.expanded,course:this.course};switch(e.get("post_type")){case"tva_chapter":i=new n(l);break;case"tva_lesson":i=new o(l);break;case"tva_assessment":i=new r(l);break;default:i=new Backbone.View}t.append(i.render().$el),this.addChild(i)}));const s=this.$("> .tva-cm-box .tva-cm-status"),i=this.model.get("structure").findItemsByOptions({post_status:"draft"}),l=this.model.get("structure").findItemsByOptions({post_status:"future"});this.model.isPublished()&&(i.length||l.length)?s.attr("data-tooltip",TVE_Dash.sprintf(TVA.t.ContentNotPublished,TVA.t.Module)).addClass("yellow"):"publish"===this.model.get("post_status")?s.attr("data-tooltip",TVA.t.ModulePublished):s.attr("data-tooltip",TVA.t.ModuleNotPublished)}})},17520:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(){const t=s(2921);e.exports=t.extend({className:"tva-course-slug-label",template:TVE_Dash.tpl("courses/permalink"),events:n(n({},t.prototype.events),{},{"change #tva-course-slug":"onTitleChange","keyup #tva-course-slug":"onTitleKeyup"}),successMessage:TVA.t.permalink_updated,render:function(){return this.$el.html(this.template({model:this.model})),this.afterRender(),this},afterRender:function(){this.model.get("id")||this.$el.find(".tva-zclip").attr("disabled","disabled").html("")},onTitleChange:function(e){const s=e.currentTarget,i=s.value.trim();if(i===this.model.get("slug"))return;if(this.model.set({slug:i},{silent:!0}),s.classList.remove("tva-error"),!i)return s.classList.add("tva-error"),s.focus(),TVE_Dash.err(TVA.t.InvalidSlug),!1;const n=this.model.url;this.model.url=()=>`${TVA.apiSettings.root}${TVA.apiSettings.v2}/courses/permalink`,this.model.save(null,{success:()=>{this.model.saveState(),this.render(),this.model.trigger("tva.course.permalink.modified",this.model.get("preview_url")),t.prototype.bindZclip.call(this,null),TVE_Dash.success(this.successMessage)},error:(e,t)=>{TVE_Dash.err(t.responseJSON.message)}}),this.model.url=n},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0)}})}(jQuery)},273:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(43265),a=s(19125),l=s(36832),c=s(50201);e.exports=r.extend({template:TVE_Dash.tpl("courses/integration-stripe"),products:[],prices:[],forceFetch:!1,productId:null,priceId:null,successUrl:null,cancelUrl:null,testMode:!1,isSubscription:!1,urlRegex:/(http(s)?:\/\/.)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,16}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g,initialize:function(){r.prototype.initialize.apply(this,arguments),TVA.StripeCache=TVA.StripeCache||{},this.buy_now_link=this.buy_now_links.findWhere({integration:this.model.get("slug")}),this.buy_now_link||(this.buy_now_link=new a({integration:this.model.get("slug")}),this.buy_now_links.add(this.buy_now_link)),this.successUrl=this.buy_now_link.get("success_url"),this.cancelUrl=this.buy_now_link.get("cancel_url");const e=this.rule.getItems().toJSON();e.length&&(this.productId=e[0].product_id,this.priceId=e[0].id,this.testMode=e[0].test_mode||!1),this.isSubscription=this.productId&&this.priceId&&"recurring"===this.buy_now_link.get((this.testMode?"test":"live")+"_price_type"),wp.hooks.addFilter("tva.access_rules.prevent_saving","TVA",(e=>{var t;return this.priceId&&this.productId&&(this.successUrl?(null===(t=TVA.emailTemplates.newAccount)||void 0===t?void 0:t.triggers.includes("stripe"))||(TVA.emailTemplates.newAccount.triggers=["stripe",...TVA.emailTemplates.newAccount.triggers],wp.apiRequest({url:`${TVA.routes.email_template}`,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(n({},TVA.emailTemplates.newAccount))})):(e=!0,this.isOpened||this.toggleItemsList(),this.$successUrl.addClass("tvd-invalid"),this.$successUrl.parent().addClass("mb-15"))),e}))},ensureProducts:async function(){const e=(this.testMode?"test":"live")+"_products";if(this.forceFetch||!TVA.StripeCache[e]){const t=await this.fetchProducts();t.success?(this.products=t.products||[],TVA.StripeCache[e]=this.products,this.renderProducts()):TVE_Dash.err(t.message,5e3,null,"top")}else this.products=TVA.StripeCache[e],this.renderProducts();this.forceFetch=!1},ensurePrices:async function(){const e=`${this.testMode?"test":"live"}_prices_${this.productId}`;if(TVA.StripeCache[e])this.prices=TVA.StripeCache[e],this.renderPrices();else try{const t=await this.fetchPrices(this.productId);t.success?(this.prices=t.prices||[],TVA.StripeCache[e]=this.prices,this.renderPrices()):TVE_Dash.err(t.message,5e3,null,"top")}catch(e){var t;const s=(null===(t=e.responseJSON)||void 0===t?void 0:t.error)||e.statusText||e.message;TVE_Dash.err(s,3e3,null,"top")}},toggleItemsList:function(e,t){if(TVA.stripe.account_id){const e=jQuery(t);this.$items.toggle(!this.$items.is(":visible")),e.find("span").toggleClass("i-visible",this.$items.is(":visible")),this.isOpened=this.$items.is(":visible"),this.$el.toggleClass("tva-stripe-no-product",this.hasApi()&&(this.isOpened||!this.productId&&!this.priceId)),this.$el.toggleClass("tva-collapsed",!this.isOpened),this.$label.first().toggleClass("tva-hide",this.isOpened)}},clearSelectedItems:function(){r.prototype.clearSelectedItems.apply(this,arguments),this.priceId="",this.isSubscription=!1,this.productId="",this.$priceSelect.val("").trigger("change"),this.$productSelect.val("").trigger("change"),this.$successUrl.val(""),this.$cancelUrl.val(""),this.buy_now_links.remove(this.buy_now_link),this.buy_now_link=new a({integration:this.model.get("slug")}),this.buy_now_links.add(this.buy_now_link),this.renderLabel(),this.toggleTrial()},afterRender:function(){TVA.Utils.displayStripeError(),r.prototype.afterRender.apply(this,arguments),this.$productSelect=this.$("#tva-stripe-products"),this.$productWrapper=this.$(".tva-stripe-product-select"),this.$priceWrapper=this.$(".tva-stripe-price-select"),this.$priceSelect=this.$("#tva-stripe-prices"),this.$successUrl=this.$("#tva-stripe-success-url"),this.$cancelUrl=this.$("#tva-stripe-cancel-url"),this.$successUrl.val(this.successUrl),this.$cancelUrl.val(this.cancelUrl),this.$permissions=this.$(".tva-stripe-permissions"),this.$firstProduct=this.$(".tva-stripe-first-product"),this.$modeButtons=this.$(".tva-stripe-mode"),this.$el.toggleClass("tva-collapsed",!this.isOpened),this.$modeSelect=this.$("#tva-stripe-mode-select"),this.$urlWrapper=this.$(".tva-stripe-urls"),this.$setupWrapper=this.$(".tva-stripe-product-wrapper"),this.$productActions=this.$(".tva-stripe-product-actions"),this.$buyButtonNotice=this.$(".tva-buy-button-notice"),this.$trialSetting=this.$(".tva-stripe-free-trial"),this.$trialInput=this.$(".tva-stripe-free-trial .tvd-switch input"),this.$referenceCheck=this.$(".tva-stripe-reference .tvd-switch input"),this.$referenceSelect=this.$("#tva-stripe-client-reference"),this.$emailPopulate=this.$(".tva-stripe-prepopulate-email input"),this.$allowCoupons=this.$(".tva-stripe-allow-coupons input"),this.$trialDays=this.$("#tva-stripe-trial-days"),this.$createSuccesPageWrapper=this.$(".tva-stripe-success-create"),this.$createSuccesPageButton=this.$('.tva-create-new-page[data-fn="toggleSuccessPage"]'),this.$createSuccessPageTitle=this.$createSuccesPageWrapper.find("input"),this.$createCancelPageWrapper=this.$(".tva-stripe-cancel-create"),this.$createCancelPageButton=this.$('.tva-create-new-page[data-fn="toggleCancelPage"]'),this.$createCancelsPageTitle=this.$createCancelPageWrapper.find("input"),this.$extraSettingsWrapper=this.$(".tva-sub-advanced-settings-wrapper"),TVA.stripe.account_id?this.hasApi()?this.productId||this.priceId||this.$el.addClass("tva-stripe-no-product"):this.$el.addClass("tva-stripe-no-api-key"):this.$el.addClass("tva-stripe-no-account"),this.$trialInput.prop("checked",!!this.buy_now_link.get((this.testMode?"test":"live")+"_free_trial")),this.$referenceCheck.prop("checked",!!this.buy_now_link.get((this.testMode?"test":"live")+"_reference")),this.$referenceSelect.val(this.buy_now_link.get((this.testMode?"test":"live")+"_reference_type")||"user_id"),this.$emailPopulate.prop("checked",!!this.buy_now_link.get("populate_email")),void 0===this.buy_now_link.get("allow_coupons")?this.$allowCoupons.prop("checked",parseInt(TVA.stripe.tva_stripe_allow_checkout_coupons)):this.$allowCoupons.prop("checked",!!this.buy_now_link.get("allow_coupons")),TVA.stripe.api_key&&TVA.stripe.test_api_key?this.$modeSelect.select2():(this.$modeSelect.addClass("tva-disabled"),this.testMode=!TVA.stripe.api_key),this.hasApi()&&(this.$el.find(".tva-stripe-key-setup").remove(),this.products.length||this.ensureProducts()),this.toggleTrial(),this.toggleReference(),this.bindAutocomplete(this.$successUrl),this.bindAutocomplete(this.$cancelUrl),this.setTestModeClass(),this.$buyButtonNotice.toggleClass("tva-hide",this.hasBuyButton()||!this.productId||!this.priceId)},toggleTrial:function(){this.$trialSetting.toggleClass("tva-hide",!this.isSubscription),this.$trialDays.toggleClass("tva-hide",!this.buy_now_link.get((this.testMode?"test":"live")+"_free_trial")),this.$trialDays.val(this.buy_now_link.get((this.testMode?"test":"live")+"_free_trial_days")||7)},hasApi:function(){return!(!TVA.stripe.api_key&&!TVA.stripe.test_api_key)},setTestModeClass:function(){this.$el.toggleClass("tva-stripe-test-mode",this.testMode),this.$modeSelect.val(this.testMode?"test":"live").trigger("change"),this.$modeButtons.addClass("tva-hide").filter(`[data-mode="${this.testMode?"test":"live"}"]`).removeClass("tva-hide")},changeTestMode:function(e,t){const s="test"===t.value;s!==this.testMode&&(this.testMode=s,this.afterModeChange(),this.isSubscription=this.productId&&this.priceId&&"recurring"===this.buy_now_link.get((this.testMode?"test":"live")+"_price_type"),this.toggleTrial())},afterModeChange:function(){this.testMode?(this.productId=this.buy_now_link.get("test_product_id"),this.priceId=this.buy_now_link.get("test_price_id")):(this.productId=this.buy_now_link.get("live_product_id"),this.priceId=this.buy_now_link.get("live_price_id")),this.setTestModeClass(),this.ensureProducts(),this.rule.getItems().first()&&this.updateRule()},refreshProducts:function(){this.forceFetch=!0,TVA.StripeCache={},this.$firstProduct.tvaToggleLoader(20,!0,{position:"center"}),this.ensureProducts()},changeSuccessUrl:function(){const e=this.$successUrl.val();new RegExp(this.urlRegex).test(e)?(this.successUrl=e,this.buy_now_link.set("success_url",this.successUrl),this.$successUrl.removeClass("tvd-invalid"),this.$successUrl.parent().removeClass("mb-15")):(this.$successUrl.addClass("tvd-invalid"),this.$successUrl.parent().addClass("mb-15"))},changeCancelUrl:function(){const e=this.$cancelUrl.val();e&&!new RegExp(this.urlRegex).test(e)?(this.$cancelUrl.addClass("tvd-invalid"),this.$cancelUrl.parent().addClass("mb-15")):(this.$cancelUrl.removeClass("tvd-invalid"),this.$cancelUrl.parent().removeClass("mb-15"),this.cancelUrl=e,this.buy_now_link.set("cancel_url",this.cancelUrl))},fetchProducts:function(){return this.$productWrapper.tvaToggleLoader(20,!0,{padding:"0 10px 0 0",position:"right"}),this.$priceWrapper.tvaToggleLoader(20,!0,{padding:"0 10px 0 0",position:"right"}),wp.apiRequest({url:`${TVA.routes.stripe}/products?force=${this.forceFetch}&test_mode=${this.testMode}`})},fetchPrices:function(e){return this.$priceWrapper.tvaToggleLoader(20,!0,{padding:"0 10px 0 0",position:"right"}),wp.apiRequest({url:`${TVA.routes.stripe}/prices?product_id=${e}&test_mode=${this.testMode}`})},renderProducts:function(){this.$productSelect.data("select2")&&this.$productSelect.select2("destroy"),this.products.length?(this.$firstProduct.hide(),this.$extraSettingsWrapper.show(),this.$setupWrapper.show(),this.$urlWrapper.show(),this.$productActions.show(),this.hidePrices(),this.$productSelect.empty(),this.prices=[],this.$productSelect.append("<option hidden disabled selected></option>"),this.products.forEach((e=>{this.$productSelect.append(`<option value="${e.id}">${e.name}</option>`)})),this.$productSelect.select2({placeholder:TVA.t.selectProduct}),this.$productWrapper.hasClass("tva-element-loading")&&this.$productWrapper.tvaToggleLoader(20,!1),this.renderPrices(),this.productId&&this.$productSelect.val(this.productId).trigger("change")):(this.$firstProduct.tvaToggleLoader(20,!1),this.$firstProduct.show(),this.$setupWrapper.hide(),this.$extraSettingsWrapper.hide(),this.$urlWrapper.hide(),this.$productActions.hide())},hidePrices:function(){this.$priceSelect.data("select2")&&this.$priceSelect.val("").trigger("change")},renderPrices:function(){this.$priceSelect.data("select2")&&this.$priceSelect.select2("destroy"),this.$priceSelect.show().empty(),this.$priceSelect.append("<option hidden disabled selected></option>"),this.prices.forEach((e=>{this.$priceSelect.append(`<option value="${e.id}">${e.currency.toUpperCase()} ${parseFloat(e.unit_amount_decimal/100).toFixed(2)}</option>`)})),this.$priceSelect.select2({placeholder:TVA.t.selectPrice}),this.priceId&&this.$priceSelect.val(this.priceId).trigger("change"),this.$priceWrapper.hasClass("tva-element-loading")&&this.$priceWrapper.tvaToggleLoader(20,!1),this.renderLabel()},selectProduct:function(){const e=this.$productSelect.val();e&&(this.productId!==e&&(this.priceId=""),this.productId=e,this.hidePrices(),this.ensurePrices(),this.productId!==e&&this.updateRule())},selectPrice:function(){const e=this.$priceSelect.val();e&&e!==this.priceId&&(this.priceId=this.$priceSelect.val(),this.updateRule())},changeSettingCheckbox:function(){this.updateRule()},updateRule:function(){var e;const t=this.prices.find((e=>e.id===this.priceId)),s=(null===(e=this.rule.getItems().first())||void 0===e?void 0:e.toJSON())||{},i={[(this.testMode?"test":"live")+"_product_id"]:this.productId,[(this.testMode?"test":"live")+"_price_id"]:this.priceId,[(this.testMode?"test":"live")+"_price_type"]:null==t?void 0:t.type,[(this.testMode?"test":"live")+"_free_trial"]:this.$trialInput.is(":checked"),[(this.testMode?"test":"live")+"_free_trial_days"]:parseInt(this.$trialDays.val())||7,[(this.testMode?"test":"live")+"_reference"]:this.$referenceCheck.is(":checked"),[(this.testMode?"test":"live")+"_reference_type"]:this.$referenceSelect.val()||"user_id"};this.rule.getItems().reset(null),this.rule.getItems().add(n(n({},s),{},{product_id:this.productId,id:this.priceId,test_mode:this.testMode},i)),this.rule.collection.trigger("add"),this.buy_now_link.set(n({product_id:this.productId,price_id:this.priceId,test_mode:this.testMode,populate_email:this.$emailPopulate.is(":checked"),allow_coupons:this.$allowCoupons.is(":checked")},i)),this.productId&&this.priceId&&parseInt(TVA.stripe.tva_stripe_auto_display_buy_button)?this.setBuyButton():this.resetBuyButton(),this.isSubscription=this.productId&&this.priceId&&"recurring"===i[(this.testMode?"test":"live")+"_price_type"],this.$buyButtonNotice.toggleClass("tva-hide",this.hasBuyButton()||!this.productId||!this.priceId),this.toggleTrial(),this.toggleReference()},createAccount:function(){TVA.Utils.stripeConnect()},toggleReference:function(){this.$referenceSelect.toggleClass("tva-hide",!this.$referenceCheck.is(":checked"))},saveApiKey:function(e,t){const s=this.$("#tva-stripe-api-key").val();if(s){const e=this.$(t);e.tvaToggleLoader(20,!0,{position:"center"}),wp.apiRequest({url:`${TVA.routes.stripe}/api_key`,method:"POST",data:{api_key:s}}).then((t=>{t.success?(this.testMode=/_test_/i.test(s),TVA.stripe[(this.testMode?"test_":"")+"api_key"]=s,this.afterModeChange(),this.$el.removeClass("tva-stripe-no-api-key").toggleClass("tva-stripe-no-product",this.hasApi()&&(this.isOpened||!this.productId&&!this.priceId)),this.$el.find(".tva-stripe-key-setup").remove()):TVE_Dash.err(t.message,3e3,null,"top"),e.tvaToggleLoader(20,!1)})).fail((t=>{var s;const i=(null===(s=t.responseJSON)||void 0===s?void 0:s.message)||t.statusText||t.message;TVE_Dash.err(i,3e3,null,"top"),e.tvaToggleLoader(20,!1)}))}},renderLabel:function(){var e;const t=(null===(e=this.products.find((e=>e.id===this.productId)))||void 0===e?void 0:e.name)||"",s=this.prices.find((e=>e.id===this.priceId)),i=s?`${s.currency.toUpperCase()} ${parseFloat(s.unit_amount_decimal/100).toFixed(2)}`:"";this.$label.html(t&&i?`${t} - ${i}`:"")},togglePermissions:function(){this.$permissions.toggle()},renderStatus:function(){const e=this.hasApi()&&0===this.rule.getItems().length?TVA.t.not_set:"";this.$status.html(e)},goToAccessRules:function(){TVA.Router.navigate(`products/${this.rulesModel.get("id")}/restricted-content`,{trigger:!0})},setBuyButton:function(){this.rulesModel.deepSet("access_restrictions.action_button_display.option","buy_action"),this.rulesModel.deepSet("access_restrictions.action_button_display.buy_action",{provider:"stripe"})},resetBuyButton:function(){this.rulesModel.deepSet("access_restrictions.action_button_display.option","call_to_action"),this.rulesModel.deepSet("access_restrictions.action_button_display.buy_action.provider","")},hasBuyButton:function(){const e=this.rulesModel.deepGet("access_restrictions.action_button_display.option"),t=this.rulesModel.deepGet("access_restrictions.action_button_display.buy_action.provider");return"buy_action"===e&&"stripe"===t},bindAutocomplete:function(e){const t=this;l(e,{select:function(s,i){s.preventDefault(),s.stopPropagation(),e.val(i.item.url),e.autocomplete("destroy"),t.bindAutocomplete(e)},change:function(e){e.preventDefault(),e.stopPropagation(),t.changeCancelUrl()}})},openCreateProductModal:function(){this.openModal(c,{model:null,width:"800px",className:"tvd-modal tva-modal-create tva-stripe-create-product-helper-modal"})},toggleCancelPage:function(){this.$createCancelPageWrapper.toggleClass("tva-hide"),this.$createCancelPageButton.toggleClass("tva-disabled")},toggleSuccessPage:function(){this.$createSuccesPageWrapper.toggleClass("tva-hide"),this.$createSuccesPageButton.toggleClass("tva-disabled")},saveSuccessPage:function(){this.$createSuccessPageTitle.val().trim()&&(TVE_Dash.showLoader(),wp.apiRequest({url:`${TVA.routes.stripe}/create_page`,method:"POST",data:{title:this.$createSuccessPageTitle.val()}}).then((e=>{e.success?(this.$successUrl.val(e.url).trigger("change"),this.toggleSuccessPage()):TVE_Dash.err(e.message,5e3,null,"top")})).always((()=>{TVE_Dash.hideLoader()})))},saveCancelPage:function(){this.$createCancelsPageTitle.val().trim()&&(TVE_Dash.showLoader(),wp.apiRequest({url:`${TVA.routes.stripe}/create_page`,method:"POST",data:{title:this.$createCancelsPageTitle.val()}}).then((e=>{e.success?(this.$cancelUrl.val(e.url).trigger("change"),this.toggleCancelPage()):TVE_Dash.err(e.message,5e3,null,"top")})).always((()=>{TVE_Dash.hideLoader()})))},toggleSettingsExpanded:function(){this.toggleTrial(),this.$extraSettingsWrapper.toggleClass("tva-collapsed")}})},5657:function(e,t,s){!function(t){const i=s(43265),n=s(8346);e.exports=i.extend({template:TVE_Dash.tpl("courses/integration-thrivecart"),$checkboxRule:null,initialize:function(e){t.extend(!0,this,e),this.listenTo(this.rules,"update",this.renderLabel),this.listenTo(this.rules,"update",this.renderStatus)},afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.$checkboxRule=this.$("#tva-thrivecart-checkbox-rule").prop("checked",this.rules.findWhere({integration:this.model.get("slug")}))},renderLabel:function(){this.rules.findWhere({integration:this.model.get("slug")})?this.$label.html(this.model.getText()):(this.$label.first().html(""),this.$label.eq(1).html(this.model.getText()))},renderStatus:function(){},toggleRule:function(e,t){if(t.checked&&!this.rules.findWhere({integration:this.model.get("slug")})){const e=new n({integration:this.model.get("slug")});e.resetItems(void 0),this.rules.add(e)}else this.rules.remove(this.rules.findWhere({integration:this.model.get("slug")}))}})}(jQuery)},78818:function(e,t,s){!function(){const t=s(43265);e.exports=t.extend({template:TVE_Dash.tpl("courses/integration-woocommerce"),renderStatus:function(){const e=this.model.get("allow")?"&nbsp;":TVA.t.not_set;this.$status.html(e)}})}(jQuery)},26711:function(e,t,s){const i=s(51135);e.exports=i.extend({template:TVE_Dash.tpl("reports/courses"),afterInsert:function(){window.thriveReportsInit(this.el,"courses")}})},24633:function(e,t,s){!function(t){const i=s(84643),n=s(30739),o=s(77003),r=s(95438),a=s(1621),l=s(27339),c=s(18421),d=s(51135),h=s(23150),u=s(59297);function p(){const e=t(this),s=e.sortable("option","items"),n=e.find(s),o=n.length-1,r=new i;n.each((function(e,t){r.set(t.dataset.id,o-e)})),r.url=`${TVA.apiSettings.root}${TVA.apiSettings.v2}/courses/update_orders`,r.save(),n.reverse().each(((e,t)=>TVA.courses.findWhere({id:parseInt(t.getAttribute("data-id"))}).set({order:e},{silent:!0}))),TVA.courses.sort()}e.exports=d.extend({className:"tva-course-main",template:TVE_Dash.tpl("courses/list"),itemTemplate:TVE_Dash.tpl("courses/item"),addTemplate:TVE_Dash.tpl("courses/add"),noItemsTemplate:TVE_Dash.tpl("courses/no-items"),$courses:null,$pagination:null,status:["publish","draft","hidden","future"],initialize:function(){this.$el.on("click",(()=>{this.closeDropdowns()})),this.collection=TVA.courses,this.listenTo(this.collection,"fetched",this.renderCourses),this.listenTo(this.collection,"destroy",(()=>{this.renderCourses(this.collection)})),this.listenTo(this.collection,"fetching",(()=>this.$courses.tvaToggleLoader(50,!0))),this.listenTo(this.collection,"course-status-changed",(()=>{this.collection.addFilter("status",-1===this.activeBadgeKey?this.status:this.activeBadgeKey),this.renderBadgerFilters()}))},closeDropdowns:function(){this.$(".tva-course-status-select .tva-dropdown-list").remove()},destroy:async function(){d.prototype.destroy.apply(this,arguments),this.collection.hasFilters()&&await this.collection.resetFilters().fetch()},activeBadgeKey:-1,renderBadgerFilters:async function(){const e=await this.getCountByStatus();this.$statusFilterWrapper=this.$(".tva-filter-status").empty(),[{label:"All",number:e.publish+e.draft+e.hidden,key:-1,selected:-1===this.activeBadgeKey},{label:"Published",key:"publish",selected:"publish"===this.activeBadgeKey},{label:"Unpublished",key:"draft",selected:"draft"===this.activeBadgeKey},{label:"Hidden",key:"hidden",selected:"hidden"===this.activeBadgeKey}].forEach((t=>{var s;const i=new a({number:null!==(s=t.number)&&void 0!==s?s:e[t.key],label:t.label,key:t.key,selected:t.selected}).render();i.on("beforeTrigger",(()=>{this.$statusFilterWrapper.find(`.${i.activeClassName}`).removeClass(`${i.activeClassName}`)})),i.on("click",(e=>{this.activeBadgeKey=e,this.collection.addFilter("status",-1===e?this.status:e)})),this.$statusFilterWrapper.append(i.$el)}))},renderSearchFilter:function(){this.$searchFilterWrapper=this.$(".tva-filter-search");const e=new l({placeholder:"Search Courses"});e.on("change",(async e=>{await this.collection.addFilter("search",e.trim()),this.renderBadgerFilters()})),this.$searchFilterWrapper.append(e.render().$el)},render:function(){return this.$el.html(this.template()),this.$courses=this.$("#tva-courses"),this.$pagination=this.$(".tva-pagination"),this.$noticeOnePublishedCourse=this.$("#tva-one-published-course-notice"),this.topicFilter=new r({collection:TVA.topics,idField:"ID",labelField:"title",defaultOption:"Filter by topics",selected:this.collection.getFilter("topic",-1)}).render().on("change",this.topicChanged.bind(this)),this.$(".tva-filter-topic").append(this.topicFilter.$el),this.$(".tva-filter-topic select").select2(),this.renderSearchFilter(),this.collection.addFilter("status",-1===this.activeBadgeKey?this.status:this.activeBadgeKey),this.renderBadgerFilters(),this.renderPagination(),this.afterRender(),this},afterRender:t.noop,renderCourses:function(e){return this.$courses.tvaToggleLoader(!1).empty(),e instanceof n?(e.length?(this.toggleOneCoursePublishedNotification(),e.each((e=>{this.$courses.append(new u({model:e,courseView:this}).render().$el)})),this.$courses.append(this.addTemplate)):this.$courses.append(this.noItemsTemplate),this.$courses.sortable({items:"> .tva-course-card",handle:".tva-course-handle",placeholder:"tva-drag-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:p}),this.$courses.disableSelection(),this):this},toggleOneCoursePublishedNotification:function(){this.$noticeOnePublishedCourse.toggle(!TVA.courses.hasFilters()&&1===TVA.courses.where({status:"publish"}).length&&1!==parseInt(TVA.settings.skip_homepage_redirect.value))},renderPagination:function(){const e=new o({collection:this.collection,el:this.$pagination});e.render(),e.$el.hide()},duplicateCourse:function(e,t){e.stopPropagation();const s=parseInt(t.dataset.id),i=this;TVE_Dash.showLoader(),t.setAttribute("disabled","true"),wp.apiRequest({url:`${TVA.apiSettings.root}${TVA.apiSettings.v2}/courses/duplicate`,type:"POST",data:{id:s}}).done((e=>{TVA.courses.add(e),i.render(),TVE_Dash.hideLoader(),t.removeAttribute("disabled")})).fail((e=>{TVE_Dash.hideLoader(),TVE_Dash.err(e.responseJSON.message)}))},getCountByStatus:async function(){return await wp.apiRequest({url:`${TVA.apiSettings.root}${TVA.apiSettings.v2}/courses/get_count_by_status`,type:"GET",data:{}})},deleteCourse:function(e,s){e.stopPropagation();const i=parseInt(s.dataset.id),n=t(s).parents(".tva-course-card").first(),o=new c({template:TVE_Dash.tpl("courses/delete-course"),className:"tva-delete-course",confirm:()=>{TVE_Dash.showLoader(),this.collection.get(i).destroy({wait:!0,success:()=>{this.collection.trigger("course-status-changed"),TVA.products.resetAndFetch(),TVA.customers.reset(),TVE_Dash.hideLoader()}}),this.toggleOneCoursePublishedNotification()},afterRender:()=>{n.removeClass("click")},cancel:function(){n.addClass("click"),this.remove()}}).render();n.append(o.$el)},topicChanged:async function(e){await this.collection.addFilter("topic",e),this.renderBadgerFilters()},courseDetails:function(e,t){this.changeView(`#courses/${t.dataset.id}`),e.stopPropagation()},previewCourse:function(e){e.stopPropagation()},addCourse:function(){const e=this.collection.getFilter("topic",-1);let t="#courses/add-new-course";e>0&&(t+=`/${e}`),this.changeView(t)},toggleCourseStatus:function(e,t){if(e=parseInt(e),isNaN(e))return;const s=TVA.courses.findWhere({id:e});return new Promise(((e,t)=>{s.get("structure")instanceof h?e():(TVE_Dash.showLoader(),s.fetch({success:function(t){t.set("structure",new h(t.get("structure"))),e()},error:function(){t()}}))})).then((()=>{const i=s.get("structure").findItemsByOptions({post_status:"publish"});if("publish"===t&&!i.length)return TVE_Dash.hideLoader(),TVE_Dash.err(TVA.t.publishedItem);TVE_Dash.showLoader(),s.save({status:t},{success:()=>{s.set("fetched",!1),TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t[`course_${t}`]),this.toggleOneCoursePublishedNotification(),"archive"===t?this.collection.remove(this.collection.findWhere({id:e})):this.collection.findWhere({id:s.get("id")}).set({status:t},{silent:!0}),this.collection.trigger("course-status-changed")}})})),TVA.customers.reset(),this}})}(jQuery)},91359:function(e,t,s){class i{constructor(e=null){this.instance=e}setInstance(e){this.instance=e}setDate(){var e;null===(e=this.instance)||void 0===e||e.setDate.apply(this.instance,arguments)}}!function(t){const n=window.React,o=window.ReactDOM,r=window.wp.components.DateTimePicker,a=window.wp.date.__experimentalGetSettings||window.wp.date.getSettings,l=window.wp.compose.withState;let c;e.exports=c=s(2921).extend({initialize:function(e){this.options=e||{}},render:function(){const e=document.createElement("div");e.setAttribute("id","tva-datepicker"),this.$el.html(e);const t=this.model;let{prop:s,dateFormat:i,silent:c,onChange:d}=this.options;i=i||"Y-MM-DD HH:mm";let h=t.get(s);h||(h=new Date);const u=l({date:h})((({date:e,setState:o})=>{const l=a();this.setDate=(e,t={})=>{e=window.moment(e).format(i),o({date:e}),this.model.set(s,e,t)};const h={currentDate:e,is12Hour:void 0!==this.options.is12HourTime?this.options.is12HourTime:/a(?!\\)/i.test(l.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join("")),active:this.options.active,__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0,onChange:function(e){e||(e=window.moment().format(i)),o({date:e}),"function"==typeof d&&d(e),t.set(s,window.moment(e).format(i),{silent:c})}};return"function"==typeof this.options.isInvalidDate&&(h.isInvalidDate=this.options.isInvalidDate),n.createElement(r,h)}));return o.render(n.createElement(u),this.$el[0]),this}},{extractDatePart:function(e,t){return e.split(" ")["time"===t?1:0]},renderInline:function(e,t){const s=new c(t);return s.render().$el.appendTo(e),new i(s)},renderPopup:function(e,s){e.text()||e.text("Click to set a date / time"),s.active&&e.text(this.extractDatePart(e.text(),s.active));const n=new i;return e.off("click.tva-datepicker").on("click.tva-datepicker",(()=>{let i=e.data("tva-datepicker");t(".tva-datepicker-popup").hide();const o=s.el=t('<div class="tva-datepicker-popup tva-drip-datetime"></div>');if(e.parent().css({position:"relative",zIndex:9e5}).append(o),i||(i=new c(s),e.data("tva-datepicker",i),n.setInstance(i)),i.$el.toggle(),!i.rendered){if(i.rendered=!0,i.render(),i.$el.find(".components-datetime__date").last().after('<div style="flex: 1 0 auto" class="tva-flex tva-flex-end"><button type="button" class="components-button components-datetime__time-button components-datetime__button-done is-primary">Done</button></div>'),s.active&&i.model.on(`change:${s.prop}`,(t=>{e.text(this.extractDatePart(t.get(s.prop),s.active))})),i.$el.on("click",".components-datetime__button-done",(()=>{i.$el.hide(),s.silent&&i.model.trigger("change")})),s.active)switch(s.active){case"date":i.$el.find(".components-datetime__time").hide();break;case"time":i.$el.addClass("tva-drip-time").find(".components-datetime__date").hide()}e.parents(".tvd-modal-content,body").first().off("click.tva-datepicker-close").on("click.tva-datepicker-close",(e=>{e.target.closest(".tva-datepicker-popup,.tva-popup-datepicker")||i.$el.find(".components-datetime__button-done").trigger("click")}))}return!1})),n}})}(jQuery)},85212:function(e,t,s){const i=s(51135),n=s(36441),o=s(37184),r=s(75243),a=s(27012),l={template:s(31597),advanced:s(58254),index:s(65653)};e.exports=i.extend({className:"tva-wizard-container",model:null,template:TVE_Dash.tpl("design/base"),initialize:function(){TVE_Dash.showLoader(),TVA.design.$el=this.$el,TVA.design.$el.on("tva_iframe_loaded",(()=>{TVE_Dash.hideLoader(),a.iframeLoaded()})),i.prototype.initialize.apply(this,arguments);const e=Object.values(TVA.settings).filter((e=>"template"===e.category));this.model=new Backbone.Model(e.reduce(((e,t)=>Object.assign(e,{[t.name]:t.value})),{})),this.collection=TVA.courses,this.listenTo(this.model,"change:preview_option",(e=>{TVA.settings.preview_option.value=e.get("preview_option")})),this.fragment=Backbone.history.getFragment().split("/"),TVA.globals.availableSettingsModel?this.renderDesign():(TVA.globals.availableSettingsModel=new o,TVA.globals.availableSettingsModel.fetch().success((()=>this.renderDesign())))},render:function(){return this},renderDesign:function(){const e=TVA.courses.toArray().filter((e=>"publish"===e.get("status")));return this.model.get("preview_option")&&0===e.length&&this.model.set({preview_option:!1}),0===e.length&&TVA.settings.show_hi_professor_modal&&(this.openModal(s(95692),{model:new Backbone.Model,"max-width":"60%",width:"800px"}),delete TVA.settings.show_hi_professor_modal),this.$el.html(this.template({model:this.model,published:e})),this.renderSettings(this.fragment[1]),this.renderPreview(),TVE_Dash.materialize(this.$el),this.$(".scrollbar-inner").scrollbar(),this},renderSettings:function(e="template"){let t=null;l[e]&&(t=l[e]),this.settings=new t({model:this.model,collection:this.collection,available_settings:TVA.globals.availableSettingsModel,el:this.$(".tva-options-container")})},renderPreview:function(){this.$("#tva-preview-"+(this.model.get("preview_option")?"live":"demo")).addClass("active"),new n({model:this.model,el:this.$(".tva-template-container")})},setActivePreview:function(e,t){const s=parseInt(t.getAttribute("data-preview"));r.prototype.save.apply(this,[]).always((()=>{wp.apiRequest({type:"POST",url:`${TVA.routes.settings_v2}/switch_preview/`,data:{key:"preview_option",value:s}}).done(((e,t,i)=>{200===i.status&&(this.model.set({preview_option:s}),this.renderDesign())})).fail((()=>{TVE_Dash.hideLoader()}))}))}})},59339:function(e,t,s){const i=s(51135),n=s(86171);e.exports=i.extend({template:TVE_Dash.tpl("design/welcome"),className:"tva-wiz-welcome",gotIt:function(){new n({key:"visual_editor_welcome",value:1}).save(),TVA.Router.menuItems.findWhere({slug:"design"}).set({route:"#design"}),TVA.Router.navigate("#design",{trigger:!0})}})},99651:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(51135),a=TVA.skins,l=s(58792);e.exports=r.extend({template:TVE_Dash.tpl("design/new/dashboard"),className:"tva-designs",afterInitialize:function(){this.collection=a,this.listenTo(TVA.skins,"fetch ajax",(()=>TVE_Dash.showLoader(!0))),this.listenTo(TVA.skins,"sync reset ajaxdone",(()=>TVE_Dash.hideLoader())),this.listenTo(TVA.skins,"add remove reset",this.render),this.listenTo(TVA.skins,"sync",((e,t,s)=>{s&&s.silent||this.render()}))},publishClicked:function(e,t){const s=TVA.skins.get(Number(t.dataset.skinId));TVA.Utils.confirmation(n(n({},TVA.t.skin_publish_confirmation),{},{title:TVA.t.skin_publish_confirmation.title.replace("{title}",`<strong>${s.get("name")}</strong>`),yesClass:"tva-modal-btn-blue"})).then((()=>{TVA.skins.setDefaultSkin(t.dataset.skinId).then((()=>{TVE_Dash.success(TVA.t.skin_published.replace("{name}",`<strong>${s.get("name")}</strong>`),3e3)}))}))},getRenderParams:function(){const e=TVA.skins.getActiveSkin();return{activeSkin:e,skins:TVA.skins.filter((t=>t!==e))}},skinAction:function(e,t){const s=TVA.skins.get(Number(t.dataset.skinId));switch(t.dataset.action){case"delete":TVA.Utils.confirmation(TVA.t.skin_delete_confirmation).then((()=>{s.destroy().then((()=>TVE_Dash.success(TVA.t.skin_deleted.replace("{name}",`<strong>${s.get("name")}</strong>`)))).fail((e=>TVE_Dash.err(e.responseJSON.message,3e3)))}));break;case"rename":const e=t.closest(".tva-skin-item,.tva-main-skin-parent");jQuery(e).find(".tva-skin-name").tvaInlineEdit({validation_fn:e=>!TVA.skins.getByName(e)||(TVE_Dash.err(TVA.t.skin_invalid_name.replace("{name}",`<strong>${e}</strong>`)),!1)}).one("change",((e,t)=>{s.set("name",t),s.save(null,{silent:!0})}));break;case"duplicate":TVA.skins.duplicateSkin(t.dataset.skinId).then((()=>{TVE_Dash.success(TVA.t.skin_duplicated.replace("{name}",`<strong>${s.get("name")}</strong>`),3e3)}))}},addClicked:function(){TVE_Dash.showLoader();const e=new a.model;return e.save().then((()=>{a.add(e),TVE_Dash.hideLoader()})),!1},openCloudModal:function(){return this.openModal(l,{"max-width":"1040px",height:"90vh",width:"90vw"}).on("cloud-skin-downloaded",(e=>{a.unshift(e)})),!1}})},58254:function(e,t,s){!function(){function t(e){return e.getAttribute("name")}const i=s(75243),n=s(27012);e.exports=i.extend({template:TVE_Dash.tpl("design/advanced"),initialize:function(e){this.available_settings=e.available_settings,i.prototype.initialize.apply(this,arguments),TVA.design.$el.on("tva_iframe_loaded",(()=>{n.collapse(this.model.get("template"))}))},render:function(){return this.$el.empty().html(this.template({template:this.model.get("template"),available_settings:this.available_settings})),this.addColorPickers(),this},addColorPickers:function(){const e=this;this.$("#tva-headline-color, #tva-paragraph-color, #tva-course-title-color").spectrum({type:"component",showPalette:!1,showAlpha:!1,allowEmpty:!1,chooseText:"Apply",change:function(s){const i=t(this);e.model.get("template")[i]=s?s.toHexString():""},move:function(e){const s=e?e.toHexString():"",i=t(this).replace("_color","");n.styleIframeElements(`.tva_${i}`,"color",s)},cancel:function(e){const s=e?e.toHexString():"",i=t(this).replace("_color","");n.styleIframeElements(`.tva_${i}`,"color",s)}})}})}(jQuery)},75243:function(e,t,s){!function(t){const i=s(27012),n=s(2921),o=s(86171);e.exports=n.extend({events:function(){return _.extend(n.prototype.events,{"click .tva-settings-card-title":"toggleSettingsCard"})},initialize:function(){n.prototype.initialize.apply(this,arguments),this.render(),TVE_Dash.materialize(this.$el)},changeModelTemplateValue:function(e,t){this.model.get("template")[e]=t},sliderInput:function(e,s){const n=t(s),o=s.getAttribute("name"),r=s.getAttribute("data-css-prop"),a=s.getAttribute("type"),l=`${s.value}px`;let c=n.closest(".tva-card");0===c.length&&(c=n.closest(".tva-sidebar-wrapper")),c.find("range"===a?`#tva_${o}_input`:`#tva_${o}`).val(s.value),i.styleIframeElements(`.tva_${o}`,r,l),this.changeModelTemplateValue(o,parseInt(l))},checkboxInput:function(e,t){const s=t.getAttribute("name");this.changeModelTemplateValue(s,Number(t.checked)),i.collapse(this.model.get("template"))},changeText:function(e,t){const s=t.getAttribute("name");i.changeText(`.tva_${s}`,t.value),this.changeModelTemplateValue(s,t.value)},changeAttribute:function(e,t){const s=t.getAttribute("name"),n=t.getAttribute("data-attr-name");i.changeAttr(`.tva_${s}`,n,t.value),this.changeModelTemplateValue(s,t.value)},modifySettingsView:function(e,t){this.save().always((()=>{this.changeView(`#${t.getAttribute("data-state")}`)}))},toggleSettingsCard:function(e){return t(e.currentTarget).closest(".tva-settings-card").siblings().removeClass("open").end().toggleClass("open"),!1},save:function(e){return TVE_Dash.showLoader(),new o({key:"template",value:this.model.get("template")}).save().success((()=>{e&&TVE_Dash.hideLoader()})).error((()=>{TVE_Dash.hideLoader()}))}})}(jQuery)},45849:function(e){var t;t=jQuery,e.exports={_api:"https://www.googleapis.com/webfonts/v1/webfonts",_key:"AIzaSyDJhU1bXm2YTz_c4VpWZrAyspOS37Nn-kI",generate_link:function(e){const t=[];return t.push("//fonts.googleapis.com/css?family="),t.push(e.family.replace(/ /g,"+")),t.push(":"),t.push(e.variants.join(",")),t.push("&subset="),t.push(e.subset),t.join("")},get_google_fonts:function(){let e=TVA.Utils.LocalStorage.get("ta_google_fonts");return e&&e.length||(t.ajax({method:"GET",url:this._api,dataType:"json",async:!1,cache:!0,data:{key:this._key}}).done((function(t){e=t.items||[]})).fail((function(){e=[]})),TVA.Utils.LocalStorage.set("ta_google_fonts",e)),e}}},47233:function(e,t,s){!function(t){const i=s(71318),n=s(27012);e.exports=i.extend({template:TVE_Dash.tpl("design/fonts/google"),variants:{bold:[],regular:[]},afterRender:function(){this.$regular=this.$("#tva-regular-select").empty(),this.$bold=this.$("#tva-bold-select").empty(),this.$charset=this.$("#tva-charset-select").empty();const e=this.model.get("template").font_family;return this.renderVariants(e),this.renderCharset(e),this},renderVariants:function(e=""){this.variants.bold=[],this.variants.regular=[];const s=this._getFontObj(e);s&&Array.isArray(s.variants)&&s.variants.forEach((e=>{-1===e.indexOf("italic")&&("bold"===e||/^-?\d+$/.test(e)&&parseInt(e)>400?this.variants.bold.push(e):this.variants.regular.push(e))})),Object.keys(this.variants).forEach((e=>{if(0===this.variants[e].length)this["$"+e].parent().hide();else{this["$"+e].empty().parent().show();const s=this.model.get("template")[`font_${e}`];this.variants[e].forEach((i=>{const n=t("<option/>"),o={value:i};s===i&&(o.selected=!0),n.attr(o).text(i),this["$"+e].append(n)}))}}))},renderCharset:function(e=""){const s=this._getFontObj(e);if(s&&Array.isArray(s.subsets)&&s.subsets.length){this.$charset.empty().parent().show();const e=this.model.get("template").font_charset;s.subsets.forEach((s=>{const i=t("<option/>"),n={value:s};e===s&&(n.selected=!0),i.attr(n).text(s),this.$charset.append(i)}))}else this.$charset.parent().hide()},changeFont:function(e,t){i.prototype.changeFont.apply(this,arguments),this.renderVariants(t.value),this.renderCharset(t.value),this.model.get("template").font_regular=this.$regular.val(),this.model.get("template").font_bold=this.$bold.val(),this.model.get("template").font_charset=this.$charset.val(),this._applyFont(),TVE_Dash.materialize(this.$el)},changeFontProperty:function(e,t){this.model.get("template")[t.getAttribute("data-template-font-prop")]=t.value,this._applyFont()},_applyFont:function(){const e={family:this.model.get("template").font_family,variants:[this.model.get("template").font_regular,this.model.get("template").font_bold],subset:this.model.get("template").font_charset};this.model.get("template").font_url=TVA.Utils.FontManager.generate_link(e),n.addFontToHead(this.model.get("template").font_url)},_getFontObj:function(e=""){return this.fonts.find((t=>t.family===e))||null}})}(jQuery)},71318:function(e,t,s){!function(t){const i=s(2921),n=s(27012);e.exports=i.extend({template:TVE_Dash.tpl("design/fonts/safe"),fonts:[],selectors:["body a","body p","body h1","body h2","body h3","body h4","body h5","body span","body strong"],initialize:function(e){i.prototype.initialize.apply(this,arguments),this.fonts=e.fonts,this.render();const s=this.$(".tva-fonts-select");this.fonts.forEach((i=>{const n=t("<option/>"),o={value:i.family};e.selected===i.family&&(o.selected=!0),n.attr(o).text(i.family),s.append(n)}))},changeFont:function(e,t){this.model.get("template").font_family=t.value,this.selectors.forEach((e=>{n.styleIframeElements(e,"font-family",t.value)}))},removeEventsFromView:function(){this.undelegateEvents(),this.$el.removeData().unbind()}})}(jQuery)},65653:function(e,t,s){const i=s(75243);e.exports=i.extend({template:TVE_Dash.tpl("design/index"),initialize:function(e){this.available_settings=e.available_settings,i.prototype.initialize.apply(this,arguments)},render:function(){return this.$el.empty().html(this.template({template:this.model.get("template"),available_settings:this.available_settings})),this}})},36441:function(e,t,s){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("design/preview"),initialize:function(){i.prototype.initialize.apply(this,arguments),this.render()},render:function(){let e=this.getPreviewBaseUrl().replace(/^https?\:/i,"");return e+=-1===e.indexOf("?")?"?":"&",e+=`tpl=${this.model.get("template").ID}&`,e+=this.model.get("advanced")?"tva_advanced=1&":"",this.$el.html(this.template({url:e})),this},getPreviewBaseUrl:function(){return"design-legacy/index"===Backbone.history.getFragment()?TVA.indexPageModel.get("preview_url"):TVA.Utils.getPreviewUrl()}})},53416:function(e,t,s){e.exports=s(2921).extend({template:TVE_Dash.tpl("design/new/skin-filters"),afterInitialize:function(){this.listenTo(this.model,"tva_dash:filter",this.render),this.listenTo(this.model,"tva_dash:filterByModel",this.filterByModel)},before_render:function(){this.counter=0},after_render:function(){this.$filterTitle=this.$(".templates-title"),this.$counter=this.$(".templates-counter")},toggleDropdown:function(){this.$(".ttd-dropdown-w-count").toggleClass("ttd-dwc-selected")},mainFilter:function(e){const t=e.currentTarget.dataset.template;this.toggleDropdown(),this.model.setOptions({title:t,template:t})},filterByModel:function(e){const t={title:"",template:""};e.isHomepage()?t.title=t.template="homepage":e.isLesson()?t.title=t.template="lesson":e.isModule()?t.title=t.template="module":e.isCourse()?t.title=t.template="course":e.isCompleted()&&(t.title=t.template="course_completed"),this.model.setOptions(t)}})},34500:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(51135);e.exports=i.extend({template:TVE_Dash.tpl("design/new/skin-item"),className:"tva-skin-item-screen",afterInitialize:function(e){this.model=TVA.skins.findWhere({term_id:parseInt(e.id)}),this.model||(console.warn("Invalid skin ID"),this.template=t.noop),this.listenTo(TVA.skins,"sync",(()=>{this.skip_render_one||(this.model=TVA.skins.findWhere({term_id:parseInt(e.id)}),this.render()),delete this.skip_render_one})),t(window).one("typographyloaded",(e=>{this.$(".ttd-typography-content").css("height",25+e.detail.frame_height+"px")})).off("message.typography").on("message.typography",(e=>{var t;const s=e.originalEvent;s.isTrusted&&"ttb-typography-saved"===(null===(t=s.data)||void 0===t?void 0:t.action)&&this.reloadTypographyPreview()}))},afterRender:function(){this.$(".tva-skin-item-active-label").html(this.model.isActive()?'<span class="tva-published">Published</span>':'<span class="tva-unpublished">Not published</span>'),this.$(".tva-skin-not-publish-display").toggle(!this.model.isActive());const e=this.$(".ttd-typography-block").tvaToggleLoader(20,!0);this.$typographyFrame=this.$("iframe").on("load",(()=>e.tvaToggleLoader(!1))).on("preload",(()=>e.tvaToggleLoader(20,!0)))},rename:function(){this.$(".tva-skin-name").tvaInlineEdit({validation_fn:e=>!TVA.skins.getByName(e)||(TVE_Dash.err(TVA.t.skin_invalid_name.replace("{name}",`<strong>${e}</strong>`)),!1)}).one("change",((e,t)=>{this.model.set("name",t),this.model.save(null,{silent:!0})}))},back:function(){this.changeView("design")},publish:function(){TVA.Utils.confirmation(n(n({},TVA.t.skin_publish_confirmation),{},{title:TVA.t.skin_publish_confirmation.title.replace("{title}",`<strong>${this.model.get("name")}</strong>`),yesClass:"tva-modal-btn-blue"})).then((()=>{TVE_Dash.showLoader(!0),TVA.skins.setDefaultSkin(this.model).then((()=>{TVE_Dash.success(TVA.t.skin_published.replace("{name}",`<strong>${this.model.get("name")}</strong>`),3e3),TVE_Dash.hideLoader()}))}))},reloadTypographyPreview:function(){this.$typographyFrame.trigger("preload").attr("src",this.$typographyFrame.attr("src"))},changeInheritTypography:function(e){this.skip_render_one=!0,this.model.set({inherit_typography:e.currentTarget.checked},{silent:!0}),this.model.patch("inherit-typography",{value:e.currentTarget.checked?1:0}),this.$(".ttd-typography-block").toggle(!this.model.inheritTypography())},toggleTypography:function(){const e=this.$(".ttd-typography-block").toggleClass("ttd-block-expand").hasClass("ttd-block-expand");this.$(".height-toggle .text").html(e?"COLLAPSE":"EXPAND")},resetTypography:function(){TVA.Utils.confirmation(TVA.t.typography_reset_confirmation).then((()=>{this.$typographyFrame.trigger("preload"),this.model.patch("reset-typography").then((()=>{this.reloadTypographyPreview(),TVE_Dash.success(TVA.t.typography_reset_done)}))}))}})}(jQuery)},58849:function(e,t,s){const i=s(64006);e.exports=s(2921).extend({template:TVE_Dash.tpl("design/new/skin-template-item"),className:"theme-template",afterInitialize:function(e){this.optionsTooltip=e.optionsTooltip,this.filterModel=e.filterModel,this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change",this.render),this.el.addEventListener("mouseleave",(()=>this.el.classList.remove("tooltip-open")))},afterRender:function(){this.$el.css("order",this.model.getOrder()).attr("data-primary",this.model.primary()).attr("data-secondary",this.model.secondary())},delete:function(){TVA.Utils.confirmation(TVA.t.skin_template_delete_confirmation).then((()=>{this.model.destroy()}))},reset:function(){TVA.Utils.confirmation(TVA.t.skin_template_reset_confirmation).then((()=>{this.model.save({action:"reset_template"},{wait:!0,success:()=>{TVE_Dash.success("Template has been <b>reset</b> to default.")}})}))},editTitle:function(){this.$(".template-name").tvaInlineEdit().one("change",((e,t)=>{this.model.save({post_title:t,action:"update_fields",fields:{post_title:t}},{wait:!0,success:()=>this.render()&&TVE_Dash.success("Title <b>changed</b> successfully!"),error:()=>TVE_Dash.err("Error saving the title!","error")})})),this.$el.removeClass("tooltip-open")},makeDefault:function(){if(1===parseInt(this.model.meta("default")))return!1;this.model.meta("default",1),this.model.save({action:"make_default"},{wait:!0,success:()=>{this.collection.forEach((e=>{this.model.get("ID")!==e.get("ID")&&this.model.primary()===e.primary()&&this.model.secondary()===e.secondary()&&this.model.format()===e.format()&&(e.meta("default",0),e.trigger("change",e))})),this.render(),TVE_Dash.success("The template is now <b>default</b> !")},error:()=>{TVE_Dash.err("Error making template default!")}})},duplicate:function(){const e=new i({meta_input:{primary_template:this.model.primary(),secondary_template:this.model.secondary(),format:this.model.format(),default:0},thumbnail:this.model.get("thumbnail"),post_title:`Copy of ${this.model.get("post_title")}`});e.skin_id=this.model.collection.skin_id,e.save({inherit_from:this.model.get("ID")},{wait:!0,success:(t,s)=>{this.filterModel.trigger("tva_dash:filterByModel",e),this.model.collection.reset(s),TVE_Dash.success("Template <b>duplicated</b> successfully!")},error:function(){TVE_Dash.err("Error creating template!")}})},showOptionsTooltip:function(){this.optionsTooltip.$(".ttd-template-preview-url").toggleClass("tva-hide",!this.model.canPreview()),this.optionsTooltip.$('.ttd-tooltip-row[data-fn="delete"]').toggleClass("default",!this.model.canDelete()),this.optionsTooltip.$('.ttd-tooltip-row[data-fn="makeDefault"]').toggleClass("default",!this.model.canMakeDefault()),this.optionsTooltip.$(".ttd-template-preview-url").attr("href",this.model.get("preview_url")),this.$el.append(this.optionsTooltip.$el.css({bottom:70})),this.$el.toggleClass("tooltip-open")}})},98404:function(e,t,s){!function(t){const i=s(51135),n=s(3063),o=s(58849),r=s(64006),a=s(53416),l=s(56298),c=s(2921).extend({tagName:"div",className:"tcb-template-options-tooltip",template:"design/new/options-tooltip"});e.exports=i.extend({skin_id:null,filterModel:null,template:TVE_Dash.tpl("design/new/skin-item-templates"),afterInitialize:function(e){this.skin_id=parseInt(e.id),this.model=TVA.skins.findWhere({term_id:this.skin_id}),this.filterModel=new l({}),this.optionsTooltip=(new c).render(),this.model||(console.warn("Invalid skin ID"),this.template=t.noop),this.listenTo(this.model.get("templates"),"reset remove",this.render),this.listenTo(this.filterModel,"tva_dash:filter",this.renderTemplates)},afterRender:function(){this.$list=this.$(".ttd-templates-inner"),this.$settings=this.$(".ttd-settings-container"),this.renderTemplates(),this.$(".ttd-settings-container").prepend(new a({model:this.filterModel}).render().$el)},renderTemplates:function(){this.$list.empty();const e=this.model.get("templates").filterItems(this.filterModel.get("template"));this.filterModel.setOptions({counter:e.length},!0),e.forEach((e=>{const t=new o({model:e,filterModel:this.filterModel,collection:this.model.get("templates"),optionsTooltip:this.optionsTooltip});if(this.$list.append(t.render().$el),e.isJustAdded()){if(!TVA.Utils.is_in_viewport(t.el)){const e=60,s=t.el.getBoundingClientRect().top-e;window.scrollTo({top:s,behavior:"smooth"})}t.$el.addClass("ttd-just-added"),setTimeout((()=>t.$el.removeClass("ttd-just-added")),5e3),e.set("just_added",0)}}))},addTemplate:function(){this.openModal(n,{width:"808px",top:"10%",model:new r,filterModel:this.filterModel,collection:this.model.get("templates"),skin_id:this.skin_id,className:"tvd-modal tva-skin-template-modal"})},back:function(){TVA.Router.navigate(`#design/${this.skin_id}`,{trigger:!0})}})}(jQuery)},31597:function(e,t,s){!function(t){const i=s(27012),n=s(75243),o={safe:s(71318),google:s(47233)};TVA.Utils.FontManager=s(45849),e.exports=n.extend({template:TVE_Dash.tpl("design/template"),templateData:{},fontOptions:{safe:TVA.t.design_tab.fonts.safe,google:TVA.t.design_tab.fonts.google},initialize:function(){TVA.design.fonts.google=TVA.Utils.FontManager.get_google_fonts(),this.frame=wp.media({title:"Select or Upload Your Logo",button:{text:"Use this logo"},multiple:!1,library:{type:"image"}}),this.frame.on("select",(()=>{const e=this.frame.state().get("selection").first().toJSON();0===i.getLogo().length&&i.addImageLogo(),i.changeLogo({src:e.url},{width:`${this.model.get("template").logo_size||300}px`,"max-width":"600px","max-height":"300px"}),this.model.get("template").logo_type=!1,this.model.get("template").logo_url=e.url,this.render(),this.$(".tva-logo-image").closest(".tva-settings-card").find(".tva-settings-card-title").trigger("click"),TVE_Dash.materialize(this.$el)})),n.prototype.initialize.apply(this,arguments)},render:function(){this.$el.empty().html(this.template({model:this.model})),this.templateData=this.model.get("template"),Object.keys(this.fontOptions).forEach((e=>{const s=t("<option/>"),i={value:e};this.templateData.font_source===e&&(i.selected=!0),s.attr(i).text(this.fontOptions[e]),this.$("#tva-fonts-source").append(s)})),this.renderFonts(null,{value:this.templateData.font_source}),this.$(".tva-logo-text")[this.templateData.logo_type?"show":"hide"](),this.$(".tva-logo-image")[this.templateData.logo_type?"hide":"show"](),this.$(".tva-logo-input, .tva-change-logo-button")[this.templateData.logo_type?"hide":"show"]();const e=this.$("#tva-main-color-select").attr("name");return this.$("#tva-main-color-select").spectrum({type:"component",showPalette:!1,showAlpha:!1,allowEmpty:!1,chooseText:"Apply",change:t=>{this.model.get("template")[e]=t?t.toHexString():""},move:t=>{const s=t?t.toHexString():"";i.changeMainColorCallback(e,s)},cancel:t=>{const s=t?t.toHexString():"";i.changeMainColorCallback(e,s)}}),this.$("#tva-main-color-select").on("input",(t=>{/^#([0-9A-F]{3}){1,2}$/i.test(t.target.value)&&(this.model.get("template")[e]=t.target.value)})),this},renderFonts:function(e,t){const s=t.value;o[s]&&(this.fontView instanceof Backbone.View&&this.fontView.removeEventsFromView(),this.fontView=new o[s]({el:this.$("#tva-fonts"),fonts:TVA.design.fonts[s],model:this.model,selected:this.templateData.font_family}),e&&this.fontView instanceof Backbone.View&&(this.model.get("template").font_source=s,this.fontView.$(".tva-fonts-select").trigger("change"),TVE_Dash.materialize(this.fontView.$el)))},changeLogo:function(){this.frame.open()},changeLogoType:function(e,t){this.model.get("template").logo_type=t.checked,this.model.get("template").logo_url="",i.getIframe().find(".lg").empty(),this.$(".tva-logo-image input, #tva-logo-text").val(""),this.$(".tva-logo-input, .tva-change-logo-button").toggle(!t.checked),this.$(".tva-logo-text").toggle(t.checked),this.$(".tva-logo-image").toggle(!t.checked),t.checked&&(this.model.get("template").logo_size=50,this.$("#tva_logo_size_input,#tva_logo_size").val(this.model.get("template").logo_size))},sliderInput:function(e,t){n.prototype.sliderInput.apply(this,arguments),"logo_size"===t.getAttribute("name")&&(i.styleIframeElements(".tva-img-logo","width",`${t.value}px`),this.model.get("template").logo_type&&i.styleIframeElements(".header-logo > a,.header-logo > a > .tva_text_logo_size","font-size",`${t.value}px`))},changeLogoText:function(e,t){i.changeText(".lg",t.value),i.styleIframeElements(".lg","font-size",`${this.model.get("template").logo_size}px`),i.styleIframeElements(".lg","color",this.model.get("template").main_color),this.model.get("template").logo_url=t.value}})}(jQuery)},27012:function(e){var t;t=jQuery,e.exports={getIframe:function(){return t("iframe#tva_frame").contents()},iframeLoaded:function(){this.getIframe().find('a, input[type="submit"]').on("click",(e=>{e.preventDefault()}))},addImageLogo:function(){t("<img />",{class:"tva-img-logo tva-resize-img"}).appendTo(this.getIframe().find(".lg"))},getLogo:function(){return this.getIframe().find(".lg img")},changeLogo:function(e={},t={}){this.getLogo().attr(e).css(t)},changeText:function(e,t){this.getIframe().find(e).text(t)},changeAttr:function(e,t,s){this.getIframe().find(e).attr(t,s)},styleIframeElements:function(e,t,s){const i={};i[t]=s,this.getIframe().find(e).css(i)},addFontToHead:function(e){this.getIframe().find("#tva_google_font").remove(),this.getIframe().find("head").append(`<link rel="stylesheet" id="tva_google_font" href="${e}" type="text/css" media="all">`)},changeMainColorCallback:function(e,s){this.styleIframeElements(`.tva_${e}`,"color",s),this.styleIframeElements(`.tva_${e}`,"fill",s),this.styleIframeElements(`.tva_${e}_bg, header.tva-header ul.menu > li.h-cta`,"background-color",s),this.styleIframeElements(".tva-sidebar-container ul a","color",s),this.styleIframeElements(".tva_text_logo_size, a.lg","color",s),this.getIframe().find(".tva-cm-redesigned-breadcrumbs ul li a").hover((function(){t(this).css("color",s)}),(function(){t(this).css("color","#666666")}))},collapse:function(e={}){const s=window.inner_jQuery(this.getIframe());s.find(".tva-cm-container .tve-chapters-wrapper, .tva-cm-container .tve-lessons-wrapper").slideDown(),s.find(".tva-cm-container").tva_collapsible(t.extend({collapse_modules:0,collapse_chapters:0},e))}}},57470:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(51135),a=s(68478),l=s(17438);e.exports=r.extend({template:"design/wizard",className:"ta-wizard-container p-0",id:"tva-wizard",popupCoords:{top:0,left:"50%"},render:function(){return TVE_Dash.showLoader(),this.model.$$fetched?r.prototype.render.apply(this,arguments):(this.model.fetch().then((()=>{this.model.setOriginalData(),this.model.loadStepTemplates()})).fail((e=>TVE_Dash.err(e.responseJSON.message||"Something went wrong"))).always((()=>this.render())),this)},afterInitialize:function(e){this.model=TVA.skins.getWizard(e.id),this.model.on("ajax-done",(e=>{["school","course","module","lesson"].includes(e)&&this.skin.refreshTemplates()})),this.skin=TVA.skins.get(e.id),this.id="tva-wizard",this.$el.attr("id","tva-wizard"),window.TVA.wizardView=this,this.top=new l({model:this.model,skin:this.skin}),this.sidebar=new a({model:this.model,skin:this.skin}),this.addChild(this.sidebar,this.top),this.top.parent=this,this.model.on("step-change",this.onStepChange.bind(this)),this.model.on("finished",(()=>{this.loadPreview()})),this.model.on("templates-loaded",(e=>{const t=this.model.get("active");if(e.length){const s=this.model.getPreviewTemplateId(),i=this.model.getPreviewTemplateSource();this.previewTemplate({id:s||e[0].id,source:i||e[0].source,previewedStep:t},!1)}})),TVA.$eventBus.off("page_keyup.wizard").on("page_keyup.wizard",this.onKeyup.bind(this))},afterRender:function(){this.$dom={wrapper:this.$(".ttd-wizard-content"),frame:this.$("#wizard-frame"),container:this.$(".ttd-wizard-frame-container"),welcome:this.$(".ttd-wizard-welcome"),overlay:this.$(".ttd-wizard-frame-overlay"),nav:this.$(".ttd-template-nav")},this.top.setElement(this.$("#ttd-wizard-top")),this.top.render(),this.sidebar.setElement(this.$("#tva-wizard-sidebar")),this.sidebar.render(),this.loadPreview()},start:function(){return this.model.start(),!1},onStepChange:function(e,t){this.$dom.wrapper.removeClass(((e,t)=>t.split(" ").filter((e=>0===e.indexOf("step-"))).join(" "))).addClass(`step-${e.id}`),t&&t.id!==e.id&&this.$dom.overlay.empty(),this.loadPreview()},loadPreview:function(e=this.model.getFrameURL()){let t=this.$dom.frame.attr("src");t&&(t=t.replace(/(\\?|&)_=(\d+)/,"",e)),e&&t!==e?(e=TVA.Utils.buildUrl(e,{_:String((new Date).getTime())}),this.$dom.nav.hide(),this.loading(),this.$dom.frame.attr("src",e).one("load",(()=>{setTimeout(this.loading.bind(this,!1),300)}))):this.buildOverlay()},buildOverlay:function(){if(!this.iframeData)return;setTimeout((()=>TVE_Dash.hideLoader()),300),this.top.render(),this.$dom.overlay.empty();const e=this.getStepOverlay();e instanceof Backbone.View?("function"==typeof e.beforeMainRender&&e.beforeMainRender(this),e.setElement(this.$dom.overlay),e.parent=this,e.render()):this.$dom.overlay.html(e).toggle(!!e),!this.model.isStepCompleted()&&this.model.getPreviewTemplateId()?this.$dom.nav.show().filter(".btn-prev").toggleClass("disabled",!this.model.hasAdjacentTemplate("prev")).end().filter(".btn-next").toggleClass("disabled",!this.model.hasAdjacentTemplate("next")):this.$dom.nav.hide(),this.showTooltip(),this.contentClass()},loading:function(e=!0){e?TVE_Dash.showLoader(!0):TVE_Dash.hideLoader()},getStepOverlay:function(){let e;if(this.$dom.overlay.removeAttr("style"),this.model.isStarted())if(this.model.isFinished())e="design/wizard/overlay-finished";else{let t=this.model.getCurrentStep();t||(t=this.model.getNextAvailableStep(),this.model.set({active:t.id,activeIndex:this.model.getNextAvailableStepIndex()},{silent:!0}));const i=t.id;e="";let n=`calc(50% + ${this.iframeData.headerHeight/2}px)`,o=`${this.iframeData.scrollWidth||0}px`;switch(this.popupCoords.top=`${this.iframeData.headerHeight+50}px`,i){case"logo":e=s(847);break;case"color":e=s(10245);break;case"header":this.$dom.overlay.css("margin-top",this.iframeData.headerHeight),n=this.iframeData.headerHeight/2+"px";break;case"footer":this.$dom.overlay.css("bottom",this.iframeData.footerHeight+"px"),n=`calc(100% - ${this.iframeData.footerHeight/2}px)`,this.popupCoords.top=`calc(100% - ${this.iframeData.footerHeight+250}px)`;break;case"menu":e=s(51616);break;case"sidebar":o=`calc(100% - ${this.iframeData.sidebarWidth}px - ${this.iframeData.scrollWidth||0}px)`}this.$dom.nav.css({top:n}).filter(".btn-next").css({right:o})}else e="design/wizard/overlay-welcome";return!e||e instanceof Backbone.View||(e=TVE_Dash.tpl(e)({view:this,data:this.iframeData,skin:this.skin,wizard:this.model})),e},clickSaveTemplate:function(){return this.saveTemplate(),!1},saveTemplate:function(){var e;this.hideTooltip();const t=Number(this.model.getPreviewTemplateId()),s=this.skin.getTemplates().get(t);s&&s.setDefault(),(null===(e=this.model.getCurrentStep())||void 0===e?void 0:e.delayNextStep)&&TVE_Dash.showLoader(),this.model.completeStep()},onNavigationArrowClick:function(e,t){const s=t.dataset.direction;this.displayAdjacentTemplate(s)},displayAdjacentTemplate:function(e){return this.model.hasAdjacentTemplate(e)&&this.previewTemplate({id:this.model.getAdjacentTemplateId(e),source:this.model.getAdjacentTemplateSource(e)}),!1},onKeyup:function(e){switch(e.which){case 37:this.displayAdjacentTemplate("prev");break;case 39:this.displayAdjacentTemplate("next")}},hideTooltip:function(e=!1){const t=this.$("#ttd-step-tooltip");e?(t.addClass("ttd-out"),setTimeout((()=>t.removeClass("ttd-visible ttd-out")),1e3)):t.removeClass("ttd-visible")},showTooltip:function(){this.hideTooltip();const e=this.model.getPopupMessage();if((!this.lastHoveredElement||!this.lastHoveredElement.closest("#template-selector"))&&e&&!TVA.Utils.isTooltipViewed("wizard-select")){const t=this.top.$(".selector-btn");this.$("#ttd-step-tooltip").addClass("ttd-visible").css({right:`${(t.outerWidth()||0)+15}px`}).find(".tt-message").html(e)}},tooltipNeverShow:function(){return this.hideTooltip(!0),TVA.Utils.saveTooltips("wizard-select"),!1},dismissTooltipOnMouseenter:function(){this.hideTooltip(!0)},previewTemplate:function(e,t=!0){const s=()=>{let t=!0;return e.previewedStep&&(t=e.previewedStep===this.model.get("active")),t};if(this.templateLoading||!s())return;if(void 0===this.iframeAPI)return setTimeout(this.previewTemplate.bind(this,e,t),200);const i=this.model.getStepKey("previewMode");this.templateLoading=!0,this.$(".template-loading").addClass("ttd-loading"),"iframe"!==i?this.iframeAPI.getPreviewElement().addClass("ttb-loading"):TVE_Dash.showLoader(),this.model.selectTemplate(e).then((n=>{if(delete this.templateLoading,t&&this.hideTooltip(),s()&&"iframe"!==i){if(void 0===this.iframeAPI)return setTimeout(this.previewTemplate.bind(this,e,t),200);this.iframeAPI.inlinePreview(n)}}))},contentClass:function(){let e=this.model.get("active");this.model.isFinished()&&(e="finished"),this.$dom.wrapper.removeClass(((e,t)=>t.split(" ").filter((e=>e.startsWith("step-")||e.startsWith("home--"))).join(" "))).addClass(`step-${e||"welcome"}`)},publishSkin:function(){TVA.Utils.confirmation(n(n({},TVA.t.skin_publish_confirmation),{},{title:TVA.t.skin_publish_confirmation.title.replace("{title}",`<strong>${this.skin.get("name")}</strong>`),yesClass:"tva-modal-btn-blue"})).then((()=>{TVA.skins.setDefaultSkin(this.skin).then((()=>{TVE_Dash.success(TVA.t.skin_published.replace("{name}",`<strong>${this.skin.get("name")}</strong>`),3e3),TVA.Router.navigate(`#design/${this.skin.get("term_id")}/skin-templates`,{trigger:!0})}))}))},recordMouseOver:function(e){this.lastHoveredElement=e.target},gotoCourses:function(){jQuery('[data-route="#courses"]').trigger("click")}})},10245:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let o;const r=s(86171),a=s(2921).extend({template:"design/wizard/overlay-color",shareColor:0,beforeMainRender:function(e){this.wizard=e.model,this.shareColor=parseInt(this.wizard.get("share_color")),this.data=this.wizard.globals.colors},afterRender:function(){const e={preferredFormat:"hex",showInput:!0,alpha_input:!0,showAlpha:!0,allowAlpha:!0,cancelText:"CANCEL",chooseText:"APPLY",saveOnApply:!1,appendTo:"#wizard-spectrum-container",showPalette:!1,change:this.change.bind(this)};o=this.$("#ttd-skin-color-picker").spectrum(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e)),o.on("hue.changed.spectrum",((e,t)=>{})),o.on("show.spectrum",(()=>{this.$(".sp-picker-container .tva-share-color-cp-warning").remove(),this.shareColor&&this.$(".sp-picker-container").prepend('<div class="tva-share-color-cp-warning">This color is linked to Thrive Theme Builder. Changing it here will also change the brand color of your theme.</div>')})),this.toggleShareColorSign(this.shareColor),this.shareColor&&this.$(".sp-colorize").css("background-color",this.getThemeHSLColorCode())},change:function(e){if(e){const t=e.toHsl(),s={h:parseInt(t.h),s:Number(Math.round(parseFloat(t.s)+"e2")+"e-2"),l:Number(Math.round(parseFloat(t.l)+"e2")+"e-2"),a:t.a};this.data.hsl_code=s,this.shareColor&&(document.documentElement.style.setProperty("--tcb-theme-main-master-h",t.h),document.documentElement.style.setProperty("--tcb-theme-main-master-s",`${parseInt(100*t.s)}%`),document.documentElement.style.setProperty("--tcb-theme-main-master-l",`${parseInt(100*t.l)}%`),document.documentElement.style.setProperty("--tcb-theme-main-master-a",t.a))}},shareThemeColor:function(e,t){if(new r({key:"share_ttb_color",value:Number(t.checked)}).save(),this.toggleShareColorSign(t.checked),this.shareColor=Number(t.checked),t.checked){const e=getComputedStyle(document.documentElement),t=parseInt(e.getPropertyValue("--tcb-theme-main-master-h")),s=parseInt(e.getPropertyValue("--tcb-theme-main-master-s")),i=parseInt(e.getPropertyValue("--tcb-theme-main-master-l")),n=e.getPropertyValue("--tcb-theme-main-master-a"),o=`hsl(${t},${s}%,${i}%)`;this.$(".sp-colorize").css("background-color",o),this.$("#ttd-skin-color-picker").spectrum("set",o),this.data.hsl_code={h:t,s:Number(s/100),l:Number(i/100),a:n}}},getThemeHSLColorCode:function(){const e=getComputedStyle(document.documentElement);return`hsl(${parseInt(e.getPropertyValue("--tcb-theme-main-master-h"))},${parseInt(e.getPropertyValue("--tcb-theme-main-master-s"))}%,${parseInt(e.getPropertyValue("--tcb-theme-main-master-l"))}%)`},toggleShareColorSign:function(e){this.$(".sp-colorize-container").toggleClass("tva-shared-brand-color",!!e)},clickNext:function(){return this.parent.loading(),this.wizard.setStepData({save_data:this.data},!0).completeStep(!1),!1}});e.exports=new a},847:function(e,t,s){!function(t){let i;const n=s(2921).extend({template:"design/wizard/overlay-logo",beforeMainRender:function(e){this.wizard=e.model,this.logos=e.model.deepGet("settings.logo",{}),this.logoDark=this.logos.dark,this.logoLight=this.logos.light,this.model.set({attachment_light_id:this.logoLight.attachment_id,light_src:this.logoLight.src,attachment_dark_id:this.logoDark.attachment_id,dark_src:this.logoDark.src},{silent:!0})},afterInitialize:function(){this.model=new Backbone.Model({attachment_id:"",src:""}),i=i||wp.media({title:"Select or upload an image",button:{text:"Use this image"},library:{type:"image"}}),i.on("select",(()=>{const e=i.state().get("selection").first().toJSON(),t=this.model.get("opened");this.$(".logo-"+t).css("background-image","url("+e.url+")"),"light"!==t&&"default"!==t||this.model.set({attachment_light_id:e.id,light_src:e.url},{silent:!0}),"dark"!==t&&"default"!==t||this.model.set({attachment_dark_id:e.id,dark_src:e.url},{silent:!0}),"default"===t&&(this.logoDark.attachment_id=this.logoLight.attachment_id=this.model.get("attachment_dark_id"),this.logoDark.src=this.logoLight.src=this.model.get("dark_src"),this.wizard.setStepData({dark_id:this.model.get("attachment_dark_id")},!0),this.wizard.setStepData({light_id:this.model.get("attachment_dark_id")},!0),this.render())})),this.listenTo(this.model,"change:src",this.render)},getRenderParams:function(){return this.model.set({attachment_id:this.logoDark.attachment_id||"",src:this.logoDark.src||""},{silent:!0}),{model:this.model}},afterRender:function(){const e=this;this.$(".logo-light, .logo-dark").hover((function(){t(this).children().toggle()})),""===this.logos.tva_logo_tooltip&&setTimeout((()=>{this.$(".ttb-mega-tooltip").addClass("ttb-tooltip-visible")}),100),this.$(".ttb-mega-tooltip-acknowledge").click((function(){e.logos.tva_logo_tooltip=1,t(this).parent().parent().hide(),wp.apiRequest({type:"post",url:`${TVA.routes.settings_v2}/user-meta`,data:{meta_key:"tva_logo_tooltip",meta_value:1}})}));const s=this.logos.preview_url.src.replace(/\\/g,"/");this.$(".logo-default").css("background-image",'url("'+s+'")'),parseInt(this.logoDark.attachment_id)&&this.$(".logo-button").css("background-image","url("+this.logoDark.src+")"),parseInt(this.logoLight.attachment_id)&&this.$(".logo-light").css("background-image","url("+this.logoLight.src+")")},openMedia:function(e){const t=e.currentTarget.classList;t.contains("logo-light")?this.model.set("opened","light"):t.contains("logo-default")||t.contains("upload-logo-text")?this.model.set("opened","default"):this.model.set("opened","dark"),i.open()},loaderTarget:function(){return this.$(".logo-button")},nextStep:function(){return this.parent.loading(),this.logoDark.attachment_id=this.model.get("attachment_dark_id")?this.model.get("attachment_dark_id"):this.model.get("attachment_id"),this.logoDark.src=this.model.get("dark_src")?this.model.get("dark_src"):this.model.get("src"),this.logoLight.attachment_id=this.model.get("attachment_light_id")?this.model.get("attachment_light_id"):this.model.get("attachment_id"),this.logoLight.src=this.model.get("light_src")?this.model.get("light_src"):this.model.get("src"),this.wizard.setStepData({1:this.logoDark},!0),this.wizard.setStepData({2:this.logoLight},!0).completeStep(!1),!1}});e.exports=new n}(jQuery)},51616:function(e,t,s){const i=s(2921).extend({id:"#ttd-wizard-menu",className:"ttd-wizard-menu ttd-d-flex",template:TVE_Dash.tpl("design/wizard/menu"),afterInitialize:function(){this.menus=[...TVA.menus,{id:-1,name:"I will choose later...",extra_class:" choose-later"}]},readSelectedMenus:function(){const e={id:0,name:"Choose a WordPress menu"},t=this.model.deepGet("settings.menu")||{};this.activeMenus={header:_.find(this.menus,(e=>e.id===parseInt(t.header)))||e,footer:_.find(this.menus,(e=>e.id===parseInt(t.footer)))||e}},beforeMainRender:function(e){this.model=e.model,this.readSelectedMenus()},toggleDropdown:function(e){e.currentTarget.classList.toggle("dropdown-visible")},selectItem:function(e){const t=e.currentTarget;this.$(`.selected-menu[data-target="${t.dataset.target}"]`).attr("data-id",t.dataset.id).html(t.innerHTML),this.activeMenus[t.dataset.target]={id:t.dataset.id,name:t.innerHTML}},finishMenu:function(e){return"1"===e.currentTarget.dataset.templates&&(this.activeMenus.header.id=this.activeMenus.footer.id=0),this.parent.loading(),this.model.setStepData({header:this.activeMenus.header.id||0,footer:this.activeMenus.footer.id||0}),this.model.completeStep(!1),!1}});e.exports=new i},68478:function(e,t,s){var i;i=jQuery,e.exports=s(2921).extend({template:"design/wizard/sidebar",stepTemplate:"design/wizard/sidebar/steps",afterInitialize:function(e){this.skin=e.skin,this.model.on("change",this.render.bind(this))},afterRender:function(){this.$dom={},this.model.sections.forEach((e=>this.$dom[e.id]=this.$(`#wizard-section-${e.id}`))),this.renderSteps(),this.$(".scrollbar-inner").scrollbar()},toggleCollapse:function(e,t){t.closest(".collapsible").classList.toggle("collapse"),i(t).next(".section-steps").slideToggle(200)},renderSteps:function(){let e=1;const t=TVE_Dash.tpl(this.stepTemplate);this.model.sections.forEach((s=>{const i=this.model.getSteps(s.id);this.$dom[s.id].html(t({view:this,steps:i,baseIndex:e})),e+=i.length}))},stepClick:function(e){this.model.gotoStep(e.currentTarget.dataset.step),TVA.wizardView.hideTooltip()},restart:function(){return this.model.isNew=()=>!1,TVE_Dash.showLoader(),this.model.destroy().then((()=>location.reload())),!1}})},45795:function(e,t,s){!function(){const t=s(2921);e.exports=t.extend({template:TVE_Dash.tpl("design/wizard/list-section"),afterInitialize:function(e){this.title=e.title,this.items=e.items,this.view=e.view},render:function(){let e="";_.each(this.items,(t=>{e+=this.view.item({model:this.view.model,item:t,itemClass:this.view.itemClass.replace(".","")})}));const t=this.template({title:this.title,sectionContent:e});return this.$el.html(t),this}})}()},17438:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(){const t=s(2921),i=s(79391);e.exports=t.extend({template:"design/wizard/top",structureModals:[],events:()=>n(n({},t.prototype.events),{},{"mousedown .ttd-wizard-selector *":()=>!1}),previousClick:function(e){e.isDefaultPrevented()||(this.parent.hideTooltip(!0),this.model.previous())},render:function(){return this.model.hasTopBar()?t.prototype.render.apply(this,arguments):(this.$el.html(""),this)},openTemplatesModal:function(){this.openModal(i,{model:this.model,className:"tvd-modal tvd-modal-templates"})},selectorClick:function(){return this.openTemplatesModal(),!1}})}()},76719:function(e,t,s){const i=s(2921),n=s(57790);e.exports=i.extend({template:TVE_Dash.tpl("drip/campaign/display"),className:"tva-relative",itemSummaryTemplate:TVE_Dash.tpl("drip/campaign/overview/unlock-summary"),afterInitialize:function(e){this.course=e.course,this.parentView=e.parent},setCampaign:function(e){this.model=this.campaign=e,this.render()},render:function(){return this.model&&(this.currentModuleIndex=0,i.prototype.render.apply(this,arguments),this.tooltipKey=`campaign_${this.model.get("id")}_unlock_conditions`,TVA.Utils.isTooltipViewed(this.tooltipKey)||0===this.course.getModulesAndLessons().length||(this.$tooltip=this.$(".tva-campaign-tooltip"),requestAnimationFrame((()=>this.showTooltip())))),this},getRenderParams:function(){return{model:this.model,publishedContent:this.course.getModulesAndLessons(!0)}},renderCourseItem:function(e){return"module"===e.getType()?(this.currentModuleIndex++,TVE_Dash.tpl("drip/campaign/overview/module")({view:this,module:e,currentModuleIndex:this.currentModuleIndex})):TVE_Dash.tpl("drip/campaign/overview/lesson")({view:this,lesson:e})},editUnlockSettings:function(e){const t=parseInt(e.currentTarget.dataset.contentId);return this.openModal(n,{post_id:t,campaign:this.campaign,course:this.course,className:"tvd-modal tva-drip-modal",width:"690px",openTrigger:!1,courseItem:this.course.get("structure").findItem(t)}).on("saved",this.render.bind(this)),!1},back:function(){this.parentView.render().listView()},renderUnlockSummary:function(e){var t;const s=this.campaign.getUnlockSummaryForContentId(e);return this.itemSummaryTemplate({unlockedLabel:this.campaign.getUnlockedLabel(),unlockedTooltip:this.campaign.getUnlockedTooltip(),mainView:this,total:(null===(t=s.items)||void 0===t?void 0:t.length)||0,state:s,contentId:e})},showTooltip:function(){const e=this.$(".tva-drip-unlock-summary").first(),t=e.offset(),s=this.$el.offset();e.addClass("no-hover"),this.$tooltip.addClass("ttd-visible").css({position:"absolute",left:`${parseInt(t.left-s.left-this.$tooltip.outerWidth(!0)/3)}px`,top:`${parseInt(t.top-s.top-this.$tooltip.outerHeight(!0)-10)}px`})},hideTooltip:function(){return this.$tooltip.addClass("ttd-out"),this.$(".tva-drip-unlock-summary").first().removeClass("no-hover"),setTimeout((()=>this.$tooltip.removeClass("ttd-visible ttd-out")),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},63181:function(e,t,s){const i=s(2921),n=s(91359),o=s(41027);e.exports=i.extend({template:TVE_Dash.tpl("drip/campaign/form-general"),className:"tva-drip-form",dynamicConditions:["trigger","schedule_type"],afterInitialize:function(e){this.course=e.course,this.listenTo(this.model,"change:content_type",(()=>{this.model.set("lock_from","",{silent:!0}),this.model.prefillLockFrom(this.course),this.renderModulesAndLessonsDropdown()})),this.listenTo(this.model,"invalid",(()=>{requestAnimationFrame((()=>{jQuery(".tvd-modal-content").prop("scrollTop",0)}),100)}).bind(this))},getContentTypeOptions:function(){const e=[];let t=!1,s=!1;this.course.getModulesAndLessons().forEach((i=>{t||"lesson"!==i.getType()||(e.push(`[value="${i.get("post_type")}"]`),t=!0),s||"module"!==i.getType()||(e.push(`[value="${i.get("post_type")}"]`),s=!0)}));const i=this.$courseItemOptions.filter(e.join(",")||".not-found");return 1===i.length&&this.model.set("content_type",i.val(),{silent:!0}),i},afterRender:function(){this.$courseItemOptions=this.$courseItemOptions||this.$('[data-bind="content_type"] option'),this.$contentSelect=this.$(".tva-content-select"),this.$('[data-bind="content_type"]').html(this.getContentTypeOptions()),this.renderModulesAndLessonsDropdown(),this.renderAdvancedSettings(),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select")),this.handleDynamicFields();const e=window.datepickerApi=n.renderPopup(this.$(".tva-popup-datepicker"),{model:this.model,prop:"unlock_date",active:"date",isInvalidDate:e=>wp.date.format("d-m-Y",e)!==wp.date.format("d-m-Y")&&!wp.date.isInTheFuture(e),onChange:function(e){t.setDate(e)}}),t=window.timepickerApi=n.renderInline(this.$(".tva-popup-timepicker"),{model:this.model,prop:"unlock_date",is12HourTime:!1,onChange:function(t){e.setDate(t)}})},handleDynamicFields:function(){const e=this.$(".tva-drip-dynamic").hide();_.each(this.dynamicConditions,(t=>{e.filter(`.${t}-${this.model.get(t)}`).show()})),this.schedule&&(this.schedule.destroy(),delete this.schedule),"repeating"===this.model.get("schedule_type")&&(this.schedule=o.renderTo(this.$(".tva-schedule-controls"),this.model.get("schedule_type"),this.model.get("schedule")),this.schedule.on("model-change",(()=>{this.model.set("schedule",this.getScheduleData(),{silent:!0}),this.model.trigger("settings-changed")}))),this.model.trigger("settings-changed")},getScheduleData:function(){var e;return(null===(e=this.schedule)||void 0===e?void 0:e.getData())||{e:1}},renderModulesAndLessonsDropdown:function(e="index"){let t="",s=this.model.get("lock_from");""!==s&&(s=parseInt(s));let i=1,n=1;const o=TVA.t[`drip_choose_${this.model.get("content_type")}`];t+=`<option value=""${""===s?" selected":""} disabled>${o}</option>`,this.course.getModulesAndLessons().forEach(((o,r)=>{if("tva_module"===this.model.get("content_type")&&"lesson"===o.getType())return;const a=s===o.get("ID")?" selected":"",l=this.model.get("content_type")!==o.get("post_type")?" disabled":"";let c;c="lesson"===o.getType()?`&nbsp;&nbsp;&nbsp;&nbsp;L${n++} &bull;`:`M${i++} &bull;`;const d="index"===e?r:o.get("ID");t+=`<option value="${d}"${a+l}>${c} ${_.escape(o.get("post_title"))}</option>`})),this.$contentSelect.html(t).trigger("change")},renderAdvancedSettings:function(){"sequential"===this.model.get("type")&&(this.$(".tva-drip-campaign-behaviour").removeClass("hidden"),this.$("#tva-drip-force-unlock-order").attr("checked","checked"),this.$("#tva-drip-display-locked").attr("checked","checked"),this.$(".tva-active-options").removeClass("hidden"),this.$("#ta-arrow-up").removeClass("hidden"),this.$("#ta-arrow-down").addClass("hidden")),this.countActiveOptions(),this.$(".tva-advanced-settings-button").on("click",(()=>{this.$(".tva-drip-campaign-behaviour").toggleClass("hidden"),this.$("#ta-arrow-up").toggle(),this.$("#ta-arrow-down").toggle()})),this.model.set("display_locked",this.$("#tva-drip-display-locked")[0].checked),this.model.set("force_unlock_order",this.$("#tva-drip-force-unlock-order")[0].checked),this.$(".tva-drip-settings-input").on("change",(()=>{this.countActiveOptions()}))},countActiveOptions:function(){const e=this.$(".tva-drip-settings-input:checked").length;e>0?(this.$(".tva-active-options").removeClass("hidden"),this.$(".tva-active-options")[0].innerText=e+" "+TVA.t.active):this.$(".tva-active-options").addClass("hidden")},visibilityChanged:function(e){this.model.set("display_locked",e.currentTarget.checked)},forceOrderChanged:function(e){this.model.set("force_unlock_order",e.currentTarget.checked)}})},85787:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(2921),a=s(5905),l=s(76419),c=s(76719);e.exports=r.extend({template:TVE_Dash.tpl("drip/course-tab"),afterInitialize:function(){this.listenTo(this.collection,"add remove render",this.render.bind(this))},onActivate:function(){this.render();const e=Backbone.history.getFragment().split("/");if(e[2]){const t=e[2].split("-")[1];requestAnimationFrame((()=>{this.$(`[data-fn="clickEditCampaign"][data-id="${t||"nothing"}"]`).click()}))}},renameCampaign:function(e){const t=e.currentTarget.dataset.campaignId,s=this.collection.get(parseInt(t)),i=this.model.dripCampaigns;this.$(".tva-campaign-name").unbind(),this.$(".tva-campaign-name").tvaInlineEdit({validation_fn:e=>0!==i.where({post_title:e}).length?TVE_Dash.err(TVA.t.drip_campaign_name_taken):!("string"!=typeof e||0===e.trim().length)}).one("change",((e,t)=>{s.set({post_title:t},{silent:!0}),s.save(null,{silent:!0})}))},newWeeklyLogicConfirmThisCampaign:function(e){const t=e.currentTarget.dataset.campaignId,s=this.collection.get(parseInt(t));s.set({new_weekly_logic:1},{silent:!0}),s.save(null,{silent:!0}),this.$(".tva-new-drip-weekly-logic").remove()},newWeeklyLogicConfirmAll:function(){this.collection.newWeeklyLogic(),this.$(".tva-new-drip-weekly-logic").remove()},openCampaignModal:function(e){let t,s=e.currentTarget.dataset.campaignId;s?(t=this.collection.get(parseInt(s)),t.ensureValidSettings(this.model),t.saveState()):t=new l({course_id:this.model.get("id")});const i=this.openModal(a,{model:t,course:this.model,className:"tvd-modal tva-drip-modal",width:"800px"});if(s&&e.currentTarget.dataset.step){const t=this.$("#tva-drip-force-unlock-order:checked").length>0,s=this.$("#tva-drip-display-locked:checked").length>0;i.form.$("#tva-drip-force-unlock-order").attr("checked",t),i.form.$("#tva-drip-display-locked").attr("checked",s),i.model.set("force_unlock_order",t),i.model.set("display_locked",s);const n=i.form.$(".tva-drip-settings-input:checked").length;n>0?(i.form.$(".tva-active-options").removeClass("hidden"),i.form.$(".tva-active-options")[0].innerText=n+" "+TVA.t.active,i.form.$(".tva-drip-campaign-behaviour").removeClass("hidden")):i.form.$(".tva-active-options").addClass("hidden"),i.gotoStep(parseInt(e.currentTarget.dataset.step))}return i.on("saved",(()=>{s||(s=t.get("id"),this.collection.unshift(t)),this.editView(s),i.destroy()})),s&&i.on("canceled",(()=>t.restoreState())),!1},forceOrderChanged:function(e){const t=this.collection.get(parseInt(e.currentTarget.dataset.campaignId));t instanceof l&&(t.set("force_unlock_order",e.currentTarget.checked),t.save(),TVA.customers.resetIndividualStudentViews()),setTimeout((()=>{this.editView(t.get("id"))}),200)},visibilityChanged:function(e){const t=this.collection.get(parseInt(e.currentTarget.dataset.campaignId));t.set("display_locked",e.currentTarget.checked),t.save(),TVA.customers.resetIndividualStudentViews()},listView:function(){this.$(".tva-view-state").hide().filter(".state-list").show()},editView:function(e){this.display.setCampaign(this.collection.get(parseInt(e))),this.$(".tva-view-state").hide().filter(".state-edit").show()},afterRender:function(){this.display&&this.display.destroy(),this.display=new c({course:this.model,parent:this}),this.addChild(this.display),this.$(".state-edit").html(this.display.render().$el)},clickEditCampaign:function(e){return this.editView(e.currentTarget.dataset.id),!1},deleteCampaign:function(e){const t=this.collection.get(parseInt(e.currentTarget.dataset.id));TVA.Utils.confirmation(n(n({},TVA.t.drip_delete_confirmation),{},{title:TVA.t.drip_delete_confirmation.title.replace("{title}",`<strong>${t.get("post_title")}</strong>`),yesClass:"tva-modal-btn-blue"})).then((()=>{t.destroy({success:()=>{TVA.customers.resetIndividualStudentViews(),TVE_Dash.success(TVA.t.drip_deleted)},error:e=>{TVE_Dash.err(e.responseJSON.message)}})}))},openContentTab:function(){return jQuery(".tva-tabs-ul li:nth-child(2)").trigger("click"),!1}})},5905:function(e,t,s){const i=s(39105),n=s(63181);e.exports=i.extend({template:TVE_Dash.tpl("drip/modals/campaign-settings"),infoTemplate:TVE_Dash.tpl("drip/campaign/info-text"),noMaterialize:!0,disableContainerClass:"tva-drip-container-disabled",afterInitialize:function(){this.listenTo(this.model,"change:schedule_type change:trigger settings-changed",_.debounce((()=>{this.toggleSaveBtn()})),50)},afterRender:function(){this.model.get("type")&&this.renderInfoBox(),i.prototype.afterRender.apply(this,arguments),this.form=new n({model:this.model,course:this.course}),this.$(".tva-drip-form").html(this.form.render().$el)},renderInfoBox:function(){this.$(".tva-blue-bubble-info-text").html(this.infoTemplate({type:this.model.get("type"),longdesc:TVA.drip.campaign_types.find((({type:e})=>e===this.model.get("type"))).longdesc}))},typeSelected:function(){this.model.prepopulate(),this.model.prefillLockFrom(this.course),this.form.render(),this.gotoStep(1),this.renderInfoBox(),this.toggleSaveBtn()},selectType:function(e){this.$(".drip-campaign-type").removeClass("selected");const t=e.currentTarget;t.classList.add("selected");let s=TVA.drip.campaign_types.find((({type:e})=>e===t.dataset.type)).label;return s=this.course.dripCampaigns.getTitleFromLabel(s),this.model.set({type:t.dataset.type,post_title:s}),this.$('[data-step="0"] .tva-next-step').removeClass("tva-disabled"),this.renderInfoBox(),!1},saveClicked:function(){if(this.model.get("id"))this.$(".tva-drip-types-container").addClass(this.disableContainerClass),this.$(".tva-save-warn").fadeIn(100);else{const e=window.location.hash.split("?")[1];if(e){const t=new URLSearchParams(e).get("product_id");this.model.set("product_id",t)}this.save()}return!1},cancelSave:function(){return this.$(".tva-save-warn").fadeOut(50),this.$(".tva-drip-types-container").removeClass(this.disableContainerClass),!1},save:function(){if(!this.canSaveCampaign())return!1;const e=this.model.validate();if(void 0!==e)return TVE_Dash.err(_.first(e).message);{var t;const e=this.course.getModulesAndLessons();this.model.set({schedule:this.form.getScheduleData(),lock_from_id:(null===(t=e[this.model.get("lock_from")])||void 0===t?void 0:t.get("ID"))||""},{silent:!0}),this.model.updateTemplateType({silent:!0}).applySettings(this.course,!0),TVA.customers.resetIndividualStudentViews()}const s=this.model.save();return s&&(TVE_Dash.showLoader(),s.done((()=>{this.__saved=!0,this.close(!1),this.trigger("saved")})).always((()=>TVE_Dash.hideLoader()))),s},onClose:function(){this.__saved||this.trigger("canceled")},canSaveCampaign:function(){return this.model.get("trigger")&&this.model.get("schedule_type")},toggleSaveBtn:function(){this.$(".tva-btn-save-campaign").toggleClass("tva-disabled",!this.canSaveCampaign())}})},57790:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=s(39105),r=s(19311),a=s(18421);e.exports=o.extend({template:TVE_Dash.tpl("drip/modals/content-unlock-settings"),noMaterialize:!0,beforeInitialize:function(e){this.campaign=e.campaign,this.model=this.campaign.getUnlockSettingsForContentId(e.post_id,!0),this.collection=this.model.get("triggers"),this.post_id=e.post_id,this.listenTo(this.collection,"add remove",this.render.bind(this)),e.openTrigger&&(this.openTrigger=e.openTrigger)},afterRender:function(){delete this.activeTrigger;const e="inherited"===this.model.get("forced_unlock")&&!0===this.campaign.get("force_unlock_order"),t=this.course,s=("yes"===this.model.get("forced_unlock")||e)&&!this.courseItem.isFirst(t),i=this.model.hasInherited()&&"tva_lesson"===this.courseItem.get("post_type");s&&!i?this.$(".tva-sequential-info-box").show():i&&this.$(`.tva-inherited${s?"-sequential":""}-info-box`).show(),this.courseItem.isFirst(t)?this.$("#tva-drip-forced-unlock-dropdown").hide():this.$("#tva-drip-forced-unlock-dropdown-disabled").hide(),this.renderAdvancedSettings(),this.$(".tva-drip-content-setting").on("change",(()=>{this.updateInfoBoxes(i)})),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select").not(".select2-hidden-accessible"),{dropdownClass:"select2-unlock-condition"}),this.$dom={form:this.$(".tva-trigger-form"),settings:this.$(".tva-trigger-settings")},this.openTrigger&&(this.$(`[data-fn="editTrigger"][data-id="${this.openTrigger}"]`).trigger("click"),delete this.openTrigger),this.toggleSaveBtn()},toggleSaveBtn:function(){const e=!!this.activeTrigger;this.$('[data-fn="save"]').toggleClass("tva-disabled",e)},removeTrigger:function(e){const t=this.collection.at(parseInt(e.currentTarget.dataset.index));t.canRemove()&&jQuery(e.currentTarget).closest(".tva-content-trigger-item").append(new a({template:TVE_Dash.tpl("products/partials/remove-rule"),className:"tva-delete-simple",confirm:()=>{this.collection.remove(t)}}).render().$el)},getAvailableTriggers:function(){if(this.model.hasTrigger("automator"))return[];const e=[],t=this.campaign.get("trigger"),s=this.model.hasTrigger("scheduled"),i=this.model.getTriggerCount();return TVA.drip.content_triggers.forEach((n=>{s&&"campaign"===n.id||n.id===t||i&&"automator"===n.id||this.model.hasTrigger(n.id)||(n.icon=r(n).icon(),e.push(n))})),e},getAllTriggers:function(){return TVA.drip.content_triggers},addRule:function(e){this.$(".tva-new-trigger").removeClass("tva-hide"),this.$(".tva-drip-no-triggers").addClass("tva-hide"),e.currentTarget.classList.add("tva-hide")},editTrigger:function(e){this.activeTrigger=this.model.getTrigger(e.currentTarget.dataset.id),this.activeTrigger.canEdit()?(this.$(".tva-new-trigger").addClass("tva-hide"),jQuery(e.currentTarget).parents(".tva-content-trigger-item").addClass("edit-trigger").append(this.$dom.form),this.renderTriggerView(),e.currentTarget.parentNode.style.display="none"):delete this.activeTrigger},cancelTriggerEdit:function(){"course-content"===this.activeTrigger.get("id")&&(this.uneditedObjects=this.activeTrigger.get("uneditedObjects"),this.activeTrigger.set("objects",this.uneditedObjects)),this.render()},triggerSelected:function(e){this.$(".tva-new-trigger").append(this.$dom.form);const t=e.currentTarget.value,s={id:t};if(this.course&&"course-content"===t){const e=this.courseItem,t=null==e?void 0:e.getType();if(t&&(s.type=t),!1===this.courseItem.isFirst(this.course)){const e=this.courseItem.getPrevious(this.course);s.object_id=e.get("ID"),s.object_name=e.get("post_title")}}this.activeTrigger=r(s),this.$(".drip-select-icon").removeClass(((e,t)=>t.split` `.filter((e=>e.startsWith`drip-selected-`)).join` `)).addClass(`drip-selected-${e.currentTarget.value}`).html(TVA.Utils.icon(this.activeTrigger.icon())),this.renderTriggerView()},renderTriggerView:function(e=this.$dom.settings){let t;this.triggerView&&this.triggerView.destroy();const o={},r=this.activeTrigger.get("id"),a=this.$(".tva-modal-btn-green");switch(r){case"datetime":t=s(615);break;case"purchase":case"campaign":t=s(11572);break;case"first-lesson":t=s(63502);break;case"course-content":t=s(40450),o.itemIndex=this.itemIndex,o.postId=this.post_id,o.courseItem=this.courseItem,o.course=this.course,this.courseItem.isFirst(this.course)&&0===this.activeTrigger.get("objects").length&&a.addClass("disabled");break;case"assessment":t=s(59835),o.course=this.course,0===this.course.getAssessments().length&&a.addClass("disabled");break;case"video-progress":t=s(39946),o.course=this.course,o.courseItem=this.courseItem,0===this.course.getLessonsByType("video").filter((e=>e.get("ID")!==this.courseItem.get("ID"))).length&&a.addClass("disabled");break;default:t=TVA.drip.trigger_views[r]?TVA.drip.trigger_views[r]:s(2921)}this.$(".tva-trigger-settings").on("change",(()=>{void 0!==this.$("#tva-search-content").val()&&a.toggleClass("disabled",0===this.$("#tva-search-content").val().length)})),this.triggerView=new t(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({model:this.activeTrigger},o)),this.addChild(this.triggerView),e.html(this.triggerView.render().$el),this.$(".tva-trigger-buttons").show(),this.toggleSaveBtn()},saveTriggerData:function(){return this.activeTrigger&&this.activeTrigger.isValid()&&(this.activeTrigger.set(this.triggerView.getData?this.triggerView.getData():{}),this.model.addTrigger(this.activeTrigger,"last")),!1},save:function(){this.campaign.setUnlockSettingsForContentId(this.post_id,this.model.toJSON()),this.campaign.ensureInheritedSettings(this.course.getStructure().findItem(this.post_id)),this.campaign.save().done((()=>TVE_Dash.success(TVA.t.drip_saved))),TVA.customers.resetIndividualStudentViews(),this.close(),this.trigger("saved")},renderAdvancedSettings:function(){let e=[this.model.get("forced_unlock"),this.model.get("visibility")],t=e.filter((e=>"inherited"!==e)).length;t>0&&(this.$(".tva-active-options").removeClass("hidden"),this.$(".tva-active-options")[0].innerText=t+" "+TVA.t.active),this.$(".tva-drip-content-setting").on("change",(()=>{e=[this.$(".tva-drip-content-setting")[0].value,this.$(".tva-drip-content-setting")[1].value],t=e.filter((e=>"inherited"!==e)).length,t>0?(this.$(".tva-active-options").removeClass("hidden"),this.$(".tva-active-options")[0].innerText=t+" "+TVA.t.active):this.$(".tva-active-options").addClass("hidden")})),this.$(".tva-advanced-settings-button").on("click",(()=>{this.$(".tva-drip-content-settings").toggle(),this.$("#ta-arrow-up").toggle(),this.$("#ta-arrow-down").toggle()}))},updateInfoBoxes:function(e){const t="yes"===this.$(".tva-drip-content-setting")[0].value||"inherited"===this.$(".tva-drip-content-setting")[0].value&&!0===this.campaign.get("force_unlock_order");t&&!e?(this.$(".tva-sequential-info-box").show(),this.$(".tva-inherited-sequential-info-box").hide(),this.$(".tva-inherited-info-box").hide()):e?(this.$(`.tva-inherited${t?"-sequential":""}-info-box`).show(),this.$(`.tva-inherited${t?"":"-sequential"}-info-box`).hide(),this.$(".tva-sequential-info-box").hide()):this.$(".tva-sequential-info-box").hide()}})},41027:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(2921),a=s(91359),l=r.extend({className:"tva-drip-schedule",templates:{repeating:TVE_Dash.tpl("drip/schedule/repeating"),non_repeating:TVE_Dash.tpl("drip/schedule/non-repeating"),specific:TVE_Dash.tpl("drip/schedule/specific")},options:{},afterInitialize:function(e){if(!e.type||!this.templates[e.type])throw new Error("Missing or invalid `type` field in schedule view constructor");Array.isArray(e.schedule)&&_.isEmpty(e.schedule)&&delete e.schedule,this.type=e.type,this.template=this.templates[e.type],e.schedule=jQuery.extend({},TVA.drip.schedule_defaults[e.type],e.schedule||{}),this.options=jQuery.extend(!0,{},e.options||{}),this.model=new Backbone.Model,this.setData(e.schedule,{silent:!0}),this.listenTo(this.model,"change",(()=>{this.render(),this.trigger("model-change")}))},afterRender:function(){if(this.$el.off().on("change","[data-field]",(e=>{const t={},s=e.currentTarget;if("number"===s.type){""===s.value.trim()&&(s.value=s.min||1);const e=parseInt(s.value);s.min&&e<parseInt(s.min)&&(s.value=s.min),s.max&&e>parseInt(s.max)&&(s.value=s.max),String(e)!==s.value&&(s.value=e),t.silent=!0}void 0!==e.currentTarget.dataset.silent&&(t.silent=!0);let i={[s.dataset.field]:s.value};"interval"===s.dataset.field&&(i=n(n({},TVA.drip.schedule_defaults[this.type]),{},{interval:s.value})),this.model.set(i,t)})),this.model.changed.interval&&this.model.previous("interval_number")){let e=parseInt(this.model.previous("interval_number"));"days"===this.model.get("interval")&&e>5&&(e=1),this.model.set("interval_number",e)}if(this.type===l.TYPE_SPECIFIC){const e=a.renderPopup(this.$(".tva-popup-datepicker"),{model:this.model,prop:"datetime",silent:!0,active:"date",static:!0,isInvalidDate:e=>wp.date.format("d-m-Y",e)!==wp.date.format("d-m-Y")&&!wp.date.isInTheFuture(e),onChange:e=>{t.setDate(e,{silent:!0})}}),t=a.renderInline(this.$(".tva-popup-timepicker"),{model:this.model,prop:"datetime",is12HourTime:!1,silent:!0,onChange:t=>{e.setDate(t,{silent:!0})}})}TVA.Utils.bindModalSelect2(this.$("select"))},getData:function(){return n({type:this.type},this.model.toJSON())},setData:function(e,t={}){return this.model.set(e,t),this},renderDropdown:function(e,t,s=""){let i=`<select data-field="${e}"${(" "+s).trim()}>`;const n=this.model.get(e);return t.forEach((e=>{const{value:t,label:s}=e;i+=`<option value="${_.escape(t)}"${String(n)===String(t)?" selected":""}>${_.escape(s)}</option>`})),i+="</select>",i},getIntervalNumber:function(e=!1){let t=this.model.get("interval_number");return e&&isNaN(parseInt(t))&&(t="1",this.model.set("interval_number",t,{silent:!0})),t}},{TYPE_SPECIFIC:"specific",TYPE_NON_REPEATING:"non_repeating",TYPE_REPEATING:"repeating",renderTo:function(e,t,s,i={}){const n=new l({type:t,schedule:s,options:i});return jQuery(e).html(n.render().$el),n}});e.exports=l},59835:function(e,t,s){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/assessment"),afterInitialize:function(e){void 0!==e.course&&(this.course=e.course),this.assessments=this.course.getAssessments(),!this.model.get("object_id")&&this.assessments.length>0&&this.model.set({object_id:this.assessments[0].get("ID"),object_name:this.assessments[0].get("post_title"),when:"pass"})},afterRender:function(){this.$assessmentsDropdown=this.$("#tva-drip-assessment-dropdown"),this.$assessmentsWhen=this.$("#tva-drip-assessment-when"),this.assessments.length>0?(this.assessments.forEach((e=>{this.$assessmentsDropdown.append(`<option value="${e.get("ID")}">${e.get("post_title")}</option>`)})),this.$assessmentsDropdown.val(this.model.get("object_id")),this.$assessmentsWhen.val(this.model.get("when")),TVA.Utils.bindModalSelect2(this.$("select")),TVE_Dash.data_binder(this)):this.$(".tva-drip-assessment").html(`<div class="tva-drip-warning">${TVA.t.assessments.no_entries.all}</div>`),this.$assessmentsDropdown.on("select2:select",(e=>{const t=e.params.data;this.model.set({object_id:parseInt(t.id),object_name:t.text})}))}})},40450:function(e,t,s){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/course-content"),courseItem:null,$typesDropdown:null,$searchDropdown:null,tooltipKey:"drip-course-content-trigger-modules",afterInitialize:function(e){void 0!==e.courseItem&&(this.courseItem=e.courseItem),void 0!==e.course&&(this.course=e.course),this.listenTo(this.model,"change:type",(()=>{const e=this.$("#tva-search-content");e.hasClass("select2-hidden-accessible")&&e.select2("destroy"),e.show(),setTimeout((()=>{TVA.Utils.bindModalSelect2(e,n(this.getSearchRoute()))}),0),void 0!==this.$tooltip&&this.$tooltip.removeClass("ttd-visible"),"module"!==this.model.get("type")||TVA.Utils.isTooltipViewed(this.tooltipKey)||(this.$tooltip=this.$(".tva-course-content-module-tooltip"),requestAnimationFrame((()=>this.showTooltip())))}))},showTooltip:function(){this.$tooltip.addClass("ttd-visible")},hideTooltip:function(){return this.$tooltip.addClass("ttd-out"),setTimeout((()=>this.$tooltip.removeClass("ttd-visible ttd-out")),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1},afterRender:function(){if(this.$typesDropdown=this.$("#tva-content-types"),_.each(TVA.content_types,(e=>{this.$typesDropdown.append('<option value="'+e.value+'">'+e.label+"</option>")})),this.$typesDropdown.val(this.model.get("type")),this.$searchDropdown=this.$("#tva-search-content"),TVA.Utils.bindModalSelect2(this.$typesDropdown),TVA.Utils.bindModalSelect2(this.$searchDropdown,n(this.getSearchRoute())),this.order=this.courseItem.get("order"),!1===this.courseItem.isFirst(this.course)&&0===this.model.get("objects").length){const e=this.courseItem.getPrevious(this.course);this.model.set("objects",[{id:e.get("ID"),type:e.getType(),text:e.get("post_title")}])}this.uneditedContentList=this.model.get("objects"),this.model.set("uneditedObjects",this.uneditedContentList),this.contentList=this.model.get("objects"),this.ids=[],this.model.get("objects").forEach((e=>{this.ids.push(e.id),this.$searchDropdown.append('<option value="'+e.id+'">'+e.text+"</option>")})),this.$searchDropdown.val(this.ids).trigger("change"),this.$("#tva-content-types").on("select2:select",(()=>{this.$("#tva-search-content").val(null).trigger("change"),this.contentList=[],this.model.set("objects",this.contentList)})),this.$("#tva-search-content").on("select2:select",(e=>{const t=e.params.data;this.contentList.push({id:t.id,type:t.type,text:t.text}),this.model.set("objects",this.contentList)})),this.$("#tva-search-content").on("select2:unselect",(e=>{const t=parseInt(e.params.data.id);this.contentList=this.contentList.filter((e=>e.id!==t)),this.model.set("objects",this.contentList)})),"module"!==this.model.get("type")||TVA.Utils.isTooltipViewed(this.tooltipKey)||(this.$tooltip=this.$(".tva-course-content-module-tooltip"),requestAnimationFrame((()=>this.showTooltip()))),setTimeout((()=>{TVE_Dash.data_binder(this)}),0)},getSearchRoute:function(){return`${TVA.content_types[this.model.get("type")].route}/?exclude=${this.courseItem.get("ID")}`}});const n=e=>({ajax:{transport:function(t,s){wp.apiRequest({url:`${TVA.apiSettings.root}${TVA.apiSettings.v2}${e}`,data:t.data}).done((e=>{s({results:(null==e?void 0:e.items)||e})}))},data:e=>({search:e.term}),delay:250,cache:!0},templateResult:function(e){let t=e.text;return"string"==typeof e.label&&e.label.length>0&&(t=`${e.label}${e.type?" -":":"} ${t}`),t},escapeMarkup:function(e){return e},withSearch:!0,minimumResultsForSearch:1,multiple:!0,placeholder:"Search",dropdownClass:"select2-content-unlock"})},615:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(2921),a=s(41027);e.exports=r.extend({className:"tva-inline-datetime",template:TVE_Dash.tpl("drip/triggers/datetime"),afterRender:function(){const e=this.$(".tva-trigger-schedule");e.length&&(this.schedule=a.renderTo(e,this.model.scheduleType,this.model.get("schedule"),{hideLabel:!0}),this.addChild(this.schedule)),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select"))},getData:function(){var e;return n(n({},this.model.toJSON()),{},{schedule:(null===(e=this.schedule)||void 0===e?void 0:e.getData())||{}})}})},63502:function(e,t,s){const i=s(11572);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/first-lesson")})},11572:function(e,t,s){const i=s(615);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/purchase")})},39946:function(e,t,s){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/video-progress"),afterInitialize:function(e){if(void 0!==e.courseItem&&(this.courseItem=e.courseItem),void 0!==e.course&&(this.course=e.course),this.videoLessons=this.course.getLessonsByType("video").filter((e=>e.get("ID")!==this.courseItem.get("ID"))),!this.model.get("object_id")&&this.videoLessons.length>0){let e=this.videoLessons[0].get("ID"),t=this.videoLessons[0].get("post_title");if(this.courseItem.getPrevious(this.course,"video")){const s=this.courseItem.getPrevious(this.course,"video");e=s.get("ID"),t=s.get("post_title")}this.model.set({object_id:e,object_name:t})}},afterRender:function(){this.$videoDropdown=this.$("#tva-drip-video-dropdown"),this.videoLessons.length>0?(this.videoLessons.forEach((e=>{this.$videoDropdown.append(`<option value="${e.get("ID")}">${e.get("post_title")}</option>`)})),this.$videoDropdown.val(this.model.get("object_id")),TVA.Utils.bindModalSelect2(this.$("select")),TVE_Dash.data_binder(this)):this.$(".tva-drip-video-progress").html(`<div class="tva-drip-warning">${TVA.t.dripNoVideoLessons}</div>`),this.$videoDropdown.on("select2:select",(e=>{const t=e.params.data;this.model.set({object_id:parseInt(t.id),object_name:t.text})}))}})},61606:function(e,t,s){!function(t){const i=s(75195),n=s(86171),o=s(43388);let r;e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/email-templates"),initialize:function(){r instanceof o||(r=new o(Object.values(TVA.emailTemplates))),this.collection=r,this.emailServiceSetting=new n({key:"email_service",value:TVA.settings.email_service.value})},render:function(){return this.$el.html(this.template()),this.$("#email-template").select2(),this.$apiSelect=this.$("#tva-email-apis"),this.afterRender(),this},afterRender:function(){this.$select=this.$("#email-template"),this.$formWrapper=this.$("#tva-email-template-form-wrapper"),this.collection.each((e=>{this.$select.append(t("<option/>").text(e.get("name")).val(e.get("slug")))})),1===this.collection.length&&this.$select.val(this.collection.first().get("slug")).trigger("change");const e=this.emailServiceSetting.get("value").trim();this.$apiSelect.empty(),TVA.connected_email_providers.forEach((s=>{const i="campaignmonitoremail"===s.id?"campaignmonitor":s.id,n=`${TVE_Dash_Const.dash_url}/inc/auto-responder/views/images/${i}.png`,o=t(`<option value="${s.id}" data-image="${n}">${s.name}</option>`);e===s.id&&o.prop("selected",!0),this.$apiSelect.append(o)})),this.$(".tva-own-site-warning").toggleClass("tva-hide","own_site"!==e),this.$apiSelect.select2({minimumResultsForSearch:-1,templateResult:this.select2ImageItemRenderer,templateSelection:this.select2ImageItemRenderer}).data("select2").$dropdown.addClass("tva-email-apis-select-dropdown"),0===e.length&&this.$apiSelect.trigger("change")},select2ImageItemRenderer:function(e){return e.element&&e.element.dataset.image?t(`<span><span class="opt-image" style="background-image: url('${e.element.dataset.image}')"></span><span>${e.text}</span></span>`):e.text},selectApiConnection:function(e,t){this.$(".tva-own-site-warning").toggleClass("tva-hide","own_site"!==t.value),this.emailServiceSetting.setValue(t.value).save()},renderEmailTemplate:function(e,t){const s=t.value;0!==s.length?this.$formWrapper.html(new i({model:this.collection.findWhere({slug:s})}).render().$el):this.$formWrapper.empty()}})}(jQuery)},75195:function(e,t,s){!function(t){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("settings/email-template-item"),triggerTpl:TVE_Dash.tpl("settings/email-template-trigger"),initialize:function(){i.prototype.initialize.apply(this,arguments),this.emailShortcodesCollection=new Backbone.Collection(Object.values(TVA.emailShortcodes)),this.emailTriggersCollection=new Backbone.Collection(Object.values(TVA.emailTriggers))},afterRender:function(){switch(this.$emailShortcodes=this.$("#tva-email-shortcodes"),this.$emailTriggers=this.$("#tva-email-triggers-wrapper"),this.$emailBodyTextarea=this.$("#tva-email-body"),this.$saveButton=this.$(".tva-email-template-save"),this.emailBodyCodeEditor=this._configureCodeEditor(),this.emailShortcodesCollection.each((e=>{this.$emailShortcodes.append(t("<option/>").text(e.get("label")).val(e.get("slug")))})),this.model.get("slug")){case"assessmentMarked":this.emailTriggersCollection.each((e=>{e.get("slug").toLowerCase().includes("assessment")&&this.$emailTriggers.append(this.triggerTpl({model:e,checked:this.model.get("triggers").includes(e.get("slug"))}))}));break;case"certificateIssued":case"productAccessExpire":this.$(".tva-email-trigger-header").hide();break;default:this.emailTriggersCollection.each((e=>{"certificate_issued"===e.get("slug")||e.get("slug").toLowerCase().includes("assessment")||this.$emailTriggers.append(this.triggerTpl({model:e,checked:this.model.get("triggers").includes(e.get("slug"))}))}))}setTimeout((()=>{this.emailBodyCodeEditor.refresh(),this.emailBodyCodeEditor.setCursor(this.emailBodyCodeEditor.lineCount(),0),this.emailBodyCodeEditor.focus()}))},changeField:function(e,t){const s={};s[t.getAttribute("data-field")]=t.value,this.model.set(s)},saveTrigger:function(){const e=[];this.$(".tva-email-trigger:checked").each(((t,s)=>{e.push(s.getAttribute("name"))})),this.model.set("triggers",e)},insertShortcode:function(){const e=this.emailShortcodesCollection.findWhere({slug:this.$emailShortcodes.val()});e&&this._insertCodeEditorText(e.get("text"))},save:function(){TVE_Dash.showLoader(),this.$saveButton.attr("disabled","true"),this.model.save(null,{success:function(){TVE_Dash.success(TVA.t.template_saved)},error:(e,t)=>{TVE_Dash.err(t.responseJSON.message)},complete:()=>{this.$saveButton.removeAttr("disabled"),TVE_Dash.hideLoader()}})},_insertCodeEditorText:function(e){const t=this.emailBodyCodeEditor.getDoc(),s=t.getCursor();t.replaceRange(e,s)},_configureCodeEditor:function(){const e=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};e.codemirror=_.extend({},e.codemirror,{lineNumbers:!0,mode:"text",indentUnit:2,tabSize:2,lineWrapping:!0});const t=wp.codeEditor.initialize(this.$emailBodyTextarea,e);return t.codemirror.setSize("100%","300px"),t.codemirror.on("change",(e=>{this.model.set("body",e.getValue())})),t.codemirror}})}(jQuery)},1621:function(e,t,s){e.exports=s(2921).extend({tagName:"div",className:"tva-filter-badge",activeClassName:"tva-badge-active",events:{click:"onClick"},initialize:function(e){this.number=e.number,this.label=e.label,this.key=e.key,this.selected=e.selected},onClick:function(){this.trigger("beforeTrigger",this.key),this.$el.addClass(this.activeClassName),this.trigger("click",this.key)},render:function(){return this.$el.html(`<div>${this.label}</div><div class="tva-filter-badge-number">${this.number}</div>`),this.selected&&this.$el.addClass(this.activeClassName),this}})},95438:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r;r=jQuery,e.exports=s(2921).extend({tagName:"select",events:{change:"onSelected"},selected:-1,initialize:function(e){(e=n({idField:"id",labelField:"label",className:"tva-filter-dropdown",defaultOption:"",selected:-1},e)).collection&&(this.collection=new Backbone.Collection(function(e,t={}){const s=[],i=n({id:"id",label:"label"},t);return e instanceof Backbone.Collection&&(e=e.toJSON()),e.forEach((function(e){e instanceof Backbone.Model&&(e=e.toJSON()),s.push({id:e[i.id],label:e[i.label]})})),s}(e.collection,{id:e.idField,label:e.labelField})),e.defaultOption&&this.setDefaultOption(e.defaultOption)),this.$el.addClass(e.className),this.selected=e.selected},render:function(){let e=r();return this.collection.each((t=>{e=e.add(r(`<option value="${t.get("id")}">${t.get("label")}</option>`))}),this),this.$el.append(e).val(String(this.selected)),this},setDefaultOption:function(e){return this.collection.add(new Backbone.Model({id:-1,label:e}),{at:0}),this},selectOption:function(e,t){const s=this.collection.findWhere(e);s instanceof Backbone.Model&&(this.$el.val(s.get("id")),t&&this.$el.trigger("change"))},onSelected:function(e){this.trigger("change",e.currentTarget.value)}})},27339:function(e,t,s){!function(t){function i(e){this.trigger("change",e.target.value)}e.exports=s(2921).extend({className:"tva-search-elem",template:TVE_Dash.tpl("search-elem"),events:{"keyup input":_.debounce((function(){i.apply(this,arguments)}),400),"click .tva-close":function(e){const s=t(e.target).closest(".tva-search-elem");s.find(".tva-close").removeClass("tva-close"),s.find("input").val("").trigger("keyup")},"input #tva-search":function(e){t(e.target).siblings().toggleClass("tva-close",e.target.value.trim().length>0)}},initialize:function(e={}){this.options=e},afterRender:function(){this.options.placeholder&&this.$("input").attr("placeholder",this.options.placeholder),this.options.value&&this.options.value.trim().length>0&&this.$("input").val(this.options.value).siblings().toggleClass("tva-close",!0)},getValue:function(){return this.$("input").val()}})}(jQuery)},1569:function(e,t,s){const i=s(51135);e.exports=i.extend({className:"tva-generation",template:TVE_Dash.tpl("generate-courses"),events:{"click button":"handleClick"},handleClick:function(e){let t={};switch(e.target.form instanceof HTMLFormElement&&(t=Object.fromEntries(new FormData(e.target.form).entries())),e.target.dataset.fn){case"tva-generate-courses":this.performGenerateRequest(t,"courseGeneration",TVA.routes.courses+"/generate_courses",(e=>{TVA.courses.add(e)}));break;case"tva-generate-members":this.performGenerateRequest(t,"memberGeneration",TVA.routes.customer+"/generate_members",(e=>{TVA.customers.add(e),TVA.products.resetAndFetch()}));break;case"tva-generate-completion":this.performGenerateRequest(t,"completionGeneration",TVA.routes.customer+"/generate_completion",(()=>{TVA.customers.reset()}));break;case"tva-generate-products":this.performGenerateRequest(t,"productGeneration",TVA.routes.products+"/generate_products",(e=>{TVA.products.add(e)}));break;case"tva-delete-generated-courses":this.performDeleteRequest(TVA.routes.courses+"/delete_generated_courses",(e=>{e.forEach((e=>{TVA.courses.remove(e,{silent:!0})}))}));break;case"tva-delete-generated-members":this.performDeleteRequest(TVA.routes.customer+"/delete_generated_members",(e=>{e.forEach((e=>{TVA.customers.remove(e,{silent:!0})})),TVA.products.resetAndFetch()}));break;case"tva-delete-generated-products":this.performDeleteRequest(TVA.routes.products+"/delete_generated_products",(e=>{e.forEach((e=>{TVA.products.remove(e,{silent:!0})}))}));break;case"tva-delete-generated-completion":this.performDeleteRequest(TVA.routes.customer+"/delete_generated_completion",(()=>{TVA.customers.reset(),TVA.products.resetAndFetch()}));break;default:TVE_Dash.err(TVA.t.button_broken)}},performGenerateRequest:function(e,t,s,i){const n=this.validate(e,t);n?TVE_Dash.err(n):s&&i&&(TVE_Dash.showLoader(),wp.apiRequest({type:"POST",data:e,url:s}).done((e=>{this.performCallback(e,i)})))},performDeleteRequest:function(e,t){TVE_Dash.showLoader(),wp.apiRequest({type:"DELETE",url:e}).done((e=>{this.performCallback(e,t)}))},performCallback:function(e,t,s=!0){"function"==typeof t&&t(e),s&&TVE_Dash.hideLoader()},validate:function(e,t){let s="";switch(t){case"productGeneration":(e.productsCount<=0||!this.validPercentageInterval(e.coursePercentageMin,e.coursePercentageMax))&&(s=TVA.t.invalid_input_product_generation);break;case"memberGeneration":(e.membersCount<=0||!this.validPercentageInterval(e.productPercentageMin,e.productPercentageMax))&&(s=TVA.t.invalid_input_member_generation);break;case"courseGeneration":(e.courseCount<=0||!this.validInterval(e.minModules,e.maxModules)||!this.validInterval(e.minChapters,e.maxChapters)||!this.validInterval(e.minLessons,e.maxLessons)||e.minLessons<=0||e.minChapters<0||e.minModules<0)&&(s=TVA.t.invalid_input_course_generation);break;case"completionGeneration":this.validPercentageInterval(e.completionPercentageMin,e.completionPercentageMax)||(s=TVA.t.invalid_input_completion)}return s},validPercentageInterval:function(e,t){return e>=0&&e<=100&&t<=100&&this.validInterval(e,t)},validInterval:function(e,t){return parseInt(t)>=parseInt(e)}})},56766:function(e,t,s){!function(t){const i=s(77431),n=s(86355);e.exports=s(51135).extend({template:TVE_Dash.tpl("home"),className:"tva-home-content",afterInitialize:function(){this.icon=[],this.color=[],this.collection=new n(TVA.courses.toJSON(),{total:TVA.courses.total}),this.courseArray=this.collection.models.slice(0,TVA.home_course_count),this.courseArray.forEach((e=>{const t=TVA.topics.findWhere({id:e.get("topic")});"svg_icon"===t.get("icon_type")?this.icon[e.get("topic")]=t.get("svg_icon"):this.icon[e.get("topic")]="<img src="+t.get("icon")+">"}))},afterRender:function(){this.$(".tva-course-topic").each(((e,s)=>{const i=this.courseArray[e],n=TVA.topics.findWhere({id:i.get("topic")});t(s).css("background-color",n.get("color"))})),this.$(".tva-home-course-status").each((e=>{const t=this.courseArray[e].get("status");this.$(".tva-custom-tooltip")[e].innerText=TVA.t.courseStatusText[t],this.$(".tva-home-course-status")[e].classList.add(`tva-course-status-${t}`)}));const e=t(".tve-metrics-consent-notice");e.length&&this.$(".tva-home-container").prepend(e)},helpModal:function(){this.openModal(i,{className:"tvd-modal modal-help-corner"})},shouldShowProductsCard:function(){return TVA.courses.length<=2}})}(jQuery)},83217:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(2921);e.exports=i.extend({template:"utils/inline-edit",className:"tva-inline-edit tva-flex",required:!0,events:function(){return n(n({},i.prototype.events),{},{"change .tva-title-events":"onTitleChange","blur .tva-title-events":"onTitleBlur","keyup .tva-title-events":"onTitleKeyup"})},afterInitialize:function(e){if(t.extend(!0,this,e),!this.$element)throw new Error("$element is expected");this.model=new Backbone.Model({text:(this.text||this.$element.text()).trim(),editing:!0}),e.validation_fn&&"function"==typeof e.validation_fn&&(this.validation=e.validation_fn),this.listenTo(this.model,"change",this.render)},validation:()=>!0,afterRender:function(){this.$input=this.$("input"),requestAnimationFrame((()=>{this.$input.select().focus()}))},editing:function(){this.model.set("editing",!0)},onTitleChange:function(e){const t=e.currentTarget,s=t.value.trim();return s&&this.validation(s)?(this.preventBlur=!0,s===this.model.get("text")?(this.model.set("editing",!1),!1):(this.model.set({text:s,editing:!1}),this.$element.trigger("change",[s]),!1)):(t.classList.add("tva-error"),t.focus(),!1)},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0,this.model.set("editing",!1))},onTitleBlur:function(){this.preventBlur?delete this.preventBlur:this.model.set("editing",!1)}})}(jQuery)},89166:function(e,t,s){!function(t){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("utils/input-title"),events:function(){return t.extend(i.prototype.events,{"keyup input":"keyup","click input":e=>e.stopPropagation(),"blur input":"cancel"})},afterInitialize:function(e){this.$titleTextHolder=e.titleTextHolder,t.extend(!0,this,e)},afterRender:function(){this.$input=this.$("input"),setTimeout((()=>{this.$input.select().focus()}),0),this.$titleTextHolder.hide()},inputChanged:function(e,t){this.model.set("title",t.value.trim()),this.apply()},keyup:function(e){27===e.which&&this.cancel()},cancel:function(){this.$titleTextHolder.show(),this.destroy().remove()},apply:function(){_.isEmpty(this.model.get("title"))?TVE_Dash.err("This field can not be left empty"):(this.$titleTextHolder.html(this.model.get("title")+TVA.Utils.icon("pen_light")).show(),this.destroy().remove(),this.save(this.model.get("title")))},save:t.noop})}(jQuery)},96308:function(e,t,s){var i;i=jQuery,e.exports=s(51135).extend({initialize:function(e){i.extend(!0,this,{templates:{},callbacks:{}},e),e.states_views_path||console.error("required argument states_views_path missing"),this.states_views_path=e.states_views_path,this.listenTo(this.model,"change:state",this.render),this.listenTo(this.model,"sync",(e=>{const t=e.get("name"),s=e.toJSON();TVA.settings[t]&&Object.keys(TVA.settings[t]).forEach((function(e){Object.keys(s).indexOf(e)&&(TVA.settings[t][e]=s[e])})),"checkout_page"===t&&TVA.access_integrations.forEach((e=>{["sendowl_product","sendowl_bundle"].includes(e.slug)&&(e.allow=s.value?1:0)})),this.model.trigger("value-changed")}))},render:function(){this._view instanceof Backbone.View&&(this._view.undelegateEvents(),this._view.stopListening(),this._view.$el.empty(),delete this._view);try{const e=this.model.get("state"),t=s(3264)(this.states_views_path+e+".js"),i={el:this.el,model:this.model,labels:this.labels&&this.labels[e]?this.labels[e]:{},settings:this.settings&&this.settings[e]?this.settings[e]:{},callbacks:this.callbacks};this.templates[e]&&(i.template=this.templates[e]),this._view=new t(i),this._view.render()}catch(e){console.error(this.states_views_path+this.model.get("state")+".js is not a valid Backbone view"),console.log(e)}return this.afterRender(),this},afterRender:i.noop})},25343:function(e,t,s){const i=s(27863);e.exports=i.extend({template:TVE_Dash.tpl("labels/button-label"),afterRender:function(){}})},27643:function(e,t,s){const i=s(27863);e.exports=i.extend({template:TVE_Dash.tpl("labels/course-structure-input"),afterRender:function(){},onTitleChange:function(e){const t=e.currentTarget,s=t.attributes["data-label-type"].value,i=t.value.trim()||this.defaultTitle[s];if(!i)return t.classList.add("tva-error"),t.focus(),!1;i!==this.model.get(s)?this.model.persist({[`${s}`]:i},{loader:!0,showSuccess:!0}):t.value=this.model.get(s)},onTitleKeyup:function(e){27===e.which&&e.currentTarget.blur()}})},38563:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(51135);e.exports=i.extend({className:"tva-course-type-label",template:TVE_Dash.tpl("labels/course-type-label"),events:n(n({},i.prototype.events),{},{"change .tva-title-events":"onTitleChange","keyup .tva-title-events":"onTitleKeyup","blur .tva-title-events":"onTitleBlur"}),afterInitialize:function(e){t.extend(this,e),this.model&&this.model.on("change",this.render.bind(this))},onTitleChange:function(e){const t=e.currentTarget,s=t.value.trim()||this.defaultTitle;if(!s)return t.classList.add("tva-error"),t.focus(),!1;s!==this.model.get("title")?this.model.persist({title:s},{loader:!0,showSuccess:!0}):t.value=this.model.get("title")},onTitleKeyup:function(e){27===e.which&&e.currentTarget.blur()}})}(jQuery)},12386:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(77494);e.exports=r.extend({className:"tva-label-item click",events:n(n({},r.prototype.events),{},{click:"editing"}),template:TVE_Dash.tpl("labels/item"),deletedMessage:TVA.t.label_deleted,getConfirmationModal:function(){return s(31779)},beforeDelete:function(e){TVA.courses.where({label:e.get("ID")}).forEach((e=>{e.set("label",-1,{silent:!0}),e.saveState()}))},spectrumOptions:function(){return{containerClassName:"tva-label-spectrum"}},toggleLoader:function(){this.$el.tvaToggleLoader(20,!!this.model.get("loading"),{background:"",position:"right",padding:"0 20px 0 0"})}})},95220:function(e,t,s){const i=s(27863);e.exports=i.extend({template:TVE_Dash.tpl("labels/simple-label"),afterRender:function(){},onTitleChange:function(e){const t=e.currentTarget,s=t.value.trim()||this.defaultTitle;if(!s)return t.classList.add("tva-error"),t.focus(),!1;s!==this.model.get("title")?this.model.persist({title:s},{loader:!0,showSuccess:!0}):t.value=this.model.get("title")},onTitleKeyup:function(e){27===e.which&&e.currentTarget.blur()}})},30873:function(e,t,s){const i=s(27863);e.exports=i.extend({template:TVE_Dash.tpl("labels/textarea-warning-label"),afterRender:function(){}})},27863:function(e,t,s){!function(t){const i=s(77494);e.exports=i.extend({className:"tva-flex tva-label-user-switch tva-align-center tva-label-row",template:TVE_Dash.tpl("labels/user-context-item"),afterInitialize:function(e){t.extend(this,e),i.prototype.afterInitialize.call(this,e)},spectrumOptions:function(){return{containerClassName:"tva-label-spectrum"}},afterRender:function(){TVE_Dash.materialize(this.$el),this.$("select").data("select2").$dropdown.addClass("tva-context-dropdown")},toggleLoader:function(){this.$el.tvaToggleLoader(20,!!this.model.get("loading"),{background:"",position:"right",padding:"0 20px 0 0"})},labelDisplayChanged:function(e){this.model.persist({opt:e.currentTarget.value},{showSuccess:!1})}})}(jQuery)},52875:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(51135),o=s(44938),r=s(86662),a=s(27339),l=s(77003);e.exports=i.extend({template:TVE_Dash.tpl("settings/logs"),searchDefaultParams:{s:"",types:[]},initialize:function(){i.prototype.initialize.apply(this,arguments),this.collection=new o(TVA.logs.items,{total:TVA.logs.total}),this.types=TVA.logs.types,this.listenTo(this.collection,"fetched",_.bind(this.renderData,this))},afterRender:function(){this.$filters=this.$("#tva-logs-filters"),this.$content=this.$("#tva-logs-content"),this.$pagination=this.$(".tva-pagination"),Array.isArray(this.types)&&this.types.length>0&&this.renderTypes(),this.renderSearch(),this.renderData(),this.renderPagination()},renderTypes:function(){this.$select=t('<select multiple="multiple"></select>'),this.$clearSelect=t(`<span id="tva-clear-dropdown-filter" style="max-width:100px;" class="tva-customers-clear click" data-fn="clearDropdownFilter">${TVA.Utils.icon("cross")} Clear Filters</span>`).hide(),this.$filters.append(this.$select),this.$filters.append(this.$clearSelect),this.types.forEach((e=>{const s=t("<option/>").val(e.type).text(e.type);this.$select.append(s)})),this.$select.select2({closeOnSelect:!1,allowHtml:!0,allowClear:!0,tags:!0}).on("select2:select select2:unselect",(()=>this._handleLogsFilterSelection())).trigger("select2:select").data("select2").$dropdown.addClass("tva-select2-with-checkboxes")},_handleLogsFilterSelection:function(){const e=this.$select.val();let t=`Filters ${TVA.Utils.icon("filter")}`;this.$clearSelect.toggle(Array.isArray(e)&&e.length>0),Array.isArray(e)&&e.length>0&&(t=`${e.length} ${1===e.length?"Filter":"Filters"} Active ${TVA.Utils.icon("filter")}`),this.$(".select2-selection").html(t),this.searchDefaultParams=n(n({},this.searchDefaultParams),{types:e||[]}),this.collection.search(this.searchDefaultParams)},clearDropdownFilter:function(){this.$select.val("").trigger("select2:select")},renderSearch:function(){const e=new a({placeholder:"Search Logs..."});this.$(".tva-logs-search").append(e.render().$el),e.on("change",(e=>{this.searchDefaultParams=n(n({},this.searchDefaultParams),{s:e}),this.collection.search(this.searchDefaultParams)}))},renderData:function(){this.$content.empty(),this.collection.each((e=>{this.$content.append(new r({model:e}).render().$el)})),this.$(".tvd-collection-header:not(.ttw-table-header), .tvd-collection-item:not(.ttw-table-header)").hide()},renderPagination:function(){new l({el:this.$pagination,collection:this.collection,noItemTemplate:TVE_Dash.tpl("settings/logs-empty-list")}).render()}})}(jQuery)},86662:function(e,t,s){!function(t){const i=s(2921),n=i.extend({tagName:"li",className:"tvd-collection-header tva-logs-small",initialize:function(e){this.value=e.value,this.$(".tvd-collection-item").hide()},render:function(){return this.$el.html(`<div class="tve-debug-item"><h5>${this.value||0===this.value?this.value:"---"}</h5></div>`),this}}),o=n.extend({className:"tvd-collection-item tve-debug-column tva-logs-big"}),r=i.extend({tagName:"li",className:"tvd-collection-item tve-debug-column tve-debug-sub-table tva-logs-big",render:function(){return this.renderData(),this},renderData:function(){this.$el.append(new l({model:this.model}).render().$el)}}),a=i.extend({tagName:"li",className:"tvd-collection-header ttw-table-header",template:TVE_Dash.tpl("settings/log-info-item")}),l=i.extend({tagName:"ul",className:"tvd-collection tvd-with-header tva-logs",events:{"click .ttw-table-header":"toggleLog"},toggleLog:function(e){const s=t(e.currentTarget);return this.$(".tvd-collection-item, .tvd-collection-header").not(".ttw-table-header").toggle(),s.find(".tve-debug-slide > span").toggleClass("tve-churn-icon-keyboard_arrow_up"),s.find(".tve-debug-slide > span").toggleClass("tve-churn-icon-keyboard_arrow_down"),!1},render:function(){const e=this.model.get("data");return this.model.get("type")&&this.model.get("identifier")&&this.renderInfo(),"object"==typeof e&&_.each(e,((e,t)=>{this.$el.append(new n({value:t}).render().$el);const s="object"==typeof e&&null!==e?new r({model:new Backbone.Model({data:e})}):new o({value:e});this.$el.append(s.render().$el)})),this},renderInfo:function(){this.$el.append(new a({model:this.model}).render().$el)}});e.exports=i.extend({template:TVE_Dash.tpl("settings/log-item"),afterRender:function(){this.$(".tve-debug-table").append(new l({model:this.model}).render().$el)}})}(jQuery)},79389:function(e,t,s){!function(t){const i=s(2921),n=s(95296);e.exports=i.extend({template:TVE_Dash.tpl("courses/media/settings"),$options:null,$types:null,types:[],labels:{youtube:"Youtube",wistia:"Wistia",vimeo:"Vimeo",bunnynet:"Bunny.net Stream",soundcloud:"Soundcloud",custom:"Custom"},afterInitialize:function(e){t.extend(this,e),this.listenTo(this.model,"change:type",(()=>{this.model.set("source",""),this.model.setDefaultOptions(this.model.get("type")),this.renderOptions(),TVE_Dash.data_binder(this)}))},render:function(){return this.$el.html(this.template({model:this.model})),"tva-lesson-video-options"!==this.$el[0].id||["bunnynet"].includes(this.model.get("type"))||this.$el.append(TVE_Dash.tpl("courses/media/video-progress")),this.$types=this.$("#tva-media-types"),this.types.forEach((e=>{this.$types.append(t("<option/>").val(e).text(this.labels[e]))})),this.$types.val(this.model.get("type")),this.$types.select2(),this.$options=this.$("#tva-media-options"),this.listenTo(this.model,"change:progress_enabled change:source",(()=>{if(this.model.get("progress_enabled")){const e=this.model.get("type"),t=this.model.get("source");let s="";switch(e){case"youtube":s=!!t.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|shorts\/|\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/)&&RegExp.$1;break;case"vimeo":s=t.match(/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/i)[1];break;case"wistia":s=!!t.match(new RegExp("https?://(.+)?(wistia.com|wi.st)/(medias|embed)/(.+)"))&&RegExp.$4}n.fetchVideoInformation(s,e).then((e=>{void 0!==e&&e&&this.model.set({title:e.title,duration:e.duration})}))}})),this.renderOptions(),TVE_Dash.data_binder(this),this},renderOptions:function(){let e="";const t=this.model.get("type").toLowerCase();switch(t){case"youtube":case"vimeo":case"wistia":case"bunnynet":case"custom":e="courses/media/"+t;break;default:e="courses/media/default"}const s=TVE_Dash.tpl(e);this.$options.html(s({model:this.model})),Object.keys(this.model.get("options")).forEach((e=>{this.$('input:checkbox[data-prop="'+e+'"]').prop("checked",1===this.model.get("options")[e])})),["bunnynet","custom"].includes(t)?(this.$("#tva-video-progress-options").hide(),this.model.set("progress_enabled",0)):this.$("#tva-video-progress-options").show()},toggleMediaOption:function(e,t){const s=t.dataset.prop;return!!s&&(0===this.model.get("options").length&&this.model.set("options",{}),e.currentTarget.checked?this.model.get("options")[s]=1:delete this.model.get("options")[s])}})}(jQuery)},5053:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(72877),o=s(7750),r=s(27339),a=s(77003),l=s(91960),c=s(11316),d="###",h=s(51135),u=s(21598),p=s(46498),m=Backbone.Collection.extend({getItems:function(e=""){const t=[];return e+=d,this.toJSON().forEach((s=>{s.id=e+s.id,t.push(s)})),t}});e.exports=h.extend({$filters:null,$pagination:null,searchFilterView:null,template:TVE_Dash.tpl("customers/list"),ensureData:async function(){if(!(TVA.allProducts&&TVA.customers instanceof Backbone.Collection&&10===TVA.customers.length))return TVE_Dash.showLoader(),new Promise((e=>{wp.apiRequest({url:TVA.routes.customer,data:{limit:10}}).done((e=>{this.collection=TVA.customers=new p(e.items,{total:e.total}),this.products=TVA.allProducts=e.products,this.setupCollectionListeners()})).always(e)}));this.collection=TVA.customers,this.products=TVA.allProducts,this.setupCollectionListeners()},setupCollectionListeners:function(){this.collection.on("fetching",(()=>{this.$customers.tvaToggleLoader(20,!0)})),this.collection.on("fetched",(()=>{this.renderCustomers(),this.$customers.tvaToggleLoader(20,!1)}))},destroy:function(){h.prototype.destroy.apply(this,arguments),this.collection.hasFilters()&&this.collection.resetFilters().fetch()},render:function(){return TVA.migrate_access&&1===parseInt(TVA.migrate_access.should_migrate)?i.getInstance():(this.$el.html(this.template()),this.$filters=this.$("#tva-filters-wrapper"),this.$customers=this.$("#tva-customers"),this.$pagination=this.$(".tva-pagination"),this.renderDropdownFilter(),this.searchFilterView=this.renderSearchFilter().on("change",(e=>{const t=n({},{s:e});if(this.$("#tva-dropdown-filter").length){const e=this.$("#tva-dropdown-filter").val();if("0"!==e){const s=e.split(d);t[s[0]]=s[1]}}this.$(".tva-no-students").empty(),this.$customers.tvaToggleLoader(),this.fetchOrdered(t)})),this.renderCustomers(),this.renderPagination(),this.afterRender()),TVE_Dash.hideLoader(),this},renderCustomers:function(){this.$customers.empty(),this.collection.each((e=>{const t=new u({model:e,collection:this.collection,customer:e});this.$customers.append(t.render().$el)})),this.$(".tva-students-total").html(this.collection.total),this.$(".tva-students-label").html(TVA.Utils._n(this.collection.total,"student","students",!1)),this.$pagination.toggleClass("tva-flex-start",0===this.collection.length)},renderSearchFilter:function(){const e=new r;return this.$filters.append(e.render().$el),e},dropdownFilterChange:function(e,t){const s=t.value.split(d),i=n({},{s:this.searchFilterView.getValue()});this.$(".tva-no-students").empty(),i[s[0]]=s[1],this.$customers.tvaToggleLoader(),this.fetchOrdered(i)},renderDropdownFilter:function(){let e=[],s="Search";e=[...e,{id:"TA_Products_OptionGroup",name:"Products",option_group:1},...new m(this.products.map((e=>({id:e.term_id,name:e.name})))).getItems("ta_product_id")],e=[...e,{id:"Courses_OptionGroup",name:"Courses",option_group:1},...new m(TVA.courses.models).getItems("course_id")],TVA.sendowl.is_available&&(e=[...e,{id:"Products_OptionGroup",name:"SendOwl Products",option_group:1},...new m(TVA.sendowl.products).getItems("product_id")],e=[...e,{id:"Bundles_OptionGroup",name:"SendOwl Bundles",option_group:1},...new m(TVA.sendowl.bundles).getItems("bundle_id")],s+=" course, product, bundles..."),e.unshift({id:0,name:"All members"});const i=t('<select id="tva-dropdown-filter" class="change" data-fn="dropdownFilterChange"><option></option></select>');e.forEach((e=>{i.append(e.option_group?`<optgroup label="${e.name}"></optgroup>`:t("<option/>").val(e.id).text(e.name))})),i.find('option[value="0"]').attr("selected","selected"),this.$filters.append(i),i.select2({placeholder:"Filter by product"}).on("select2:open",(()=>{t("input.select2-search__field").prop("placeholder",s)})).data("select2").$dropdown.addClass("tva-customers-select")},renderPagination:function(){new a({el:this.$pagination,collection:this.collection,noItemTemplate:TVE_Dash.tpl("customers/empty-list")}).render()},afterInsert:function(){window.thriveReportsInit(this.el,"students")},addCustomer:function(){TVE_Dash.showLoader(),TVA.products.getAll().then((()=>{TVE_Dash.hideLoader(),this.openModal(l,{model:new o({}),collection:this.collection,width:"1180px",top:"40px",className:"tvd-modal tvd-modal-big"})}))},importCustomer:function(){TVE_Dash.showLoader(),TVA.products.getAll().then((()=>{TVE_Dash.hideLoader(),this.openModal(c,{model:new o({}),collection:this.collection,width:"1180px",top:"40px",className:"tvd-modal tvd-modal-big"})}))},orderBy:function(e){const s=t(e.currentTarget),i=e.currentTarget.dataset.col,n="asc"===e.currentTarget.dataset.order?"desc":"asc";s.attr("data-order",n),s.toggleClass("tva-rotate-90"),this.collection.ordering={},this.collection.ordering[i]=n,this.$customers.tvaToggleLoader(),this.fetchOrdered()},fetchOrdered:function(e={}){0!==Object.keys(e).length&&(this.collection.filters=e),this.collection.fetchWithData().success((e=>{this.collection.reset(e.items),this.collection.total=e.total,this.collection.resetPagination(),TVA.customers=this.collection,this.collection.trigger("fetched")}))}})}(jQuery)},31721:function(e,t,s){e.exports=s(2921).extend({model:null,collection:null,className:"tva-menu-item",template:TVE_Dash.tpl("menu-item"),selectedClass:"tva-menu-item-selected",disabledClass:"tva-menu-item-disabled",events:{click:function(e){let t=e.currentTarget.dataset.route;if(0!==this.model.get("items").length){const e=this.model.get("items").first();t=e?e.get("slug"):t}t&&this.changeView(t)}},tagName:function(){return this.model.has("href")?"a":"div"},initialize:function(){this.listenTo(this.model,"change:selected",this.onChangeSelected),this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template({model:this.model})).removeClass(`${this.disabledClass} tvd-tooltipped`).removeAttr("data-position data-tooltip data-route href target"),this.model.get("disabled")?this.$el.addClass(`${this.disabledClass} tvd-tooltipped`).attr({"data-position":"right","data-tooltip":this.model.get("disabled")}):this.model.has("route")?this.$el.attr("data-route",this.model.get("route")):this.model.has("href")&&this.$el.attr({href:this.model.get("href"),target:"_blank"}),"#home"===this.$el.attr("data-route")&&this.$el.addClass("tva-logo"),"#assessments"===this.$el.attr("data-route")&&(TVA.Utils.isTooltipViewed("assessments-intro")?TVA.assessments.pending_count&&this.$el.prepend(`<span class="tva-pending-count">${TVA.assessments.pending_count>99?"99+":TVA.assessments.pending_count}</span>`):this.$el.prepend(`<span class="tva-new-badge">${TVA.t.new}</span>`)),this},onChangeSelected:function(e,t){this.$el.toggleClass(this.selectedClass,t)}})},50186:function(e,t,s){!function(t){const i=s(31721),n=s(66740);e.exports=s(2921).extend({collection:null,className:"tva-menu",submenuView:null,afterInitialize:function(){this.listenTo(TVA.indexPageModel,"sync",(e=>{this.collection.findWhere({slug:"course-homepage"}).set({href:e.get("preview_url"),disabled:0===e.get("preview_url").length?"You need to have defined a course page":0})}))},render:function(){return this.$body=t("body"),this.$el.append('<div class="fixed-inner" />'),this.collection.each(this.renderMenuItem,this),this.submenuView=new n({collection:new Backbone.Collection}),this},renderMenuItem:function(e){if(e.get("hidden"))return;const t=new i({model:e});this.$(".fixed-inner").append(t.render().$el)}})}(jQuery)},49089:function(e,t,s){!function(t){const i=s(18156);e.exports=s(2921).extend({className:"tva-submenu-dropdown",tagName:"div",template:TVE_Dash.tpl("submenu-dropdown"),selectedClass:"tva-submenu-item-selected",collapsedClass:"tva-collapsed",events:{click:function(e){this.onDropdownOpen();const t=e.currentTarget.dataset.route;TVA.Router.navigate(t,{trigger:!0})}},initialize:function(){this.model.off("change:selected").on("change:selected",_.bind(this.onChangeSelected,this)),this.model.off("change:collapsed").on("change:collapsed",_.bind(this.onDropdownOpen,this))},render:function(){this.$el.html(this.template({model:this.model})),this.model.get("disabled")?this.$el.hide():this.model.get("route")?this.$el.attr("data-route",this.model.get("route")):this.model.get("href")&&this.$el.attr("onmousedown",`window.open('${this.model.get("href")}')`),!0===this.model.get("selected")&&this.$el.addClass(this.selectedClass),!0===this.model.get("collapsed")&&this.$el.addClass(this.collapsedClass);let e=t();return this.model.get("items").forEach((t=>{t.set("tag-name","div");const s=this.renderItem(t);e=e.add(s)})),this.$el.append(e),this},onChangeSelected:function(e,t){this.$el.toggleClass(this.selectedClass,t)},onDropdownOpen:function(e,t){this.$el.toggleClass(this.collapsedClass,t)},renderItem:function(e){return e.set("parentModel",this.model),new i({model:e,parentModel:this.model}).render().$el}})}(jQuery)},18156:function(e,t,s){jQuery,e.exports=s(2921).extend({className:"tva-submenu-item",tagName:"div",template:TVE_Dash.tpl("submenu-item"),selectedClass:"active",events:{click:function(e){e.stopPropagation();const t=e.currentTarget.dataset.route;TVA.Router.navigate(t,{trigger:!0})}},initialize:function(){this.model.off("change:selected").on("change:selected",_.bind(this.onChangeSelected,this))},render:function(){return this.$el.html(this.template({model:this.model})),this.model.get("disabled")?this.$el.hide():this.model.get("route")?this.$el.attr("data-route",this.model.get("route")):this.model.get("href")&&this.$el.attr("onmousedown",`window.open('${this.model.get("href")}')`),!0===this.model.get("selected")&&this.$el.addClass(this.selectedClass),this},onChangeSelected:function(e,t){this.$el.toggleClass(this.selectedClass,t)}})},66740:function(e,t,s){!function(t){const i=s(18156),n=s(49089);e.exports=s(2921).extend({menuItem:null,className:"tva-submenu",titleClassName:"tva-submenu-title",afterInitialize:function(){this.listenTo(this.collection,"reset",this.render)},render:function(){this.$el.empty().append('<div class="fixed-inner" />'),this.$(".fixed-inner").append(t(`<h3 class="${this.titleClassName}">${this.menuItem.get("label")}</h3>`)),this.menuItem instanceof Backbone.Model&&this.menuItem.get("sections")instanceof Backbone.Collection&&this.menuItem.get("sections").each((e=>{this.$(".fixed-inner").append(this.renderSection(e))}));let e=t();return this.collection.each((t=>{if(t.get("hidden"))return;const s=this.renderItem(t);t.get("section")?this.$(`.tva-submenu-section[data-slug="${t.get("section")}"]`).append(s):e=e.add(s)})),this.$el.toggle(!!e.length),this.$(".tva-submenu-title").after(e),this.$(".tva-submenu-section").hasClass("tva-submenu-simple")||this.$(".tva-submenu-section-title").on("click",(e=>{const s=t(e.currentTarget).parent();s.toggleClass("tva-collapsed"),this.menuItem.get("sections").findWhere({slug:s.data("slug")}).set("expanded",!s.hasClass("tva-collapsed"))})),this},renderItem:function(e){return e.get("items").length?new n({model:e}).render().$el:new i({model:e}).render().$el},renderSection:function(e){return t(`<div class="tva-submenu-section ${e.get("expanded")||e.get("simple")?"":"tva-collapsed"}${e.get("simple")?"tva-submenu-simple":""}" data-slug="${e.get("slug")}"><div class="tva-submenu-section-title">${e.get("label")}</div></div>`)}})}(jQuery)},55215:function(e,t,s){!function(t){const i=s(39105).extend({template:"modals/access-migration",productsMigrated:{},products:null,afterInitialize:function(){this.products=this.model.get("items"),this.spinnerURL=this.model.get("spinnerURL")},dom:function(){this.$statusWrapper=this.$("#tva-access-migrate-products"),!Array.isArray(this.products)||Array.isArray(this.products)&&0===this.products.length?this.checkMigrationDone():this.products.forEach((e=>{this.productsMigrated[e.term.term_id]=0;const s=t(`<div data-id="${e.term.term_id}" class="mb-5 tva-flex tva-flex-row tva-access-migrate-product"><div class="mr-10"><img width="20px" height="20px" class="tve-lazy-img" src="${this.spinnerURL}"/></div><div>${e.term.name}</div></div>`);this.$statusWrapper.append(s)}))},afterStep1Loaded:function(){this.migrate()},migrate:async function(){if(Array.isArray(this.products))for(const e of this.products)await this.migrateAccessForProduct(e.term.term_id).then((()=>{t(`div[data-id='${e.term.term_id}']`).find("img").replaceWith('<i style="color: green;" class="tvd-icon-check tvd-left"></i>'),this.checkMigrationDone()})).catch((e=>{TVE_Dash.err("Error during the migration process. Please contact Thrive Support!"),console.error(e)}))},migrateAccessForProduct:function(e){return new Promise(((t,s)=>{wp.apiRequest({url:TVA.migrate_access.route,type:"POST",data:{id:e}}).done((s=>{delete this.productsMigrated[e],t(s)})).fail((e=>s(e)))}))},checkMigrationDone:function(){0===Object.keys(this.productsMigrated).length&&(TVE_Dash.success("Migration done! Loading data..."),TVE_Dash.showLoader(),setTimeout((()=>{location.reload()}),2e3))}});e.exports=i}(jQuery)},27860:function(e,t,s){e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/api-key"),afterInitialize:function(){this.listenTo(this.model,"change:key",(e=>{this.$("#tva-token-key").val(e.get("key"))}))},changeFiled:function(e,t){const s={};s[t.getAttribute("data-field")]="checkbox"===t.type?Number(t.checked):t.value,this.model.set(s)},save:function(){const e=!!this.model.get("id");this.model.isValid()?(TVE_Dash.showLoader(),this.model.save(null,{success:t=>{!1===e?(this.collection.add(this.model),TVE_Dash.success(TVE_Dash.sprintf(TVA.t.token_name_saved,t.get("name")))):TVE_Dash.success(TVE_Dash.sprintf(TVA.t.token_name_saved,t.get("name")))},error:(e,t)=>{TVE_Dash.err(t.responseJSON.message)},complete:e=>{200===e.status&&this.close(),TVE_Dash.hideLoader()}})):TVE_Dash.err(this.model.getValidationError())}})},25670:function(e,t,s){const i=s(4023),n=s(39105),o=s(47949);e.exports=o.extend({template:TVE_Dash.tpl("modals/assessment-item"),stepSelector:".tva-modal-step",afterInitialize:function(e){this.parentStructure=e.structure,this.initialModel=this.model,this.model=this.model.clone(),this.listenTo(this.model,"change:assessment_type",this.toggleOptions),this.listenTo(this.model,"change:grading_method",this.toggleGradingOptions),this.listenTo(this.model,"change:quiz_id",this.handleQuiz),this.listenTo(this.model,"change:grading_manually_mark",this.manuallyMarked),this.listenTo(this.model,"change:upload_max_file_size",((e,t)=>{let s;t=parseInt(t),isNaN(t)?(t=1,s=!0):(t>parseInt(TVA.max_upload_size)||t<1)&&(t=Math.max(1,t),t=Math.min(t,parseInt(TVA.max_upload_size)),s=!0),s&&(this.model.set("upload_max_file_size",t),this.$("#tva-assessment-max-filesize").val(t))}))},afterRender:function(){n.prototype.afterRender.apply(this,arguments),this.$tabs=this.$(".tva-tab"),this.$tabsContent=this.$(".tva-tab-content"),this.$settingsOptions=this.$(".tva-assessment-options-section"),this.$parentsSelect=this.$("#tva-parent-target"),this.$description=this.$("#tva-item-description"),this.$quizSelect=this.$("#tva-assessment-quiz"),this.$types=this.$("#tva-assessment-type"),this.$fileTypes=this.$(".tva-assessment-file-type"),this.$gradingExtraSettings=this.$(".tva-grading-passing"),this.$fileNotice=this.$(".tva-assessment-files-notice"),this.$typeCards=this.$(".tva-assessment-type"),this.$uploadNotice=this.$(".tva-upload-notice"),this.$tqbUnavailable=this.$(".tva-tqb-unavailable"),this.$continueButton=this.$(".tva-assessment-continue"),this.$categoriesNotice=this.$(".tva-grading-categories-notice"),this.$categoriesReplaceNotice=this.$(".tva-grading-replace-categories-notice"),this.$markedNotice=this.$(".tva-marked-notice"),this.$customExtensions=this.$(".tva-assessment-custom-extensions"),this.$gradingMethod=this.$("#tva-grading-method"),this.$gradingMethodWrapper=this.$('.tva-grading-setting[data-setting="grading_method"]'),this.initCategoryTags(),this.model.get("assessment_type")?(this.goToAssessmentSettings(),this.$(".tva-ai-close").removeClass("tva-hide"),this.$(".tva-ai-go-back").addClass("tva-hide"),this.model.get("has_submission")&&this.disabledChanges()):(this.model.set("upload_allowed_files",["documents"]),this.decisionMaking()),TVE_Dash.data_binder(this),this.initGeneralOptions()},setType:function(e,t){this.model.set("assessment_type",t.dataset.type),this.$continueButton.removeClass("tva-disabled")},save:function(){if(this.$("input, textarea, [contenteditable]").trigger("blur"),this.model.isGradingMethodCategory()){const e={pass:this.passingCategories.list.toJSON(),fail:this.failingCategories.list.toJSON()};this.model.set("grading_method_data",e);const t=this.model.validateCategory(this.model.toJSON());t.length?(this.model.attributes.grading_method_data.pass.length||this.$(".tva-grading-passing-notice").removeClass("tva-hide").html(t[0].message),this.model.attributes.grading_method_data.fail.length||this.$(".tva-grading-fail-notice").removeClass("tva-hide").html(t[0].message)):this.$categoriesNotice.addClass("tva-hide")}else this.model.set("grading_method_data","");const e=this.model.save(null,{success:e=>{this.initialModel.set(e.toJSON()),this.structure.add(e);const t=TVA.courses.findWhere({id:this.course.get("id")});t&&t.trigger("tva.structure.modified",e)}});e&&(TVE_Dash.showLoader(),e.always((()=>{TVE_Dash.hideLoader(),this.close()})))},decisionMaking:function(){if(!this.model)return console.warn("a model has to be set in order to make decision for it");switch(this.structure.getType()){case"assessments":case"content":case"lessons":return this.goToTypePickup();case"chapters":case"modules":return this.model.getType()!==this.structure.getSingularType()&&this.model.set("post_parent",0),this.renderParentsDropDowns()}return this},renderParentsDropDowns:function(){return o.prototype.renderParentsDropDowns.apply(this,arguments),this.gotoStep(0),this},initGeneralOptions:function(){this.$("#tva-comment-status").val(this.model.get("comment_status")),this.$("#tva-freemium").val(this.model.get("freemium")),this.model.get("assessment_type")&&this.toggleOptions(this.model.get("assessment_type")),new i({el:this.$("#tva-assessment-image"),model:this.model,prop:"cover_image"}).render()},toggleOptions:function(){const e=this.model.get("assessment_type"),t=`init${TVA.Utils.camelCaseFuncName(e)}Options`;this.$settingsOptions.removeClass("tva-active"),this.$settingsOptions.filter(`[data-type=${e}]`).addClass("tva-active"),this.$uploadNotice.toggle("upload"===e&&!TVA.assessments.can_upload),this.$typeCards.removeClass("tva-active").filter(`[data-type=${e}]`).addClass("tva-active"),this.initUploadOptions(),"function"==typeof this[t]&&this[t](),this.hasQuizCategories&&this.resetDefaultCategories(),this.handleQuiz(),this.manuallyMarked()},resetDefaultCategories:function(){this.toggleCategoriesEditing(!1),this.failingCategories.resetList().renderTags(),this.passingCategories.resetList().renderTags(),this.hasQuizCategories=!1},initUploadOptions:function(){let e=this.model.get("upload_allowed_files")||[];e.length||(e=["documents"],this.model.set("upload_allowed_files",e)),e.forEach((e=>{this.$fileTypes.filter(`[data-file="${e}"]`).addClass("tva-active")})),this.$customExtensions.toggleClass("tva-hide",!e.includes("custom"))},initTqbOptions:function(){const e=this.getQuizzes(),t=this.model.get("quiz_id");this.$quizSelect.hasClass("select2-hidden-accessible")&&this.$quizSelect.select2("destroy"),this.$quizSelect.empty(),this.$quizSelect.append(`<option value="">${TVA.t.selectQuiz}</option>`),this.$quizSelect.append(e.map((e=>new Option(e.post_title,e.ID,!1,!1)))),this.$tqbUnavailable.addClass("tva-hide"),t&&(e.find((e=>parseInt(e.ID)===parseInt(t)))?this.$quizSelect.val(t):(this.$quizSelect.val(""),this.$tqbUnavailable.removeClass("tva-hide"))),TVE_Dash.materialize(this.$quizSelect.parent())},setTab:function(e,t){const s=t.dataset.tab;this.$tabs.removeClass("tva-active"),this.$tabsContent.removeClass("tva-active"),this.$tabsContent.filter(`.tva-tab-${s}`).addClass("tva-active"),this.$tabs.filter(`[data-tab="${s}"]`).addClass("tva-active"),this.bindZclip()},goToTypePickup:function(){this.gotoStep(1)},goToAssessmentSettings:function(){this.gotoStep(2),this.setTab(null,{dataset:{tab:"options"}}),this.toggleOptions(),this.toggleGradingOptions(),this.manuallyMarked(),this.$types.val(this.model.get("assessment_type")).trigger("change")},toggleAllowedFile:function(e,t){const s=t.dataset.file,i=this.model.get("upload_allowed_files")||[];i.includes(s)?(i.splice(i.indexOf(s),1),t.classList.remove("tva-active")):(i.push(s),t.classList.add("tva-active")),this.$fileNotice.toggleClass("tva-hide",0!==i.length),this.$customExtensions.toggleClass("tva-hide",!i.includes("custom")),this.model.set("upload_allowed_files",i)},loadDefaultCategory:function(e,t){const s=t.getAttribute("data-key");s&&(this.passingCategories.list.length||this.failingCategories.list.length?(this.defaultCategory=s,this.$(".tva-grc-text strong").html(TVA.t.assessments.category_grades[s]),this.$categoriesReplaceNotice.removeClass("tva-hide")):this.replaceCategories(s),this.$categoriesNotice.addClass("tva-hide"))},replaceCategories:function(e=this.defaultCategory){const t=TVA.assessments.default_categories[e].pass,s=TVA.assessments.default_categories[e].fail;this.passingCategories.resetList().addItems(t),this.failingCategories.resetList().addItems(s),this.$categoriesReplaceNotice.addClass("tva-hide")},allowReplaceCategories:function(){this.replaceCategories()},preventReplaceCategories:function(){this.defaultCategory="",this.$categoriesReplaceNotice.addClass("tva-hide")},toggleGradingOptions:function(){const e=this.model.get("grading_method");this.$gradingExtraSettings.removeClass("tva-active"),this.$gradingExtraSettings.filter(`[data-type=${e}]`).addClass("tva-active"),this.$categoriesNotice.addClass("tva-hide"),this.handleQuiz(),this.manuallyMarked()},handleQuiz:function(){const e=this.model.get("grading_method"),t=this.model.get("assessment_type"),s=this.model.get("quiz_id"),i=!!s&&this.getQuizzes().find((e=>parseInt(e.ID)===parseInt(s)));if("tqb"===t&&i){let t=e;switch(i.type){case"right_wrong":case"survey":t="pass_fail";break;case"number":t="score";break;case"percentage":t="percentage";break;case"personality":t="category"}e!==t&&(this.model.set("grading_method",t),this.$gradingMethod.val(t).trigger("change"))}this.$gradingMethodWrapper.toggleClass("tva-disabled","tqb"===t||this.model.get("has_submission")),this.ensureQuizCategories(i),this.$tqbUnavailable.toggleClass("tva-hide",!s||!!i)},ensureQuizCategories:function(e){const t=this.model.get("grading_method"),s=this.model.get("assessment_type");if(e&&"category"===t&&"tqb"===s)if("personality"===e.type){const t=e.results.map((e=>e.text)),s=this.getPassingCategories(),i=s.map((e=>e.name)),n=this.getFailingCategories(),o=[...i,...n.map((e=>e.name))];_.isEqual(t.sort(),o.sort())?(this.passingCategories.list=new Backbone.Collection(s),this.failingCategories.list=new Backbone.Collection(n),this.passingCategories.renderTags(),this.failingCategories.renderTags()):(this.passingCategories.resetList().addItems(t),this.failingCategories.resetList().renderTags()),this.hasQuizCategories=!0,this.toggleCategoriesEditing(this.hasQuizCategories)}else this.hasQuizCategories?(this.resetDefaultCategories(),this.hasQuizCategories=!1):this.hasQuizCategories=!1;else this.hasQuizCategories=!1},getPassingCategories:function(){var e;return(null===(e=this.model.get("grading_method_data"))||void 0===e?void 0:e.pass)||[]},getFailingCategories:function(){var e;return(null===(e=this.model.get("grading_method_data"))||void 0===e?void 0:e.fail)||[]},toggleCategoriesEditing:function(e=!0){this.$(".tva-grading-default-categories-select, .tvd-add-tag-toggle, .tvd-remove-tag").toggleClass("tva-hide",e)},initCategoryTags:function(){this.tooltipKey="assessment-categories-notice",TVA.Utils.isTooltipViewed(this.tooltipKey)||(this.$tooltip=this.$(".tva-assessment-categories-notice"),this.$tooltip.removeClass("tva-hide")),this.passingCategories=new TVE_Dash.views.Tags({extraInputClass:"tvd-skip-modal-save",heading:TVA.t.passingCategories,list:this.getPassingCategories(),placeholder:{addGrade:TVA.t.addGrade,newGrade:TVA.t.newGrade},noTagsText:TVE_Dash.sprintf(TVA.t.noGrades,"passing"),extraTagProps:{grading:"passing"},validateTag:e=>{const t=this.failingCategories.list.findWhere({name:e});return e.length&&!t},afterTagAdded:()=>{this.$categoriesNotice.addClass("tva-hide")}}),this.$(".tva-grading-passing-categories").html(this.passingCategories.render().$el),this.passingCategories.connectWith(".tva-grading-failing-categories .tvd-tags-list"),this.failingCategories=new TVE_Dash.views.Tags({extraInputClass:"tvd-skip-modal-save",heading:TVA.t.failingCategories,list:this.getFailingCategories(),placeholder:{addGrade:TVA.t.addGrade,newGrade:TVA.t.newGrade},noTagsText:TVE_Dash.sprintf(TVA.t.noGrades,"failing"),extraTagProps:{grading:"failed"},validateTag:e=>{const t=this.passingCategories.list.findWhere({name:e});return e.length&&!t},afterTagAdded:()=>{this.$categoriesNotice.addClass("tva-hide")}}),this.$(".tva-grading-failing-categories").html(this.failingCategories.render().$el),this.failingCategories.connectWith(".tva-grading-passing-categories .tvd-tags-list")},getQuizzes:function(){return Object.values(TVA.quizzes)},disabledChanges:function(){this.$(".tva-with-submissions-notice").removeClass("tva-hide"),this.$(".tva-assessment-no-edit").addClass("tva-disabled")},goToLink:function(e,t){e.preventDefault(),this.close(),location.href=t.dataset.url},manuallyMarked:function(){let e=this.model.get("grading_method");["category","score","percentage"].includes(e)&&"tqb"===this.model.get("assessment_type")&&(e=`${e}_quiz`),this.$markedNotice.addClass("tva-hide").filter(`[data-type="${e}"]`).toggleClass("tva-hide",parseInt(this.model.get("grading_manually_mark"))>0)},hideTooltip:function(e,t){return this.$(t).closest(".tva-container-notice").hide(),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},39105:function(e,t,s){var i;i=jQuery,e.exports=TVE_Dash.views.Modal.extend({zClipCopiedClass:"tva-copied",template:"",currentStep:0,previouslyStep:0,stepSelector:".tva-modal-step",events:{"click .click":"_call","input .input":"_call","keyup .keyup":"_call","change .change":"_call"},_call:function(e){const t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)},afterRender:function(){return(this.$steps=this.$el.find(this.stepSelector).hide()).length&&this.gotoStep(0),this.bindZclip(),this.dom(),this},bindZclip:function(){const e=s(51135);setTimeout((()=>e.prototype.bindZclip.call(this,null)),200)},gotoStep:function(e){var t;return(null===(t=this.stepCss)||void 0===t?void 0:t[e])&&this.$el.animate(this.stepCss[e],100),this.$steps.hide().eq(e).show(),this.previouslyStep=this.currentStep,this.currentStep=e,"function"==typeof this[`afterStep${e}Loaded`]&&this[`afterStep${e}Loaded`](),this},goToPreviouslyStep:function(){return this.$steps.length&&this.gotoStep(this.previouslyStep),this},jumpToStep:function(e,t){const s=parseInt(t.getAttribute("data-step"));return this.$steps.length&&this.allowJumpToStep(s)&&this.gotoStep(s),this},allowJumpToStep:function(e){return!0},getCurrentStep:function(){return i(this.$steps[this.currentStep])},dom:i.noop})},25033:function(e,t,s){e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/certificate-tos"),afterRender:function(){const e=this.$(".tva-themes-tos-text")[0].innerText;e.split("\n").map((e=>`<p>${e}</p>`)).join(""),this.$(".tva-themes-tos-text")[0].innerText=e},declineTerms:function(){this.close()},acceptTerms:function(){sessionStorage.setItem("certificateTOS","accepted"),this.close()},afterOpen:function(){this.$('[data-fn="acceptTerms"]').focus()},beforeClose:function(){const e="accepted"===sessionStorage.getItem("certificateTOS");this.toggle.checked=e,this.dropdown[e?"show":"hide"](),this.model.set("has_certificate",Number(e))}})},49939:function(e,t,s){var i;i=jQuery,e.exports=s(2707).extend({afterInitialize:function(e){i.extend(!0,this,e)},confirm:function(){this.close()},afterOpen:function(){this.$('[data-fn="confirm"]').focus()}})},91479:function(e,t,s){!function(t){const i=s(39105),n=["inherit","message","content","redirect_login","redirect_custom"];e.exports=i.extend({template:TVE_Dash.tpl("modals/course-access-restriction"),title:TVA.t.access_restriction_edit,sourceModel:null,saving:!1,afterRender:function(){this.contentRestriction.model&&(this.sourceModel=this.contentRestriction.model.deepClone()),this.$(".tva-content-restriction").html(this.contentRestriction.render().$el)},afterOpen:function(){this.$el.css("overflow","visible")},onClose:function(){this.sourceModel&&!1===this.saving&&(this.contentRestriction.model.deepSet("option",this.sourceModel.get("option")),this.sourceModel.save()),this.saving=!1},save:function(){const e=this.contentRestriction.model.validateOptions();if(!0!==e)return TVE_Dash.err(e);this.showLoader(),this.saving=!0,this.contentRestriction.model.save().done((e=>{const s=t.extend(!0,{},this.contentRestriction.model.attributes);n.forEach((e=>{s.option!==e&&delete s[e]})),"redirect_custom"===s.option&&(s.redirect_custom.post=this.contentRestriction.customPageModel.attributes),"custom"!==s.scope&&(s.course_id=this.course.id,this.course.deepSet(`access_restrictions.${s.scope}`,s)),this.contentRestriction.trigger("model.sync",this,e),this.accessTab.render(),this.close(),TVE_Dash.success(TVA.t.SuccessSettings)})).fail((e=>TVE_Dash.err("Something went wrong: "+e.responseText))).always((()=>this.hideLoader()))}})}(jQuery)},47949:function(e,t,s){!function(t){const i=s(39105),n=s(2921),o=s(23150);e.exports=i.extend({template:TVE_Dash.tpl("modals/course-item"),stepSelector:".tvd-modal-step",events:t.extend(i.prototype.events,{"change #tva-parent-target":function(e){const s=isNaN(parseInt(e.currentTarget.value))?0:parseInt(e.currentTarget.value);if(!s)return this.structure=this.parentStructure,void this.model.set("post_parent",void 0);t(e.currentTarget).siblings("#tva-child-target").select2("destroy").remove();const i=this.parentStructure.findItem(s);this.__lastSelectedParent=i,this.model.set("post_parent",s),i&&i.get("structure")instanceof o&&(this.structure=i.get("structure"),this.model.set("order",this.structure.getOrderForNewItem()))}}),afterInitialize:function(e){this.parentStructure=e.structure},afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.model?this.decisionMaking():this.gotoStep(0)},renderForm:function(e){e instanceof Backbone.Model||(e=this.model),this.gotoStep(2);const t=new(s(71180)(`./${e.getType()}`))({el:this.$("#tvd-form-modal-step").find(".tvd-modal-content"),model:e}).render();return this.input_focus(t.$el),this.model.get("id")&&this.model.isPublished()||this.$el.find(".tva-course-item-slug").siblings(".tva-zclip").attr("disabled","disabled").html(""),this},decisionMaking:function(){if(!this.model)return console.warn("a model has to be set in order to make decision for it");if("content"===this.structure.getType()||this.model.get("id"))return!this.model.get("post_parent")&&this.__lastSelectedParent&&this.model.set("post_parent",this.__lastSelectedParent.get("id")),this.renderForm(this.model);switch(this.model.getType()){case"lesson":switch(this.structure.getType()){case"assessments":case"lessons":return this.renderForm(this.model);case"chapters":case"modules":return this.model.getType()!==this.structure.getSingularType()&&this.model.set("post_parent",0),this.renderParentsDropDowns()}break;case"chapter":switch(this.structure.getType()){case"chapters":return this.renderForm(this.model);case"modules":return this.renderParentsDropDowns();case"assessments":case"lessons":this.model.set("merge_items",this.structure.pluck("id"));const e=this.structure.where({post_status:"publish"});return this.model.set("post_status",e.length>0?"publish":"draft"),this.renderWarning()}break;case"module":switch(this.structure.getType()){case"assessments":case"lessons":case"chapters":this.model.set("merge_items",this.structure.pluck("id"));const e=this.structure.where({post_status:"publish"});return this.model.set("post_status",e.length>0?"publish":"draft"),this.renderWarning();case"modules":return this.renderForm(this.model)}}return this},setModel:function(e,t){const i=t.dataset.type;if(!i)return this;const o=s(25252)(`./${i}`);if(this.model=new o({course_id:this.course.get("id"),order:this.structure.getSingularType()===i?this.structure.getOrderForNewItem():0,comment_status:this.course.get("allows_comments")?"open":"closed"}),"assessment"===i){this.close();const e=s(25670);return n.prototype.openModal(e,{course:this.course,model:this.model,structure:this.structure}),this}return this.decisionMaking()},renderWarning:function(){const e=this.$("#tva-moving-item-text");return e.text(TVE_Dash.sprintf(e.text(),[this.structure.getType(),this.model.getType(),this.structure.getType()])),this.gotoStep(3)},renderParentsDropDowns:function(){switch(this.gotoStep(1),this.$parentsSelect=this.$("#tva-parent-target").empty(),this.$description=this.$("#tva-item-description"),this.structure.getType()){case"chapters":this.$description.text(TVE_Dash.sprintf(TVA.t.WhichChapter,this.model.getType())),this.$parentsSelect.append(t(`<option value="">${TVA.t.SelectChapter}</option>`));break;case"modules":this.$description.text(TVE_Dash.sprintf(TVA.t.WhichModule,this.model.getType())),this.$parentsSelect.append(t(`<option value="">${TVA.t.SelectModule}</option>`))}return this.structure.each((e=>{this.$parentsSelect.append(t(`<option value="${e.get("id")}">${e.get("post_title")}</option>`))})),this.$parentsSelect.select2(),this},setParent:function(){return this.model.get("post_parent")?this.decisionMaking():TVE_Dash.err(TVE_Dash.sprintf(TVA.t.PleaseSelect,"modules"===this.structure.getType()?TVA.t.Module:TVA.t.Chapter))},save:function(){const e=this.$el.find(".tva-course-item-slug"),t=this.model.get("post_name"),s=!this.model.get("id");if(e.removeClass("tva-error"),!t&&!s)return e.addClass("tva-error"),e.focus(),TVE_Dash.err(TVA.t.InvalidSlug),!1;this.model.get("merge_items")&&this.model.set("structure",new o(this.structure.toJSON()));const i=this.model.get("structure"),n=this.model.changedAttributes();i&&!1!==n&&Object.keys(n).includes("comment_status")&&i.updateChildrenCommentStatus(this.model.get("id"),this.model.get("comment_status"));const r=this.model.save(null,{success:e=>{e.set("structure",i),this.model.get("merge_items")?(this.structure.reset([this.model]),this.model.get("structure").each((t=>{t.set("post_parent",e.get("id"))}))):this.structure.add(e);const t=TVA.courses.findWhere({id:this.course.get("id")});t&&t.trigger("tva.structure.modified",e),s&&e.expand()}});r&&(TVE_Dash.showLoader(),r.always((()=>{this.model.set("merge_items",!1),TVE_Dash.hideLoader(),this.close()})))}})}(jQuery)},73393:function(e,t,s){const i=s(20898);e.exports=s(2707).extend({template:TVE_Dash.tpl("modals/courses/item"),afterInitialize:function(e={}){e.model||(this.model=new i({course_id:e.course.get("id"),order:parseInt(this.structure.length),post_parent:isNaN(parseInt(e.post_parent))?0:parseInt(e.post_parent)}))},afterRender:function(){return new(s(91975))({el:this.$_content,model:this.model}).render(),this},save:function(){const e=this.model.save(null,{success:e=>{this.structure.add(e);const t=TVA.courses.findWhere({id:this.course.get("id")});t&&t.trigger("tva.structure.modified",e)}});e&&(TVE_Dash.showLoader(),e.always((()=>{TVE_Dash.hideLoader(),this.close()})))}})},54637:function(e,t,s){!function(t){const i=s(23150),n=s(66795);e.exports=n.extend({template:TVE_Dash.tpl("modals/courses/content"),warningTemplate:TVE_Dash.tpl("courses/merge-warning"),$parentsSelect:null,$description:null,targetStructure:null,events:t.extend(n.prototype.events,{"change #tva-parent-target":function(e){t(e.currentTarget).siblings("#tva-child-target").select2("destroy").remove();const s=isNaN(parseInt(e.currentTarget.value))?0:parseInt(e.currentTarget.value),n=this.structure.findItem(s);if(this.itemModel.set("post_parent",s),n&&n.get("structure")instanceof i&&(this.targetStructure=n.get("structure")),n&&"module"===n.getType()&&"chapters"===n.get("structure").getType()){this.itemModel.set("post_parent",0);const e=t("<select/>").attr("id","tva-child-target").append(`<option value="">${TVA.t.SelectChapter}</option>`).on("change",(e=>{const t=isNaN(parseInt(e.currentTarget.value))?0:parseInt(e.currentTarget.value),s=this.structure.findItem(t);this.itemModel.set("post_parent",t),s&&s.get("structure")instanceof i&&(this.targetStructure=s.get("structure"))}));this.$step.find(".tvd-modal-content").append(e),n.get("structure").each((t=>{e.append(`<option value="${t.get("id")}">${t.get("post_title")}</option>`)})),e.select2()}}}),afterRender:function(){return n.prototype.afterRender.apply(this,arguments),this.$description=this.$("#tva-item-description"),this.$parentsSelect=this.$("#tva-parent-target"),this},decisionMaking:function(e,t){const i=t.dataset.type,n=s(25252)(`./${i}`);if(this.itemModel=new n({course_id:this.course.get("id"),order:this.structure.length}),0===this.structure.length)return this.gotoStep(2),this.renderForm();switch(this.itemModel.getType()){case"lesson":switch(this.structure.getType()){case"lessons":return this.next(),this.renderForm();case"chapters":case"modules":return this.renderParentsDropDowns()}break;case"chapter":switch(this.structure.getType()){case"chapters":return this.next(),this.renderForm();case"modules":return this.renderParentsDropDowns();case"lessons":this.itemModel.set("merge_items",this.structure.pluck("id"));const e=this.structure.where({post_status:"publish"});return this.itemModel.set("post_status",e.length>0?"publish":"draft"),this.renderWarning()}break;case"module":switch(this.structure.getType()){case"lessons":case"chapters":this.itemModel.set("merge_items",this.structure.pluck("id"));const e=this.structure.where({post_status:"publish"});return this.itemModel.set("post_status",e.length>0?"publish":"draft"),this.renderWarning();case"modules":return this.next(),this.renderForm()}}},parentSet:function(){if(this.itemModel.get("merge_items"))return this.next(),void this.renderForm();const e=this.targetStructure?this.targetStructure.getType():this.structure.getType();if(!this.itemModel.get("post_parent"))return TVE_Dash.err(TVE_Dash.sprintf(TVA.t.PleaseSelect,"modules"===e?TVA.t.module:TVA.t.chapter));if("lessons"===this.targetStructure.getType()&&"chapter"===this.itemModel.getType()){const e=this.structure.where({post_status:"publish"});return this.itemModel.set("post_status",e.length>0?"publish":"draft"),this.itemModel.set("merge_items",this.targetStructure.pluck("id")),this.renderWarning()}this.next(),this.renderForm()},renderParentsDropDowns:function(){switch(this.$parentsSelect.empty(),this.structure.getType()){case"chapters":this.$description.text("In which chapter you would like to add your lesson"),this.$parentsSelect.append(t(`<option value="">${TVA.t.SelectChapter}</option>`));break;case"modules":this.$description.text(TVE_Dash.sprintf(TVA.t.WhichModule,this.itemModel.getType())),this.$parentsSelect.append(t(`<option value="">${TVA.t.SelectModule}</option>`))}this.structure.each((e=>{this.$parentsSelect.append(t(`<option value="${e.get("id")}">${e.get("post_title")}</option>`))})),this.$parentsSelect.select2()},renderWarning:function(){this.$step.find(".tvd-modal-content").html(this.warningTemplate())},backToStepZero:function(){this.gotoStep(0)},renderForm:function(){new(s(71180)(`./${this.itemModel.getType()}`))({el:this.$step.find("> .tvd-modal-content"),model:this.itemModel}).render()},save:function(){const e=this.itemModel.save(null,{success:e=>{if(this.targetStructure)if("lessons"===this.targetStructure.getType()&&"chapter"===e.getType()){const t=new i(this.targetStructure.toJSON());t.updateModels({post_parent:e.get("id")}),e.set("structure",t),this.targetStructure.reset([this.itemModel])}else this.targetStructure.add(e);else if(e.get("merge_items")){const t=new i(this.structure.toJSON());t.updateModels({post_parent:e.get("id")}),e.set("structure",t),this.structure.reset([this.itemModel])}else this.structure.add(e);const t=TVA.courses.findWhere({id:this.course.get("id")});t&&t.trigger("tva.structure.modified",e)}});e&&(TVE_Dash.showLoader(),e.always((()=>{this.close(),TVE_Dash.hideLoader()})))}})}(jQuery)},94968:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=TVE_Dash.views.ModalSteps,a=s(20898);e.exports=r.extend({template:TVE_Dash.tpl("courses/grouping/chapter"),parent:null,course:null,structure:null,orphans:[],selectedItems:[],events:function(){return n(n({},r.prototype.events),{},{"click .tvd-modal-save":"save"})},initialize:function(e){this.setup(e),r.prototype.initialize.call(this,e),this.setupOrphans()},setupOrphans:function(){this.selectedItems.some((e=>{const t=e.getParent();let s=null;return t?"module"===t.getType()&&(s=t.get("structure")):s=this.structure,s&&(this.orphans=s.filter((e=>!this.selectedItems.includes(e)))),!!s}))},prepareSelection:function(e){return e},setup:function(e){this.parent=e.parent,this.course=this.parent.model,this.structure=this.parent.collection,this.selectedItems=this.prepareSelection(e.parent.selected)},getNewItemParent:function(){const e=this.selectedItems[0].getModule();return e?e.get("ID"):0},getNewItemOrder:function(){const e=this.selectedItems[0].getModule();return this.structure.countChildren(e?e.get("ID"):0)},afterRender:function(){r.prototype.afterRender.call(this);const e=this.getNewItemParent();let t=this.getNewItemOrder();if(this.orphans.length){let s=t;this.orphans[0].get("order")<this.selectedItems[0].get("order")?t++:s=t+1,this.orphanItemForm=new Backbone.View({model:this.newModel(s,e,this.orphans.map((e=>e.get("ID")))),el:this.$(".tva-orphans-form")[0]}),TVE_Dash.data_binder(this.orphanItemForm)}this.itemForm=new Backbone.View({model:this.newModel(t,e,this.selectedItems.map((e=>e.get("ID")))),el:this.$(".tva-chapter-form")[0]}),TVE_Dash.data_binder(this.itemForm)},beforeNext:function(){if(1===this.currentStep&&this.orphans.length&&!this.orphanItemForm.model.isValid())return!1},newModel:function(e,t,s){return new a({post_parent:t,type:"chapter",order:e,course_id:this.course.get("id"),item_ids:s})},url:function(){return`${TVA.routes.chapters}/group_as_chapter`},successMessage:function(){return TVA.t.success_chapter_group},save:function(){if(!this.itemForm.model.isValid())return!1;const e=[];this.orphans.length&&e.push(this.orphanItemForm.model.toJSON()),e.push(this.itemForm.model.toJSON()),this.showLoader(),wp.apiRequest({url:this.url(),type:"post",data:{course_id:this.course.get("id"),items:e}}).done((e=>{this.structure.reset(e),this.close(),TVE_Dash.success(this.successMessage())}))}})},17160:function(e,t,s){const i=s(94968),n=s(87168);e.exports=i.extend({template:TVE_Dash.tpl("courses/grouping/module"),prepareSelection:function(e){const t=e.filter((e=>"chapter"===e.getType()));return t&&t.length&&(e=e.filter((e=>"chapter"===e.getType()))),e},setupOrphans:function(){this.selectedItems.some((e=>{const t=e.getParent();let s=null;return t&&("chapter"!==t.getType()||t.getParent())||(s=this.structure),s&&(this.orphans=s.filter((e=>!this.selectedItems.includes(e)))),!!s}))},getNewItemParent:function(){return 0},getNewItemOrder:function(){const e=this.structure.findItemsByOptions({post_type:"tva_module"});return e&&e.length||0},newModel:function(e,t,s){return new n({post_parent:t,type:"module",order:e,course_id:this.course.get("id"),item_ids:s})},url:function(){return`${TVA.routes.modules}/group_as_module`},successMessage:function(){return TVA.t.success_module_group}})},68179:function(e,t,s){const i=s(88524);e.exports=s(2707).extend({template:TVE_Dash.tpl("modals/courses/item"),afterInitialize:function(e={}){e.model||(this.model=new i({course_id:e.course.get("id"),order:this.structure.length,post_parent:this.parentModel instanceof Backbone.Model?this.parentModel.get("id"):0,comment_status:this.parentModel instanceof Backbone.Model?this.parentModel.get("comment_status"):"closed"}))},afterRender:function(){return new(s(83094))({el:this.$_content,model:this.model}).render(),this},save:function(){const e=this.model.save(null,{success:e=>{this.structure.add(e);const t=TVA.courses.findWhere({id:this.course.get("id")});t&&t.trigger("tva.structure.modified",e),this.lesson.trigger("render")}});e&&(TVE_Dash.showLoader(),e.always((()=>{TVE_Dash.hideLoader(),this.close()})))}})},37653:function(e,t,s){const i=s(87168);e.exports=s(2707).extend({template:TVE_Dash.tpl("modals/courses/item"),afterInitialize:function(e={}){e.model||(this.model=new i({course_id:e.course.get("id"),order:this.structure.length}))},afterRender:function(){return new(s(71537))({el:this.$_content,model:this.model}).render(),this},save:function(){const e=this.model.get("structure"),t=this.model.changedAttributes();!1!==t&&Object.keys(t).includes("comment_status")&&e.updateChildrenCommentStatus(this.model.get("id"),this.model.get("comment_status"));const s=this.model.save(null,{success:t=>{this.structure.add(t),t.set("structure",e);const s=TVA.courses.findWhere({id:this.course.get("id")});s&&s.trigger("tva.structure.modified",t)}});s&&(TVE_Dash.showLoader(),s.always((()=>{TVE_Dash.hideLoader(),this.close()})))}})},95231:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=TVE_Dash.views.ModalSteps,a=s(59579),l=s(23150);e.exports=r.extend({template:TVE_Dash.tpl("courses/move"),courses:[],selectionType:"module",state:null,events:function(){return n(n({},r.prototype.events),{},{"change .select-item":"selectionChanged","click .tvd-modal-save":"save"})},initialize:function(e){this.parent=e.parent,this.course=this.parent.model,this.structure=this.parent.collection,this.selectedItems=e.parent.selected;const t=this.selectedItems.filter((e=>"module"===e.getType())),s=this.selectedItems.filter((e=>"chapter"===e.getType())),i=this.selectedItems.filter((e=>"lesson"===e.getType()));t.length?this.selectionType="module":s.length?this.selectionType="chapter":i.length?this.selectionType="lesson":this.selectionType="assessment",r.prototype.initialize.call(this,e),this.state=new Backbone.Model({coursesFetched:!1,selectedCourse:null,selectedModule:null,selectedChapter:null,canSave:!1}),this.listenTo(this.state,"change",this.render.bind(this))},afterRender:function(){this.state.get("coursesFetched")||this.fetchCourses()},fetchCourses:function(){this.$(".tva-loader-courses").tvaToggleLoader(20,!0,{background:"",position:"outside-right"}),wp.apiRequest({url:`${TVA.routes.courses}/for-selection`,data:{selection_type:this.selectionType,exclude:[this.course.get("id")]}}).done((e=>{this.courses=e.map((e=>(e.structure=new l(e.structure),new a(e)))).sort(((e,t)=>{const s=parseInt(e.order),i=parseInt(t.order);return s<i?-1:s>i?1:0})),this.state.set("coursesFetched",!0),1===this.courses.length&&this.selectCourse(this.courses[0].get("id")).checkValid()}))},selectionSummary:function(){const e=this.selectedItems.filter((e=>"module"===e.getType()));if(e.length)return TVA.Utils._n(e.length,"module");const t=this.selectedItems.filter((e=>"chapter"===e.getType()));return t.length?TVA.Utils._n(t.length,"chapter"):TVA.Utils._n(this.selectedItems.length,"lesson")},selectCourse:function(e){e=parseInt(e);const t=this.courses.filter((t=>e===t.get("id")))[0];let s,i;return this.state.set("selectedCourse",t,{silent:!0}),i=this.needsModuleSelection()&&1===(s=this.getAvailableModules()).length?s[0].get("ID"):0,this.selectModule(i),this},selectModule:function(e){const t=this.state.get("selectedCourse").get("structure").findItem(e);let s,i;return this.state.set("selectedModule",t,{silent:!0}),i=this.needsChapterSelection()&&1===(s=this.getAvailableChapters()).length?s[0].get("ID"):0,this.selectChapter(i),this},selectChapter:function(e){return this.state.set("selectedChapter",this.state.get("selectedCourse").get("structure").findItem(e),{silent:!0}),this},selectionChanged:function(e){this[`select${TVA.Utils.ucFirst(e.currentTarget.getAttribute("name"))}`](e.currentTarget.value),this.checkValid()},needsModuleSelection:function(){return!("module"===this.selectionType||!this.state.get("selectedCourse")||!this.state.get("selectedCourse").hasModules()||!this.getAvailableModules().length)},needsChapterSelection:function(){const e=this.state.get("selectedCourse");if(!["lesson","assessment"].includes(this.selectionType)||!e)return!1;const t=this.state.get("selectedModule");if(this.needsModuleSelection()&&!t)return!1;const s=t?t.get("structure"):e.get("structure");return!!s.length&&!s.every((e=>["lesson","assessment"].includes(e.getType())))},getAvailableModules:function(){const e=this.selectionType;return this.state.get("selectedCourse").get("structure").filter((t=>"module"===t.getType()&&(!t.get("structure").length||!!["lesson","assessment"].includes(e)||t.get("structure").every((t=>t.getType()===e)))),this)},getAvailableChapters:function(){return(this.state.get("selectedModule")||this.state.get("selectedCourse")).get("structure").filter((e=>"chapter"===e.getType()))},selectedCourseId:function(){const e=this.state.get("selectedCourse");return e&&e.get("id")||0},selectedModuleId:function(){const e=this.state.get("selectedModule");return e&&e.get("ID")||0},selectedChapterId:function(){const e=this.state.get("selectedChapter");return e&&e.get("ID")||0},checkValid:function(){const e=this.state.get("selectedCourse")&&(this.state.get("selectedModule")||!this.needsModuleSelection())&&(this.state.get("selectedChapter")||!this.needsChapterSelection());this.state.set("canSave",e,{silent:!0}),this.state.trigger("change")},preparePostData:function(){const e=this.selectedItems[0].get("post_parent"),t=TVA.Utils.pluckFields(this.selectedItems,["ID","post_parent","course_id","post_type","post_status"]).map((t=>(t.old_post_parent=e,t.course_id=this.selectedCourseId(),t.post_parent=this.selectedChapterId()||this.selectedModuleId()||0,t)));return{v:"2",action:"move",course_id:this.course.get("id"),high_level:this.selectionType,items:t}},save:function(){const e=this.preparePostData(),t=e.items.filter((e=>"tva_lesson"===e.post_type)).length,s=this.selectedCourseId();this.showLoader(),wp.apiRequest({url:`${TVA.routes.courses}/bulk_action`,type:"post",data:e}).done((e=>{this.course.get("structure").reset(e.structure),this.course.recountItems(),this.parent.render();const i=TVA.courses.findWhere({id:s});i.set({count_lessons:i.get("count_lessons")+t,fetched:!1},{silent:!0}),i.saveState(),this.course.trigger("tva.structure.status.changed"),i.trigger("tva.structure.status.changed"),this.close(),TVE_Dash.success(TVA.t.items_moved)}))}})},95974:function(e,t,s){!function(t){const i=s(2707),n=s(49406),o=s(90046),r=s(88732);e.exports=i.extend({$$children:[],template:"modals/courses/resources",initialCount:0,afterInitialize:function(){this.collection=n.get(this.lessonID),this.listenTo(this.collection,"add",this.renderItems.bind(this)),this.listenTo(this.collection,"render",this.renderItems.bind(this)),this.listenTo(this.collection,"remove",this.renderItems.bind(this)),this.listenTo(this.collection,"fetch",this.showLoader.bind(this)),this.listenTo(this.collection,"sync",(()=>{this.hideLoader(),this.renderItems()})),this.toRemove=[]},afterRender:function(){this.showLoader(),this.collection.fetch().done((()=>{this.collection.each((e=>e.set("expanded",!1,{silent:!0}))),this.initialCount=this.collection.length,this.renderItems()})),this.$el.addClass("tva-res-modal"),this.$(".scrollbar-inner").scrollbar(),this.$saveButton=this.$('button[data-fn="save"]')},renderItems:function(){let e=t();const s=this.collection.length;this.$$children.forEach((e=>e.destroy())),this.$$children=[],this.collection.sort(),this.collection.each(((t,s)=>{t.$$index=s;const i=new r({model:t});e=e.add(i.render().$el),this.$$children.push(i),t.get("expanded")&&i.$el.addClass("tva-expanded")}));const i=this.$(".tva-resources").html(e).sortable({handle:".tva-drag-handle",stop:()=>{i.sortable("destroy"),i.children().each(((e,t)=>{this.collection.at(Number(t.dataset.resourceIndex)).set("order",e,{silent:!0})})),this.collection.trigger("render")}});this.$(".tva-resources-start").toggle(0===s),this.$saveButton.toggleClass("tva-disabled",0===s&&0===this.initialCount)},beforeClose:function(){this.stopListening(),this.undelegateEvents(),this.collection.each((e=>{e.unset("delete_confirmation",{silent:!0}),e.unset("editing",{silent:!0})}))},addClicked:function(){this.$(".tva-resources-start").hide();const e=new o({order:this.collection.length,title:"Resource "+this.collection.getAutoIncrement(),icon:o.icons.default,expanded:!0});return this.collection.each((e=>e.trigger("collapse"))),this.collection.add(e),requestAnimationFrame((()=>TVE_Dash.materialize(this.$el))),setTimeout((()=>{const e=this.$(".tva-styled-scrollbar.scroll-content");e.animate({scrollTop:e[0].scrollTop+200},150)}),200),!1},removeClicked:function(e,t){const s=this.collection.at(Number(t.dataset.index));return s.get("delete_confirmation")?(s.get("id")&&this.toRemove.push(s.get("id")),this.collection.remove(s),this.collection.buildOrder(),!1):(s.set("delete_confirmation",!0),!1)},save:function(){let e=!0,t=!1;const s=this.$(".tvd-modal-content");if(this.collection.each(((i,n)=>{!0!==i.validateConfig()&&(t||(t=!0,s.animate({scrollTop:s[0].scrollTop-s.offset().top+this.$$children[n].$el.offset().top},150)),e=!1)})),!e)return TVE_Dash.err(TVA.t.resources.fix_errors);this.showLoader(),n.save(this.collection,this.toRemove).fail((e=>{TVE_Dash.err("Something went wrong. Could not save resources"),console.error(e)})).done((()=>{this.lesson.set("resource_count",this.collection.length),this.lesson.trigger("render"),TVE_Dash.success(TVA.t.resources.save_success),this.close()})).always(this.hideLoader.bind(this))}})}(jQuery)},88732:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(2921),a=s(896),l=s(36832);e.exports=r.extend({className:"tva-resource tva-draggable tva-flex tva-align-stretch",template:TVE_Dash.tpl("courses/resources/item"),events:n(n({},r.prototype.events),{},{"change .tva-title-events":"onTitleChange","blur .tva-title-events":"onTitleBlur","keyup .tva-title-events":"onTitleKeyup","change .model-field":"fieldChanged"}),afterInitialize:function(){this.listenTo(this.model,"change",this.render.bind(this)),this.listenTo(this.model,"collapse",this.collapse),this.mediaFrame=wp.media({title:"Select or upload a file",button:{text:"Use this file"}}),this.mediaFrame.on("select",(()=>{const e=this.mediaFrame.state().get("selection").first().toJSON();this.model.deepSet("config.attachment",{id:e.id,url:e.url,filename:e.filename,size:e.filesizeHumanReadable})}))},afterRender:function(){this.$el.toggleClass("tva-has-error",this.model.hasError()),this.$el.attr("data-resource-index",this.model.$$index),requestAnimationFrame((()=>{this.$(".tva-title-events").select().focus()})),["content","protected_file"].includes(this.model.get("type"))&&(this.postSearch=new l(this.$(".tva-resource-autocomplete"),{minLength:0,url:TVA.Utils.buildUrl(`${TVA.routes.settings}/search_pages/`,{post_type:"protected_file"===this.model.get("type")?TVA.files.post_type:"post,page"}),appendTo:"body",select:(e,t)=>{this.model.deepSet("config.post",{id:t.item.id,title:t.item.label,url:t.item.url,type_label:t.item.type,post_type:t.item.post_type})}})),this.model.get("delete_confirmation")&&requestAnimationFrame((()=>this.$(".delete-final").trigger("focus")))},editing:function(){return this.model.set("editing",!0),!1},onTitleChange:function(e){const t=e.currentTarget,s=t.value.trim();if(!s)return t.classList.add("tva-error"),t.focus(),!1;this.preventBlur=!0,s!==this.model.get("title")?this.model.set({title:s,editing:!1}):this.model.set("editing",!1)},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0,this.model.set("editing",!1))},onTitleBlur:function(){this.preventBlur?delete this.preventBlur:this.model.set("editing",!1)},fieldChanged:function(e){const t=e.target.dataset.field,s={silent:!!Number(e.target.dataset.silent)};"type"===t&&this.model.set({config:{}},{silent:!0}),this.model.deepSet(t,e.target.value,s)},openIconPicker:function(){this.openModal(a,{topic_title:this.model.get("title"),model:this.model,"max-width":"865px","max-height":"80vh",width:"auto",in_duration:200,out_duration:300,className:"tva-default-modal-style tvd-modal",saveCallback:function(e){this.model.set({icon_changed:1,icon:e})}})},openFilePicker:function(){this.mediaFrame.open()},clearConfig:function(){this.model.set("config",{})},destroy:function(){return this.mediaFrame&&(this.mediaFrame.off("select"),delete this.mediaFrame),r.prototype.destroy.call(this)},collapse:function(){this.model.set("expanded",!1,{silent:!0}),this.$el.removeClass("tva-expanded")},toggleExpanded:function(){return this.model.set("expanded",!this.model.get("expanded"),{silent:!0}),this.$el.toggleClass("tva-expanded",this.model.get("expanded")),requestAnimationFrame((()=>TVE_Dash.materialize(this.$el))),this.model.get("expanded")&&this.model.collection.each((e=>{e!==this.model&&e.trigger("collapse")})),this.$(".tva-res-info").toggleClass("click",!this.model.get("expanded")),!1},cancelDelete:function(){return this.model.unset("delete_confirmation"),!1}})},68300:function(e,t,s){!function(t){const i=s(18421);e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/customer/edit"),selectedCourses:[],afterStep0Loaded:function(){this.model.getPurchasedItems().then((e=>{this.renderPurchasedItems(e)}))},afterStep1Loaded:function(){this.selectedCourses=[],this.$("#tva-customer-courses").html(`<label>${TVA.t.loading}</label>`),this.renderProducts()},save:function(){if(0===this.selectedCourses.length)return TVE_Dash.err(TVA.t.noItemSelected);TVE_Dash.showLoader(),wp.apiRequest({url:`${this.model.url()}/add-access`,type:"POST",data:{course_ids:this.selectedCourses}}).done((e=>{TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t.newAccessSaved),this.close(),this.model.set("courses",new Backbone.Collection(e)),this.model.set("purchasedItems",null),this.model.trigger("access_changed"),TVA.products.resetAndFetch()})).error((e=>{TVE_Dash.hideLoader(),TVE_Dash.err(e.responseJSON.message)}))},toggleCourse:function(e,t){const s=t.dataset.id,i=this.selectedCourses.indexOf(s);-1===i?this.selectedCourses.push(s):this.selectedCourses.splice(i,1)},renderProducts:function(){const e=this.$("#tva-customer-courses").empty(),s=this.model.get("purchasedItems");TVA.products.each((i=>{const n=t(`<label><span>${i.get("name")}</span></label>`),o=t(`<input type="checkbox" class="click" data-fn="toggleCourse" data-id="${i.get("id")}">`),r=s.findWhere({product_id:i.get("id")});o.prop({checked:r,disabled:r}),e.append(n.prepend(o))}))},renderPurchasedItems:function(e){const t=TVE_Dash.tpl("customers/access-item"),s=this.getCurrentStep().find("#tva-add-access-item"),i=this.getCurrentStep().find("#tva-customer-items-wrapper"),n=i.find("#tva-customer-items-list").empty(),o=this.getCurrentStep().find("#tva-user-access-text");0===e.length?(s.toggle(!1),i.html(TVE_Dash.tpl("customers/no-access-item")({model:this.model})),o.remove()):0===TVA.products.length?(s.toggle(!1),i.html(TVE_Dash.tpl("customers/no-course")())):(e.each((e=>{"Order role"!==e.get("source")&&"Sendowl_product role"!==e.get("source")&&n.append(t({model:e}))})),s.toggle(!0))},deleteAccessItem:function(e){const s=this.model.get("purchasedItems"),n=t(e.currentTarget).parent(),o=parseInt(e.currentTarget.dataset.id),r=s.findWhere({id:o}),a=new i({template:TVE_Dash.tpl("customers/delete-purchased-item"),className:"tva-delete-simple",confirm:()=>{var e;s.remove(r),r.url=`${this.model.url()}/disable-item/${o}`,a.$el.html(TVA.t.deleting),this.model.set("courses",null),(e=r,new Promise(((t,s)=>{if(!(e instanceof Backbone.Model))return s(e);e.destroy({beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce)},success:e=>{t(e)},error:()=>s(e)})}))).then((()=>{this.renderPurchasedItems(s),this.model.trigger("access_changed",!1),TVA.products.resetAndFetch()}))}}).render();n.append(a.$el)}})}(jQuery)},91960:function(e,t,s){e.exports=s(26018).extend({template:TVE_Dash.tpl("modals/add-customer"),setField:function(e,t){const s={};t.getAttribute("data-field").split(",").forEach((e=>{s[e]=t.value})),this.model.set(s)},dom:function(){const e=this.$("#tva-add-customer-courses-list").empty();0===TVA.products.length&&e.after(TVE_Dash.tpl("customers/no-course")()),TVA.products.each((t=>e.append(this.productItemTpl({model:t}))))},save:function(){return this.model.isValid()?0===this.courses.length?TVE_Dash.err(TVA.t.selectCourse):(this.model.set("services",{course_ids:this.courses}),TVE_Dash.showLoader(),void this.model.save(null,{success:(e,t)=>{TVE_Dash.success(t.message),this.collection instanceof Backbone.Collection&&this.collection.fetch(),TVA.products.resetAndFetch()},error:(e,t)=>{TVE_Dash.err(t.responseJSON.message)},complete:e=>{200===e.status&&this.close(),TVE_Dash.hideLoader()}})):TVE_Dash.err(this.model.getValidationError())}})},26018:function(e,t,s){e.exports=s(39105).extend({template:"",serviceOptions:[],courses:[],selectedServiceOptions:{},productItemTpl:TVE_Dash.tpl("modals/customer/product-item"),afterInitialize:function(){this.courses=[]},save:function(){this.model.isValid()?this.model.hasServices()||this.model.get("ID")?(TVE_Dash.showLoader(),this.model.save(null,{success:(e,t)=>{TVE_Dash.success(t.message),this.collection instanceof Backbone.Collection&&this.collection.fetch()},error:(e,t)=>{TVE_Dash.err(t.responseJSON.message)},complete:e=>{200===e.status&&this.close(),TVE_Dash.hideLoader()}})):TVE_Dash.err("Please select some services"):TVE_Dash.err(this.model.getValidationError())},checkboxClick:function(e,t){const s=t.dataset.id;this.courses.indexOf(s)>=0?this.courses.splice(this.courses.indexOf(s),1):this.courses.push(s)},dom:function(){this.serviceOptions=[],this.$(".tva-service-options").each(((e,t)=>{this.serviceOptions.push(t.getAttribute("data-option"))})),this.reset(),this.serviceOptions.forEach((e=>{this.updateServiceOptionCounter(e)}))},notifyUser:function(e,t){this.model.set("notify",Number(t.checked))},reset:function(){this.selectedServiceOptions=this.model.get("services"),this.serviceOptions.forEach((e=>{Array.isArray(this.selectedServiceOptions[e])&&this.selectedServiceOptions[e].length>0&&this.updateCheckboxStatus(this.selectedServiceOptions[e],e)}))},updateServiceOptionCounter:function(e){const t=this.$(`.tva-option-card[data-option="${e}"]:not(.disabled)`),s=t.find("input:checkbox:checked").length;let i="<span>No access</span>";s>0&&(i=`${t.find("input:checkbox:checked").length} ${t.attr("data-option-label")}`),t.find(".tva-product-counter").html(i),t.find(".tva-option-toggle span").html(t.attr(`data-${s>0?"have":"no"}-options-action-label`))},updateCheckboxStatus:function(e=[],t=""){Array.isArray(e)&&e.forEach((e=>{const s=this.$(`#tva-${t}-${e}`);s.length&&(s[0].checked=!0)}))},toggleOptions:function(e,t){const s=t.getAttribute("data-option");this.$el.find(".tva-service-options").filter(`[data-option="${s}"]`).slideToggle("fast").closest(".tva-option-card").toggleClass("active")},toggleTable:function(e,t){t.closest("table").classList.toggle("b-hidden")},selectOption:function(e,t){const s=t.closest(".tva-option-card").getAttribute("data-option"),i=t.getAttribute("data-service-type"),n=parseInt(t.value);Array.isArray(this.selectedServiceOptions[i])||(this.selectedServiceOptions[i]=[]),t.checked?this.selectedServiceOptions[i].push(n):this.selectedServiceOptions[i]=this.selectedServiceOptions[i].filter((e=>parseInt(e)!==n)),this.updateServiceOptionCounter(s),this.model.set("services",this.selectedServiceOptions)}})},77538:function(e,t,s){e.exports=s(26018).extend({template:TVE_Dash.tpl("modals/edit-customer")})},11316:function(e,t,s){!function(t){const i=s(26018);e.exports=i.extend({template:TVE_Dash.tpl("modals/import-customer"),codeMirrorEditor:null,uploader:null,customerList:[],customersPerRequest:100,afterStep2Loaded:function(){return this.codeMirrorEditor.refresh(),this.codeMirrorEditor.setCursor(this.codeMirrorEditor.lineCount(),0),this.codeMirrorEditor.focus(),this},afterStep3Loaded:function(){this.$("tbody").empty(),this.$("#tva-csv-customer-stats").empty();let e=0,s=0;this.customerList.forEach((i=>{const n=t("<tr>");0===parseInt(i.is_valid)&&(n.addClass("tva-customers-list-error"),s++),n.append(t("<td>").html(i.buyer_name)),n.append(t("<td>").html(i.buyer_email+(n.hasClass("tva-customers-list-error")?'<span style="color: #ff0000; float: right;">Invalid entry</span>':""))),this.$("tbody").append(n),e++})),this.$("#tva-csv-customer-stats").append(`<span>${TVA.Utils._n(e,"member","members",!0)}</span>`),s&&this.$("#tva-csv-customer-stats").append(`&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #FF0000;">${s} Invalid entries</span>`);const i=this.$("#tva-add-customer-courses-list").empty();return TVA.products.each((e=>i.append(this.productItemTpl({model:e})))),this},allowJumpToStep:function(e){if(3===e){if(2===this.currentStep&&0===this.codeMirrorEditor.getValue().length)return TVE_Dash.err(TVA.t.MissingCustomers),!1;if(1===this.currentStep&&0===this.uploader.files.length)return TVE_Dash.err(TVA.t.ChooseCsv),!1}return!0},dom:function(){i.prototype.dom.apply(this,arguments),this.codeMirrorEditor=this._configureCodeEditor(),this.uploader=this._configurePlupload()},_configureCodeEditor:function(){const e=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};e.codemirror=_.extend({},e.codemirror,{lineNumbers:!0,mode:"text",indentUnit:2,tabSize:2,lineWrapping:!0,scrollbarStyle:null});const t=wp.codeEditor.initialize(this.$("#tva-list-import"),e);return t.codemirror.setSize("100%","250px"),t.codemirror.on("change",(e=>{const t=e.getValue().split(/\r\n|\n/),s=[];t.forEach((e=>{const t=e.split(",");if(t[0].trim().length){const e=t[1]?t[1].trim():"";s.push({buyer_name:t[0].trim(),buyer_email:e,is_valid:Number(e&&TVA.Utils.isEmail(e))})}})),this.customerList=s})),t.codemirror},_configurePlupload:function(){const e=this.$(".tva-drop-file-elem"),t=this.$(".tva-file-upload-trigger"),s=this.$('.tva-modal-step[data-step="1"] .tva-modal-btn-green'),i=new plupload.Uploader({headers:{"X-WP-Nonce":TVA.apiSettings.nonce},runtimes:"html5,html4",dragdrop:!0,multi_selection:!1,drop_element:e[0],browse_button:t[0],container:e[0],url:`${TVA.routes.customer}/upload_file`,multipart:!0,filters:{max_files:1,max_file_size:"1mb",mime_types:[{title:"Custom",extensions:"csv"}]},init:{FilesAdded:(e,t)=>{const i=t[0];this.$("#tva-file-name").html(i.name),s.addClass("disabled"),e.start()},Error:(e,t)=>{let i=t.message;if(t.response)try{const e=JSON.parse(t.response);e.message&&(i=e.message)}catch(e){}TVE_Dash.err(i),s.removeClass("disabled")},FileUploaded:(e,t,i)=>{const n=JSON.parse(i.response);if(Array.isArray(n)){const e=[];n.forEach((t=>{e.push({buyer_name:t.buyer_name,buyer_email:t.buyer_email,is_valid:t.is_valid})})),this.customerList=e}s.removeClass("disabled")}}});return i.init(),i},save:function(){if(0!==this.customerList.filter((e=>1===parseInt(e.is_valid))).length){if(0===this.courses.length)return TVE_Dash.err(TVA.t.selectCourse);this.model.set("services",{course_ids:this.courses}),TVE_Dash.showLoader(),this.importCustomersAjax()}else TVE_Dash.err("There are a few issues. Please correct them before saving")},importCustomersAjax:function(){const e=this.customerList.slice(0,this.customersPerRequest);t.ajax({url:`${TVA.routes.customer}/import_customers`,type:"POST",data:{customers:e,services:this.model.get("services"),notify:this.model.get("notify")},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)}}).success((e=>{this.customerList=this.customerList.slice(this.customersPerRequest,this.customerList.length),this.customerList.length?this.importCustomersAjax():(this.close(),TVE_Dash.hideLoader(),TVE_Dash.success(e.message),this.collection.fetch(),this.collection.each((e=>{e.removeServices(),e.set("purchasedItems",null)})),TVA.products.resetAndFetch())})).error((e=>{TVE_Dash.err(e.responseJSON.message),TVE_Dash.hideLoader(),this.close()}))}})}(jQuery)},57426:function(e,t,s){e.exports=s(26018).extend({template:TVE_Dash.tpl("modals/lesson-unlock"),initialize:function(e){e=e||{},this.studentID=e.studentID||null,this.courseModel=e.courseModel||null,this.itemsBypassed=e.itemsBypassed||null},unlock:function(){TVE_Dash.showLoader(),wp.apiRequest({type:"POST",url:`${TVA.routes.customer}/bypass_drip`,data:{course_id:this.courseModel.get("id"),student_id:this.studentID,item_id:this.model.get("id")}}).success((e=>{e.items_bypassed=e.items_bypassed[this.courseModel.get("id")],e.locked_items&&(e.locked_items=e.locked_items[this.courseModel.get("id")]),this.courseModel.trigger("item_bypass_set",e),TVE_Dash.success(TVA.t.drip_campaign_settings.content_unlocked)})).error((()=>{TVE_Dash.err(TVA.t.something_went_wrong)})).done((()=>{this.close()}))},afterOpen:function(){this.$('[data-fn="unlock"]').focus()}})},95692:function(e,t,s){const i=s(39105);e.exports=i.extend({template:TVE_Dash.tpl("modals/design/hi-professor")})},77431:function(e,t,s){e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/help-corner")})},896:function(e){!function(t){const s=TVE_Dash.views.IconModal.extend({afterInitialize:function(){this.selected=this.model.get("icon").match(/^([a-z0-9-_])*$/g)?this.model.get("icon"):""},saveIcon:function(){const e=t(this.selectedIcon);this.downloadIcon(e)},afterSave:function(e){"function"==typeof this.saveCallback?this.saveCallback(e.icon[0].outerHTML):this.model.persist({icon_type:"svg_icon",svg_icon:e.icon[0].outerHTML,icon:e.icon[0].id.replace("icon-","")}),this.close()}});e.exports=s}(jQuery)},31779:function(e,t,s){e.exports=s(4136).extend({template:TVE_Dash.tpl("modals/labels/confirm-delete")})},35561:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(40504),o=s(39105),r=s(88119),a=s(18421);e.exports=o.extend({template:"modals/products/access-rules",defaults:["not_logged","not_purchased","locked"],title:TVA.t.edit_access_rule,stepSelector:".tvd-rule-modal-step",events:function(){return n(n({},o.prototype.events),{},{"change .tva-rule-title-events":"onTitleChange"})},afterRender:function(){o.prototype.afterRender.apply(this,arguments),this.renderTitle(),this.renderConditions(),this.singleStep||this.renderRestriction()},renderTitle:function(){const e=t("#tva-rule-title");this.defaults.includes(this.scope)?e.attr("value",TVA.t.access_rule_select_labels[this.scope]):e.attr("placeholder",TVA.t.access_rule_placeholder)},renderRestriction:function(){const e={autoSave:!1,scope:this.scope,model:this.model,course_id:this.course_id};this.single||(e.title=TVA.t.access_custom),this.contentRestriction=new r(e),this.contentRestriction.model.ensureDataExists(this.custom_id).then((()=>{this.$(".tva-content-restriction").html(this.contentRestriction.render().$el)}))},renderEmptyCondition:function(){this.conditionsContainer.append(new i({ruleModel:this.model,parentWrapper:this.$(".tva-access-rules"),model:new Backbone.Model({scope:this.scope,index:this.model.get("index")})}).render().$el)},renderConditions:function(){this.conditionsContainer=t(".tva-rule-conditions"),this.model.set("index",0);const e=this.model.get("conditions");let s=!1;e&&Object.keys(e).forEach((t=>{const n=e[t];n.length&&(s=!0,this.conditionsContainer.append(new i({parentWrapper:this.$(".tva-access-rules"),ruleModel:this.model,model:new Backbone.Model({scope:this.scope,index:this.model.get("index"),type:t,selected:n})}).render().$el),this.model.set("index",this.model.get("index")+1))})),s||(this.renderEmptyCondition(),this.model.set("index",this.model.get("index")+1)),this.hideAddConditionButton()},hideAddConditionButton:function(){this.model.get("index")>=Object.keys(TVA.t.access_rule_select_labels[this.scope]).length&&this.$(".tva-add-rule-conditions").hide()},addCondition:function(){!1!==this.model.validateConditions()?(this.model.set("index",this.model.get("index")+1),this.renderEmptyCondition(),this.hideAddConditionButton()):TVE_Dash.err(1===this.model.get("index")?TVA.t.access_rule_conditions_empty:TVA.t.access_rule_conditions_invalid)},deleteCondition:function(e){const t=this.$(e.currentTarget).parents(".tva-rule-condition"),s=new a({template:TVE_Dash.tpl("products/content-sets/delete-rule-condition"),className:"tva-delete-simple",confirm:()=>{TVE_Dash.showLoader(),this.model.set("index",this.model.get("index")-1),e.currentTarget.dataset.type&&this.model.get("conditions")&&(this.model.get("conditions")[e.currentTarget.dataset.type]=[]),this.render(),TVE_Dash.hideLoader()}});t.append(s.render().$el)},checkboxClick:function(e){const t=e.currentTarget.dataset.id,s=parseInt(t);if(e.currentTarget.checked)isNaN(s)?this.model.get("conditions").roles.push(t):this.model.get("conditions").products.push(s);else if(isNaN(s)){const e=this.model.get("conditions").roles;e.splice(e.indexOf(t),1)}else{const e=this.model.get("conditions").products;e.splice(e.indexOf(s),1)}},onTitleChange:function(e){const t=e.currentTarget.value.trim();t!==this.model.get("title")&&this.model.set("title",t)},next:function(){const e=this.model.validateCustomSettings(this.settingsCollection);!0===e?(this.$("select.tva-section-option").select2(),this.gotoStep(1)):TVE_Dash.err(e)},save:function(){if(this.defaults.includes(this.scope))return void this.close();const e=this.model.validateCustomSettings(this.settingsCollection);if(!0!==e)return void TVE_Dash.err(e);if(this.singleStep)return void this.updateRuleConditions();const t=this.contentRestriction.model.validateOptions();!0===t?this.addRule():TVE_Dash.err(t)},addRule:function(){TVE_Dash.showLoader(),this.saving=!0,this.model.set("option",this.contentRestriction.model.get("option")),this.model.set(`${this.model.get("option")}`,this.contentRestriction.model.get(`${this.model.get("option")}`)),this.model.save().done((()=>{this.settingsCollection.unshift(this.model),TVE_Dash.success(TVA.t.access_rule_added.replace("{name}",`<strong>${this.model.get("title")}</strong>`)),TVE_Dash.hideLoader(),this.close()}))},updateRuleConditions:function(){TVE_Dash.showLoader(),this.saving=!0,this.model.save().done((()=>{this.originalModel.set(this.model.toJSON()),this.settingsCollection.trigger("settings_changed"),TVE_Dash.success(TVA.t.access_rule_edited.replace("{name}",`<strong>${this.model.get("title")}</strong>`)),TVE_Dash.hideLoader(),this.close()}))},onClose:function(){this.saving||this.singleStep?this.saving=!1:wp.apiRequest({url:TVA.Utils.buildUrl(`${TVA.routes.access_restriction}/delete_custom_post`,{course_id:this.course_id,scope:this.scope}),type:"DELETE"})}})}(jQuery)},92900:function(e,t,s){const i=s(95053),n=s(74916);e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/products/add"),afterInitialize:function(e={}){this.editRedirect=e.screen&&"list"===e.screen,this.courseRedirect=e.screen&&"course"===e.screen,this.productModel=e.productModel||new i,this.setModel=e.setModel||new TD_SETS.Models.Set,this.setModel.allowEmptyRules=!0},afterRender:function(){this.$formWrapper=this.$(".tva-product-details"),this.$name=this.$("#product_name").val(this.productModel.get("name")),this.formSection&&this.formSection.destroy(),this.formSection=new n({setModel:this.setModel}),this.$formWrapper.html(this.formSection.render().$el),this.productModel.get("name").trim().length&&this.$name.val(this.productModel.get("name").trim())},getTitle:function(){return this.$name.val().trim()},createProduct:function(){const e=this.getTitle();if(0===e.length)return this.$name.addClass("tvd-validate tvd-invalid").focus(),void TVE_Dash.err(TVA.t.productNameRequired);this.setModel.set({post_title:e},{silent:!0}),this.productModel.set({name:e},{silent:!0}),this.setModel.isValid()?(this.productModel.get("sets").add(this.setModel),TVE_Dash.showLoader(),this.productModel.save(null,{success:()=>{if(this.collection.add(this.productModel),this.collection.changeTotal(1),this.editRedirect)TVA.Router.navigate(`#products/${this.productModel.get("id")}/content`,{trigger:!0});else if(this.courseRedirect){const e=parseInt(Backbone.history.getFragment().split("/")[1]);setTimeout((()=>TVA.courses.findWhere({id:e}).set("fetched",!1))),TVA.Router.navigate(`#products/${this.productModel.get("id")}/content/${e}`,{trigger:!0})}},error:(e,t)=>{t&&t.responseJSON?TVE_Dash.err(t.responseJSON.message):TVE_Dash.err("Something went wrong with adding new product")}}).always((()=>{this.close(),TVE_Dash.hideLoader()}))):TVE_Dash.err(this.setModel.getValidationError())}})},82546:function(e,t,s){e.exports=s(39105).extend({template:"modals/products/content-sets",dom:function(){this.$setsContainer=this.$(".tva-content-sets-container"),this.$formContainer=this.$(".tva-content-sets-form-container"),TD_SETS.sets.resetFilters(),this.ListView=new TD_SETS.Views.List({collection:TD_SETS.sets,product:this.model,modal:this}),this.$setsContainer.html(this.ListView.render().$el)}})},81020:function(e,t,s){const i=s(2948),n={ajax:{transport:function(e,t){wp.apiRequest({url:TVA.routes.products,data:e.data}).done((e=>{t({results:(null==e?void 0:e.items)||e})}))},data:e=>({search:e.term}),delay:0,cache:!1},templateResult:function(e){return e.name},templateSelection:function(e){return e.text?e.text:e.name},escapeMarkup:function(e){return e},withSearch:!0,minimumResultsForSearch:1,multiple:!0,dropdownClass:""};e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/protected-files/add"),fileTemplate:TVE_Dash.tpl("protected-files/upload-control-file-item"),filesCollection:new Backbone.Collection({}),noticeDuration:3e3,noticePosition:"top",uploadControl:null,file:null,afterInitialize:function(e){e.file&&(this.file=e.file),this.listenTo(this.filesCollection,"reset",(()=>{this.$fileList.empty(),this.$uploadWrapper[0===this.filesCollection.length?"show":"hide"](),this.filesCollection.length>0&&(0===this.getLabel().length&&this.$fileLabel.val(this.filesCollection.first().get("name")),this.filesCollection.each((e=>{this.$fileList.append(this.fileTemplate({name:e.get("name"),id:e.get("id")}))})))}))},removeFileItem:function(e,t){this.uploadControl.plupload.removeFile(t.getAttribute("data-id"))},afterRender:function(){this.$uploadWrapper=this.$(".tva-protected-file-upload-wrapper"),this.$fileLabel=this.$(".tva-protected-file-label"),this.$fileList=this.$(".tva-protected-file-upload-list"),this.$select=this.$("select"),this.$productAccessWarning=this.$(".tva-protected-file-product-warning"),TVA.Utils.bindModalSelect2(this.$select,n),this.$select.data("select2").$container.addClass("tva-protected-files-select").find(".select2-search input").css({width:"400px"}),this.uploadControl=new i({collection:this.filesCollection,initialFile:this.file,context:"modal",onUploadComplete:()=>{TVA.ProtectedFiles.justAdded=!0,TVA.ProtectedFiles.fetch(),TVA.products.resetAndFetch(),setTimeout((()=>{this.close()}),500)},onUploadProgress:e=>{this.$(".tva-protected-files-upload-progress-bar").css({width:`${e}%`,visibility:"visible"})}}).render(),this.$uploadWrapper.html(this.uploadControl.$el)},getLabel:function(){return this.$fileLabel.val().trim()},getProductsIDs:function(){return this.$select.val()},productAccessChanged:function(){this.$productAccessWarning[0===this.getProductsIDs().length?"show":"hide"]()},save:function(e,t){const s=this.getLabel();return 0===s.length?(TVE_Dash.err("Your file needs a label",this.noticeDuration,null,this.noticePosition),!1):0===this.uploadControl.plupload.files.length?(TVE_Dash.err("You need to select a file first!",this.noticeDuration,null,this.noticePosition),!1):(t.classList.add("saving"),t.setAttribute("disabled","disabled"),this.uploadControl.addAdditionalParameters({label:s,products_ids:this.getProductsIDs()}).startUpload(),!0)}})},553:function(e,t,s){const i=s(81020),n=s(1978);e.exports=i.extend({model:null,afterInitialize:function(e){i.prototype.afterInitialize.call(this,arguments),e.model&&e.model instanceof n&&(this.model=e.model)},afterRender:function(){i.prototype.afterRender.call(this,arguments),this.$(".tva-protected-file-label").val(this.model.get("post_title")),this.model.getNumberOfProducts()>0&&(this.model.get("products").forEach((e=>{const t=new Option(e.name,e.id,!0,!0);this.$("select").append(t)})),this.$("select").trigger("change")),this.filesCollection instanceof Backbone.Collection&&this.filesCollection.reset([{name:`${this.model.get("original_name")}.${this.model.get("file_extension")}`,id:""}])},save:function(e,t){this.model.set({post_title:this.getLabel()}),t.classList.add("saving"),t.setAttribute("disabled","disabled"),this.model.save({products_ids:this.getProductsIDs()}).done((()=>{TVA.ProtectedFiles.fetch(),this.close(),TVA.products.resetAndFetch()}))}})},11605:function(e,t,s){e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/protected-files/help"),showAllElements:!1,afterInitialize:function(){this.showAllElements=this.className.includes("tall")},dom:function(){this.showAllElements||this.$('div[data-tall="1"]').hide()}})},72540:function(e,t,s){e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/protected-files/share"),afterStep0Loaded:function(){this.$el[0].style.removeProperty("min-height")},afterStep1Loaded:function(){this.$el.css({"min-height":"800px"})},afterStep2Loaded:function(){this.$el.css({"min-height":"700px"})}})},60929:function(e,t,s){const i=s(91359),n=["tva_lesson","tva_chapter","tva_module"];let o=!1;e.exports=s(39105).extend({template:TVE_Dash.tpl("modals/schedule"),_itemName:"",beforeInitialize:function(){const e=void 0!==typeof this.model.get("post_type")?this.model.get("post_type"):"";this._prop="publish_date",this._itemName="",n.includes(e)?this._itemName=e.replace("tva_",""):"tva_courses"===this.model.get("taxonomy")?this._itemName="course":this._itemName="items"},afterMaterialize:function(){this.openDatepicker()},openDatepicker:function(){if(!0===o)return void this.$("#tva-datepicker").show();o=!0,new i({el:this.$("#tva-datepicker"),model:this.model,prop:this._prop,isInvalidDate:e=>!window.wp.date.isInTheFuture(e)}).render();let e=window.wp.date.__experimentalGetSettings().timezone.offset;const t=window.moment().utc().add(e,"hours").format("YYYY-MM-DD HH:mm:ss");e>0&&(e=`+${e}`),this.$(".components-datetime__time").after(TVE_Dash.tpl("modals/date-info")({offset:e,local:t})),this.$(".components-datetime__buttons").hide()},save:function(){const e=new Date(this.model.get(this._prop).replace(/-/g,"/"));e.setMinutes(e.getMinutes()-1);const t=("0"+e.getDate()).slice(-2),s=("0"+(e.getMonth()+1)).slice(-2),i=(e.getHours()<10?"0":"")+e.getHours(),n=(e.getMinutes()<10?"0":"")+e.getMinutes();if(!window.wp.date.isInTheFuture(e.getFullYear()+"-"+s+"-"+t+" "+i+":"+n+":00"))return TVE_Dash.err(TVA.t.schedule_past_date);if("function"==typeof this.saveSchedule)return this.saveSchedule();this._prop.length||this.close();const o="future";this.model.set(this.statusProp,o);const r=this.courseModel instanceof Backbone.Model?this.courseModel:this.model;if(this.model.get("post_status"))return TVE_Dash.showLoader(),this.close(),TVE_Dash.success(TVA.t[`success_scheduled_${this._itemName}`]),r.trigger("tva.item.status.changed",{id:this.model.get("id"),status:o});const a=this.model.get("structure"),l=this.model.save(null,{success:()=>{this.model.set("structure",a),r.trigger("tva.structure.status.changed")}});l&&(TVE_Dash.showLoader(),l.always((()=>{TVE_Dash.hideLoader(),this.close(),TVE_Dash.success(TVA.t[`success_scheduled_${this._itemName}`])})))},onClose:function(){o=!1}})},58792:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(96308),a=s(39105),l=new(s(65773));e.exports=a.extend({stepCss:{0:{width:"630px"}},template:"modals/skins/cloud",filterText:"",afterInitialize:function(){l.$$fetched||_.delay(this.showLoader.bind(this),100),l.fetch().then((e=>{this.hideLoader(),"object"!=typeof e&&(this.close(),TVE_Dash.err(e,3e3))})),this.show_first_step&&(0===TVA.indexPageModel.previewUrl().length&&TVA.indexPageModel.set({state:"create"},{silent:!0}),this.listenTo(TVA.indexPageModel,"change",(e=>{e.get("value")||(TVA.settings.wizard.value=0,this.model.set("value",0),this.model.save())})))},getName:function(){return this.$nameInput.val()},dom:function(){let e;this.$nameInput=this.$("#tva-add-skin-name"),this.show_first_step?(new r({el:this.$(".tva-course-states-container"),model:TVA.indexPageModel,states_views_path:"./page-states-cloud/",labels:{search:{title:"Set your courses page"},normal:{title:"Course page"},delete:{title:"Are you sure you want to remove this course page?"}},afterRender:function(){this.$(".tva-edit-page-with-tar,.tva-view-page").remove()}}).render(),e=TVA.settings.index_page.value?1:0):e=2,this.gotoStep(e)},createSkin:function(){const e=this.getName();if(0===e.trim().length)return TVE_Dash.err(TVA.t.InvalidName),!1;if(TVA.skins.getByName(e))return TVE_Dash.err(TVA.t.skin_invalid_name.replace("{name}",`<strong>${e}</strong>`)),!1;this.showLoader();const t={always:!0};return wp.apiRequest({url:l.url()+"/"+l.first().get("id"),data:n({skin_scope:"tva",skin_name:e},this.skin_download_params||{})}).then((s=>{s.just_added=1,s.name=e,"function"==typeof this.download_callback?this.download_callback.call(this,s,t):(this.trigger("cloud-skin-downloaded",s),TVE_Dash.success(TVA.t.skin_imported.replace("{name}",`<strong>${s.name}</strong>`))),this.close()})).always((()=>{t.always&&this.hideLoader()})).fail((e=>{var t;return TVE_Dash.err((null===(t=e.responseJSON)||void 0===t?void 0:t.message)||e.responseText,3e3)})),!1},allowJumpToStep:function(e){const t=1!==this.currentStep||2!==e||!!TVA.indexPageModel.get("value");return t||TVE_Dash.err("You need to define a page where all your courses will reside."),t},afterStep2Loaded:function(){this.$nameInput.focus()}})},3063:function(e,t,s){const i=s(81425);e.exports=s(39105).extend({template:"modals/skins/template",inheritFrom:null,itemTemplate:"modals/skins/cloud-template-item",radioTemplate:"modals/skins/cloud-radio-item",templates:[],bigModalClass:"tvd-modal-big",selectedTemplate:null,afterInitialize:function(){this.model.on("cloud_template_select",(e=>{this.inheritFrom=e,this.save()}))},contentTypeChanged:function(e,t){this.$("#tva-post-format-input").toggle("tva_lesson"===t.options[t.selectedIndex].getAttribute("data-secondary"))},getTitle:function(){return this.$("#tva-template-name").val()},getTemplateData:function(){const e=this.$("#tva-content-type")[0];return{primary:e.options[e.selectedIndex].getAttribute("data-primary"),secondary:e.options[e.selectedIndex].getAttribute("data-secondary"),format:this.$("#tva-post-format").val()}},save:function(){const e=this.getTitle();if(0===e.length)return TVE_Dash.err(TVA.t.InvalidName),void this.$("#tva-template-name").focus();const t=this.getTemplateData();TVE_Dash.showLoader(),this.model.skin_id=this.collection.skin_id,this.model.createTemplate(e,t.primary,t.secondary,t.format).save({inherit_from:this.inheritFrom||"default"}).done((e=>{this.filterModel.trigger("tva_dash:filterByModel",this.model),e[0].just_added=1,this.collection.reset(e),this.close(),TVE_Dash.hideLoader()}))},openCloudTemplatesModal:function(){if(0===this.getTitle().length)return TVE_Dash.err(TVA.t.InvalidName),void this.$("#tva-template-name").focus();this.gotoStep(1),this.$el.addClass(this.bigModalClass),this.renderTemplates()},afterStep0Loaded:function(){this.$el.removeClass(this.bigModalClass)},dom:function(){this.$items=this.$(".tve-c-modal-items"),this.$radioFilterItems=this.$(".tve-c-modal-radio-filter"),this.dropdownFilter=new i({el:this.$(".tve-c-modal-select-filter")[0],items:[{id:"all",order:1,text:"All Templates",description:"Everything in one place."},{id:"local",order:2,text:"Saved Templates",description:"Saved templates are the ones that we have."},{id:"cloud",order:3,text:"Cloud Templates",description:"Cloud templates come from the cloud.",default:!0}]}).on("select",(()=>this.renderTemplates(!1)))},renderRadioFilters:function(e=[]){this.$radioFilterItems.empty(),this.getRadioFilterItems(e).forEach((e=>this.$radioFilterItems.append(TVE_Dash.tpl(this.radioTemplate)({item:e}))))},renderTemplates:function(e=!0,t=!1){return new Promise((s=>{e&&this.showLoader(),delete this.selectedTemplate,this.$items.empty(),this.$items.data("masonry")&&this.$items.data("masonry").destroy(),this.getItems(t).then((t=>{const i=this.filterItems(t);i.forEach((e=>{this.$items.append(TVE_Dash.tpl(this.itemTemplate)({item:e,itemWidth:260}))})),this.$items.masonry(),e&&this.hideLoader(),this.renderRadioFilters(i),s()}))}))},selectTemplate:function(e,t){this.selectedTemplate=t.dataset.id,this.$items.find(".selected").removeClass("selected"),t.closest(".tve-c-modal-item").classList.add("selected")},onRadioFilterClick:function(e,t){this.$radioFilterItems.find(".active").removeClass("active"),t.classList.add("active"),this.renderTemplates(!1)},onSearch:_.throttle((function(){this.renderTemplates(!1)}),420),refreshItems:function(){this.renderTemplates(!0,!0).then((()=>TVE_Dash.hideLoader()))},filterItems:function(e=[]){const t=this.getRadioFilterValue()||"",s=this.getDropdownFilterValue(),i=this.getSearchValue().trim().toLowerCase(),n=this.getTemplateData(),[o,r]=t.split("|");return e.filter((e=>{let a=!0;return s&&"all"!==s&&s!==e.type&&(a=!1),a&&i&&!e.title.toLowerCase().includes(i)&&(a=!1),a&&t&&"all"!==t&&(e.primary!==o||e.secondary!==r)&&(a=!1),a&&"tva_lesson"===e.secondary&&e.format!==n.format&&(a=!1),a}))},createTemplate:function(){this.selectedTemplate?(this.inheritFrom=this.selectedTemplate,this.save()):TVE_Dash.err("Please select a template")},getSearchValue:function(){return this.$(".tve-c-modal-search-input").val()},getDropdownFilterValue:function(){return this.dropdownFilter.getValue()},getRadioFilterValue:function(){const e=this.getTemplateData();return`${e.primary}|${e.secondary}`},getRadioFilterItems:function(e=[]){const t={all:{id:"all",label:"All",count:e.length,default:1}};return e.forEach((e=>{const s=`${e.primary}|${e.secondary.trim()}`;let i;switch(s){case"home|tva_course_type":i="School Page";break;case"singular|tva_lesson":i="Lesson";break;case"singular|tva_module":i="Module";break;case"archive|tva_courses":i="Course Overview";break;default:i="NOT FOUND"}void 0===t[s]&&(t[s]={id:s,label:i,count:0,default:0}),t[s].count++})),Object.values(t)},getItems:function(e=!1){return new Promise((t=>{!e&&this.templates.length?t(this.templates):wp.apiRequest({url:`${TVA.routes.templates}/cloud`,data:{tva_skin_id:this.skin_id,is_singular:"single"===this.type?1:0,bypass_cache:e?1:0}}).done((e=>{this.templates=[...e,...this.getLocalTemplates(this.type)],t(this.templates)})).fail((e=>{e.responseJSON&&(TVE_Dash.hideLoader(),TVE_Dash.err(e.responseJSON.message,3e3))}))}))},getLocalTemplates:function(){return this.collection.filter().map((e=>({id:e.get("ID"),type:"local",title:e.get("post_title"),primary:e.primary(),secondary:e.secondary(),format:e.format(),thumb:e.get("thumbnail")})))}})},66795:function(e){var t;t=jQuery,e.exports=TVE_Dash.views.ModalSteps.extend({events:t.extend(TVE_Dash.views.ModalSteps.prototype.events,{"click .click":"_call","input .input":"_call"}),_call:function(e){const t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)}})},2707:function(e){jQuery,e.exports=TVE_Dash.views.Modal.extend({events:{"click .click":"_call","input .input":"_call"},_call:function(e){const t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)}})},4136:function(e,t,s){const i=s(39105);e.exports=i.extend({template:TVE_Dash.tpl("modals/topics/confirm-delete"),open:function(){return i.prototype.open.apply(this,arguments),new Promise((e=>{this.$$promiseResolver=e}))},performDelete:function(){return this.close(),requestAnimationFrame(this.$$promiseResolver),!1}})},79391:function(e,t,s){(t=>{const i=s(45795);e.exports=s(39105).extend({template:"modals/wizard/templates",item:TVE_Dash.tpl("modals/wizard/template"),itemClass:".ttd-wizard-template",className:"tvd-modal tvd-modal-templates",hasPreview:!1,afterRender:function(){this.$el.addClass(this.className),this.$templatesList=this.$("#structure-templates-list")},afterOpen:function(){const e=this.$(".modal-content").addClass("ttd-loading loader-absolute");this.$el.toggleClass("w-narrow",!!this.model.getStepKey("narrowTemplate")),this.model.loadStepTemplates(!1).then((t=>{this.templates=_.sortBy(t,(e=>e.order)),this.createLazyLoader(),this.buildPreview(),this.markSelectedTemplate({id:this.model.getPreviewTemplateId()}),e.removeClass("ttd-loading loader-absolute")}))},createLazyLoader:function(){this.lazyLoader=new window.LazyLoad({container:this.$el[0],elements_selector:".tve-lazy-img",threshold:0,load_delay:0,callback_loaded:function(e){t(e).parent().removeClass("lazy-loading")}})},updateLazyLoader:function(){this.lazyLoader.update()},buildPreview:function(){let e="";if(["header","footer","sidebar"].includes(this.model.get("active"))){this.removeMasonry();const t=[],s=[];_.each(this.templates,(e=>{"local"===e.source?t.push(e):s.push(e)})),e+=new i({title:"Apprentice templates",items:s,view:this}).render().$el.html(),t.length&&(e+=new i({title:"My saved templates",items:t,view:this}).render().$el.html())}else _.each(this.templates,(t=>{e+=this.item({model:this.model,item:t,itemClass:this.itemClass.replace(".","")})}));this.$templatesList.html(e);const s=this.$(".do-masonry"),n=parseInt(this.$templatesList.find(this.itemClass).width());this.$templatesList.find("img").each((function(){const e=this.dataset.ratio;e&&t(this).parent().css("height",n*parseFloat(e))})),s.hasClass("masonry")&&s.masonry("destroy"),s.masonry({gutter:30,columnWidth:this.itemClass,isAnimated:!0}),this.hasPreview=!0,this.updateLazyLoader()},removeMasonry:function(){this.$(".do-masonry").removeClass("do-masonry")},markSelectedTemplate:function(e){this.$(this.itemClass).removeClass("active").filter(`[data-id="${e.id}"]`).addClass("active")},clickSelect:function(e,t){let s;return s="iframe"===this.model.getStepKey("previewMode")&&"cloud"===t.dataset.source?new Promise(((e,s)=>{const i=this.model.get("active");TVE_Dash.showLoader(!0),this.model.templates.fetchInstance(i,t.dataset.id).done((s=>{const n=s.data||s;this.model.templates.updateTemplate(i,t.dataset.id,{id:n.id,source:"local"}),e(n)})).fail(s)})):new Promise((e=>{e({id:t.dataset.id,source:t.dataset.source})})),s.then((e=>{this.markSelectedTemplate(e),TVA.wizardView.previewTemplate(e)})),requestAnimationFrame((()=>{this.close()})),!1}})})(jQuery)},70164:function(e,t,s){e.exports=s(87785).extend({template:TVE_Dash.tpl("access-restriction/states/wizard/create")})},95251:function(e,t,s){e.exports=s(12404)},91503:function(e,t,s){e.exports=s(46913)},8867:function(e,t,s){e.exports=s(50413)},61918:function(e,t,s){e.exports=s(98555)},87785:function(e,t,s){var i;i=jQuery,e.exports=s(51135).extend({template:TVE_Dash.tpl("access-restriction/states/create"),afterInitialize:function(e){i.extend(!0,this,e)},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels})),this.afterRender(),this},onCancel:function(){"custom_redirect"===this.model.get("name")?this.model.set("state","search-link"):this.model.set("state","search")},onSave:function(){if(this.tvaClearError(),!this.model.isValid())return this.tvaShowErrors(this.model);TVE_Dash.showLoader();const e=this.model.save();e&&(e.done((()=>{this.model.set("state","normal")})),e.always((function(){TVE_Dash.hideLoader()})))},onInput:function(e,t){this.model.set(t.getAttribute("data-field"),t.value)}})},12404:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r;r=jQuery,e.exports=s(51135).extend({labels:{title:""},template:TVE_Dash.tpl("access-restriction/states/delete"),afterInitialize:function(e){r.extend(!0,this,e)},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels})),this.afterRender(),this},confirmRemove:function(){if(this.callbacks.confirm)return this.callbacks.confirm(this.model);TVE_Dash.showLoader(),this.model.set(n(n({},this.model.defaults()),{},{previous_id:this.model.get("value")}));const e=this.model.save();e&&(e.done((()=>{"custom_redirect"===this.model.get("name")?this.model.set(n(n({},this.model.defaults()),{},{state:"search-link"})):this.model.set(n(n({},this.model.defaults()),{},{state:"search"}))})),e.always((function(){TVE_Dash.hideLoader()})))},cancelRemove:function(){this.model.set("state","normal")}})},46913:function(e,t,s){var i;i=jQuery,e.exports=s(51135).extend({template:TVE_Dash.tpl("access-restriction/states/normal"),labels:{title:""},settings:{edit_with_tar:!0},afterInitialize:function(e){this.settings.edit_with_tar=!0,i.extend(!0,this,e),"custom_link"===this.model.get("category")&&(this.settings.edit_with_tar=!1)},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels,settings:this.settings})),this.afterRender(),this},removePage:function(){this.model.set("state","delete")}})},50413:function(e,t,s){!function(t){const i=s(36832);e.exports=s(98555).extend({labels:{title:"",text:TVA.t.search_link},initPostSearch:function(){const e=this;i(this.$("#tva-search-base-page"),{renderItem:function(e,s){return t('<li class="tva-selected-post">').append(`<span class="tva-ps-result-title">${s.label}</span><span class="tva-ps-result-email"> (${s.type})</span>`).appendTo(e)},select:(t,s)=>{if(e.href=e.getFullUrl(s.item.url),e.$("#tva-search-base-page").val(e.href),"page"===s.item.post_type){TVE_Dash.showLoader(),this.model.set({value:s.item.id,title:s.item.value,state:"search"});const e=this.model.save();e&&(e.done((()=>{this.model.set({state:"normal",category:!1})})),e.always((function(){TVE_Dash.hideLoader()})))}else"Link"===s.item.type&&this.model.set({value:0,title:s.item.value,custom_link:e.href,preview_url:e.href,category:"custom_link",state:"normal"})}})}})}(jQuery)},98555:function(e,t,s){!function(t){const i=s(36832);e.exports=s(51135).extend({template:TVE_Dash.tpl("access-restriction/states/search"),labels:{title:"",text:TVA.t.search},afterInitialize:function(e){t.extend(!0,this,e),this.href=""},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels})),this.initPostSearch(),this.afterRender(),this},getFullUrl:function(e){return e&&!/^(?:[a-z]+:|#|\?|\.|\/)/.test(e)&&(e="//"+e),e},initPostSearch:function(){var e;new i(this.$("#tva-search-base-page"),{url:TVA.Utils.buildUrl(`${TVA.routes.settings}/search_pages/`,(null===(e=this.settings)||void 0===e?void 0:e.ajaxData)||{}),renderItem:function(e,s){return t('<li class="tva-selected-post">').append(`<span class="tva-ps-result-title">${s.label}</span><span class="tva-ps-result-email"> (${s.type})</span>`).appendTo(e)},select:(e,t)=>{if("Link"===t.item.type)TVE_Dash.err("Please choose a local page to redirect to");else{TVE_Dash.showLoader(),this.model.set("value",t.item.id);const e=this.model.save();e&&(e.done((()=>{this.model.set("state","normal")})),e.always((function(){TVE_Dash.hideLoader()})))}}})},createPage:function(){this.model.set("state","create")}})}(jQuery)},77003:function(e,t,s){!function(t){const i=s(3711);e.exports=s(2921).extend({template:TVE_Dash.tpl("pagination"),noItemTemplate:TVE_Dash.tpl("noItems"),initialize:function(e){if(!(e&&e.collection&&e.collection instanceof i))throw Error("pagination collection has to be provided for this view");t.extend(!0,this,e),this.listenTo(this.collection,"fetched",this.render),this.listenTo(this.collection,"fetching",this.fetching)},render:function(){if(0===this.collection.length)return this.$el.html(this.noItemTemplate());const e=this.collection.pageInfo();this.$el.html(e.totalPages>1?this.template(e):"")},previousPage:function(){this.collection.prev()},nextPage:function(){this.collection.next()},fetching:function(){this.$el.html("Loading...")}})}(jQuery)},70331:function(e,t,s){!function(t){const i=s(66740),n=s(95053);e.exports=s(51135).extend({productId:null,initialize:function(e){(e=e||{}).id&&(this.productId=parseInt(e.id)||null),this.model=TVA.products.get(this.productId),this.model||(this.model=new n({id:this.productId})),this.model.get("fetched")&&this.afterInitialize(e),this.initOptions=e,this.backTermID=this.getBackLTerm(),this.hasBackLink=!1!==this.backTermID},ensureData:async function(){return new Promise((e=>{this.model.get("fetched")?e():(TVA.keepLoader=!0,TVA.Utils.pageLoader(!0),this.model.fetch().done((()=>{this.model.set("fetched",!0,{silent:!0}),this.afterInitialize(this.initOptions),e(),TVA.Utils.pageLoader(!1),TVA.products.cacheModel(this.model)})))}))},getBackLTerm:function(){const e=Backbone.history.getFragment().split("/");return!!(Array.isArray(e)&&4===e.length&&parseInt(e[3])>0)&&parseInt(e[3])},getBackLink:function(){if(!this.hasBackLink)return"";const e=TVA.courses.findWhere({id:this.backTermID});return`<a class="tva-back tva-back-button" href="#courses/${this.backTermID}/access">Back to editing course: ${e.get("name")}</a>`},afterRender:function(){this.$subMenu=t("#tva-app .tva-submenu"),this.subMenu=new i({el:this.$subMenu,collection:new Backbone.Collection}),this.subMenu.menuItem=new Backbone.Model({label:"Product",items:new Backbone.Collection});const e=this.hasBackLink?`/${this.backTermID}`:"";this.subMenu.collection.reset([{slug:"content",route:`products/${this.productId}/content${e}`,icon:"icon-p-box",label:TVA.t.product_menu.content,selected:"content"===TVA.Router.subOption,items:[]},{slug:"access-expiry",route:`products/${this.productId}/access-expiry${e}`,icon:"icon-hourglass",label:TVA.t.product_menu.expiry,selected:"access-expiry"===TVA.Router.subOption,items:[]},{slug:"product-purchase",route:`products/${this.productId}/rules${e}`,icon:"icon-p-requirements",label:TVA.t.product_menu.requirements,selected:"rules"===TVA.Router.subOption,items:[]},{slug:"drip",route:`products/${this.productId}/drip${e}`,icon:"drip-main",label:TVA.t.product_menu.drip,selected:"drip"===TVA.Router.subOption,items:[]},{slug:"product-restricted-content",route:`products/${this.productId}/restricted-content${e}`,icon:"icon-p-restricted",label:TVA.t.product_menu.restriction,selected:"restricted-content"===TVA.Router.subOption,hidden:!TVA.visualEditingEnabled,items:[]}])},saveModel:function(){return TVE_Dash.showLoader(),new Promise(((e,t)=>{this.model.save(null,{success:()=>{TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t.SuccessfulSave),TVA.customers.reset(),e()},error:(e,s)=>{if(TVE_Dash.hideLoader(),s&&s.responseJSON&&403===s.responseJSON.data.status)return TVE_Dash.err(TVA.t.courseNotSavedSessionExpired);let i="";s&&s.responseJSON&&(i=s.responseJSON.message),TVE_Dash.err(`${TVA.t.courseNotSaved} ${i}`),t()}})}))}})}(jQuery)},89474:function(e,t,s){!function(t){const i=s(70331),n=s(91359),o=s(96308),r=s(95070),a=s(49939),l=s(2921).extend({afterInitialize:function(e){t.extend(!0,this,e)},getValue:t.noop}),c=l.extend({template:TVE_Dash.tpl("products/access-expiry/after-purchase-condition"),afterRender:function(){this.$input=this.$("input"),this.$select=this.$("select"),this.setValue(this.model.number,this.model.unit),this.$select.select2()},inputChanged:function(e,t){this.model.number=Number(t.value)},selectChanged:function(e,t){this.model.unit=t.value},setValue:function(e,t){return this.$input.val(e),this.$select.val(t),this}}),d=l.extend({template:TVE_Dash.tpl("products/access-expiry/after-specific-date-condition"),afterRender:function(){const e=n.renderPopup(this.$(".tva-popup-datepicker"),{model:this.expiryModel,prop:"cond_datetime",silent:!0,active:"date",static:!0,isInvalidDate:e=>wp.date.format("d-m-Y",e)!==wp.date.format("d-m-Y")&&!wp.date.isInTheFuture(e),onChange:e=>{const s=e.split("T")[0];this.$(".tva-popup-datepicker").html(s),t.setDate(e,{silent:!0})}}),t=n.renderInline(this.$(".tva-popup-timepicker"),{model:this.expiryModel,prop:"cond_datetime",is12HourTime:!1,silent:!0,onChange:t=>{e.setDate(t,{silent:!0})}})}});e.exports=i.extend({template:TVE_Dash.tpl("products/single/access-expiry"),className:"tva-access-expiry",triggers:[{id:"after_purchase",View:c,icon:"drip-trigger-purchase",image:"",name:"When user purchases product"},{id:"specific_time",View:d,icon:"drip-calendar",image:"",name:"Specific time and date"}],afterInitialize:function(){this.listenTo(this.model,"sync",this.afterRender);const e=this.model.get("access_expiry").get("redirect").value;this.pageLinkModel=new r({title:this.model.get("access_expiry").get("redirect").title,value:e,category:!_.isNumber(e)&&"custom_link",custom_link:!_.isNumber(e)&&e}),this.listenTo(this.pageLinkModel,"change",(()=>{this.model.get("access_expiry").get("redirect").value="custom_link"===this.pageLinkModel.get("category")?this.pageLinkModel.get("custom_link"):this.pageLinkModel.get("value"),this.model.get("access_expiry").get("redirect").title=this.pageLinkModel.get("title")}))},activeCondition:null,afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.$expiryTrigger=this.$("#tva-access-expire-trigger"),this.$expiryCondition=this.$("#tva-access-expire-condition"),this.$expiryReminder=this.$("#tva-access-expire-trigger-reminder"),this.$expiryRedirect=this.$("#tva-access-expire-trigger-redirect"),this.$expirySettings=this.$("#tva-access-expiry-settings"),this.$expiryTrigger.empty(),this.triggers.forEach((e=>{const s=e.id===this.model.get("access_expiry").get("expiry").get("cond"),i=t(`<option value="${e.id}" data-icon="${e.icon}" data-image="${e.image}">${e.name}</option>`);s&&i.prop("selected",!0),this.$expiryTrigger.append(i)})),this.$expiryTrigger.select2({minimumResultsForSearch:-1,templateResult:(e,s)=>{if(!e.element)return null;if(!e.element.dataset.icon)return e.text;const i=TVA.Utils.icon(e.element.dataset.icon);return s.classList.add("tva-with-icon"),t(i+'<span class="item-text">'+e.text+"</span>")},templateSelection:this.select2ImageItemRenderer}).data("select2").$dropdown.addClass("tva-email-apis-select-dropdown"),this.updateUI()},updateUI:function(){this.$('input[data-fn="toggleExpireAccess"]').prop("checked",this.model.get("access_expiry").isEnabled()),this.$expirySettings.toggle(this.model.get("access_expiry").isEnabled()),this.$(".tva-container-notice").toggle(this.model.get("access_expiry").isEnabled()),this.$$childViews.forEach((e=>e.destroy())),this.$$childViews=[],this.model.get("access_expiry").isEnabled()&&(this.$expiryTrigger.val(this.model.get("access_expiry").get("expiry").get("cond")).trigger("change"),this.$('input[data-fn="sendReminder"]').prop("checked",this.model.get("access_expiry").shouldSendReminder()),this.model.get("access_expiry").shouldSendReminder()&&this.addChild(new c({el:this.$expiryReminder[0],model:this.model.get("access_expiry").get("reminder")}).render()),this.$('input[data-fn="redirectToPage"]').prop("checked",this.model.get("access_expiry").shouldRedirect()),this.model.get("access_expiry").shouldRedirect()&&this.addChild(new o({el:this.$expiryRedirect[0],model:this.pageLinkModel,states_views_path:"./page-states/",labels:{search:{title:"Search for a page to use"},normal:{title:""},delete:{title:"Are you sure you want to remove this page?"}}}).render()))},select2ImageItemRenderer:function(e){return e.element&&e.element.dataset.image?t(`<span><span class="opt-image" style="background-image: url('${e.element.dataset.image}')"></span><span>${e.text}</span></span>`):e.text},expireTriggerChange:function(e,t){this.activeCondition instanceof l&&this.activeCondition.destroy().remove(),this.model.get("access_expiry").get("expiry").set("cond",t.value);const s=this.triggers.find((e=>e.id===t.value));if(s){this.activeCondition=new s.View({model:this.model.get("access_expiry").get("expiry").get("cond_purchase"),expiryModel:this.model.get("access_expiry").get("expiry")});const e=this.activeCondition.expiryModel.attributes.cond;this.$expiryCondition.html(this.activeCondition.render().$el),this.addChild(this.activeCondition),this.$(".tva-ac-dynamic").hide(),this.$(`.tva-${e}`).show(),this.$(".tva-ae-label").html("after_purchase"===e?"after":"on")}},sendReminder:function(e,t){this.$expiryReminder.empty(),this.model.get("access_expiry").toggleReminder(t.checked),this.updateUI()},redirectToPage:function(e,t){this.$expiryRedirect.empty(),this.model.get("access_expiry").toggleRedirect(t.checked),this.updateUI()},toggleExpireAccess:function(e,t){if(t.checked){const e=this;t.checked=!1,this.openModal(a,{template:TVE_Dash.tpl("modals/access-expiry"),className:"tvd-modal tva-access-expiry",width:"400px",confirm:function(){t.checked=!0,e.model.get("access_expiry").set("enabled",Number(t.checked)),e.updateUI(),this.close()}})}else this.model.get("access_expiry").set("enabled",Number(t.checked)),this.updateUI()},saveAccess:function(e){if(e.stopPropagation(),this.model.get("access_expiry").isValid())return this.saveModel(),!1;{const e=this.model.get("access_expiry").validationError;Array.isArray(e)&&TVE_Dash.err(e[0],3e3)}}})}(jQuery)},53473:function(e,t,s){const i=s(18421);e.exports=s(51135).extend({template:TVE_Dash.tpl("products/single/content-item"),afterInitialize:function(e){this.product=e.product},afterRender:function(){this.$contentItem=this.$(".tva-product")},removeContentSet:function(){const e=new i({template:TVE_Dash.tpl("products/content-sets/delete"),className:"tva-delete-simple",confirm:()=>{TVE_Dash.showLoader(),this.product.get("sets").remove(this.model),this.product.saveSets().done((()=>{TVE_Dash.hideLoader(),this.remove()}))}});this.$contentItem.append(e.render().$el)}})},20727:function(e){e.exports=TD_SETS.Views.Controls.Base.extend({className:"tvd-content-set-rule-step tva-filter-search ml-50",template:TVE_Dash.tpl("products/content-sets/controls/search-input"),afterInitialize:function(){TD_SETS.Views.Controls.Base.prototype.afterInitialize.apply(this,arguments),this.listenTo(this.ruleModel,"searching",this.toggleLoader.bind(this,!0)),this.listenTo(this.ruleModel,"searching-done",this.toggleLoader.bind(this,!1))},afterRender:function(){this.$iconWrapper=this.$(".tva-search-icon"),requestAnimationFrame((()=>this.ruleModel.fetchSuggestions("")))},onFilterInput:function(e){clearTimeout(this.inputTimeout);const t=e.currentTarget.value;this.inputTimeout=setTimeout((()=>{this.ruleModel.fetchSuggestions(t,1)}),200)},toggleLoader:function(e=null){this.$iconWrapper.tvaToggleLoader(16,e,{position:"left-center",background:"#fff",fadeDuration:300})}})},49438:function(e){const t=TD_SETS.Views.Form;e.exports=t.extend({template:"products/content-sets/form",back:function(){this.collection.trigger("cancel-edit-set",this.model)}})},55738:function(e){const t=TD_SETS.Views.Item;e.exports=t.extend({template:"products/content-sets/item",afterRender:function(){t.prototype.afterRender.call(this),this.$checkbox=this.$('input[type="checkbox"]')},edit:function(){this.collection.trigger("edit-set",this.model)},setChecked:function(){this.$checkbox.prop("checked",!0)},isChecked:function(){return this.$checkbox.is(":checked")},checkboxCheck:function(e,t){t.checked?this.product.get("sets").add(this.model):this.product.get("sets").remove(this.model)}})},12009:function(e){const t=TD_SETS.Views.List;e.exports=t.extend({template:"products/content-sets/list",formView:null,afterInitialize:function(){t.prototype.afterInitialize.call(this),this.listenTo(this.collection,"reset",_.bind(this.goToListView,this)),this.listenTo(this.collection,"edit-set",_.bind(this.renderFormView,this)),this.listenTo(this.collection,"cancel-edit-set",_.bind(this.goToListView,this))},afterRender:function(){t.prototype.afterRender.call(this),this.$saveButton=this.$("button"),this.updateSelectedSets()},filterSets:function(){t.prototype.filterSets.apply(this,arguments),this.updateSelectedSets()},updateSelectedSets:function(){this.product.get("sets").each((e=>{const t=e.get("ID");this.itemViews[t]&&this.itemViews[t].setChecked()}))},addSet:function(){this.renderFormView(new TD_SETS.Models.Set({}))},goToFormView:function(){this.modal.gotoStep(1)},goToListView:function(){this.formView&&this.formView.destroy().remove(),this.updateSelectedSets(),this.modal.gotoStep(0)},renderFormView:function(e){this.formView&&this.formView.destroy().remove(),this.formView=new TD_SETS.Views.Form({model:e,collection:this.collection}),this.modal.$formContainer.html(this.formView.render().$el),this.goToFormView()},renderItem:function(e){const t=new TD_SETS.Views.Item({model:e,product:this.product,collection:this.collection});this.$list.append(t.render().$el),this.itemViews[e.get("ID")]=t},saveAndClose:function(){this.$saveButton.addClass("disabled"),TVE_Dash.showLoader(),this.product.saveSets().done((()=>{this.$saveButton.removeClass("disabled"),TVE_Dash.hideLoader(),this.modal.close()}))}})},40483:function(e,t,s){const i=s(70331),n=s(74916);let o;e.exports=i.extend({template:TVE_Dash.tpl("products/single/content"),tooltipKey:"product-more-settings",afterInitialize:function(){o&&o.destroy(),o=new n({setModel:this.model.getDefaultSet(),autoSave:!0})},afterRender:function(){i.prototype.afterRender.call(this),this.$formWrapper=this.$(".tva-product-details"),this.$productName=this.$(".tva-product-name"),this.$tooltip=this.$(".tva-product-info-tooltip"),this.$formWrapper.html(o.render().$el),this.$tooltip.length&&!TVA.Utils.isTooltipViewed(this.tooltipKey)&&requestAnimationFrame((()=>this.showTooltip()))},renameProduct:function(){const e=this.model.get("id");this.$productName.unbind(),this.$productName.tvaInlineEdit({validation_fn:function(t){return!("string"!=typeof t||0===t.trim().length||TVA.products.getByName(t,e)&&(TVE_Dash.err(TVA.t.product_invalid_name.replace("{name}",`<strong>${t}</strong>`)),1))}}).one("change",((e,t)=>{this.model.set({name:t},{silent:!0}),this.model.save(null,{silent:!0}).done((()=>{TVA.products.trigger("rename")})),this.$(".tva-product-subheading").text(t)}))},showTooltip:function(){this.$tooltip.addClass("tva-visible")},hideTooltip:function(){return this.$tooltip.addClass("tva-out"),setTimeout((()=>this.$tooltip.removeClass("tva-visible tva-out")),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},99432:function(e,t,s){const i=s(2921),n=s(92900),o=s(95053),r=s(6906);e.exports=i.extend({template:TVE_Dash.tpl("products/course-tab"),templateNoProducts:TVE_Dash.tpl("products/course-tab-no-items"),tooltipKey:"access-restrictions-product",afterInitialize:function(){this.listenTo(this.collection,"total-changed",(()=>{this.model.fetchProducts().then((()=>{this.collection.reset(this.model.get("products"),{silent:!0}),this.render(),this.tabModel&&this.tabModel.set({counter:this.collection.length}),this.trigger("refresh-tab-title"),TVA.products.resetFilters().fetch({reset:!0})}))})),this.listenTo(this.collection,"add destroy",this.renderRules)},onActivate:function(){this.render()},afterRender:function(){return this.$productsList=this.$(".tva-products-wrapper"),this.$tooltip=this.$(".tva-product-info-tooltip"),this.renderRules(),0!==this.collection.length&&this.$tooltip.length&&!TVA.Utils.isTooltipViewed(this.tooltipKey)&&requestAnimationFrame((()=>this.showTooltip())),this},renderRules:function(){0!==this.collection.length?(this.$productsList.empty(),this.childItemViews&&this.childItemViews.forEach((e=>e.destroy())),this.childItemViews=[],this.collection.each(this.renderOne,this),this.addChild(this.childItemViews)):this.$el.html(this.templateNoProducts())},renderOne:function(e){const t=new r({model:e,backTerm:this.model.get("id"),collection:this.collection,allowDrag:!1,showCustomersNumber:!1,showTooltipDot:!1});this.$productsList.append(t.render().$el),this.childItemViews.push(t)},addNewProduct:function(e,t){this.openModal(n,{collection:TVA.products,productModel:new o({name:this.model.get("name")}),screen:t.getAttribute("data-screen"),setModel:new TD_SETS.Models.Set({post_title:this.model.get("name"),post_content:[{content_label:{singular:"Course",plural:"Courses"},content_type:"term",content:"tva_courses",field:"title",operator:"===",value:[{id:parseInt(this.model.get("id")),text:this.model.get("name")}]}]}),width:"760px",className:"tvd-modal tva-new-product-modal"})},toggleCourseOverview:function(e,t){this.model.set({protect_overview:Number(t.checked)},{silent:!0}),this.model.save()},linkToRules:function(){jQuery("html, body").animate({scrollTop:0},0),this.changeView(`products/${this.collection.first().get("id")}/rules`)},showTooltip:function(){this.$tooltip.addClass("tva-visible")},hideTooltip:function(){return this.$tooltip.addClass("tva-out"),setTimeout((()=>this.$tooltip.removeClass("tva-visible tva-out")),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},65127:function(e,t,s){!function(t){const i=s(70331);e.exports=i.extend({template:TVE_Dash.tpl("products/single/drip"),template_empty:TVE_Dash.tpl("products/single/drip-empty"),course_template:TVE_Dash.tpl("products/single/drip-course-item"),className:"tva-product-drip",afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.model.fetchCourses().then(_.bind(this.renderCourses,this))},renderCourses:function(e){0!==e.length?(this.$("#tva-drip-courses-list").addClass("tva-visible"),e.each((e=>{const s=t(this.course_template({course:e})),i=s.find("select");_.each(e.get("drip_campaigns"),(e=>{i.append(`<option value="${e.id}">${e.post_title}</option>`)})),i.val(e.get("selected_campaign")||"0"),i.length&&(i.select2(),i.data("select2").$dropdown.addClass("tva-no-border-select")),this.$("#tva-drip-courses-list").append(s)}))):this.$(".tva-drip-courses-empty").html(this.template_empty({product:this.model}))},setCampaign:function(e){const t=parseInt(e.currentTarget.dataset.courseId),s=parseInt(e.currentTarget.value);this.model.get("courses").findWhere({id:t}).set("selected_campaign",s),this.model.assignDripCampaign(s,t),TVA.customers.resetIndividualStudentViews()}})}(jQuery)},6906:function(e,t,s){const i=s(2921),n=s(49939);e.exports=i.extend({className:"tva-product",template:TVE_Dash.tpl("products/list-item"),backTerm:!1,settings:{allowDrag:{selector:".tva-drag-handle",value:!0},showCustomersNumber:{selector:".tva-product-no",value:!0},showTooltipDot:{selector:".tva-tooltip-dot",value:!0}},afterInitialize:function(e={}){Object.keys(this.settings).forEach((t=>{void 0!==e[t]&&(this.settings[t].value=e[t])})),this.backTerm=e.backTerm||!1},afterRender:function(){this.$el.attr("data-id",this.model.get("id")),this.$(".tva-product-info").html(this.getProductInfo()),Object.keys(this.settings).forEach((e=>{this.settings[e].value||this.$(this.settings[e].selector).css("visibility","hidden")})),this.settings.showTooltipDot.value||this.$(this.settings.showTooltipDot.selector).remove()},getProductInfo:function(){const e=[];return this.model.getDefaultSet()?(this.model.getDefaultSet().getRules().each((t=>{if(-1===t.get("field"))e.push(t.get("content_label").plural);else if(Array.isArray(t.get("value")))if("title"===t.get("field")){if(0===t.get("value").length)return;e.push(`${t.get("value").length} ${1===t.get("value").length?t.get("content_label").singular:t.get("content_label").plural}`)}else if("author"===t.get("field")){const s=t.get("value").map((e=>e.text)),i="archive"===t.get("content_type")?"of":"by";e.push(`${t.get("content_label").plural} ${i} ${t.get("field")}: ${s.join(", ")}`)}else{const s=t.get("value").map((e=>e.text));e.push(`${t.get("content_label").plural} with ${t.get("field")}: ${s.join(", ")}`)}})),e.join(" + ")):"No content set found!"},editProduct:function(){jQuery("html, body").animate({scrollTop:0},0),this.changeView(`products/${this.model.get("id")}/content${this.backTerm?"/"+this.backTerm:""}`)},deleteProduct:function(){const e=this.model,t=this.collection;this.openModal(n,{template:TVE_Dash.tpl(0===e.get("customers_count")?"modals/products/delete-no-customers":"modals/products/delete-with-customers"),width:"560px",model:e,confirm:function(){TVE_Dash.showLoader(),TD_SETS.sets.remove(e.getDefaultSet()),e.destroy({wait:!0,success:function(){t.changeTotal(-1),TVA.customers.reset()}}).always((()=>{this.close()}))}})}})},26912:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=TD_SETS.Views.Rule,a=s(18952),l=new(s(15088)),c=TD_SETS.Models.Rule.extend({orderSteps:["content","field","value"],currentPage:1,currentSearch:"",defaults:function(){return{content_type:"",content:"",field:"",operator:"===",value:""}},fetchSuggestions:async function(e="",t=1){return this.currentPage=t,this.currentSearch=e,l.fetch(this,e,t)},loadNextPage:async function(){return this.fetchSuggestions(this.currentSearch,this.currentPage+1)},hasMoreContent:function(){return l.hasMore(this,this.currentSearch)}}),d=["tva_lesson","tva_module","tva_courses","published_date"],h=r.extend({template:TVE_Dash.tpl("products/partials/add-content"),selected:[],afterInitialize:function(e){e.contentSet=this.contentSet=e.contentSet||new TD_SETS.Models.Set,e.model=this.model=new c(e.ruleModelArgs||{}),e.collection=this.collection=e.contentSet.getRules(),r.prototype.afterInitialize.apply(this,arguments),this.listenTo(this.model,"searching",this.onSearch),this.listenTo(this.model,"searching-done",this.renderResults),this.listenTo(this.model,"change:content_type change:content",(()=>this.$list.html(""))),this.listenTo(this.model,"change:content_type change:content",this.onSelectionChanged),this.preselected=e.preselected,this.existingValues=e.existingValues||[]},afterRender:function(){r.prototype.afterRender.call(this),this.$list=this.$("#tva-form-item-list").on("scroll",_.debounce(this.onScroll.bind(this),100,!1))},getStepOptions:function(e){var t;let s=(null===(t=r.prototype.getStepOptions.call(this,e))||void 0===t?void 0:t.filter((e=>!d.includes(e.value))))||[];return"field"===e&&(s=s.filter((e=>!["-1"].includes(e.value))),("archive"===this.model.get("content_type")||"term"===this.model.get("content_type")&&"category"===this.model.get("content"))&&(s=s.slice(0,1),s.push({value:"title",label:"Category"}),s.push({value:"author",label:"Author"}))),s},getStepView:function(e){return"value"===e&&this.model.get("field")!==TD_SETS.fields.published_date?s(20727):r.prototype.getStepView.apply(this,arguments)},onSearch:function(e){let t="html",s="Getting results...";1!==e&&(t="append",s="Getting more results..."),this.$(".tva-searching-text").remove(),this.$list[t](`<div class="tva-text-center tva-searching-text tva-form-text p-10"><em>${s}</em></div>`)},renderResults:function(e,t){this.$(".tva-searching-text").remove();let s="";const i=this.selected.map((e=>e.id)),n=this.preselected[a.ruleKey(this.model)]||[];e.forEach((e=>{const t=n.includes(e.id);s+=a.checkboxTemplate(e,t||i.includes(Number(e.id)),t&&!this.existingValues.includes(parseInt(e.id)))}));const o=1===t?"html":"append";s?this.$list[o](s):this.$list[o](a.noResultsTemplate(t))},onSelectionChanged:function(){this.selected=Array.from(this.$list.find("input:checked").map(((e,t)=>({id:Number(t.value),text:t.dataset.text})))),this.trigger("selection-changed",this.hasSelection())},hasSelection:function(){return!!this.selected.length||this.forceCompleteSteps()},onScroll:async function(e){const t=e.currentTarget;!this.loadingNextPage&&this.model.hasMoreContent()&&t.scrollTop>=t.scrollHeight-t.offsetHeight-50&&(this.loadingNextPage=!0,await this.model.loadNextPage(),this.loadingNextPage=!1)},getData:function(){return jQuery.extend(!0,{},n(n({},this.model.toJSON()),{},{value:this.selected}))}},{renderTo:a.renderTo});e.exports=h},18952:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=s(84643),r=new(s(15088)),a=s(2921).extend({template:TVE_Dash.tpl("products/partials/add-courses"),afterInitialize:function(e={}){e=jQuery.extend(!0,{},e),this.state=new o(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({filter_type:"title",search:"",selected_ids:[],selected_data:[]},e)),this.listenTo(this.state,"change:filter_type",(()=>{this.state.set("search",""),this.state.set("selected_ids",[],{silent:!0}),this.state.set("selected_data",[],{silent:!0}),this.dom.$selectAllLabel.hide(),"author"===this.state.get("filter_type")?(this.dom.$list.html(""),this.fetchSuggestions("",1)):this.renderItems(!0)}))},afterRender:function(){this.dom={$search:this.$(".tva-form-search-input"),$selectAllLabel:this.$(".tva-select-all"),$selectAll:this.$(".tva-select-all input"),$list:this.$("#tva-form-item-list"),get $labels(){return this.$list.find("label").filter(":visible")},get $checkboxes(){return this.$labels.find('input[type="checkbox"]')},get $enabledCheckboxes(){return this.$labels.not(".tva-disabled").find('input[type="checkbox"]')},get selectedIds(){const e=[];return this.$checkboxes.filter(":checked").each(((t,s)=>e.push(s.value))),e.map(Number)},get selectedData(){const e=[];return this.$checkboxes.filter(":checked").each(((t,s)=>e.push({id:parseInt(s.value),text:s.getAttribute("data-text")}))),e}},TVE_Dash.data_binder(this,this.state),this.renderItems(!0)},getData:function(){return{content_type:"term",content:"tva_courses",field:this.state.get("filter_type"),operator:"===",value:this.state.get("selected_data")}},onFilterInput:function(e){this.state.set("search",e.currentTarget.value.trim(),{silent:!0}),clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{"author"===this.state.get("filter_type")?(this.dom.$list.html(""),this.fetchSuggestions(this.state.get("search"),1)):this.renderItems()}),100)},onSelectionChanged:function(){this.dom.$selectAll.prop("checked",this.allSelected()),this.storeSelection()},hasSelection:function(){return!!this.state.get("selected_ids").length},hasSelectAll:function(){return["title"].includes(this.state.get("filter_type"))},toggleSelectAll:function(e){this.dom.$enabledCheckboxes.prop("checked",!!e.currentTarget.checked),this.storeSelection()},storeSelection:function(){this.state.set("selected_ids",this.dom.selectedIds,{silent:!0}),this.state.set("selected_data",this.dom.selectedData,{silent:!0}),this.trigger("selection-changed",this.state.get("selected_ids").length)},allSelected:function(){return this.dom.$checkboxes.length===this.dom.$checkboxes.filter(":checked").length},onSearch:function(e){let t="html",s="Getting results...";1!==e&&(t="append",s="Getting more results..."),this.$(".tva-searching-text").remove(),this.dom.$list[t](`<div class="tva-text-center tva-searching-text tva-form-text p-10"><em>${s}</em></div>`)},fetchSuggestions:async function(e="",t=1){const s=new Backbone.Model({content_type:"term",content:"tva_courses",field:this.state.get("filter_type"),operator:"==="});this.listenTo(s,"searching",this.onSearch),r.fetch(s,e,t).then((e=>{this.state.set({suggestion_results:e},{silent:!0}),this.renderItems(!0)}))},renderItems:function(e=!0){let t="";const s=this.state.get("search").toLowerCase(),i=this.state.get("selected_ids"),n=a.ruleKey(this.getData()),o=(this.state.get("preselected")[n]||[]).map(Number),r=(this.state.get("existingValues")||[]).map(Number),l=this.getNormalizedItems();if(l.forEach((e=>{if(!s||e.name.toLowerCase().includes(s)){const s=o.includes(Number(e.id));t+=a.checkboxTemplate(e,s||i.includes(Number(e.id)),s&&!r.includes(parseInt(e.id)))}})),t?this.dom.$list.html(t):this.dom.$list.html(a.noResultsTemplate()),e){this.dom.$selectAllLabel[t&&this.hasSelectAll()?"show":"hide"]();const e=o.length&&o.length===l.length;this.dom.$selectAllLabel.toggleClass("tva-disabled",!!e&&0===r.length),this.dom.$selectAll.prop("checked",!!e)}},getNormalizedItems:function(){let e;switch(this.state.get("filter_type")){case"title":e=TVA.courses.map((e=>{const t="draft"===e.get("status")?`${e.get("name")} [${TVA.t.Draft}]`:e.get("name");return{id:e.get("id"),name:t}}));break;case"topic":e=TVA.topics.map((e=>({id:e.get("ID"),name:e.get("title")})));break;case"label":e=TVA.labels.map((e=>({id:e.get("ID"),name:e.get("title")})));break;case"difficulty":e=TVA.levels;break;case"author":let t=this.state.get("suggestion_results")||null;null===t&&(this.fetchSuggestions(),t=[]),e=t.map((e=>({id:e.id,name:e.text})));break;default:throw new Error("Invalid filter_type: "+this.state.get("filter_type"))}return e}},{renderTo:function(e,t={}){e=jQuery(e);const s=new this(t);return e.html(s.render().$el),s},checkboxTemplate:function(e,t=!1,s=!1){return e.text=e.text||e.name,`<label${s?' class="tva-disabled"':""}><input${t?" checked":""} class="change" data-fn="onSelectionChanged" type="checkbox" data-text="${_.escape(e.text)}" value="${e.id}"><span>${_.escape(e.text)}</span></label>`},noResultsTemplate:function(e=1){return`<div class="tva-text-center tva-searching-text tva-form-text p-10"><em>${1===e?"No results found. Try modifying the search criteria":"No more results found"}</em></div>`},ruleKey:function(e){return e instanceof Backbone.Model&&(e=e.toJSON()),[e.content_type,e.content,e.field].join("-")}});e.exports=a},74916:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=s(18952),r=s(26912),a=s(86152),l=s(2921).extend({template:TVE_Dash.tpl("products/partials/product-form"),afterInitialize:function(e={}){this.editMode=e.editMode||!1,this.formArgs=e.formArgs||{},this.setModel=e.setModel,this.formType=e.formType},afterRender:function(){this.$formWrapper=this.$(".tva-product-course-form"),this.$btn=this.$(".tva-list-action").hide(),this.renderForm()},renderForm:function(){let e;switch(this.form&&this.form.destroy(),this.formType){case"courses":e=o;break;case"content":e=r;break;default:throw new Error("Invalid item type: "+this.formType)}this.form=e.renderTo(this.$formWrapper,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({preselected:this.getPreselectedContent()},this.formArgs)),this.$btn.show().toggleClass("tva-disabled",!this.form.hasSelection()),this.form.on("selection-changed",(e=>{this.$btn.toggleClass("tva-disabled",!e)})),this.$("select").each((function(){const e=jQuery(this);e.data("select2")&&e.select2("destroy")})).select2({width:"100%",dropdownParent:this.$(".tva-product-course-form")})},addToProduct:function(){if(this.form&&this.form.hasSelection()){const e=this.form.getData(),t=this.setModel.getRules().findWhere({content_type:e.content_type,content:e.content,field:e.field,operator:e.operator});if(t&&Array.isArray(t.get("value"))){const s=_.uniq(this.editMode?e.value:t.get("value").concat(e.value),!1,(e=>Number(e.id)));t.set({value:s}),t.hasChanged("value")||this.setModel.getRules().trigger("reset")}else this.setModel.getRules().add(new TD_SETS.Models.Rule(e));this.$btn.hide(),this.$("button").removeClass("tva-tab-active tva-tab-inactive"),this.form.destroy().remove(),TVA.customers.reset(),this.trigger("rule-added")}return this.destroy().remove(),!1},getPreselectedContent:function(){const e={};return this.setModel.getRules().each((t=>{e[o.ruleKey(t)]=Array.from(t.get("value")).map((e=>e.id))})),e}});e.exports=s(2921).extend({template:TVE_Dash.tpl("products/partials/add-form"),afterInitialize:function(e={}){this.setModel=e.setModel,this.autoSave=!!e.autoSave,this.listenTo(this.setModel.getRules(),"add change reset",this.renderRules),this.listenTo(this.setModel.getRules(),"add remove",(()=>TVA.$eventBus.trigger("products_changed"))),this.listenTo(this.setModel.getRules(),"reset",(()=>{TVA.$eventBus.trigger("content_sets_changed")})),this.listenTo(this.setModel.getRules(),"edit-rule",(e=>{const t=e.model,s=e.$el;s.html(new l({editMode:!0,setModel:this.setModel,formType:"term"===t.get("content_type")&&"tva_courses"===t.get("content")?"courses":"content",formArgs:{ruleModelArgs:t.toJSON(),filter_type:t.get("field"),existingValues:t.getValues()}}).render().$el),this.toggleRules(!0),s.removeClass("tva-disabled")})),this.autoSave&&parseInt(this.setModel.get("ID"))>0?(this.setModel.allowEmptyRules=!0,this.listenTo(this.setModel.getRules(),"add change",(()=>{this.$rulesWrapper.tvaToggleLoader(),this.setModel.save({return_one:1}).done((()=>this.$rulesWrapper.tvaToggleLoader(!1)))}))):this.listenTo(this.setModel.getRules(),"add change",(e=>{this.$rulesWrapper.tvaToggleLoader(),e.normalize().then((t=>{e.set({content_label:t.content_label},{silent:!0}),this.renderRules(),this.$rulesWrapper.tvaToggleLoader(!1)}))}))},afterRender:function(){this.$rulesWrapper=this.$(".tva-add-product-rules-wrapper"),this.renderRules()},renderRules:function(){this.$rulesWrapper.empty().removeClass("tva-disabled"),this.ruleViews&&this.ruleViews.forEach((e=>e.destroy())),this.ruleViews=[];let e=0;this.setModel.getRules().each((t=>{if(0===t.get("value").length&&-1!==t.get("field"))return;const s=new a({model:t,setModel:this.setModel,collection:this.setModel.getRules()});this.ruleViews.push(s),this.$rulesWrapper.append(s.render().$el),e++})),this.addChild(this.ruleViews),this.autoSave&&0===e&&this.$rulesWrapper.html('<div class="tva-text-light tva-text-center"><em>This product does not protect anything! Add some content to it</em></div>')},addClicked:function(e){this.closeForm(),jQuery(e.currentTarget).removeClass("tva-tab-inactive").addClass("tva-tab-active").siblings().addClass("tva-tab-inactive").removeClass("tva-tab-active"),this.$(".product-form-wrapper").html(new l({setModel:this.setModel,formType:e.currentTarget.dataset.type,formArgs:{}}).render().$el),this.toggleRules(!0)},toggleRules:function(e=!0){Array.isArray(this.ruleViews)&&this.ruleViews.forEach((t=>t.$el.toggleClass("tva-disabled",e)))},closeForm:function(){this.render()}})},15088:function(e){function t(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function s(e){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?t(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}e.exports=class{constructor(){this.data={},this.allFetched={}}hasMore(e,t){const s=e.toJSON(),i=[s.content_type,s.content,s.field,s.operator].join("|")+t.trim();return!this.allFetched[i]}async fetch(e,t="",i=1){return new Promise(((n,o)=>{const r=e.toJSON(),a=[r.content_type,r.content,r.field,r.operator,i].join("|")+t.trim(),l=[r.content_type,r.content,r.field,r.operator].join("|")+t.trim();void 0===this.data[a]?(e.trigger("searching",i),jQuery.ajax({url:TD_SETS.routes.base,type:"GET",dataType:"json",data:s(s({},r),{},{_wpnonce:TD_SETS.nonce,query_string:t,paged:1,page:i})}).done((t=>{this.allFetched[l]=!t.length,this.data[a]=t,e.trigger("searching-done",t,i),n(t)})).fail((e=>o(e)))):(n(this.data[a]),e.trigger("searching-done",this.data[a],i))}))}}},86152:function(e,t,s){const i=s(18421);e.exports=s(2921).extend({className:"tva-rule-item-wrapper",template:TVE_Dash.tpl("products/partials/rule-item"),afterInitialize:function(e){this.setModel=e.setModel},afterRender:function(){switch(this.deleteWarning="",this.dataVal="",this.$type=this.$(".tva-rule-item-content-type"),this.$data=this.$(".tva-rule-item-content-data"),this.$icon=this.$(".tva-rule-item-content-icon"),this.$type.html(`${1===this.model.get("value").length?this.model.get("content_label").singular:this.model.get("content_label").plural}`),this.model.get("content_type")){case"term":"tva_courses"===this.model.get("content")&&this.$icon.html(TVA.Utils.icon("book_light"));break;case"post":switch(this.model.get("content")){case"page":this.$icon.html(TVA.Utils.icon("file-alt_light"));break;case"post":this.$icon.html(TVA.Utils.icon("feather_light"));break;case TVA.files.post_type:this.$icon.html(TVA.Utils.icon("icon-protected-files"));break;case"product":this.$type.html(1===this.model.get("value").length?"WooCommerce product":"WooCommerce products"),this.$icon.html(TVA.Utils.icon("hand-holding-box_light"))}break;case"tvd_blog_page":case"tvd_search_result_page":break;case"archive":this.$type.append(" of");break;default:this.$type.html("Custom content")}switch(this.model.get("field").toString()){case"title":this.$type.append(":");break;case"-1":break;case"author":"archive"!==this.model.get("content_type")&&this.$type.html(`${this.model.get("content_label").plural} by`),this.$type.append(` ${this.model.get("field")}:`);break;case"category":this.$type.html(`${this.model.get("content_label").plural} with  ${this.model.get("field")}:`);break;case"topic":case"tag":case"difficulty":this.$type.html(`${this.model.get("content_label").plural} with ${this.model.get("field")}:`);break;default:this.$type.append(` with ${this.model.get("field")}:`)}this.deleteWarning+=`${this.$type.html()} `,this.model.get("value").forEach((e=>{if(this.deleteWarning+=`${e.text}, `,"tva_courses"===this.model.get("content")&&"title"===this.model.get("field")){const t=TVA.courses.findWhere({id:e.id}),s="draft"===t.get("status")?`${t.get("name")} [${TVA.t.Draft}]`:t.get("name");this.dataVal+=`<div data-id="${e.id}">${s}</div>`}else this.dataVal+=`<span data-id="${e.id}">${e.text}</span>, `})),"tva_courses"===this.model.get("content")&&"title"===this.model.get("field")&&this.$data.addClass("tva-flex tva-flex-column"),this.$data.html(this.dataVal.replace(/,\s*$/,""))},delete:function(){const e=this;this.$el.append(new i({template:TVE_Dash.tpl("products/partials/delete-rule"),className:"tva-delete-simple",afterRender:function(){this.$(".tva-content-details").html(e.deleteWarning.replace(/,\s*$/,""))},confirm:()=>{this.$el.tvaToggleLoader(),this.collection.remove(this.model),TVA.customers.reset(),this.setModel.get("ID")?this.setModel.save({return_one:1}).done((()=>this.destroy().remove())):this.destroy().remove()}}).render().$el)},edit:function(){this.setModel.getRules().trigger("edit-rule",this)}})},16273:function(e,t,s){const i=s(91479),n=s(35561),o=s(66340),r=s(88119),a=s(70331),l=s(18421),c=s(84643);e.exports=a.extend({template:TVE_Dash.tpl("products/single/restricted-content"),className:"tva-product-restricted-content",dragHandleSelector:".tva-drag-handle",afterInitialize:function(){this.listenTo(this.model.get("access_restrictions").custom,"add settings_changed",this.render)},afterRender:function(){a.prototype.afterRender.call(this),this.$itemsWrapper=this.$("#tva-restriction-wrapper"),this.$itemsWrapper.sortable({items:"> .tva-restriction-card",handle:this.dragHandleSelector,placeholder:"tva-drag-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:this.updateOrderNumbers.bind(this)})},updateOrderNumbers:function(){const e=this.$itemsWrapper.sortable("option","items"),t=this.$itemsWrapper.find(e),s=this.model.get("access_restrictions").custom;t.each((function(e,t){s.findWhere({custom_id:parseInt(t.dataset.id)}).set("order",e)})),s.sort(),this.model.save()},openRestrictionsModal:function(e){let t=this.model.get("access_restrictions")[e.currentTarget.dataset.scope];t.course_id=this.model.get("id"),e.currentTarget.dataset.id&&(t=this.model.get("access_restrictions").custom.findWhere({custom_id:parseInt(e.currentTarget.dataset.id)})),this.openModal(i,{accessTab:this,course:this.model,width:"670px",top:"40px",title:TVA.t.rule_behaviour_edit,className:"tvd-modal tvd-modal-small",contentRestriction:new r({scope:e.currentTarget.dataset.scope,autoSave:!1,settings:t})})},renderRestrictionSummary:function(){this.$(".product-restriction-summary").each(((e,t)=>{if(t.dataset.id){const e=this.model.get("access_restrictions").custom.findWhere({custom_id:parseInt(t.dataset.id)});t.textContent=this.getCustomRestrictionSummary(e.get("option"))}else t.textContent=this.model.getRestrictionSummary(t.dataset.scope)}))},getCustomRestrictionSummary:function(e){return TVA.accessRestriction.options[e].replace("(deprecated)","").trim()},openRuleModal:function(e){let t=this.model.get("access_restrictions");t=e.currentTarget.dataset.id?t.custom.findWhere({custom_id:parseInt(e.currentTarget.dataset.id)}):new c(t[e.currentTarget.dataset.scope]),this.openModal(n,{width:"670px",top:"40px",className:"tvd-modal tva-access-rules",title:TVA.t.edit_access_rule_conditions,scope:e.currentTarget.dataset.scope,model:t.deepClone(),originalModel:t,singleStep:!0,settingsCollection:this.model.get("access_restrictions").custom})},addRule:function(){this.openModal(n,{width:"670px",top:"40px",className:"tvd-modal tva-access-rules",title:TVA.t.add_access_rule,model:new o({scope:"custom",course_id:this.model.get("id"),currentStep:0,custom_id:-1}),settingsCollection:this.model.get("access_restrictions").custom})},deleteAccessRule:function(e){const t=this.model.get("access_restrictions").custom.findWhere({custom_id:parseInt(e.currentTarget.dataset.id)});if(t){t.set("id",t.get("custom_id"));const s=this.$(e.currentTarget).parents(".tva-restriction-card"),i=new l({template:TVE_Dash.tpl("products/partials/remove-rule"),className:"tva-delete-simple",confirm:()=>{t.destroy(),TVE_Dash.success(TVA.t.skin_deleted.replace("{name}",`<strong>${t.get("title")}</strong>`)),s.remove()}});s.append(i.render().$el)}else TVE_Dash.err(TVA.t.something_went_wrong)}})},62348:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(43265),a=s(5657),l=s(78818),c=s(273),d=s(2527),h=s(70331);e.exports=h.extend({template:TVE_Dash.tpl("products/single/rules"),className:"tva-purchase-req",$integrationsWrapper:null,$rulesCountMessage:null,events:n(n({},h.prototype.events),{},{"change #tva-product-identifier":"onIdentifierChange"}),saving:!1,afterInitialize:function(){this.listenTo(this.model.get("rules"),"add",this.renderRulesCount),this.listenTo(this.model.get("rules"),"remove",this.renderRulesCount),this.listenTo(this.model,"sync",this.afterRender)},afterRender:function(){if(h.prototype.afterRender.apply(this,arguments),this.$integrationsWrapper=this.$("#tva-course-integrations-wrapper"),this.$rulesCountMessage=this.$("#tva-rules-count-message"),!this.model)throw"Undefined model";this.model.get("identifier")||this.$(".tva-input-delete-x").hide(),this.renderIntegrations(TVA.access_integrations),TVE_Dash.data_binder(this)},renderIntegrations:function(e){this.$integrationsWrapper.empty(),e instanceof Backbone.Collection&&(e.each((e=>{const t={model:e,rules:this.model.get("rules"),buy_now_links:this.model.get("buy_now_links"),rulesModel:this.model},s=(()=>{let s;switch(e.get("slug")){case"woocommerce":s=new l(t);break;case"thrivecart":s=new a(t);break;case"stripe":s=new c(t);break;case"custom_payment":s=new d(t);break;default:s=new r(t)}return s})();this.$integrationsWrapper.append(s.render().$el)})),this.renderRulesCount())},renderRulesCount:function(){const e=this.model.get("rules").filter((e=>e.getItems().length||"thrivecart"===e.get("integration")));0===e.length?this.$rulesCountMessage.text(TVA.t.noAccessRulesSet):1===e.length?this.$rulesCountMessage.text(TVA.t.oneAccessRuleSet):this.$rulesCountMessage.text(TVE_Dash.sprintf(TVA.t.accessRulesSet,e.length))},onIdentifierChange:function(){const e=this.model.validateIdentifier();return e?(TVE_Dash.err(e),this.model.set("identifier",""),null):(this.saving=!0,""!==this.model.get("identifier")?wp.apiRequest({type:"PUT",url:`${this.model.url()}/identifier`,data:{identifier:this.model.get("identifier")}}).success((()=>{this.$(".tva-input-delete-x").show(),TVE_Dash.success(TVA.t.identifier_saved)})).error((e=>{this.model.set("identifier",e.responseJSON.old_identifier),TVE_Dash.err(e.responseJSON.error_messages)})).always((()=>this.saving=!1)):void this.deleteIdentifier())},deleteIdentifier:function(){return this.model.set("identifier",""),this.$(".tva-input-delete-x").hide(),wp.apiRequest({type:"DELETE",url:`${this.model.url()}/identifier`}).success((()=>{TVE_Dash.success(TVA.t.identifier_deleted)})).error((e=>TVE_Dash.err(e.responseJSON)))},saveRules:function(){wp.hooks.applyFilters("tva.access_rules.prevent_saving",this.saving)||this.saveModel()}})},85159:function(e,t,s){!function(t){const i=s(92900),n=s(84643),o=s(27339),r=s(51135),a=s(6906);e.exports=r.extend({className:"tva-products",template:TVE_Dash.tpl("products/list"),templateNoItem:TVE_Dash.tpl("products/no-item"),templateNoSearchResult:TVE_Dash.tpl("products/no-search-result"),templateItem:TVE_Dash.tpl("products/list-item"),searchFilterView:null,dragHandleSelector:".tva-drag-handle",isLoading:!0,afterInitialize:function(){t(window).scroll(this.checkScroll.bind(this)),t(window).on("resize",this.checkWindowScroll.bind(this)),this.collection=TVA.products,this.listenTo(this.collection,"total-changed",this.loadResults),this.listenTo(this.collection,"fetched",this.loadResults),this.listenTo(this.collection,"fetching",(()=>this.$loadingNotice.show()))},afterRender:function(){this.$itemsWrapper=this.$(".tva-products-wrapper").empty(),this.$filters=this.$("#tva-products-filters-wrapper"),this.$loadingNotice=this.$(".tva-loading-notice").hide(),this.$productsCounter=this.$("#tva-products-counter"),this.$hideFor0Products=this.$(".tva-hide-for-no-products"),this.renderProducts(),this.renderSearchFilter(),this.$itemsWrapper.sortable({items:"> .tva-product",handle:this.dragHandleSelector,placeholder:"tva-drag-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:this.updateOrderNumbers.bind(this)})},updateOrderNumbers:function(){if(0===TVA.products.length)return;const e=this.$itemsWrapper.sortable("option","items"),t=this.$itemsWrapper.find(e),s=t.length-1,i=new n;t.each((function(e,t){i.set(t.dataset.id,s-e)})),i.url=`${TVA.routes.products}/update_orders`,TVE_Dash.showLoader(),i.save().done((e=>{e&&(t.reverse().each(((e,t)=>TVA.products.findWhere({id:parseInt(t.getAttribute("data-id"))}).set({order:e},{silent:!0}))),TVA.products.sort(),TVE_Dash.hideLoader())}))},renderSearchFilter:function(){this.searchFilterView=new o({placeholder:TVA.t.searchProducts+"...",value:this.collection.hasFilters()?this.collection.getFilter("search",""):""}),this.addChild(this.searchFilterView),this.$filters.append(this.searchFilterView.render().$el),this.searchFilterView.on("change",(e=>e.trim().length>0?this.collection.search({search:e}):this.collection.resetAndFetch()))},renderProducts:function(){return this.$itemsWrapper.empty(),0===this.collection.length?this.collection.hasFilters()?this.$itemsWrapper.html(this.templateNoSearchResult()):(this.$hideFor0Products.hide(),this.$itemsWrapper.html(this.templateNoItem())):this.$hideFor0Products.show(),this.renderCollection().checkWindowScroll(),this},addNewProduct:function(e,t){this.collection.hasFilters()?this.collection.resetAndFetch().done((()=>this.addNewProduct(e,t))):this.openModal(i,{collection:this.collection,screen:t.getAttribute("data-screen"),width:"760px",className:"tvd-modal tva-new-product-modal"})},renderCollection:function(){return this.itemViews&&this.itemViews.forEach((e=>e.destroy())),this.itemViews=[],this.contentProducts=[],this.collection.each((e=>{const t=new a({model:e,collection:this.collection,allowDrag:!0,showCustomersNumber:!0,showTooltipDot:!0});e.getContent().forEach((e=>{void 0===this.contentProducts[e]?this.contentProducts[e]=1:this.contentProducts[e]++})),this.itemViews.push(t),this.$itemsWrapper.append(t.render().$el)})),this.itemViews.forEach((e=>{e.model.getContent().forEach((t=>{this.contentProducts[t]>1&&e.$el.addClass("tva-tooltip-enabled")}))})),this.addChild(this.itemViews),this.$(".tva-product-item").toggleClass("tva-drag-disabled",this.collection.hasFilters()),this.isLoading=!1,this.$productsCounter.html(TVA.Utils._n(this.collection.total,"product","products")),this},checkScroll:function(){const e=this.collection.pageInfo();return e.currentPage>=e.totalPages||!this.isLoading&&this.$el[0].scrollTop+this.$el[0].clientHeight+100>this.$el[0].scrollHeight&&(this.isLoading=!0,this.collection.next()),this},checkWindowScroll:function(){return document.body.scrollHeight>document.body.clientHeight||this.checkScroll(),this},loadResults:function(){this.renderProducts(),this.$loadingNotice.hide()}})}(jQuery)},43350:function(e,t,s){const i=s(51135),n=s(16591),o=s(48327),r=s(81020),a=s(11605),l=s(27339),c=s(77003),d=s(26035),h=s(83524);e.exports=i.extend({template:TVE_Dash.tpl("protected-files/list"),tooltipKey:"protected-files-intro",ensureData:async function(){return new Promise((e=>{TVA.allProducts?e():(TVE_Dash.showLoader(),wp.apiRequest({url:TVA.routes.products,data:{return_terms:1}}).done((e=>{e.items&&(TVA.allProducts=e.items)})).always((()=>{TVE_Dash.hideLoader(),e()})))}))},afterInitialize:function(){this.listenTo(TVA.ProtectedFiles,"fetched",this.loadList)},afterRender:function(){this.$notice=this.$(".tva-protected-files-notice"),this.$list=this.$(".tva-protected-files-list"),this.$auxiliaryUploadControl=this.$(".tva-protected-files-auxiliary-upload-control"),this.$filters=this.$(".tva-protected-files-filters"),this.$pagination=this.$(".tva-pagination"),this.$noResults=this.$(".tva-protected-files-no-results"),TVA.Utils.isTooltipViewed(this.tooltipKey)||(requestAnimationFrame((()=>this.autoOpenHelpLightbox())),TVA.Utils.saveTooltips(this.tooltipKey)),this.checkFileProtection(),this.renderSearchFilter().renderProductFilter(),this.loadList(),new c({el:this.$pagination,collection:TVA.ProtectedFiles,noItemTemplate:function(){return""},fetching:function(){this.$el.html(TVE_Dash.tpl("pagination-loading-full-width")({text:"Looking for matching results"}))}}).render()},renderProductFilter:function(){return this.$filters.append(new d({dropdownClass:"tva-protected-files-product-filter-dropdown tva-select-tags-filter-dropdown",containerClass:"tva-protected-files-product-filter-container tva-select-tags-filter-container",withCounterTags:!0,selectOptions:{closeOnSelect:!1,placeholder:"Show all products' files"},selectData:[{id:0,text:"Not assigned"},...TVA.allProducts.map((e=>({id:e.term_id,text:e.name})))],change:e=>{TVA.ProtectedFiles.search({products:e.length?e:[]})}}).render().$el),this},renderSearchFilter:function(){const e=new l({placeholder:"Search for files",value:TVA.ProtectedFiles.hasFilters()?TVA.ProtectedFiles.getFilter("search",""):""});return this.addChild(e),this.$filters.append(e.render().$el),e.on("change",(e=>e.trim().length>0?TVA.ProtectedFiles.search({search:e}):TVA.ProtectedFiles.resetAndFetch())),this},checkFileProtection:function(){wp.apiRequest({type:"GET",url:`${TVA.routes.protected_files}/check-file-protection`,data:{}}).done((e=>{0===parseInt(e.ok)&&this.$notice.html(TVE_Dash.tpl("protected-files/"+(0===parseInt(e.code)?"notice-incompatible-server":"notice-server-not-configured"))())}))},loadList:function(){this.$filters.css("visibility",TVA.ProtectedFiles.hasFilters()||0!==TVA.ProtectedFiles.length?"visible":"hidden"),this.$auxiliaryUploadControl.html(new h({template:TVA.ProtectedFiles.length>0||TVA.ProtectedFiles.hasFilters()?"protected-files/upload-control-small":"protected-files/upload-control-big"}).render().$el),this.$list.empty(),TVA.ProtectedFiles.each((e=>{this.$list.append(new o({model:e,showTooltip:!(!TVA.ProtectedFiles.justAdded||TVA.ProtectedFiles.first().cid!==e.cid)}).render().$el)})),delete TVA.ProtectedFiles.justAdded,this.$noResults[TVA.ProtectedFiles.hasFilters()&&0===TVA.ProtectedFiles.length?"show":"hide"]()},addFile:function(){this.openModal(r,{width:n.ModalWidth,className:n.ModalClasses})},openHelpLightbox:function(){this.openModal(a,{width:n.ModalWidth,className:n.HelpModalTallCLasses})},autoOpenHelpLightbox:function(){this.openModal(a,{width:n.ModalWidth,className:n.HelpModalShortCLasses})}})},83524:function(e,t,s){const i=s(81020),n=s(16591);e.exports=s(2921).extend({className:"tva-file-upload-area",afterRender:function(){new plupload.Uploader({browse_button:this.$(".tva-file-upload-control-select").get(0),container:this.$el.get(0),drop_element:this.$el.get(0),multi_selection:!1,init:{FilesAdded:(e,t)=>{this.openModal(i,{file:t[0],width:n.ModalWidth,className:n.ModalClasses})},Init:()=>{this.$el.on("dragover.wp-uploader",(()=>{this.$el.addClass("drag-over")})).on("dragleave.wp-uploader, drop.wp-uploader",(()=>{this.$el.removeClass("drag-over")}))}}}).init()}})},16591:function(e){e.exports={ModalClasses:"tvd-modal tva-protected-files-modal",HelpModalCLasses:"tvd-modal tva-protected-files-help-modal",HelpModalTallCLasses:"tvd-modal tva-protected-files-help-modal tva-protected-files-help-modal-tall",HelpModalShortCLasses:"tvd-modal tva-protected-files-help-modal tva-protected-files-help-modal-short",ModalWidth:"760px"}},48327:function(e,t,s){const i=s(18421),n=s(16591),o=s(72540),r=s(553);e.exports=s(2921).extend({template:"protected-files/item",className:"tva-protected-file-item tva-flex",shouldShowTooltip:!1,afterInitialize:function(e){this.shouldShowTooltip=e.showTooltip},afterRender:function(){this.$actionButtonsWrapper=this.$(".tva-protected-file-item-action-buttons"),this.$tooltip=this.$(".tva-share-tooltip"),this.$(".tva-included-counter").html(TVA.Utils._n(this.model.getNumberOfProducts(),"product","products")),this.$(".tva-download-counter").html(TVA.Utils._n(this.model.get("download_counter"),"time","times")),this.shouldShowTooltip&&(this.$tooltip.addClass("ttd-visible"),this.$actionButtonsWrapper.addClass("visible"))},editFile:function(){this.closeTooltip(),this.openModal(r,{model:this.model,width:n.ModalWidth,className:n.ModalClasses})},shareFile:function(){this.closeTooltip(),this.openModal(o,{width:n.ModalWidth,className:n.HelpModalCLasses})},closeTooltip:function(){this.$tooltip.removeClass("ttd-visible"),this.$actionButtonsWrapper.removeClass("visible")},removeFile:function(){this.closeTooltip();const e=new i({template:TVE_Dash.tpl("protected-files/item-delete-confirmation"),title:`Are you sure you want to delete "${this.model.get("post_title")}" file?`,className:"tva-delete-simple",confirm:()=>{this.model.destroy({wait:!0,success:()=>{TVA.ProtectedFiles.fetch(),this.destroy().remove()}})},cancel:function(){this.remove()}});this.$el.append(e.render().$el)},getFileIcon:function(){const e=this.model.get("file_type");return this.icons[e]?this.icons[e]:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5z"/> </g> </svg>'},icons:{pdf:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472zM4.739 18.373l.126-.005c.4-.057.794-.3 1.18-.73.387-.43.838-1.088 1.353-1.975l.645-.215c1.316-.43 2.276-.701 2.877-.816.458.258.945.465 1.46.623.515.157.952.236 1.31.236.357 0 .63-.107.816-.322a.956.956 0 0 0 .236-.752c-.029-.286-.115-.5-.258-.644-.43-.43-1.489-.53-3.178-.3-.859-.516-1.503-1.332-1.932-2.448l.043-.13c.143-.572.229-1.015.257-1.33.086-.544.086-.974 0-1.289-.057-.4-.229-.665-.515-.794a1.172 1.172 0 0 0-.88-.043c-.3.1-.48.279-.537.537-.115.372-.129.844-.043 1.417.057.487.186 1.13.386 1.932-.658 1.604-1.26 2.863-1.803 3.78-1.518.801-2.362 1.56-2.534 2.275-.028.258.065.494.28.709.214.215.493.308.837.28l-.126.004zm4.077-8.293c-.115-.315-.172-.73-.172-1.245 0-.516.028-.773.086-.773v-.043c.171 0 .264.286.279.859.014.572-.05.973-.193 1.202zm-1.289 4.81c.372-.687.773-1.604 1.203-2.749.4.745.901 1.346 1.503 1.804-.516.086-1.231.315-2.148.687l-.558.258zm6.442-.215c-.115.029-.287.014-.516-.043-.343-.057-.744-.186-1.202-.387.515-.057.945-.057 1.288 0 .258.058.437.122.537.194.1.071.107.136.022.193-.029.029-.072.043-.13.043zm-9.315 2.928-.004-.008c.143-.4.601-.945 1.374-1.632l.129-.129c-.286.458-.558.83-.816 1.117-.172.229-.33.4-.472.515-.143.115-.215.158-.215.13l.004.007z"/> <path d="M12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5z"/> </g> </svg>',text:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M15 9.75a.75.75 0 1 1 0 1.5H4a.75.75 0 1 1 0-1.5h11zM14 12.75a.75.75 0 1 1 0 1.5H4a.75.75 0 1 1 0-1.5h10zM13 15.75a.75.75 0 1 1 0 1.5H4a.75.75 0 1 1 0-1.5h9zM12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5z"/> </g> </svg>',doc:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M6.5 18.667a.66.66 0 0 0 .39-.13c.122-.087.2-.2.235-.34l1.667-6.25c.07-.381.139-.78.208-1.197l.104.52c.14.556.608 2.31 1.406 5.261l.417 1.667a.578.578 0 0 0 .234.338.66.66 0 0 0 .391.13h.73c.138 0 .294-.043.468-.13.174-.086.278-.2.313-.338l2.24-8.75a.673.673 0 0 0-.131-.547.593.593 0 0 0-.495-.234h-.364a.66.66 0 0 0-.391.13c-.122.087-.2.2-.235.338-.021.154-.062.375-.122.664l-.067.31c-.133.612-.33 1.45-.592 2.516-.59 2.708-.903 4.167-.937 4.375a6.74 6.74 0 0 0-.313-1.198c-.416-1.389-1.041-3.611-1.875-6.667a.625.625 0 0 0-.208-.338.552.552 0 0 0-.365-.13h-.364a.552.552 0 0 0-.365.13.625.625 0 0 0-.208.338c-.938 3.368-1.51 5.504-1.719 6.407a36.982 36.982 0 0 0-.364 1.562v.104l-.053-.52c-.104-.695-.677-3.212-1.718-7.553a.578.578 0 0 0-.235-.338.66.66 0 0 0-.39-.13h-.365a.593.593 0 0 0-.495.234.673.673 0 0 0-.13.547l2.24 8.75c0 .139.06.252.182.338a.66.66 0 0 0 .39.13H6.5zM12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5z"/> </g> </svg>',xls:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5zM6 19.5a.577.577 0 0 0 .469-.234 45.61 45.61 0 0 1 1.687-2.578c.407-.563.688-1 .844-1.313.719 1.281 1.422 2.375 2.11 3.281l.421.61A.577.577 0 0 0 12 19.5h.188a.534.534 0 0 0 .492-.281.495.495 0 0 0-.024-.563l-2.719-4.218 2.344-3.844a.495.495 0 0 0 .024-.563.534.534 0 0 0-.492-.281h-.188a.485.485 0 0 0-.469.281l-1.078 1.594c-.531.812-.89 1.438-1.078 1.875l-.047-.094a22.7 22.7 0 0 0-.984-1.64L6.844 10.03a.485.485 0 0 0-.469-.281h-.188a.534.534 0 0 0-.492.281.495.495 0 0 0 .024.563l2.39 3.844-2.765 4.171c-.125.22-.133.422-.024.61.11.187.274.281.492.281H6z"/> </g> </svg>',archive:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M9 3.5V2H7.5v1.5H9zM7.5 5V3.5H6V5h1.5zM9 6.5V5H7.5v1.5H9zM7.5 8V6.5H6V8h1.5zM9 9.5V8H7.5v1.5H9zm-1.5 9c.781 0 1.414-.297 1.898-.89.485-.594.649-1.282.493-2.063l-.797-4.078a.542.542 0 0 0-.211-.352A.594.594 0 0 0 8.53 11H7.5V9.5H6V11l-.89 4.547c-.157.781.007 1.469.492 2.062.484.594 1.117.891 1.898.891zm0-1.219c-.406 0-.758-.125-1.055-.375-.297-.25-.445-.547-.445-.89 0-.344.148-.641.445-.891.297-.25.657-.375 1.078-.375.422 0 .782.125 1.079.375.296.25.445.547.445.89 0 .344-.149.641-.445.891-.297.25-.665.375-1.102.375zM12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5z"/> </g> </svg>',video:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5zM9.906 17.333c.321 0 .584-.102.788-.306.204-.204.306-.467.306-.787v-.438l1.225 1.225c.204.204.452.306.744.306h1.181c.292 0 .54-.102.744-.306.204-.204.306-.452.306-.744v-4.9c0-.291-.102-.54-.306-.743a1.013 1.013 0 0 0-.744-.307h-1.181c-.292 0-.54.102-.744.307L11 11.865v-.438c0-.32-.102-.583-.306-.787-.204-.205-.467-.307-.788-.307H5.094c-.321 0-.584.102-.788.307-.204.204-.306.466-.306.787v4.813c0 .32.102.583.306.787.204.204.467.306.788.306h4.812zm-.306-1.4H5.4v-4.2h4.2v4.2zm4.2 0h-.7L11 14.14v-.613l2.1-1.794h.7v4.2z"/> </g> </svg>',audio:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M11.719 19.5a.507.507 0 0 0 .375-.14 6.285 6.285 0 0 0 2.133-2.344A6.398 6.398 0 0 0 15 13.969a6.44 6.44 0 0 0-.867-3.281 6.303 6.303 0 0 0-2.32-2.344c-.188-.125-.376-.164-.563-.117a.639.639 0 0 0-.422.328.723.723 0 0 0-.07.539.656.656 0 0 0 .305.422 5.139 5.139 0 0 1 1.851 1.898 5 5 0 0 1 .68 2.508c0 .875-.203 1.687-.61 2.437a5.384 5.384 0 0 1-1.687 1.875.578.578 0 0 0-.281.422.766.766 0 0 0 .14.563c.125.187.313.281.563.281zm-1.266-1.828c.156.031.297 0 .422-.094a4.388 4.388 0 0 0 1.406-1.57c.344-.64.516-1.336.516-2.086 0-.75-.195-1.461-.586-2.133a4.58 4.58 0 0 0-1.57-1.617.656.656 0 0 0-.516-.07.721.721 0 0 0-.445.328.604.604 0 0 0-.07.539.748.748 0 0 0 .328.422c.437.28.789.648 1.054 1.101.266.453.399.93.399 1.43a3.037 3.037 0 0 1-1.313 2.484.594.594 0 0 0-.281.446.791.791 0 0 0 .117.562c.11.172.29.258.54.258zm-3.14.703c.156 0 .289-.055.398-.164a.542.542 0 0 0 .164-.398v-7.125a.542.542 0 0 0-.164-.399.542.542 0 0 0-.399-.164.445.445 0 0 0-.375.188L4.876 12H3.562a.542.542 0 0 0-.398.164.542.542 0 0 0-.164.399v3.374c0 .157.055.29.164.399.11.11.242.164.398.164h1.313l2.063 1.688a.445.445 0 0 0 .375.187zm1.921-2.484c.125 0 .25-.032.375-.094.313-.188.563-.445.75-.774.188-.328.282-.687.282-1.078 0-.39-.102-.758-.305-1.101a2.042 2.042 0 0 0-.867-.797.593.593 0 0 0-.516-.047.725.725 0 0 0-.422.352.651.651 0 0 0-.047.539c.063.187.172.312.329.375.28.156.421.382.421.68 0 .296-.125.507-.375.632a.852.852 0 0 0-.304.469c-.047.187-.008.375.117.562.125.188.312.282.562.282zm-2.765.093-1.219-.89h-.844v-1.688h.844l1.219-.89v3.468zM12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5z"/> </g> </svg>',image:'<svg width="23" height="30" viewBox="0 0 23 30" xmlns="http://www.w3.org/2000/svg"> <g fill="currentColor" fill-rule="nonzero"> <path d="M17.865 18.326c2.618 0 3.202 1.287 3.202 4.424h-1.3l-.004-.46c-.037-2.045-.36-2.624-1.745-2.662l-.153-.002c-1.617 0-1.898.623-1.898 3.124h-1.3l.005-.493c.063-2.78.718-3.93 3.193-3.93z"/> <path d="M21 22.35h-6A1.65 1.65 0 0 0 13.35 24v4c0 .911.739 1.65 1.65 1.65h6A1.65 1.65 0 0 0 22.65 28v-4A1.65 1.65 0 0 0 21 22.35zm0 1.3a.35.35 0 0 1 .35.35v4a.35.35 0 0 1-.35.35h-6a.35.35 0 0 1-.35-.35v-4a.35.35 0 0 1 .35-.35h6z"/> <path d="M18 24.433a.65.65 0 0 1 .65.65v1.397a.65.65 0 1 1-1.3 0v-1.397a.65.65 0 0 1 .65-.65zM11.972.25a2.25 2.25 0 0 1 1.644.714l4.528 4.848c.39.417.606.966.606 1.536v10.036h-1.5V7.348a.75.75 0 0 0-.202-.512L12.52 1.988a.75.75 0 0 0-.548-.238H2.5a.75.75 0 0 0-.75.75v20c0 .414.336.75.75.75H12v1.5H2.5A2.25 2.25 0 0 1 .25 22.5v-20A2.25 2.25 0 0 1 2.5.25h9.472z"/> <path d="M12.75 1v4.5c0 .414.336.75.75.75H18v1.5h-4.5a2.25 2.25 0 0 1-2.25-2.25V1h1.5zM5.953 11c.813 0 1.516-.297 2.11-.89.593-.594.89-1.298.89-2.11 0-.812-.297-1.516-.89-2.11C7.468 5.298 6.766 5 5.953 5c-.812 0-1.515.297-2.11.89-.593.594-.89 1.298-.89 2.11 0 .812.297 1.516.89 2.11.595.593 1.298.89 2.11.89zm0-1.5c-.406 0-.758-.148-1.055-.445A1.442 1.442 0 0 1 4.453 8c0-.406.149-.758.445-1.055A1.442 1.442 0 0 1 5.953 6.5c.406 0 .758.148 1.055.445.297.297.445.649.445 1.055 0 .406-.148.758-.445 1.055a1.442 1.442 0 0 1-1.055.445zm9 8.346V13.25l-2.578-2.625a.686.686 0 0 0-.422-.14.507.507 0 0 0-.375.14L7.453 14.75l-1.828-1.875a.686.686 0 0 0-.422-.14.583.583 0 0 0-.422.187L3 14.703 2.953 20H13.35l1.603-2.154zm-1.5-.319-.687.973H4.453v-3.14l.75-.75 2.25 2.25 4.5-4.5 1.5 1.5v3.667z"/> </g> </svg>'}})},2948:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r;r=jQuery,e.exports=s(2921).extend({className:"tva-file-upload-area",template:"protected-files/upload-control-big",plupload:null,maxNoFilesAllowed:1,collection:new Backbone.Collection({}),afterInitialize:function(e){this.collection=e.collection,this.onUploadComplete="function"==typeof e.onUploadComplete?e.onUploadComplete:r.noop,this.onUploadProgress="function"==typeof e.onUploadProgress?e.onUploadProgress:r.noop,this.initialFile=e.initialFile||!1,this.context=e.context||""},afterRender:function(){this.plupload=new plupload.Uploader(n(n({},TVA.files.upload_params),{},{headers:{"X-WP-Nonce":TVA.apiSettings.nonce},url:TVA.routes.protected_files,browse_button:this.$(".tva-file-upload-control-select").get(0),container:this.$el.get(0),drop_element:this.$el.get(0),multi_selection:!1,multipart:!0,multipart_params:{},init:{FilesAdded:e=>{const t=e.files.length,s=r.map(e.files,(e=>e.id));let i=0;if(t>this.maxNoFilesAllowed)for(i=0;i<t-this.maxNoFilesAllowed;i++)this.plupload.removeFile(this.plupload.getFile(s[i]));this.collection.reset(this.plupload.files)},Init:()=>{this.$el.on("dragover.wp-uploader",(()=>{this.$el.addClass("drag-over")})).on("dragleave.wp-uploader, drop.wp-uploader",(()=>{this.$el.removeClass("drag-over")}))},PostInit:e=>{e.refresh(),this.initialFile&&this.plupload.addFile(this.initialFile)},UploadProgress:(e,t)=>{this.onUploadProgress(t.percent)},FilesRemoved:()=>{this.collection.reset(this.plupload.files)},UploadComplete:()=>{this.onUploadComplete()},Error:(e,t,s)=>{switch(t.code){case plupload.FILE_SIZE_ERROR:s=TVA.files.errors.file_exceeds_size_limit;break;case plupload.FILE_EXTENSION_ERROR:s=TVA.files.errors.invalid_filetype;break;default:s=TVA.files.errors.default_error}TVE_Dash.err(s)}}})),this.plupload.init()},addAdditionalParameters:function(e={}){return this.plupload.setOption("multipart_params",e),this},startUpload:function(){this.plupload.start()}})},95967:function(e,t,s){const i=s(51135);e.exports=i.extend({template:TVE_Dash.tpl("reports/quiz")})},31357:function(e,t,s){const i=s(72877);e.exports=s(2921).extend({afterInitialize:function(e){this.reportScope=e.scope},afterRender:function(){TVA.migrate_access&&1===parseInt(TVA.migrate_access.should_migrate)&&i.getInstance()},afterInsert:function(){window.thriveReportsInit(this.el,this.reportScope)},toggleShowMore:function(e){e.target.closest(".apprentice-info").classList.toggle("expanded")},dismissWelcomeNotification:function(e){e.target.closest(".apprentice-intro").remove(),TVA.Utils.saveTooltips("reports-dismiss-welcome-notification")}})},76821:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(73799),o=s(2921),r=o.extend({template:TVE_Dash.tpl("select/add-item"),inputTemplate:_.template('<input type="text" placeholder="<#= this.str.title #>" class="">',TVE_Dash.templateSettings),str:{title:"Add new item",save:"Save",err:"Required field missing"},events:n(n({},o.prototype.events),{},{'keyup input[type="text"]':"onKeyup"}),initialize:function(e){this.state=new Backbone.Model({step:"default"}),t.extend(!0,this,e),this.listenTo(this.state,"change",this.render.bind(this))},onKeyup:function(e){switch(e.which){case 13:this.save();break;case 27:this.reset()}},afterRender:function(){this.$input=this.$("input").filter(":visible").not(".tva-dropdown-thumb input"),this.focusInput()},focusInput:function(){requestAnimationFrame((()=>this.$input.focus()))},renderInput:function(){return this.inputTemplate({})},showInput:function(){return this.state.set("step","input"),!1},reset:function(){this.$input.val("").removeClass("tvd-validate tvd-invalid"),this.state.set("step","default")},save:function(){if(!this.$input.val().trim())return this.$input.addClass("tvd-validate tvd-invalid"),TVE_Dash.err(this.str.err),this.focusInput(),!1;this.$input.removeClass("tvd-validate tvd-invalid");const e=this.getModelForSave();return this.$el.tvaToggleLoader(),e.save().done((t=>{!t.id&&t.ID&&(t.id=t.ID),this.addToCollection(t),this.dropdown.closeSelect(),this.$el.tvaToggleLoader(!1),"function"==typeof this.afterSave&&this.afterSave(t,e),this.dropdown.selectItem(this.dropdown.collection.findWhere({id:t.id}))})),!1},addToCollection:function(e){this.dropdown.collection.unshift(e)},destroy:function(){this.$(".tva-colorpicker").each((function(){const e=t(this);e.data("spectrum.id")&&e.spectrum("destroy")})),o.prototype.destroy.call(this)}});e.exports=o.extend({thumbCssClass:"tva-dropdown-thumb",listCssClass:"tva-dropdown-list",listItemCssClass:"tva-dropdown-list-item",className:"tva-dropdown",template:TVE_Dash.tpl("select"),label:null,$thumb:null,renderThumbs:!1,deletable:!1,events:function(){return n(n({},o.prototype.events),{},{click:function(e){const s=t(e.target).closest("."+this.listItemCssClass);if(s.length){const e=parseInt(s.attr("data-id"));return this.selectItem(this.collection.findWhere({[this.collection.idAttribute]:e}))}if("INPUT"===e.target.tagName.toUpperCase())return e.stopPropagation();e.target.closest("."+this.listCssClass)||(this.displayList(),e.stopPropagation())}})},initialize:function(e){if(t.extend(!0,this,e),!e||!e.collection)throw new Error("collection has to be provided for this select view");if(!(e.collection instanceof i))throw new Error("collection has to inherit from specific select collection");this.model=this.collection.getSelectedItem(),this.collection.on("selectionchange",(e=>this.model=e))},render:function(e=!1){if(!this.model)return console.error("No selected item to be rendered"),this;let s;const i=t(this.template({model:this.model}));return!0===e&&(s=this.$(".tva-dropdown-items")).length?s.replaceWith(i.filter(".tva-dropdown-items")):this.$el.html(i),this.renderThumbs&&this.renderThumb(this.$el,this.model),this},getLabel:function(){return this.label},renderThumb:function(e,s){const i=t("<div/>").css("background-color",s.get("color")).addClass(this.thumbCssClass);return"icon"===s.get("icon_type")?i.css({"background-image":"url("+s.get("icon")+")"}):"svg_icon"===s.get("icon_type")?i.html(s.get("svg_icon")):s.get("url")?i.css({"background-image":"url("+s.get("url")+")"}):s.get("avatar_url")&&i.css({"background-image":"url("+s.get("avatar_url")+")"}),s.get("class")&&i.addClass(s.get("class")),i[0].style.setProperty("--thumb-color",s.get("color")),e.prepend(i),this},displayList:function(){if(this.$("."+this.listCssClass).length)return this.closeSelect();this.trigger("tva.before.display.list");const e=t('<div class="tva-items-holder"></div>');return this.collection.each((s=>{const i=t("<div/>").addClass(this.listItemCssClass);this.renderThumbs&&this.renderThumb(i,s),i.append(t("<div/>").html(s.get("title")||s.get("name"))),i.attr("data-id",s.get(this.collection.idAttribute)),this.editable&&(i.append(`<span class="tva-difficulty-edit tva-hide pl-10 click" data-fn="editItem">${TVA.Utils.icon("pencil-custom")}</span>`),i.append('<div style="display: none;">\n\t\t\t\t\t\t\t\t\t\t<input class="m-0" id="tva-level-'+s.get("id")+'-name" type="text" data-bind="name">\n\t\t\t\t\t\t\t\t\t\t<label for="tva-course-'+s.get("id")+'-name"></label>\n\t\t\t\t\t\t\t\t\t</div>'),i.hover((function(){const e=t(this).find(".tva-difficulty-edit");e&&e.removeClass("tva-hide")})),i.mouseleave((function(){const e=t(this).find(".tva-difficulty-edit");e&&e.addClass("tva-hide")}))),this.deletable&&0!==parseInt(s.get("id"))&&i.append(`<span class="tva-difficulty-delete click" data-fn="deleteItem" data-id="${s.get("id")}">${TVA.Utils.icon("trash-1")}</span>`),e.append(i)})),this.$el.append(e.wrap(`<div class="${this.listCssClass}"></div>`).parent()),this.add_item&&(this.add_item.dropdown=this,this.addItemView=new r(this.add_item),this.addChild(this.addItemView),e.after(this.addItemView.render().$el)),this.trigger("tva.display.list",e,this),this},selectItem:function(e,t=!1){return this.model=e,this.collection.setSelected(this.model),this.render(t),this.trigger("tva.dropdown.item.selected",this.model,this.collection,t),this},closeSelect:function(){return this.addItemView&&this.addItemView.destroy(),this.$(`.${this.listCssClass}`).remove()},editItem:function(e,s){e.stopPropagation();const i=t(s).hide(),n=i.prev().hide(),o=i.next().show().find("> input").val(n.text()).focus().select();o.off("keyup blur click").on("keyup",(e=>{13===e.which&&this.saveName.call({self:this,value:o.val().trim(),id:o[0].id.match(/\d+/)[0]})})).on("click",(e=>{e.stopPropagation()})).on("blur",(()=>{this.saveName.call({self:this,value:o.val().trim(),id:o[0].id.match(/\d+/)[0]})}))},saveName:function(){if(this.value&&"string"==typeof this.value){const e=this.self.collection.models.find((e=>e.get("id")===parseInt(this.id))),t=TVA.levels.findIndex((e=>e.id===parseInt(this.id)));e.set("name",this.value),e.url=`${TVA.apiSettings.root}${TVA.apiSettings.v1}/levels/${this.id}`,e.save(),this.self.render(),TVA.levels[t].name=this.value,TVE_Dash.success(TVA.t.level_saved)}else TVE_Dash.err(TVA.t.EmptyName)},deleteItem:t.noop})}(jQuery)},26035:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(2921).extend({template:_.template('<select class="change" data-fn="changed" multiple></select>'),className:"tva-select-with-checkboxes",selectOptions:{},selectData:[],withCounterTags:!1,afterInitialize:function(e={}){o.extend(!0,this,e),this.selectOptions=e.selectOptions?e.selectOptions:{},this.selectData=Array.isArray(e.selectData)?e.selectData:[],this.dropdownClass=e.dropdownClass?e.dropdownClass:"tva-select-with-checkboxes-dropdown",this.containerClass=e.containerClass?e.containerClass:"tva-select-with-checkboxes-container"},change:o.noop,render:function(){return this.$el.html(this.template()),this.$select=this.$el.find("select").empty(),this.selectData.forEach((e=>{const t=new Option(e.text,e.id,!1,!1);this.$select.append(t)})),this.$select.select2(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({placeholder:"Select an option",closeOnSelect:!0,maximumSelectionLength:1/0,templateResult:e=>{const t=o('<input type="checkbox" class="tva-select-with-checkboxes-checkbox"/>');t.attr("value",e.id),e.selected&&t.attr("checked","checked"),t.on("change",(e=>(e.preventDefault(),!1)));const s=o('<label class="tva-select-with-checkboxes-label">').append(t).append(e.text);return s.on("click",(e=>(e.preventDefault(),!1))),o("<span>").append(s)},escapeMarkup:function(e){return e}},this.selectOptions)),this.$select.data("select2").$dropdown.addClass(this.dropdownClass),this.$select.data("select2").$container.addClass(this.containerClass),this.$select.data("select2").$container.find(".select2-search input").css({width:"400px"}),this},changed:function(){const e=this.$select.data("select2").isOpen(),t=Array.from(this.$select.val());if(e){const e=this.$select.data("select2").$dropdown;e.find(".tva-select-with-checkboxes-checkbox").prop("checked",!1),t.forEach((t=>{e.find(`.tva-select-with-checkboxes-checkbox[value="${t}"]`).prop("checked",!0)}))}this.change(t),this.withCounterTags&&this.handleCounterTags()},handleCounterTags:function(){const e=this.$(".select2-selection__rendered");let t=0,s=0;const i=[];if(e.children(".select2-selection__choice").each(((n,o)=>{n&&t+o.offsetWidth+6>e.width()-36?(o.remove(),this.$(".select2-selection__counter").remove(),t+=36,s+=1,e.find(".select2-search").before(`<li class="select2-selection__counter">+ ${s}</li>`),i.push(o.getAttribute("title"))):t+=o.offsetWidth+6})),e.find(".select2-selection__counter__list").remove(),i.length){const t=o('<ul class="select2-selection__counter__list"></ul>');i.forEach((e=>t.append(`<li class="select2-selection__counter__choice" title="${e}">${e}</li>`))),t.insertAfter(e.find(".select2-selection__counter"))}}})},21808:function(e,t,s){e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/sendowl"),render:function(){return this.$el.html(this.template()),this},changeSendOwlView:function(e,t){this.changeView(t.getAttribute("data-route"))}})},40189:function(e,t,s){const i=s(51135),n=s(96308);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/checkout"),afterInitialize:function(){this.model=new Backbone.Model({state:"register"})},afterRender:function(){this.$(".tva-page-container").html(TVE_Dash.tpl("settings/sendowl/checkout-content")),new n({el:this.$(".tva-so-checkout-tabs"),model:this.model,states_views_path:"./sendowl/tabs/checkout-states/"}).render(),this.$(`[data-tab=${this.model.get("state")}]`).addClass("tva-active-tab")},click:function(e,t){e.stopPropagation(),this.model.set("state",t.dataset.tab),this.$(".tva-active-tab").removeClass("tva-active-tab"),this.$(`[data-tab=${t.dataset.tab}]`).addClass("tva-active-tab")}})},66530:function(e,t,s){const i=s(51135);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/create-product")})},91657:function(e,t,s){const i=s(51135),n=s(52697);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/integration"),afterInitialize:function(){this.model=new n(TVA.settings.account_keys.value)},input:function(e,t){const s={};s[t.getAttribute("data-field")]=t.value,this.model.set(s)},save:function(e,t){this.model.isValid()?(TVE_Dash.showLoader(),t.setAttribute("disabled","true"),this.model.save(null,{success:(e,t)=>{TVA.settings.account_keys.value=e.toJSON(),TVE_Dash.success(t.message)},error:(e,t)=>{TVE_Dash.err(t.responseJSON.message)},complete:()=>{TVE_Dash.hideLoader(),t.removeAttribute("disabled")}})):TVE_Dash.err(this.model.getValidationError())}})},51705:function(e,t,s){const i=s(51135),n=s(96014),o=s(63891);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/links"),className:"tva-purchase",optionSelectedClass:"tva-selected",activeOption:null,activeDiscount:null,linksInputView:null,linksQueryString:{pp:"Sendowl"},afterRender:function(){this.$options=this.$(".tva-so-options"),this.$optionContent=this.$(".tva-option-content"),this.$discountContent=this.$(".tva-discount-content"),this.$linksContent=this.$(".tva-links-content"),requestAnimationFrame(TVA.Utils.rebindWistiaFancyBoxes)},selectOption:function(e,t){this.$options.removeClass(this.optionSelectedClass);const s=t.getAttribute("data-option"),i=t.getAttribute("data-query-string"),n=t.getAttribute("data-option-button-label"),o=t.getAttribute("data-option-discount-label");this.linksQueryString={pp:"Sendowl"},this._removeLinksInputView(),this._renderOption(s,n,i),this._renderDiscount(o),this.activeDiscount.toggle(this.activeOption.hasData()),t.classList.add(this.optionSelectedClass)},_renderOption:function(e,t,s){this.activeOption instanceof n&&(delete this.linksQueryString[this.activeOption.queryStringName],this.activeOption.remove()),this.activeOption=new n({option:e,button_label:t,queryStringName:s}),this.activeOption.selectChange=(e,t)=>{this.activeDiscount.toggleDisabled(!1),this.linksQueryString[this.activeOption.queryStringName]=t.value,this._renderLinks()},this.activeOption.refreshDataCallback=()=>{const e=this.activeOption.hasData();this.activeDiscount.toggle(e)},this.$optionContent.append(this.activeOption.render().$el)},_renderDiscount:function(e){this.activeDiscount instanceof n&&(delete this.linksQueryString[this.activeOption.queryStringName],this.activeDiscount.remove()),this.activeDiscount=new n({option:"discounts",button_label:e,queryStringName:"thrv_so_discount"}),this.activeDiscount.selectChange=(e,t)=>{this.linksQueryString[this.activeDiscount.queryStringName]=t.value,this._renderLinks()},this.$discountContent.append(this.activeDiscount.render().$el),this.activeDiscount.toggleDisabled(!0)},_renderLinks:function(){this._removeLinksInputView(),this.linksInputView=new o({queryParams:this.linksQueryString}),this.$linksContent.html(this.linksInputView.render().$el)},_removeLinksInputView:function(){this.linksInputView instanceof o&&this.linksInputView.remove()}})},63891:function(e,t,s){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/links-input"),className:"tva-card tva-purchase-links",baseUrl:TVA.checkout_endpoint,params:[],queryParams:[],htmlParams:[],afterInitialize:function(e){this.params=e.queryParams,this.queryParams=[],this.htmlParams=[],_.each(this.params,((e,t)=>{this.queryParams.push(`${t}=${e}`),this.htmlParams.push(`${t}='${e}'`)})),this.model=new Backbone.Model({url:this.getUrl(),shortcode:this.getShortcode(),html:this.getHTML()})},afterRender:function(){0==!!TVA.settings.checkout_page.value&&this.$("#tva-html-url-input, #tva-links-url-input, #tva-links-shortcode-input").parent().addClass("tva-disable-copy")},getUrl:function(){return`${this.baseUrl}?${this.queryParams.join("&")}`},getShortcode:function(){return`[tva_sendowl_buy ${this.htmlParams.join(" ")} title='Buy Now']`},getHTML:function(){return`<a href="${this.getUrl()}">Buy Now</a>`}})},96014:function(e,t,s){!function(t){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/links-option"),items:[],className:"tva-card tva-purchase-card",buttonLabel:"Button",disabledClass:"tva-so-option-disabled",queryStringName:"",afterInitialize:function(e){this.option=e.option,this.queryStringName=e.queryStringName,this.hasData()&&(this.items=TVA.sendowl[this.option]),this.buttonLabel=e.button_label||this.buttonLabel},hasData:function(){return TVA.sendowl[this.option]&&Array.isArray(TVA.sendowl[this.option])&&TVA.sendowl[this.option].length>0},afterRender:function(){this.$select=this.$("select").empty().append('<option value="">Select an option</option>'),this.$button=this.$("button"),this.hasData()?this.items.forEach((e=>{const s=t("<option/>").val("discounts"===this.option?e.code:e.id).text(e.name);this.$select.append(s)})):(this.$select.hide(),this.$select.after(TVE_Dash.tpl(`settings/sendowl/no-${this.option}`)())),this.$button.html(this.buttonLabel)},toggleDisabled:function(e){this.$el.toggleClass(this.disabledClass,e)},toggle:function(e){this.$el.toggle(e)},refreshData:function(e,s){TVE_Dash.showLoader(),s.setAttribute("disabled","disabled"),t.ajax({url:`${TVA.routes.sendowl}/refresh_data`,type:"POST",data:{option:this.option},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)}}).success((e=>{e.items&&Array.isArray(e.items)&&(this.items=TVA.sendowl[this.option]=e.items,this.render(),this.refreshDataCallback())})).error((e=>{TVE_Dash.err(e.responseJSON.message)})).complete((()=>{TVE_Dash.hideLoader(),s.removeAttribute("disabled")}))},refreshDataCallback:t.noop,selectChange:t.noop})}(jQuery)},21232:function(e,t,s){const i=s(51135);e.exports=i.extend({afterInitialize:function(){this.model=new Backbone.Model,this.listenTo(this.model,"tva.so-guide-change",(()=>{this.setSteps(),this.render()})),this.setSteps()},setSteps:function(){const e=TVA.sendowl,t=_.isNumber(TVA.settings.checkout_page.value)&&parseInt(TVA.settings.checkout_page.value)>0,s=_.isNumber(TVA.settings.thankyou_page.value)&&parseInt(TVA.settings.thankyou_page.value)>0,i=_.isNumber(TVA.settings.thankyou_page_type.value)&&parseInt(TVA.settings.thankyou_page_type.value)>0,n=TVA.settings.account_keys.value&&TVA.settings.account_keys.value.secret,o="redirect"===TVA.settings.thankyou_page_type.value,r={step1Completed:Array.isArray(e.bundles)&&e.bundles.length>0||Array.isArray(e.products)&&e.products.length>0,step2Completed:t&&(s||o||i),step3Completed:t,step4Completed:n,step5Completed:TVA.courses.length>0,step6Completed:TVA.courses.getSendOwlItems().length>0,step7Completed:n};this.model.set(r)},template:TVE_Dash.tpl("settings/sendowl/quick-start")})},23035:function(e,t,s){const i=s(51135),n=s(96308),o=s(58052);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/register-page"),afterInitialize:function(){this.model=new o(TVA.settings.checkout_page)},afterRender:function(){new n({el:this.$(".tva-so-checkout-reg"),model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your registration page"},normal:{title:"Registration Page"},delete:{title:"Are you sure you want to remove this registration page?"}},afterRender:function(){if("normal"===this.model.attributes.state&&this.model.attributes.value){for(const e in TVA.settings.checkout_page)TVA.settings.checkout_page[e]="value"===e?parseInt(this.model.attributes[e]):this.model.attributes[e];this.model.trigger("tva.so-guide-change")}}}).render(),requestAnimationFrame(TVA.Utils.rebindWistiaFancyBoxes)}})},90598:function(e,t,s){!function(){const t=s(51135),i=s(7314);e.exports=t.extend({template:TVE_Dash.tpl("settings/sendowl/thankyou-page"),afterInitialize:function(){this.model=new Backbone.Model({type:TVA.settings.thankyou_page_type.value}),this.listenTo(this.model,"change:type",this.render)},afterRender:function(){this.renderCards(),this.renderPageOptions(),TVA.settings.thankyou_page_type.value=this.model.attributes.type,this.model.trigger("tva.so-guide-change")},renderCards:function(){this.cardsView=new i({el:this.$(".tva-cards"),model:this.model}),this.cardsView.render()},renderPageOptions:function(){try{new(s(28027)(`./${this.model.get("type")}.js`))({el:this.$(".tva-thankyou-wrapper"),model:this.model}).render()}catch(e){}}})}(jQuery)},7314:function(e,t,s){!function(){const t=s(51135),i=s(86171);e.exports=t.extend({template:TVE_Dash.tpl("settings/sendowl/th-page-cards"),selectedClass:"tva-selected",afterRender:function(){this.$(`[data-type=${this.model.get("type")}]`).addClass(this.selectedClass)},click:function(e,t){if(e.stopPropagation(),t.classList.contains(this.selectedClass))return;TVE_Dash.showLoader(),this.model.set("type",t.dataset.type);const s=new i({key:"thankyou_page_type",value:t.dataset.type});if(!s.isValid())return void TVE_Dash.err(s.validationError.message);const n=s.save();n&&n.done((()=>{this.$(`.${this.selectedClass}`).removeClass(this.selectedClass),this.$(`[data-type=${this.model.get("type")}]`).addClass(this.selectedClass),TVE_Dash.success(TVA.t.SuccessfulSave,3e3,null,"top")})).always((()=>TVE_Dash.hideLoader()))}})}(jQuery)},7e4:function(e,t,s){const i=s(51135),n=s(86171),o=s(96308),r=s(58052);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/redirect-th-options"),afterInitialize:function(){this.model=new Backbone.Model({message:TVA.settings.welcome_message.value}),this.model.on("tva_tinymce_blur",(()=>{const e=new n({key:"welcome_message",value:this.model.get("message")});if(!e.isValid())return void TVE_Dash.err(e.validationError.message);TVA.settings.welcome_message.value=this.model.get("message");const t=e.save();t&&t.done((()=>TVE_Dash.success(TVA.t.settings_tab.checkout_screen.message_updated)))}))},afterRender:function(){TVA.Utils.renderMCE("tva-thankyou-message",this.model,"message"),new o({el:this.$(".tva-thankyou-page-multiple"),model:new r(TVA.settings.thankyou_multiple_page),states_views_path:"./page-states/",labels:{search:{title:"Set your thank you page"},normal:{title:"Thank you Page"},delete:{title:"Are you sure you want to remove this thank you page?"}},settings:{normal:{edit_with_tar:1===parseInt(TVA.tar_active)}},afterRender:function(){this.$(".tva-page-label").append(`<br><span class="tva-notice-span tvd-tooltipped" data-position="top" data-tooltip="If one of your customers purchases access to more than one course then we will show this thank you page rather than redirecting to the start of one of the courses.">${TVA.t.settings_tab.checkout_screen.th_info}</span>`).prepend(`<h3>${TVA.t.settings_tab.checkout_screen.several_courses}</h3>`).show()}}).render(),requestAnimationFrame(TVA.Utils.rebindWistiaFancyBoxes)}})},67482:function(e,t,s){!function(){const t=s(51135),i=s(96308),n=s(58052);e.exports=t.extend({afterInitialize:function(){this.model=new n(TVA.settings.thankyou_page)},afterRender:function(){new i({el:this.$el,model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your thank you page"},normal:{title:"Thank you Page"},delete:{title:"Are you sure you want to remove this thank you page?"}},settings:{normal:{edit_with_tar:1===parseInt(TVA.tar_active)}}}).render()}})}(jQuery())},74322:function(e,t,s){const i=s(51135);e.exports=i.extend({})},4091:function(e,t,s){!function(){const t=s(51135),i=s(58052),n=s(96308);e.exports=t.extend({initialize:function(){t.prototype.initialize.apply(this,arguments),this.model=new i(TVA.settings.thankyou_page)},afterRender:function(){new n({el:this.$el,model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your register page"},normal:{title:TVA.t.setTyPage},delete:{title:"Are you sure you want to remove this register page?"}}}).render()}})}(jQuery)},35673:function(e,t,s){!function(){const t=s(86171),i=s(96308),n=s(46913),o=s(58052),r=s(84643);e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/general"),initialize:function(){const e=Object.values(TVA.settings).filter((e=>"general"===e.category));this.model=new Backbone.Model(e.reduce(((e,t)=>Object.assign(e,{[t.name]:t})),{})),this.registerPageModel=new o(TVA.settings.register_page),this.listenTo(TVA.indexPageModel,"sync",(e=>{Array.isArray(TVA.design.demo_courses)&&TVA.design.demo_courses.forEach((t=>{t.preview_url=e.get("preview_url")+t.slug})),TVA.courses.fetch(),TVA.courses.where({fetched:!0}).forEach((e=>{e.set("fetched",!1)}))}))},render:function(){return this.$el.html(this.template({model:this.model,visualEditingEnabled:TVA.visualEditingEnabled})),this.afterRender(),this},afterRender:function(){this.$("[data-toggle-setting]").each(((e,t)=>{this.toggleElementsDependencies(t)})),new i({el:this.$(".tva-course-states-container"),model:TVA.indexPageModel,states_views_path:"./page-states/",labels:{search:{title:"Set your courses page"},normal:{title:"Courses Page"},delete:{title:"Are you sure you want to remove this course page?"}},settings:{search:{ajaxData:{no_landing_pages:1}}},afterRender:function(){this.$(".tva-edit-page-with-tar").remove()}}).render(),new i({el:this.$("#tva-clear-cache-states-container"),templates:{normal:TVE_Dash.tpl("states/simple"),delete:TVE_Dash.tpl("states/delete")},callbacks:{confirm:this.clearCertificatesCache},labels:{normal:{title:TVA.t.clear_certificate_cache}},model:new r({state:"normal",id:123}),states_views_path:"./page-states/"}).render(),TVA.settings.certificate_verification.value&&this.renderValidationPage(new o(TVA.settings.certificate_validation_page))},changeSettingCheckbox:function(e,t){const s=t.checked?t.getAttribute("data-val-checked")||1:t.getAttribute("data-val-not-checked")||0;this._save(t.getAttribute("data-field"),s).then((e=>{"certificate_validation_page"===e.name&&this.renderValidationPage(new o(e))})).always((()=>{TVE_Dash.hideLoader()})),this.toggleElementsDependencies(t)},changeRoute:function(e,t){const s=t.value,i=s.replace(/\/|\\/g,""),n=this.$(t).closest(".tva-route-item"),o=t.dataset.field;n.find(".tva-route-notice").remove(),t.classList.remove("tva-error"),TVA.current_routes[o]!==i&&(TVE_Dash.showLoader(),wp.apiRequest({url:TVA.routes.slug_routes,type:"POST",data:{route:s,identifier:o}}).done((()=>{TVA.current_routes[o]=i,TVE_Dash.success(TVA.t.route_changed)})).fail((()=>{n.append(TVE_Dash.tpl("route-unavailable")),t.classList.add("tva-error")})).always((()=>{TVE_Dash.hideLoader()})))},renderValidationPage:function(e){new n({template:TVE_Dash.tpl("states/validation-page"),el:this.$("#tva-validation-page-wrapper"),model:e}).render()},toggleElementsDependencies:function(e){const t=e.getAttribute("data-toggle-setting"),s=!!e.getAttribute("data-toggle-value");t&&this.$(t).toggle(s===e.checked)},input:function(e,t){let s=t.value;"number"===t.type&&(s=Number(s)),this._save(t.getAttribute("data-field"),s).always((()=>{TVE_Dash.hideLoader()}))},clearCertificatesCache:function(e){e.url=`${TVA.routes.certificate}/clear-cache`,TVE_Dash.showLoader();const t=e.destroy();t&&t.always((()=>{e.set("state","normal"),TVE_Dash.hideLoader()}))},_save:function(e,s){if(TVE_Dash.showLoader(),TVA.visualEditingEnabled&&"load_scripts"===e)return;this.model.get(e).value=s,TVA.settings[e].value=s;const i=new t({key:e,value:s});if(i.isValid())return i.save();TVE_Dash.err(i.validationError.message)}})}(jQuery)},48410:function(e,t,s){!function(t){const i=s(58846);e.exports=s(2921).extend({template:TVE_Dash.tpl("utils/slider-input"),className:"tva-grid tva-grid-columns-4-1 tva-grid-column-gap-15 tva-align-center",afterInitialize:function(e){t.extend(!0,this,e),this.model&&this.model instanceof Backbone.Model||(this.model=new i(this.model||{}))},sliderInput:function(e,t){this.$("input").val(t.value),this.change(t.value)},change:t.noop})}(jQuery)},7578:function(e,t,s){const i=s(49939);e.exports=s(51135).extend({template:TVE_Dash.tpl("settings/stripe"),afterInitialize:function(){TVA.Utils.displayStripeError()},changeSetting:function(e,t){wp.apiRequest({url:`${TVA.routes.stripe}/settings`,method:"POST",data:{setting:t.dataset.setting,value:t.checked?1:0}}).then((()=>{TVA.stripe[t.dataset.setting]=t.checked?1:0}))},modeSwitch:function(e,t){TVE_Dash.showLoader(),wp.apiRequest({url:`${TVA.routes.stripe}/switch`,method:"POST",data:{from:t.dataset.from,to:t.dataset.to}}).always((()=>{TVE_Dash.hideLoader()}))},confirmDisconnect:function(){this.openModal(i,{template:TVE_Dash.tpl("stripe/disconnect"),className:"tvd-modal tva-disconnect-stripe",width:"400px",confirm:function(){wp.apiRequest({url:`${TVA.routes.stripe}/disconnect`}).then((()=>{location.reload(),this.close()}))}})},createAccount:function(){TVA.Utils.stripeConnect()}})},50201:function(e,t,s){const i=s(66795);e.exports=i.extend({template:TVE_Dash.tpl("stripe/create-product-helper")})},2629:function(e,t,s){const i=s(51135),n=s(68300);e.exports=i.extend({className:"tva-customer-edit",template:TVE_Dash.tpl("customers/base-student"),editCustomer:function(){const e=e=>{this.openModal(n,{model:e,width:"1180px",top:"40px",className:"tvd-modal tvd-modal-big tva-modal-edit-customer"})};TVE_Dash.showLoader(),this.model.getPurchasedItems().then((()=>{this.model.getAccessCourses(),TVA.products.getAll(),TVE_Dash.hideLoader(),e(this.model)}))},loginAsCustomer:function(e){const t=this.id,s=e.currentTarget.dataset.nonce;TVA.Utils.confirmation({title:TVA.t.login_as_user_title,description:TVA.t.login_as_user_description,yes:TVA.t.login_as_user_confirm,yesClass:"tva-modal-btn-green",no:TVA.t.login_as_user_cancel,noClass:"tva-modal-btn-gray"}).then((()=>{wp.apiRequest({url:`${TVA.routes.customer}/${t}/login_as_customer`,method:"POST",data:{nonce:s}}).success((e=>{window.location.replace(e.courses_url)})).error((()=>TVE_Dash.err("Unauthorized user.")))}))}})},1382:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=s(57426),a=s(23150),l=s(94254),c=s(91791),d=s(2629),h=s(11257),u=s(49939);e.exports=d.extend({className:"tva-customer-edit",courseStructureTemplate:TVE_Dash.tpl("customers/course-structure"),selected:[],events:n(n({},d.prototype.events),{},{"change #tva-check-all":"toggleSelectAll","change .tva-section-select":"onItemSelect"}),ensureData:async function(){let e;if(TVA.customers instanceof Backbone.Collection&&0!==TVA.customers.length&&(e=TVA.customers.findWhere({ID:this.studentID}),e instanceof Backbone.Model&&e.get("courses")instanceof Backbone.Collection&&(this.model=e,this.setUpCourseData(),this.setUpListeners())),!(this.model instanceof Backbone.Model))return new Promise((t=>{wp.apiRequest({url:TVA.routes.customer+`/${this.studentID}/course_data/${this.courseID}`}).done((t=>{this.model=new l(t),e instanceof Backbone.Model?e=this.model.clone():(e=this.model,TVA.customers.add(e)),this.setUpCourseData(),this.setUpListeners()})).always(t)}))},setUpListeners:function(){this.model.on("change",this.render.bind(this)),this.courseModel.on("item_bypass_set",(e=>{this.model.deepSet(`items_bypassed.${this.courseID}`,e.items_bypassed),this.itemsBypassed=e.items_bypassed,e.locked_items&&(this.model.deepSet(`locked_status.${this.courseID}`,e.locked_items),this.locked=e.locked_items),this.render()}))},setUpCourseData:function(){this.courseModel=this.model.get("courses").findWhere({id:this.courseID}),this.courseProgress=this.model.getCourseProgress(this.courseID),this.itemsBypassed=this.model.getCourseData("items_bypassed",this.courseID),this.locked=this.model.getCourseData("locked_status",this.courseID)||{}},initialize:function(e={}){this.studentID=parseInt(e.id)||null,this.courseID=parseInt(e.subID)||null,this.currentModuleIndex=0,TVE_Dash.showLoader()},afterRender:function(){const e=this.$(".tva-cc-container"),t=this.courseModel.hasFreeLesson();this.$(".tva-back-courses").show(),this.$(".tva-back-students").hide(),"function"==typeof this.courseStructureTemplate&&(e.html(this.courseStructureTemplate(this.getRenderParams())),this.$structureContainer=this.$(".tva-cc-container-inner"),this.$structureContainer.empty(),this.currentModuleIndex=0,_.each(this.courseModel.getModulesAndLessons(!0),(e=>{"module"===e.getType()?this.$structureContainer.append(this.renderModule(e)):"lesson"===e.getType()&&this.$structureContainer.append(this.renderLesson(e))}))),this.$massActions=this.$(".tva-mass-action").hide(),this.locked.course_locked&&!t&&this.$(".tva-cc-container").addClass("tva-mass-actions-hidden"),this.locked.course_locked&&t&&this.$(".tva-cc-container").addClass("tva-mass-actions-free"),TVE_Dash.hideLoader()},toggleSelectAll:function(e){this.$("input.tva-section-select").prop("checked",e.currentTarget.checked),this.onSelectionChange()},onItemSelect:function(e){const t=e.currentTarget,s=this.$(t.closest(".tva-customer-card"));s.find("input.tva-section-select").not(t).prop("checked",t.checked),t.checked||s.parents(".tva-customer-card").find(".tva-c-course-grid-top input.tva-section-select").prop("checked",!1),this.onSelectionChange()},onSelectionChange:function(){this.selected=[],this.$("input.tva-section-select:checked").each(((e,t)=>this.selected.push(t.dataset.itemId))),this.$("#tva-check-all").prop("checked",this.selected.length&&this.selected.length===this.$("input.tva-section-select").length),this.selected.length?this.$massActions.fadeIn(100):this.$massActions.fadeOut(100)},massAction:function(e){if(!this.selected||!this.selected.length)return;const t=e.currentTarget.dataset.action,s=()=>wp.apiRequest({type:"POST",url:`${TVA.routes.customer}/bulk_edit`,data:{course_id:this.courseModel.get("id"),student_id:this.studentID,items_ids:this.selected,action:t}}).success((e=>{this.model.set(e,{silent:!0}),this.setUpCourseData(),this.render(),TVE_Dash.success(TVA.t.bulk_completed)})).error((()=>{TVE_Dash.err(TVA.t.something_went_wrong)}));this.openModal(u,{template:TVE_Dash.tpl(`modals/bulk-${t}`),className:"tvd-modal tva-sl-bulk",width:"550px",confirm:function(){TVE_Dash.showLoader(),requestAnimationFrame((()=>{s().done((()=>{this.close()}))}))}})},renderModule:function(e){return this.currentModuleIndex++,new c({model:this.model,module:e,index:this.currentModuleIndex,contentStatuses:this.model.getCourseData("modules_and_lessons_status",this.courseID),lessonsCompleted:this.model.getCourseData("lessons_completed",this.courseID),itemsBypassed:this.itemsBypassed,locked:this.locked,progress:this.model.getModuleProgress(this.courseID,e.get("ID"))}).render().$el},renderLesson:function(e){return new h({model:this.model,lesson:e,contentStatuses:this.model.getCourseData("modules_and_lessons_status",this.courseID),lessonsCompleted:this.model.getCourseData("lessons_completed",this.courseID),itemsBypassed:this.itemsBypassed,locked:this.locked,courseLocked:this.locked?this.locked.course_locked:""}).render().$el},unlockItem:function(e){const t=parseInt(e.currentTarget.dataset.id),s=new a(this.courseModel.get("structure"),{total:this.courseModel.get("structure").length}).findItem(t);this.openModal(r,{className:"tvd-modal tva-sl-unlock",courseModel:this.courseModel,model:s,studentID:this.studentID,itemsBypassed:this.itemsBypassed,width:"550px"})}})},64618:function(e,t,s){const i=s(49939);var n;n=jQuery,e.exports=s(2921).extend({template:TVE_Dash.tpl("customers/courses-item"),afterInitialize:function(e){e=e||{};const t=this.model.get("id");this.progress=e.studentModel.getCourseProgress(t),this.activity=e.studentModel.getCourseData("activity",t),this.locked=e.studentModel.isCourseLocked(t),this.certificate=e.studentModel.getCourseCertificate(t),this.student=e.studentModel},afterRender:function(){0===this.model.getModulesAndLessons().length&&(this.$el.addClass("tva-tooltip-parent"),n("<span>",{class:"tva-custom-tooltip",text:TVA.t.noPublishedLessons}).appendTo(this.$el)),this.$(".tva-view-certificate").on("click",(function(e){e.stopPropagation()}))},sendToStudent:function(e){e.stopPropagation();const t=this;this.openModal(i,{template:TVE_Dash.tpl("modals/send-certificate"),className:"tvd-modal tva-sl-bulk",width:"550px",confirm:function(){TVE_Dash.showLoader(),n.ajax({url:`${TVA.routes.customer}/send_certificate`,type:"POST",data:{student_id:t.student.id,course_id:t.model.id},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)}}).complete((e=>{200===e.status?TVE_Dash.success("E-mail has been sent"):TVE_Dash.err("An error has occurred"),TVE_Dash.hideLoader(),this.close()}))}})},downloadCertificate:function(e){e.stopPropagation();const t=this,s=t.model.get("certificate"),i=n("body");TVE_Dash.showLoader(),n.ajax({url:`${TVA.routes.certificate}/download`,type:"POST",data:{course_id:t.model.id,user_id:t.student.id,tva_admin_download:!0},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)},xhr:function(){const e=new XMLHttpRequest;return e.onreadystatechange=()=>{2===e.readyState&&(e.responseType=200===e.status?"blob":"text")},e},success:function(e){const t=new Blob([e],{type:"application/octetstream"}),o=window.URL||window.webkitURL,r=n("<a />").attr({href:o.createObjectURL(t),download:`${s.get("title")}.pdf`});i.append(r),r[0].click(),i.remove(r),TVE_Dash.success(TVA.t.pdf_download),TVE_Dash.hideLoader()},error:function(e){const t="object"==typeof e.responseJSON&&e.responseJSON.message?e.responseJSON.message:e.statusText;TVE_Dash.err(t),TVE_Dash.hideLoader()}})}})},96282:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(2629),o=s(64618),r=s(30739),a=s(94254);e.exports=i.extend({className:"tva-customer-edit",coursesTemplate:TVE_Dash.tpl("customers/courses"),noCoursesTemplate:TVE_Dash.tpl("customers/no-courses"),statuses:["publish","hidden","archived"],ensureData:async function(){let e;if(TVA.customers instanceof Backbone.Collection&&0!==TVA.customers.length&&(e=TVA.customers.findWhere({ID:this.studentID}),e instanceof a&&e.get("courses")instanceof Backbone.Collection&&e.get("courses").length&&(this.model=e,this.setUpListeners())),!(this.model instanceof Backbone.Model))return new Promise((t=>{wp.apiRequest({url:TVA.routes.customer+`/${this.studentID}/courses_data`}).done((t=>{e instanceof a?(t.courses=new r(t.courses,{total:t.courses.length}),delete t.courses_count,delete t.enrolled,e.set(t),this.model=e):(e=this.model=new a(t),TVA.customers.add(e)),this.setUpListeners()})).always(t)}))},setUpListeners:function(){this.model.on("access_changed",((e=!0)=>{e&&TVE_Dash.showLoader(!0),this.model.getCoursesData().success((e=>{e.courses=new r(e.courses,{total:e.courses.length}),delete e.courses_count,delete e.enrolled,this.model.set(n(n({},e),{},{courses_count:e.courses.length})),this.afterRender()}))}))},initialize:function(e){(e=e||{}).id&&(this.studentID=parseInt(e.id)||null,TVE_Dash.showLoader())},afterRender:function(){const e=this.model.get("courses");this.$(".tva-back-courses").hide(),this.$(".tva-back-students").show(),e instanceof r&&e.length>0?(e.each((e=>{e.set("enrollment_date",this.model.get("enrollment_dates")[e.get("id")])})),this.$(".tva-cc-container").empty(),this.renderCourses(this.sortByEnrollment(e.where((e=>this.statuses.includes(e.get("status"))))),"publish"),this.renderCourses(this.sortByEnrollment(e.where({status:"draft"})),"draft")):this.$(".tva-cc-container").html(this.noCoursesTemplate()),TVE_Dash.hideLoader()},sortByEnrollment:function(e,t=!1){return e.sort(((e,s)=>{let i=e.attributes.enrollment_date,n=s.attributes.enrollment_date;return i=i?window.moment(i,"DD.MM.YYYY").toDate():"",n=n?window.moment(n,"DD.MM.YYYY").toDate():"",t?i-n:n-i}))},renderCourses:function(e,t,s=!1){e.length&&(s||this.$(".tva-cc-container").append(this.coursesTemplate({status:t})),this.$coursesContainer=this.$(`.tva-cc-inner-${t} .tva-cc-container-inner`).empty(),e.forEach((e=>{const t=new o({model:e,studentModel:this.model});this.$coursesContainer.append(t.render().$el)})))},viewCourse:function(e){const t=parseInt(e.currentTarget.dataset.id);0!==this.model.get("courses").get(t).getModulesAndLessons().length&&this.changeView(`members/${this.studentID}/courses/${t}`)},reorder:function(e){const s=t(e.currentTarget),i="asc"===e.currentTarget.dataset.order?"desc":"asc",n="asc"!==e.currentTarget.dataset.order,o=e.currentTarget.dataset.courses,r=this.model.get("courses").where((e=>"draft"===o?"draft"===e.get("status"):this.statuses.includes(e.get("status")))),a=this.sortByEnrollment(r,n);s.attr("data-order",i),s.toggleClass("tva-rotate-90"),this.renderCourses(a,o,!0)}})}(jQuery)},21598:function(e,t,s){const i=s(2921);e.exports=i.extend({className:"tva-student",template:TVE_Dash.tpl("customers/item"),viewUser:function(e){this.changeView(`members/${e.currentTarget.dataset.id}/courses`)}})},11257:function(e,t,s){const i=s(51135);e.exports=i.extend({className:"tva-student-lesson-item",template:TVE_Dash.tpl("customers/overview/lesson"),initialize:function(e={}){this.lesson=e.lesson,this.contentStatuses=e.contentStatuses,this.completed=!!e.lessonsCompleted&&e.lessonsCompleted[this.lesson.get("id")],this.itemsBypassed=e.itemsBypassed,this.locked=e.locked,this.campaignType=e.campaignType?e.campaignType:null,this.courseLocked=e.courseLocked?e.courseLocked:null,this.moduleLocked=e.moduleLocked?e.moduleLocked:null,this.prepareLockedData(),this.prepareStatusData()},prepareLockedData:function(){const e=this.lesson.get("ID");!this.courseLocked&&this.itemsBypassed&&this.itemsBypassed[e]?this.locked=!1:this.locked&&this.locked.locked_lessons&&this.locked.locked_lessons[e]?this.locked=this.locked.locked_lessons[e]:this.locked=!1},lessonNoAccess:function(){return this.courseLocked||this.locked||this.moduleLocked&&"inherit"===this.lesson.get("freemium")},prepareStatusData:function(){const e=this.lesson.get("ID"),t=this.contentStatuses&&this.contentStatuses[e]?this.contentStatuses[e]:null;t&&(this.lessonComplete=!t.tva_lesson_complete||this.lessonNoAccess()?"":t.tva_lesson_complete,this.lessonStart=!t.tva_lesson_start||this.lessonNoAccess()?"":t.tva_lesson_start)}})},91791:function(e,t,s){const i=s(51135),n=s(11257);e.exports=i.extend({className:"tva-student-module-item",template:TVE_Dash.tpl("customers/overview/module"),initialize:function(e={}){this.currentModuleIndex=parseInt(e.index)||null,this.module=e.module,this.contentStatuses=e.contentStatuses||{},this.lessonsCompleted=e.lessonsCompleted,this.itemsBypassed=e.itemsBypassed,this.progress=e.progress,this.campaignType=e.locked.campaign_type,this.courseLocked=e.locked.course_locked,this.lockedContents=e.locked[this.module.get("id")],this.locked=this.lockedContents&&this.lockedContents.module_locked?this.lockedContents.module_locked:null,this.prepareStatuses()},prepareStatuses:function(){const e=this.module.get("ID"),t=this.contentStatuses&&this.contentStatuses[e]?this.contentStatuses[e]:null;if(this.itemsBypassed&&this.itemsBypassed[e]&&(this.locked=!1),t)this.moduleFinish=t.tva_module_finish&&!this.locked?t.tva_module_finish:"",this.moduleStart=t.tva_module_start&&!this.locked?t.tva_module_start:"";else if(Array.isArray(this.module.get("lessons"))){const e=[],t=[];this.module.get("lessons").forEach((s=>{if(this.contentStatuses[s.get("ID")]){if(this.contentStatuses[s.get("ID")].tva_lesson_start){const t=new Date(this.contentStatuses[s.get("ID")].tva_lesson_start);e.push({label:this.contentStatuses[s.get("ID")].tva_lesson_start,dateObj:t})}if(this.contentStatuses[s.get("ID")].tva_lesson_complete){const e=new Date(this.contentStatuses[s.get("ID")].tva_lesson_complete);t.push({label:this.contentStatuses[s.get("ID")].tva_lesson_complete,dateObj:e})}}})),e.sort(((e,t)=>e.dateObj-t.dateObj)),t.sort(((e,t)=>e.dateObj-t.dateObj)),e.length>0&&(this.moduleStart=e[0].label),t.length>0&&t.length===this.module.get("lessons").length&&(this.moduleFinish=t[t.length-1].label)}},afterRender:function(){const e=this.$(".tva-c-course-elems");_.each(this.module.get("lessons"),(function(t){e.append(this.renderLesson(t))}),this)},renderLesson:function(e){return new n({model:this.model,lesson:e,contentStatuses:this.contentStatuses,lessonsCompleted:this.lessonsCompleted,itemsBypassed:this.itemsBypassed,locked:this.lockedContents,campaignType:this.locked?this.campaignType:"",courseLocked:this.locked?this.courseLocked:"",moduleLocked:this.locked}).render().$el}})},80201:function(e,t,s){var i;i=jQuery,e.exports=s(2921).extend({$tabs:null,className:"tva-tabs",selectedIndex:0,contentViews:[],selectedTabCssClass:"tva-tab-selected",tabUlClass:"tva-tabs-ul",selectedContentCssClass:"tva-tab-content-selected",events:{"click ul.tva-tabs-ul>li":function(e){const t=i(e.currentTarget).data();void 0!==this.course.id&&(window.location.href=`#courses/${this.course.id}/${t.slug}`);const s=parseInt(t.index);this.selectTab(s)}},initialize:function(e){i.extend(!0,this,e),this.contentViews=[]},updateNames:function(){const e=this.$tabs.find(".tva-tab-title");this.collection.each(((t,s)=>{e[s]&&(e[s].textContent=t.get("name"))}))},render:function(){return this.$tabs=i("<ul/>"),this.$tabs.addClass(this.tabUlClass),this.$el.append(this.$tabs),this.collection.each(((e,t)=>{const s=i("<li>").html(this.getTabTitleHTML(e)).data({index:t,slug:e.get("slug")});this.$tabs.append(s);const n=e.get("view");n.tabModel=e,n.on("refresh-tab-title",(()=>{s.html(this.getTabTitleHTML(e))})),this.contentViews.push(n),this.$tabs.after(n.render().$el.hide())})),this.selectTab(this.selectedIndex),this.addChild(this.contentViews),this},getTabTitleHTML:function(e){let t=`<span class="tva-tab-icon">${TVA.Utils.icon(e.get("icon"))}</span><span class="tva-tab-title">${e.get("name")}</span>`;return e.get("counter")&&(t+=`&nbsp;<span class="tva-tab-counter">${e.get("counter")}</span>`),t},selectTab:function(e){if(0===e||this.course.get("id")||(e=0,TVE_Dash.warning(TVA.t.saveCourseBefore)),e=parseInt(e),isNaN(e)&&(e=0),e>this.contentViews.length)throw new Error("there are not so many tabs to select index: "+e);this.selectedIndex=e,this.$tabs.find("li").removeClass(this.selectedTabCssClass),this.$tabs.find("li").eq(this.selectedIndex).addClass(this.selectedTabCssClass),this.contentViews.forEach(((e,t)=>{const s=t===this.selectedIndex?"show":"hide";e.$el[s]();const i=t===this.selectedIndex?"addClass":"removeClass";e.$el[i](this.selectedContentCssClass),t===this.selectedIndex&&("function"==typeof e.onActivate&&e.onActivate(),e.bindZclip())})),this.trigger("tab.selected.index",this.selectedIndex)},getSelected:function(){return this.$tabs.find(`li.${this.selectedTabCssClass}`)},changeIcon:function(e,t){e.find(".tva-tab-icon").html(t)}})},34470:function(e,t,s){!function(){const t=s(51135),i=s(8426),n=s(77494);e.exports=t.extend({id:"tva-topics",className:"tva-topics",template:TVE_Dash.tpl("topics/dashboard"),collection:TVA.topics,afterInitialize:function(){this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"remove",this.render)},itemsContainer:function(){return this.$(".tva-topics-list")},render:function(){t.prototype.render.apply(this,arguments);const e=this.itemsContainer();return this.collection.each((t=>e.append(this.newItemView(t).render().$el))),this},newModel:function(){return new i},newItemView:function(e){return new n({model:e,parent:this})},add:function(){const e=this.newModel();TVE_Dash.showLoader(),e.save().then((()=>{this.collection.add(e),e.set("editing",!0),requestAnimationFrame((()=>TVE_Dash.hideLoader()))}))}})}(jQuery)},77494:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){const i=s(51135),o=s(896),r=i.extend({className:"tva-topic-item tva-flex tva-align-center mb-20",template:TVE_Dash.tpl("topics/item"),deletedMessage:TVA.t.topic_deleted,parent:null,defaultTitle:null,events:n(n({},i.prototype.events),{},{"change .tva-title-events":"onTitleChange","blur .tva-title-events":"onTitleBlur","keyup .tva-title-events":"onTitleKeyup"}),afterInitialize:function(e){this.parent=e.parent,this.model.on("change",this.render.bind(this))},spectrum:function(e){const{model:s,parent:i}=this,o=t(e.currentTarget.parentNode).find(`input[data-field="${e.currentTarget.dataset.field}"]`).spectrum(n({containerClassName:"tva-color-picker",showPalette:!1,allowEmpty:!1,showInitial:!1,showButtons:!0,chooseText:"Apply",cancelText:"Cancel",showInput:!0,preferredFormat:"hex",hide:function(e){e=e.toString(),i.$el.removeClass("tva-disabled"),e!==s.get(this.dataset.field)&&s.persist({[this.dataset.field]:e.toString()})},show:function(){i.$el.addClass("tva-disabled")}},this.spectrumOptions()));return requestAnimationFrame((()=>o.spectrum("show"))),!1},spectrumOptions:function(){return{}},render:function(){return i.prototype.render.apply(this,arguments),this.$(".tva-title-events").select().focus(),this.toggleLoader(),this},editing:function(){this.model.set("editing",!0)},onTitleChange:function(e){0===this.model.get("ID")&&(this.defaultTitle=TVA.t.label_default_text);const t=e.currentTarget,s=t.value.trim()||this.defaultTitle;if(!s)return t.classList.add("tva-error"),t.focus(),!1;this.preventBlur=!0,s!==this.model.get("title")?this.model.persist({title:s},n({loader:!0,showSuccess:!0},this.saveOptions()||{})):this.model.set("editing",!1)},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0,this.model.set("editing",!1))},onTitleBlur:function(){this.preventBlur?delete this.preventBlur:this.model.set("editing",!1)},openIconPicker:function(){return this.openModal(o,{topic_title:this.model.get("title"),model:this.model,"max-width":"865px","max-height":"80vh",width:"auto",in_duration:200,out_duration:300,className:"tva-default-modal-style tvd-modal"}),!1},openImagePicker:function(){return r.initMedia().then((e=>{this.model.persist({icon:e.url,icon_type:"icon"})})),!1},getConfirmationModal:function(){return s(4136)},openDeleteConfirmation:function(){return this.openModal(this.getConfirmationModal()).then((()=>{this.model.set("loading",!0);const e=this.model.clone();this.beforeDelete(e),e.destroy().done((()=>TVE_Dash.success(this.deletedMessage))).always((()=>this.model.collection.remove(this.model)))})),!1},beforeDelete:function(e){TVA.courses.where({topic:e.get("ID")}).forEach((e=>{e.set("topic",0,{silent:!0}),e.saveState()}))},toggleLoader:function(){this.$el.tvaToggleLoader(30,!!this.model.get("loading"),{background:"#eaefef"})},saveOptions:function(){}},{initMedia:function(){const e=r.mediaFrame||(r.mediaFrame=wp.media({title:"Select or upload an image",button:{text:"Use this image"},library:{type:"image"},multiple:!1}));return e.open(),new Promise((t=>{e.off("select").on("select",(()=>t(e.state().get("selection").first().toJSON())))}))}});e.exports=r}(jQuery)},8767:function(e,t,s){const i=s(40377),n=s(27863);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/access-restrictions"),itemsContainer:function(){return this.$(".tva-labels-grid")},toggleLabelsSection:function(e){return this.$(".tva-user-contexts").toggleClass("tva-expanded"),this.settings.set("switch_labels",e.currentTarget.checked),this.settings.save(),!1},afterRender:function(){this._renderContextItems(this.$(".tva-user-contexts"),TVA.dynamicLabelSetup.userLabelContexts,TVA.dynamicLabelSetup.userLabelDefaults,n,(e=>this.settings.getUserContextLabel(e)))}})},33461:function(e,t,s){const i=s(40377),n=s(25343);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/call-to-action-buttons"),afterRender:function(){this._renderContextItems(this.$("#tva-cta-buttons"),TVA.dynamicLabelSetup.ctaLabelContexts,TVA.dynamicLabelSetup.ctaLabelDefaults,n,(e=>this.settings.getCTAButtonLabel(e)))}})},47492:function(e,t,s){const i=s(40377),n=s(38563);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-content-types"),afterRender:function(){this._renderContextItems(this.$("#tva-course-type-labels"),TVA.dynamicLabelSetup.courseTypeLabelContexts,TVA.dynamicLabelSetup.courseTypeLabelDefaults,n,(e=>this.settings.getCourseTypeLabel(e)))}})},63090:function(e,t,s){const i=s(40377),n=s(25343),o=s(30873);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-navigation"),afterRender:function(){this._renderContextItems(this.$("#tva-course-navigation"),TVA.dynamicLabelSetup.courseNavigationContexts,TVA.dynamicLabelSetup.courseNavigationDefaults,n,(e=>this.settings.getCourseNavigationLabel(e))),this._renderContextItems(this.$("#tva-course-navigation-warnings"),TVA.dynamicLabelSetup.courseNavigationWarnings,TVA.dynamicLabelSetup.courseNavWarningsDefaults,o,(e=>this.settings.getCourseNavigationLabel(e)))}})},29848:function(e,t,s){const i=s(40377),n=s(95220);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-progress"),afterRender:function(){this._renderContextItems(this.$("#tva-course-progress"),TVA.dynamicLabelSetup.courseProgressContexts,TVA.dynamicLabelSetup.courseProgressDefaults,n,(e=>this.settings.getCourseProgressLabel(e)))}})},37764:function(e,t,s){const i=s(40377),n=s(27643);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-structure"),afterRender:function(){this._renderContextItems(this.$("#tva-course-structure"),TVA.dynamicLabelSetup.courseStructureContexts,TVA.dynamicLabelSetup.courseStructureDefaults,n,(e=>this.settings.getCourseStructureLabel(e)))}})},40377:function(e,t,s){const i=s(34470),n=s(93275),o=s(12386);e.exports=i.extend({collection:TVA.labels,afterInitialize:function(){i.prototype.afterInitialize.apply(this,arguments),this.settings=s(70108)},newModel:function(){return new n},newItemView:function(e){const t=new o({model:e,parent:this});return e.get("ID")<0&&t.$el.hide(),t},_renderContextItems:function(e,t,s,i,n){_.each(t,((t,o)=>{const r=new i({settings:this.settings,parent:this,defaultTitle:s[o],contextTitle:t,type:o,class:o.replace(/_/g,"-"),model:n(o)});this.addChild(r),e.append(r.render().$el)}))}})},25387:function(e,t,s){!function(){const t=s(51135),i=s(86171),n=s(58792);e.exports=t.extend({initialize:function(){TVE_Dash.hideLoader(),TVA.licenseActivated&&(this.openModal(n,{show_first_step:!0,model:new i({key:"wizard",value:""}),no_close:!0,className:"tvd-modal tva-modal-welcome",dismissible:!1,modal_title:TVA.t.choose_school_design,skin_download_params:{activate:1,fresh_install:1},download_callback:function(e,t){TVA.skins.unshift(e),TVA.Router.menuItems.updateItem({route:"#design-welcome"},{route:"#design"}),TVA.Router.navigate(`#design/${e.term_id}/wizard`,{trigger:!0}),t.always=!1,TVE_Dash.showLoader(!0),window.location.reload()}}),TVA.settings.show_hi_professor_modal=!0)}})}(jQuery)},4023:function(e,t,s){!function(t){const i=s(2921);e.exports=i.extend({template:TVE_Dash.tpl("image-upload"),prop:"url",events:{"click .removeImage":function(){this.model.set(this.prop,"")},"click .uploadImage":function(){TVA.Utils.wpMedia({},this.model,this.prop)}},initialize:function(e){t.extend(!0,this,e),this.listenTo(this.model,`change:${this.prop}`,(e=>{this.setImage(e.get(this.prop))}))},render:function(){return this.$el.html(this.template()),this.setImage(this.model.get(this.prop)),this},setImage:function(e){this.$("p").toggle(!e),this.$el.css("background-image",`url('${e||""}')`).toggleClass("w-img",!!e)}})}(jQuery)},81425:function(e,t,s){const i=s(2921);e.exports=i.extend({template:"dropdown",afterInitialize:function(e){this.items=e.items||[],"function"==typeof e.onSelect&&(this.onSelect=e.onSelect),this.render(),this.$selectedValue=this.$(".ttd-selected-value"),this.$items=this.$(".ttd-dropdown-items"),this.setDefaultValue()},getItems:function(){return this.items},setItems:function(e){return this.items=e,this},onSelect:function(e,t){this.$el.removeClass("open"),this.setValue(t.dataset.id),this.trigger("select",t.dataset.id)},toggle:function(){this.$el.toggleClass("open")},open:function(){this.$el.addClass("open")},close:function(){this.$el.removeClass("open")},setValue:function(e=0){this.selectedValue=e,this.$items.find(".selected").removeClass("selected"),this.$items.find(`[data-id="${e}"]`).addClass("selected"),this.$selectedValue.html(this.getSelectedText())},getValue:function(){return this.selectedValue},getSelectedText:function(){const e=this.getItems().find((e=>e.id===this.getValue()));return e?e.text:""},setDefaultValue:function(){let e=this.items.find((e=>e.default));e||(e=this.items[0]),this.setValue(e.id)}})},32643:function(e){e.exports=async()=>(void 0!==TVA.quizzes||(TVA.quizzes=await new Promise(((e,t)=>{wp.apiRequest({url:TVA.Utils.buildUrl(TVA.routes.admin,{},"get_quizzes")}).done((t=>{e(t)})).fail((e=>t(e)))}))),TVA.quizzes)},68003:function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r="quiz_complete",a="based_on_result",l=s(48410),c=s(68338);e.exports=s(2921).extend({template:TVE_Dash.tpl("quiz-result-trigger-settings"),$condSelect:null,$condWhenSelect:null,shouldDisplayInfoText:!1,quiz:{},labels:{condWhenSelect:{number:"User achieves minimum score",percentage:"User achieves minimum percentage",right_wrong:"Minimum number of correct answers",personality:"Result is selected categories"},slider:{number:"Score",percentage:"Percentage",right_wrong:"Correct answers",personality:""}},afterInitialize:function(){this.listenTo(this.model,"change:quiz_id",(()=>{this.model.set({when:r},{silent:!0}),this.model.unset("when_cond",{silent:!0}),this.redraw(this.model.get("quiz_id"))}))},redraw:function(e){this.setQuiz(e),this.buildCondWhenSelect(),this.generateWhenControls(this.model.get("when")===a)},afterRender:function(){this.$condSelect=this.$("#tva-tqb-cond"),this.$condWhenSelect=this.$("#tva-tqb-cond-when"),this.$extraControlsWrapper=this.$(".tva-tqb-extra-controls"),this.$infoText=this.$(".info-text.orange").hide(),Object.values(TVA.quizzes).forEach((e=>{this.$condSelect.append(new Option(e.post_title,e.ID,!1,!1))})),this.model.get("quiz_id")||this.model.set({quiz_id:Object.values(TVA.quizzes)[0].ID,when:r},{silent:!0}),this.redraw(this.model.get("quiz_id")),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select"))},buildCondWhenSelect:function(){0!==Object.keys(this.quiz).length&&(this.$condWhenSelect.empty(),this.$condWhenSelect.append(new Option("Quiz completed",r,!1,!1)),this.labels.condWhenSelect[this.quiz.type]&&this.$condWhenSelect.append(new Option(this.labels.condWhenSelect[this.quiz.type],a,!1,!1)),this.$condWhenSelect.trigger("change"))},changeWhen:function(e,t){this.generateWhenControls(t.value===a)},resultIsWithinRage:function(e={}){return 0===Object.keys(e).length&&(e=this.quiz),"object"==typeof e.results&&"min"in e.results&&"max"in e.results},generateWhenControls:function(e=!0){this.$extraControlsWrapper.empty(),this.shouldDisplayInfoText=!1,this.$infoText.hide(),e&&(this.resultIsWithinRage()?(this.$extraControlsWrapper.html(new l({model:{label:this.labels.slider[this.quiz.type],value:this.model.get("when_cond")||this.quiz.results.min,min:this.quiz.results.min,max:this.quiz.results.max},change:e=>{this.model.set({when_cond:e})}}).render().$el),void 0!==this.model.get("when_cond")&&(this.quiz.results.max<Number(this.model.get("when_cond"))||this.quiz.results.min>Number(this.model.get("when_cond")))&&(this.shouldDisplayInfoText=!0)):(this.$extraControlsWrapper.html(new c({inputs:this.quiz.results.map((e=>({value:parseInt(e.id),label:e.text,checked:Array.from(this.model.get("when_cond")||[]).includes(e.id)}))),change:e=>{this.model.set({when_cond:e})}}).render().$el),void 0!==this.model.get("when_cond")&&this.quiz.results.filter((e=>this.model.get("when_cond").includes(e.id))).length!==this.model.get("when_cond").length&&(this.shouldDisplayInfoText=!0)),this.shouldDisplayInfoText&&this.$infoText.show())},setQuiz:function(e){this.quiz=TVA.quizzes[e]},getData:function(){return n(n({},this.model.toJSON()),{},{schedule:{}})}})},15492:function(e,t,s){TVA.drip.trigger_views.tqb_result=s(68003);const i="tqb_result",n=_.findWhere(TVA.drip.content_triggers,{id:i}),o=s(86274).extend({scheduleType:i,defaults:function(){return jQuery.extend(!0,{},{id:i,schedule:{}})},canRemove:function(){return!0},canEdit:function(){return parseInt(TVA.tqb_active)&&void 0!==TVA.quizzes},icon:function(){return"drip-tqb"},getLabel:function(){return n.name},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:n.summary,tooltip:this.getLabel()}}});e.exports=o}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},async function(e){window.TVA=window.TVA||{},TVA.globals={},TVA.Utils=s(69129),TVA.Utils.LocalStorage=s(29171).instance(),s(72567),TVA.$eventBus=e({}),e(window).on("td_sets_ready",(()=>{window.TD_SETS=window.TD_SETS||{},e.extend(!0,window.TD_SETS,{Views:{List:s(12009),Item:s(55738),Form:s(49438)}})}));const t=TVA.$app=e("#tva-app");TVA.lazyLoading=!0,await async function(){return new Promise(((t,s)=>{wp.apiRequest({url:TVA.Utils.buildUrl(TVA.routes.admin,{},"localize")}).done((s=>{e.extend(!0,TVA,s),t(s)})).fail((e=>s(e)))}))}(),e((async function(){location.href.includes("debug")&&requestAnimationFrame(TVA.Utils.debugIcons.bind(TVA.Utils)),e(document).on("keyup",(e=>{e.type="page_keyup",TVA.$eventBus.trigger(e)}));const i=s(30739);TVA.courses=new i(TVA.courses.items,{total:TVA.courses.total}),TVA.courses.on("add remove change destroy",(()=>TVA.$eventBus.trigger("courses_changed"))),TVA.skins=new(s(37816))(TVA.skins);const n=_.debounce((()=>TVA.skins.fetch()),200);TVA.$eventBus.on("courses_changed",n);const o=s(84531);TVA.topics=new o(TVA.topics);const r=s(84716);TVA.labels=new r(TVA.labels),TVA.dismissedTooltips=TVA.dismissedTooltips||[],s(56766),TVA.indexPageModel=new(s(58052))(TVA.settings.index_page),TVA.certificateValidationPage=new(s(58052))(TVA.settings.certificate_validation_page);const a=s(65035);TVA.products=new a(TVA.products.items,{total:TVA.products.total}),TVA.products.on("add remove change destroy",(()=>TVA.$eventBus.trigger("products_changed"))),TVA.products.on("rename",(()=>{TVA.ProtectedFiles.resetAndFetch()})),TVA.$eventBus.on("products_changed",(()=>TVA.courses.where({fetched:!0}).forEach((e=>e.set("fetched",!1)))));const l=s(69362);TVA.access_integrations=new l(TVA.access_integrations);const c=s(46498);TVA.customers=new c([],{total:0});const d=s(8125);TVA.ProtectedFiles=new d(TVA.files.items,{total:TVA.files.total});const h=_.debounce((()=>TVA.ProtectedFiles.resetAndFetch()),500);TVA.products.on("remove add",(()=>{h(),delete TVA.allProducts})),TVA.$eventBus.on("content_sets_changed",(()=>{TVA.ProtectedFiles.resetAndFetch()})),TVA.assessments.upload_connections.dropbox&&TVA.assessments.upload_connections.dropbox.client_id&&window.ThriveDropBoxPicker.init(TVA.assessments.upload_connections.dropbox.client_id);const u=s(25679);TVA.Router=new u,Backbone.history.start({hashchange:!0}),TVA.settings.wizard.value||TVA.Router.navigate("#wizard",{trigger:!0}),Backbone.history.fragment||TVA.Router.navigate("#home",{trigger:!0}),TVA.keepLoader||t.tvaToggleLoader(!1,null,{fadeDuration:200}),TVA.lazyLoading=!1}))}(jQuery)}();