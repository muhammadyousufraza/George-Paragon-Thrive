(()=>{var e;(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t;window.ThriveComments=window.ThriveComments||{},ThriveComments.util=ThriveComments.util||{},_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/<#=([\s\S]+?)#>/g,escape:/<#-([\s\S]+?)#>/g},t=jQuery,ThriveComments.util.tpl=function(e,i){var s=t("script#"+e.replace(/\//g,"-")).html()||"";return i?_.template(s)(i):_.template(s)},ThriveComments.util.nested=function(e,t){var i=this;return e instanceof Backbone.Model?this.nested(e.attributes,t):_.each(t,(function(t){t.children&&(e[t.name]=i.nested(e[t.name],t.children)),_.isArray(e)?_.each(e,(function(e){e[t.name]=new t.obj(e[t.name])})):e[t.name]=new t.obj(e[t.name])})),e},ThriveComments.util.validateInput=function(e,t,i){var s=e instanceof jQuery?e.val():e,n=!0;return""==(s=s.trim())?(t||(t=ThriveComments.util.render_label("isRequired")),n=!1,e instanceof jQuery&&(e.removeClass("tcm-valid"),e.addClass("tcm-invalid"),e.prev(".tcm-error-message").show().html(t))):(e.removeClass("tcm-invalid"),e.prev(".tcm-error-message").hide(t)),n},ThriveComments.util.validateInputUrl=function(e,t,i){var s=e instanceof jQuery?e.val():e,n=!0;return null!=s&&0==this.isValidUrl(this.addHttp(s))?(t||(t=ThriveComments.util.render_label("isRequired")),n=!1,e instanceof jQuery&&(e.removeClass("tcm-valid"),e.addClass("tcm-invalid"),e.prev(".tcm-error-message").show().html(t))):(e.removeClass("tcm-invalid"),e.prev(".tcm-error-message").hide(t)),n},ThriveComments.util.validateStoringConsent=function(e,t){var i=e instanceof jQuery?e.is(":checked"):e,s=e.siblings(".tcm-consent-text"),n=ThriveComments.util.get_cookie("tcm_cookie_user_name"),r=!0;return""===ThriveComments.settings.storing_consent||0===ThriveComments.settings.storing_consent||(i||""!==n?(s.removeClass("tcm-not-selected"),e.prev(".tcm-error-message").hide(t)):(t||(t=ThriveComments.util.render_label("isRequired")),r=!1,e instanceof jQuery&&(s.removeClass("tcm-not-selected"),s.addClass("tcm-not-selected"),e.prev(".tcm-error-message").show().html(t)))),r},ThriveComments.util.validateEmail=function(e,t){var i=e.length?e.val():e;return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i)?(e instanceof jQuery&&(e.removeClass("tcm-invalid"),e.prev(".tcm-error-message").hide()),!0):(e instanceof jQuery&&(e.removeClass("tcm-valid"),e.addClass("tcm-invalid"),e.prev(".tcm-error-message").show().html(t)),!1)},ThriveComments.util.valuesToArray=function(e){return Object.keys(e).map((function(t){return e[t]}))},ThriveComments.util.set_avatar_url=function(e){e.length&&e.attr("data-src")===ThriveComments.default_author_picture_url&&this.checkGravatar(e.attr("data-email-hash")).done((function(t){e.css("background-image",'url("'+t+'")')}))},ThriveComments.util.previousUser=function(){return""!==ThriveComments.util.get_cookie("social-login")||!!ThriveComments.current_user.ID||void 0},ThriveComments.util.set_cookie=function(t,i,s,n){n=n||"/",s=s||2592e3;var r,o=new Date;s=parseInt(s),o.setTime(o.getTime()+1e3*s),r=o.toUTCString(),"object"===e(i)&&(i=JSON.stringify(i)),document.cookie=encodeURIComponent(t)+"="+i+";expires="+r+";path="+n},ThriveComments.util.get_cookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var n=i[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},ThriveComments.util.search_comment=function(e,t){return void 0!==e.models&&this.search_recursive(e.models,t)},ThriveComments.util.search_recursive=function(e,t){for(var i=0,s=0;!i&&s<e.length;s++)e[s].get("comment_ID")==t?i=e[s]:e[s].get("children")&&e[s].get("children").length&&(i=i||this.search_recursive(e[s].get("children"),t));return i},ThriveComments.util.elem_viewport=function(e){var i=e.offset(),s=i?i.top:0,n=s+e.outerHeight(),r=t(window).scrollTop(),o=r+t(window).height();return n>r&&s<o},ThriveComments.util.focusElement=function(e){var i,s=e.offset().top,n=e.height(),r=t(window).height();i=n<r?s-(r/2-n/2):s,t("html, body").animate({scrollTop:i},300,"easeOutQuint")},ThriveComments.util.save_setting_model=function(e,t,i,s){if(!e)return!1;(s=s||{}).success||(s.success=ThriveComments.translations.settings_saved_success_toast),s.fail||(s.fail=ThriveComments.translations.settings_saved_fail_toast),new ThriveComments.models.Settings({name:e,value:t}).save().done((function(n){"NoMessage"!==s.success&&TVE_Dash.success(s.success),-1!==ThriveComments.tcm_sync_settings.indexOf(e)&&i.where({name:e}).shift().set("value",t)})).fail((function(e){TVE_Dash.err(s.fail)}))},ThriveComments.util.render_label=function(e,t,i){var s,n,r,o,a,c;if(t||(t=""),!(s=window.parent.ThriveComments?void 0===window.parent.ThriveComments.objects.Settings?ThriveComments.tcm_customize_labels:window.parent.ThriveComments.objects.Settings.get(ThriveComments.tcm_labels_key).get("value"):ThriveComments.tcm_customize_labels)||!s.hasOwnProperty(e))return"";if(-1===(a=s[e].text).indexOf("{"))return a;switch(r=a.indexOf("{"),o=a.indexOf("}"),i){case"before":c=a.substr(0,r);break;case"after":c=a.substr(o+1,a.length-1);break;default:n=a.substring(r,o+1),c=a.replace(n,t)}return c},ThriveComments.util.showCommentsNumber=function(e){var i=t(".tcm-comments-number");i.length&&i.html(i.html().replace("comment_count",e)).show()},ThriveComments.util.tcm_show_loader=function(){t(".tcm-dot-loader").show()},ThriveComments.util.tcm_hide_loader=function(){t(".tcm-dot-loader").hide(),t(".thrive-comments-content").show()},ThriveComments.util.tcm_hide_textareas=function(e){var i=t(e.currentTarget).closest(".tcm-reply-container").find(".tcm-reply-btn").attr("data-id");t("textarea[name=tcm-post-content]").each((function(){var e=t(this).closest(".tcm-comment-wrapper"),s=t(this).closest(".tcm-reply-container").find(".tcm-reply-btn").attr("data-id"),n=e.find(".tcm-create-post-container").attr("data-position");void 0!==i&&t(this).closest(".comment-id-0").find(".tcm-comment-additional-fields").hide(),""!=n&&"top"===n||i==s||(t(this).closest(".tcm-comment-wrapper").slideUp(),t(this).closest(".tcm-reply-container").find(".tcm-reply-btn").attr("data-clicked",0))}))},ThriveComments.util.after_ajax_login_actions=function(){t(".tcm-lazy-comments").empty(),t.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},cache:!1,url:ThriveComments.routes.generate_nonce,dataType:"JSON",data:{action:"refresh_nonce"},type:"GET"}).done((function(e){var i=window.parent.ThriveComments.util.commentId,s=i?"comments/"+i:"";ThriveComments.current_user=e.current_user,ThriveComments.nonce=e.nonce,Backbone.history.loadUrl(s),t(".tcm-comment-item").each((function(){var e=t(this);e.find(".tcm-comment-wrapper").hide(),e.find(".tcm-error-heading").hide()}))}))},ThriveComments.util.focusAfterLogin=function(){if(this.commentId&&parseInt(this.commentId)===this.commentId){var e=t("div[data-comment-id="+this.commentId+"]");e.find(".tcm-reply-btn").click(),e.find("#tcm-post-content").val(this.content).focus()}if("bottom"===this.position){var i=t(".add-comment");i.click(),i.closest(".tcm-lazy-comments").find("textarea#tcm-post-content").val(this.content).focus()}"top"===this.position&&t("textarea#tcm-post-content").focus(),this.position=null},ThriveComments.util.scrollToElement=function(e){e.length&&t("body, html").animate({scrollTop:e.offset().top-t(window).height()/2+30},{duration:500,complete:function(){var t=e.parent();t.addClass("tcm-highlight-item"),setTimeout((function(){return t.removeClass("tcm-highlight-item")}),800)}})},ThriveComments.util.showCommentConversion=function(e){var t=new ThriveComments.views.CommentConversion({commentView:e});t.handleAfterShowAction(),e.$el.prepend(t.$el)},ThriveComments.util.isValidUrl=function(e){return!(null===e.match(/(http(s)?:\/\/.)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g))},ThriveComments.util.addHttp=function(e){return(e=t.trim(e))&&!/^(?:f|ht)tps?\:\/\//.test(e)&&(e="http://"+e),e},ThriveComments.util.err=function(e,i,s){t(".tvd-toast").remove(),Toasts.init(e,i||3e3,"tvd-toast tvd-red",s,"bottom"),t(".tvd-toast").parent().addClass("tcm-frontend-toast")},ThriveComments.util.getDropDownItems=function(e){var t;if(e.meta_query.tcm_delegate)t={approve:1,unapprove:1,no_reply_needed:1,featured:1,delegate:1,spam:1,trash:1};else if(e.meta_query.tcm_featured)t={stop_featured:1,no_reply_needed:1,delegate:1};else switch(e.status){case"all":case"hold":case"tcm_unreplied":t={approve:1,unapprove:1,no_reply_needed:1,featured:1,delegate:1,spam:1,trash:1};break;case"featured":t={no_reply_needed:1,stop_featured:1,delegate:1};break;case"spam":t={not_spam:1,delete:1};break;case"trash":t={spam:1,restore:1,delete:1}}return t},ThriveComments.util.dynamicSortByProperty=function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(i,s){return(i[e]<s[e]?-1:i[e]>s[e]?1:0)*t}},ThriveComments.util.insertAtCaret=function(e,t){if(e.length){var i=e[0],s=i.scrollTop,n=0,r=i.selectionStart||"0"==i.selectionStart?"ff":!!document.selection&&"ie";if("ie"==r){i.focus();var o=document.selection.createRange();o.moveStart("character",-i.value.length),n=o.text.length}else"ff"==r&&(n=i.selectionStart);var a=i.value.substring(0,n),c=i.value.substring(n,i.value.length);if(i.value=a+t+c,n+=t.length,"ie"==r){i.focus();var m=document.selection.createRange();m.moveStart("character",-i.value.length),m.moveStart("character",n),m.moveEnd("character",0),m.select()}else"ff"==r&&(i.selectionStart=n,i.selectionEnd=n,i.focus());i.scrollTop=s}},ThriveComments.util.ajaxurl=function(e){var t=-1!==ajaxurl.indexOf("?")?"&":"?";return e&&e.length?(e=e.replace(/^(\?|&)/,""),e+="&_nonce="+ThriveComments.admin_nonce,ajaxurl+t+e):ajaxurl+t+"_nonce="+ThriveComments.admin_nonce},ThriveComments.util.toCamelCase=function(e){return(e=e.replace(/_/g," ")).toLowerCase().replace(/(?:(^.))/g,(function(e){return e.charAt(e.length-1).toUpperCase()}))},ThriveComments.util.formatSelection=function(e){var t,i,s,n=e instanceof jQuery?e[0]:document.getElementById(e);return void 0!==document.selection?(n.focus(),t=document.selection.createRange().text):void 0!==n.selectionStart&&(i=n.selectionStart,s=n.selectionEnd,t=n.value.substring(i,s)),{selectedText:t,startPos:i,endPos:s}},ThriveComments.util.set_subscriber_cookies=function(e){var t=ThriveComments.util.get_cookie("subscribed_posts");if(""!==t&&(t=JSON.parse(t)),0===e){var i=t.indexOf(ThriveComments.post.ID);i>-1&&(t.splice(i,1),ThriveComments.util.set_cookie("subscribed_posts",JSON.stringify(t),31104e3))}else""===t?t=[ThriveComments.post.ID]:t.push(ThriveComments.post.ID),ThriveComments.util.set_cookie("subscribed_posts",JSON.stringify(t),31104e3)},ThriveComments.util.checkGravatar=function(e){var i=this,s=t.Deferred();if(this.gravatarCache=this.gravatarCache||{},this.gravatarCache[e])this.gravatarCache[e].success?s.resolve(this.gravatarCache[e].url):s.reject();else{var n="https://www.gravatar.com/avatar/"+e+"?s=512";t.ajax({type:"HEAD",url:n+"&d=404"}).done((function(t){i.gravatarCache[e]={url:n,success:!0},s.resolve(n)})).fail((function(){i.gravatarCache[e]={url:"",success:!1},s.reject()}))}return s}})(),window.ThriveComments=window.ThriveComments||{},ThriveComments.models=ThriveComments.models||{},ThriveComments.collections=ThriveComments.collections||{},jQuery,ThriveComments.models.Base=Backbone.Model.extend({idAttribute:"comment_ID",sync:function(e,t,i){var s;return(i=i||{}).cache=!1,_.isUndefined(ThriveComments.nonce)||_.isNull(ThriveComments.nonce)||(s=i.beforeSend,i.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",ThriveComments.nonce),s)return s.apply(this,arguments)}),Backbone.sync(e,t,i)}}),ThriveComments.collections.Base=Backbone.Collection.extend({sync:function(e,t,i){var s;return(i=i||{}).cache=!1,i.url=this.url(),_.isUndefined(ThriveComments.nonce)||_.isNull(ThriveComments.nonce)||(s=i.beforeSend,i.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",ThriveComments.nonce),s)return s.apply(this,arguments)}),Backbone.sync(e,t,i)}}),ThriveComments.models.Settings=ThriveComments.models.Base.extend({idAttribute:"name",defaults:{name:"",value:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.Settings=ThriveComments.collections.Base.extend({model:ThriveComments.models.Settings,url:function(){return ThriveComments.routes.settings}}),ThriveComments.models.Badges=ThriveComments.models.Base.extend({idAttribute:"id",defaults:{id:"",name:"",awarded:"",reaches:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.Badges=ThriveComments.collections.Base.extend({model:ThriveComments.models.Badges,url:function(){return ThriveComments.routes.settings}}),ThriveComments.models.Keywords=ThriveComments.models.Base.extend({idAttribute:"name",defaults:{name:"",value:"",new_tab:"",no_follow:"",post_id:""},url:function(){return ThriveComments.routes.settings+"/keywords"}}),ThriveComments.collections.Keywords=ThriveComments.collections.Base.extend({model:ThriveComments.models.Keywords,url:function(){return ThriveComments.routes.settings+"/keywords"},parse:function(e){return _.map(e,(function(e,t,i,s){return new ThriveComments.models.Keywords({name:e,value:t,new_tab:i,no_follow:s})}))}}),ThriveComments.models.BadgeImage=ThriveComments.models.Base.extend({idAttribute:"id",defaults:{id:"",name:"",url:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.BadgeImages=ThriveComments.collections.Base.extend({model:ThriveComments.models.BadgeImage,url:function(){return ThriveComments.routes.settings}}),ThriveComments.models.SignInButton=ThriveComments.models.Base.extend({idAttribute:"id",defaults:{id:"",name:"",status:"",url:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.SignInButtons=ThriveComments.collections.Base.extend({model:ThriveComments.models.SignInButton,url:function(){return ThriveComments.routes.settings}}),window.ThriveComments=window.ThriveComments||{},ThriveComments.views=ThriveComments.views||{},ThriveComments.objects=ThriveComments.objects||{},e=jQuery,ThriveComments.views.Base=Backbone.View.extend({render:function(){return this._render(),TVE_Dash.materialize(this.$el),this}}),ThriveComments.views.Dashboard=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("dashboard"),events:{"click .tcm-checkbox":"saveSetting","change .tcm-input":"saveSetting","click .tcm-radio":"saveSetting","change .tcm-dropdown":"saveSetting","click .tcm-upload-image":"openUploadImage","click #tcm-revert-default":"revertDefault","click .tcm-gravatar-switch":"hideShowAvatarSettings","click #tcm-preview-header a":"hideShowLivePreview","click #comment_registration":"disableActivateLogin","click .tcm-conversion-menu":"showCommentConversion","click .size-s":"setSmall","click .size-l":"setBig","change .role-checkbox":"roleSetting","click .tcm-voting-card":"saveVotingSetting","click .tcm-badge-new":"addNewBadge","click #tcm-badges-option":"hideShowBadges","click #color-picker":"showColorPicker",click:"hideColorPicker","click #tcm_live_update":"show_live_update_refresh_rate"},initialize:function(e){this.listenTo(this.collection,"sync",this.render),this.labels=e.labels},_render:function(){this.$el.html(this.template({collection:this.collection,default_avatar:ThriveComments.default_avatar_url,roles:ThriveComments.thrive_roles})),TVE_Dash.materialize(this.$el);var t,i=this.$(".color-picker-container"),s=this.$(".color-picker"),n=this;return s.iris({width:250,defaultColor:!0,change:function(e,i){n.$(".color-picker-label").css("background-color",i.color.toString()),setTimeout((function(){performance.now()-t>500&&(ThriveComments.util.save_setting_model("tcm_color_picker_value",i.color.toString(),n.collection),t=performance.now())}),800),t=performance.now()},target:i,hide:!1,palettes:!0}),s.iris("hide").iris("option","hide",!0),this.labels=new ThriveComments.views.Labels({el:this.$(".labels-container"),collection:this.collection}),ThriveComments.objects.CustomImagesCollection=this.collection.get("tcm_badges_custom_images").get("value"),ThriveComments.objects.CustomImagesCollection||(ThriveComments.objects.CustomImagesCollection=[]),ThriveComments.objects.BadgeImages=new ThriveComments.collections.BadgeImages(ThriveComments.badges_default),ThriveComments.objects.Badges=new ThriveComments.collections.Badges(this.collection.get("tcm_badges").get("value")),this.badges=new ThriveComments.views.BadgesCards({el:this.$(".tcm-badges-cards"),collection:ThriveComments.objects.Badges}),ThriveComments.objects.SocialSignInButtons=new ThriveComments.collections.SignInButtons(ThriveComments.tcm_social_apis),this.social=new ThriveComments.views.SignInButtons({el:this.$("#tcm-social-status"),collection:ThriveComments.objects.SocialSignInButtons,settings_api:this.collection.get("tcm_api_status").get("value")}),ThriveComments.objects.Keywords=new ThriveComments.collections.Keywords(this.collection.get("tcm_keywords").get("value")),this.keywords=new ThriveComments.views.Keywords({el:this.$(".keywords-container"),collection:ThriveComments.objects.Keywords}),this.notifications=new ThriveComments.views.Notifications({el:this.$(".tcm-notifications"),collection:this.collection}),this.notifications.render(),ThriveComments.objects.SocialSignInButtons=new ThriveComments.collections.SignInButtons([]),ThriveComments.tcm_hide_live_preview.length>0&&e(".tcm-preview-slider").trigger("click"),this.stickySidebar(),this},showColorPicker:function(){e(".color-picker").iris("show")},hideColorPicker:function(t){var i=e(t.target);i.hasClass("color-picker-container")||i.closest(".color-picker-container").length>0||e("#color-picker").is(":focus")||e(".color-picker").iris("hide")},show_live_update_refresh_rate:function(){this.$(".tcm_live_update_refresh_rate").toggleClass("tcm-hide")},stickySidebar:function(){e(window).scroll((function(){var t=e(window).scrollTop();e("#tcm-live-preview").toggleClass("sticky",t>=78)}))},setSmall:function(t){e(t.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","large")&&(e("#tcm-live-preview").animate({width:360}),e("#tcm-admin-configurator").animate({width:e("#tcm-holder").width()-360}),e("#tcm-preview-header span").removeClass("active"),e(t.currentTarget).addClass("active"),e(t.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","small"),e("iframe.live-preview").contents().find("#thrive-comments").removeClass("tcm-large-preview").addClass("tcm-small-preview"))},setBig:function(t){e(t.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","small")&&(e("#tcm-live-preview").animate({width:460}),e("#tcm-admin-configurator").animate({width:e("#tcm-holder").width()-460}),e("#tcm-preview-header span").removeClass("active"),e(t.currentTarget).addClass("active"),e(t.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","large"),e("iframe.live-preview").contents().find("#thrive-comments").removeClass("tcm-small-preview").addClass("tcm-large-preview"))},hideShowLivePreview:function(e){var t=this.$("#tcm-live-preview"),i=this.$("#tcm-admin-configurator"),s=this.$("#tcm-holder");return this.$(".tcm-icon-keyboard_arrow_down").toggleClass("icon-variation"),t.find("#tcm-preview-header a").toggleClass("icon-box-position"),e.currentTarget.getAttribute("data-hide")?e.currentTarget.getAttribute("data-hide")&&("large"==e.currentTarget.getAttribute("data-size")?i.animate({width:s.width()-460}):i.animate({width:s.width()-360}),t.animate({right:"0"}),e.currentTarget.removeAttribute("data-hide"),ThriveComments.util.save_setting_model("tcm_hide_live_preview",!1)):("large"==e.currentTarget.getAttribute("data-size")?t.animate({right:-460}):t.animate({right:-360}),i.animate({width:"100%"}),0===ThriveComments.tcm_hide_live_preview.length&&ThriveComments.util.save_setting_model("tcm_hide_live_preview",!0),e.currentTarget.setAttribute("data-hide",1)),!1},saveSetting:function(e){var t=e.currentTarget.dataset.type,i="",s="",n=e.currentTarget.dataset.setting;switch(t){case"checkbox":i=e.currentTarget.checked;break;case"number":var r=parseInt(this.$("#"+n).val());if(!new RegExp("^[0-9]+$").test(r)||""===r||0===r||r>1e4)return TVE_Dash.err("This input only accepts digits between 1 and 10000"),e.currentTarget.value=e.currentTarget.getAttribute("value"),!1;e.currentTarget.setAttribute("value",r),i=r;break;case"dropdown":i=(s=document.getElementById("sorting_type")).options[s.selectedIndex].value;break;case"radio":i=n===ThriveComments.const.absolute_date||n===ThriveComments.const.light_design?1:n===ThriveComments.const.relative_date||n===ThriveComments.const.dark_design?2:0,n=n===ThriveComments.const.absolute_date||n===ThriveComments.const.relative_date||n===ThriveComments.const.hide_date?"comment_date":"comment_style_template";break;case"textarea":i=this.$("#"+n).val()}ThriveComments.util.save_setting_model(n,i,this.collection)},revertDefault:function(e){ThriveComments.util.save_setting_model(e.currentTarget.dataset.setting,ThriveComments.default_avatar_url,this.collection),this.afterImageSave(1)},openUploadImage:function(){var e=this,t=wp.media({title:ThriveComments.translations.choose_avatar,button:{text:ThriveComments.translations.choose_avatar_button},library:{type:"image"},multiple:!1,frame:"select"});t.on("select",(function(){var i=t.state().get("selection").first().toJSON();ThriveComments.util.save_setting_model("tcm_default_picture",i.url,e.collection),e.$(".tcm-upload-div").css("background-image",i.url),e.afterImageSave(0,i.url)})),t.open()},afterImageSave:function(e,t){e?(this.$(".tcm-upload-div").css("background-image","url("+ThriveComments.default_avatar_url+")"),this.$("#tcm-revert-default").attr("disabled",!0),this.$("#tcm-upload-image").html(ThriveComments.translations.choose_image),this.$(".tcm-selected-image").html(ThriveComments.translations.default_avatar)):(this.$("#tcm-revert-default").attr("disabled",!1),this.$("#tcm-upload-image").html(ThriveComments.translations.change_image),this.$(".tcm-upload-div").css("background-image","url("+t+")"),this.$(".tcm-selected-image").html(ThriveComments.translations.selected_image+": "+t.substr(t.lastIndexOf("/")+1)))},hideShowAvatarSettings:function(e){var t=this.$(".tcm-avatar-settings");if(e.currentTarget.checked)return t.show(),!0;t.hide()},disableActivateLogin:function(e){var t=this.$("#login_activation"),i=this.$("#login_activation_label");this.$("#comment_registration").is(":checked")?(t.is(":checked")||ThriveComments.util.save_setting_model("login_activation",1,this),i.addClass("tcm-disabled"),t.prop("checked",!0),t.prop("disabled",!0)):(t.prop("disabled",!1),i.removeClass("tcm-disabled"))},showCommentConversion:function(e){if(!this.conversionView){var t=jQuery(e.currentTarget);return t.addClass("tvd-active"),t.find(".tvd-collapsible-header").addClass("tvd-active"),this.conversionView=new ThriveComments.views.Conversion({collection:this.collection}),t.append(this.conversionView.$el),this.conversionView.$el.slideDown(),!1}},roleSetting:function(e){var t=e.currentTarget.dataset.setting,i=e.currentTarget.checked;i=i?1:0,ThriveComments.util.save_setting_model(t,i,this.collection)},saveVotingSetting:function(t){var i=t.currentTarget.getAttribute("data-value"),s=this.$(".elemToggle");e(".tcm-voting-card").removeClass("current"),t.currentTarget.classList.add("current"),ThriveComments.util.save_setting_model("tcm_vote_type",i,this.collection,{success:ThriveComments.translations.options_saved_success_toast,fail:ThriveComments.translations.options_saved_fail_toast}),this.saveCommentOrderSetting(i),"no_vote"===i?s.hide():s.show()},saveCommentOrderSetting:function(e){var t="no_vote"===e?"desc":"top_rated";ThriveComments.util.save_setting_model("comment_order",t,this.collection,{success:ThriveComments.translations.options_saved_success_toast,fail:ThriveComments.translations.options_saved_fail_toast})},addNewBadge:function(){ThriveComments.objects.NewBadge=new ThriveComments.models.Badges({id:0,name:ThriveComments.translations.badge_default_title,awarded:"asc",reaches:"10"}),TVE_Dash.modal(ThriveComments.views.BadgeModal,{badge:ThriveComments.objects.NewBadge,"max-width":"40%"})},hideShowBadges:function(e){var t=e.currentTarget.checked,i=this.$(".tcm-badges-wrapper");!0===t?i.show():i.hide()}}),ThriveComments.views.Conversion=ThriveComments.views.Base.extend({className:"tvd-collapsible-body",template:ThriveComments.util.tpl("comment-conversion"),events:{"click .tcm-cards .tcm-card":"clickTab","focusout textarea":"saveConversionSetting","focusout .redirect_url":"redirect","click .tcm-checkbox":"saveConversionSetting","change .tcm-select-thrivebox":"saveConversionSetting","click .social-share-checkbox":"verifyCheckboxes","mousedown .tcm-hyperlink":"openHyperLink"},initialize:function(e){this.allSettings=e.collection,this.conversionSettings=e.collection.get("tcm_conversion").get("value"),this.render()},_render:function(){return this.$el.html(this.template({conversionSettings:this.conversionSettings})),this.initTooltips(),this.initThriveBoxes(),this.initRedirect(),this.initVerification(),this},clickTab:function(t){e(t.currentTarget).hasClass("leads_inactive")||(this.updateActiveCard(t),this.showHideTabs(t))},initThriveBoxes:function(){ThriveComments.leads_active&&(this.renderThriveBoxes(this.$("#thrive-boxes-first-time")),this.renderThriveBoxes(this.$("#thrive-boxes-second-time")))},renderThriveBoxes:function(e){e.select2({minimumResultsForSearch:2})},initTooltips:function(){var t=this.getTooltipMessage();this.$(".tooltips").each((function(){var i=e(this);i.hasClass("leads_inactive")&&this.setAttribute("data-powertip",t),i.powerTip({placement:"n",smartPlacement:!0,mouseOnToPopup:!0})}))},getTooltipMessage:function(){return ThriveComments.translations.conversion_leads_availabe+' <a href="https://thrivethemes.com/leads/"  target="_blank">Thrive Leads</a> '+ThriveComments.translations.conversion_leads_installed},showHideTabs:function(t){var i=e(t.currentTarget),s=i.attr("data-tab");i.siblings().removeClass("current"),i.parent().siblings(".tcm-message-container").children(".tcm-message-box").removeClass("current"),i.addClass("current"),i.parent().siblings(".tcm-message-container").children("#"+s).addClass("current")},updateActiveCard:function(e){var t=jQuery(e.currentTarget).parent().data("conversion-setting");this.conversionSettings[t].active=e.currentTarget.getAttribute("data-card"),ThriveComments.util.save_setting_model("tcm_conversion",this.conversionSettings,this.allSettings,{success:ThriveComments.translations.options_saved_success_toast,fail:ThriveComments.translations.options_saved_fail_toast})},saveConversionSetting:function(e){var t=e.currentTarget.getAttribute("data-card");t in this&&"function"==typeof this[t]&&this[t](e),ThriveComments.util.save_setting_model("tcm_conversion",this.conversionSettings,this.allSettings)},live_update:function(e){var t=e.currentTarget.getAttribute("data-conversion-setting");this.conversionSettings.tcm_live_update[t].custom_message=e.currentTarget.value},social_share:function(e){var t=e.currentTarget.getAttribute("data-conversion-setting");"checkbox"===e.currentTarget.type?this.conversionSettings.tcm_social_share[t].social_sharing_buttons[e.currentTarget.name]=e.currentTarget.checked?1:0:this.conversionSettings.tcm_social_share[t].custom_message=e.currentTarget.value},related_posts:function(e){var t=e.currentTarget.getAttribute("data-conversion-setting");"checkbox"===e.currentTarget.type?this.conversionSettings.tcm_related_posts[t].show_featured_image=e.currentTarget.checked?1:0:this.conversionSettings.tcm_related_posts[t].custom_message=e.currentTarget.value},tcm_thrivebox:function(t){var i=t.currentTarget.getAttribute("data-conversion-setting");this.conversionSettings.tcm_thrivebox[i].thrivebox_id=t.currentTarget.value,"0"===t.currentTarget.value?e(t.currentTarget).next().next().show():e(t.currentTarget).next().next().hide()},redirect:function(e){var t,i;"redirect_url"==e.target.id?(t="first_time",i="#redirect-error"):(t="second_time",i="#redirect-error2");var s=e.currentTarget.value,n=ThriveComments.util.addHttp(s),r=this.conversionSettings.tcm_redirect[t].redirect_post_val,o=this.conversionSettings.tcm_redirect[t].redirect_url;if(0!=e.currentTarget.getAttribute("data-flag")&&s!=o&&s!=r){if(!ThriveComments.util.isValidUrl(n)){this.conversionSettings.tcm_redirect[t].flag=1,this.conversionSettings.tcm_redirect[t].redirect_post_val=s;var a="tcm_conversion",c=this.conversionSettings,m=this.allSettings;return new ThriveComments.models.Settings({name:a,value:c}).save().done((function(e){-1!==ThriveComments.tcm_sync_settings.indexOf(a)&&m.where({name:a}).shift().set("value",c)})).fail((function(e){TVE_Dash.err(ThriveComments.translations.settings_saved_fail_toast)})),void this.$(i).show()}this.conversionSettings.tcm_redirect[t].redirect_url=n,this.conversionSettings.tcm_redirect[t].flag=0,this.conversionSettings.tcm_redirect[t].redirect_post_id=0,ThriveComments.util.save_setting_model("tcm_conversion",this.conversionSettings,this.allSettings),this.$(i).hide()}else""==s&&this.$(i).show()},getPostNameById:function(t,i){var s=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:s,type:"POST",data:{postId:t}}).done((function(t){"first_time"==i&&e("#redirect_url").removeClass("ui-autocomplete-loading"),"second_time"==i&&e("#redirect_url2").removeClass("ui-autocomplete-loading")})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)})).always((function(){TVE_Dash.hideLoader()}))},redirectAutocomplete:function(t,i,s,n){var r,o,a=this;"first_time"==n?(r="#redirect_url",o="#redirect-error"):(r="#redirect_url2",o="#redirect-error2"),s.autocomplete({delay:50,select:function(e,t){a.conversionSettings.tcm_redirect[n].redirect_post_id=t.item.id,a.conversionSettings.tcm_redirect[n].redirect_post_val=t.item.value,a.conversionSettings.tcm_redirect[n].redirect_url=i[0]+"//"+i[2]+"?p="+t.item.id,a.conversionSettings.tcm_redirect[n].flag=0,a.$(r)[0].setAttribute("data-flag",0),ThriveComments.util.save_setting_model("tcm_conversion",a.conversionSettings,a.allSettings),a.$(o).hide()},source:function(i,s){e.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:t,dataType:"json",data:{q:i.term},type:"POST"}).done((function(e){a.$(r)[0].setAttribute("data-flag",1),a.conversionSettings.tcm_redirect[n].flag=1,s(e)})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)}))}})},redirectInitInput:function(e,t){0==this.conversionSettings.tcm_redirect[t].redirect_post_id?e.val(this.conversionSettings.tcm_redirect[t].redirect_url):e.val(this.conversionSettings.tcm_redirect[t].redirect_post_val),1==this.conversionSettings.tcm_redirect[t].flag&&(e.val(this.conversionSettings.tcm_redirect[t].redirect_post_val),"first_time"==t?this.$("#redirect-error").show():this.$("#redirect-error2").show())},initRedirect:function(){this.redirectInitInput(this.$("#redirect_url"),"first_time"),this.redirectInitInput(this.$("#redirect_url2"),"second_time");var e=ThriveComments.routes.settings+"/redirect_autocomplete",t=location.href.split("/"),i=this.$(".tcm-autocomplete"),s=this.$(".tcm-autocomplete2");this.redirectAutocomplete(e,t,i,"first_time"),this.redirectAutocomplete(e,t,s,"second_time"),this.getPostNameById(this.conversionSettings.tcm_redirect.first_time.redirect_post_id,"first_time"),this.getPostNameById(this.conversionSettings.tcm_redirect.second_time.redirect_post_id,"second_time")},verifyCheckboxes:function(t){var i=e(t.target).parents(".social-sharing-checkboxes").find(".social-share-checkbox:checked");1==i.length?i.prop("disabled",!0):i.prop("disabled",!1)},initVerification:function(){var e=this.$(".first-case").find(".social-share-checkbox:checked"),t=this.$(".second-case").find(".social-share-checkbox:checked");1==e.length&&e.prop("disabled",!0),1==t.length&&t.prop("disabled",!0)},openHyperLink:function(t){var i=e(t.currentTarget).parent().parent().find("textarea"),s=e(t.currentTarget).next();this.hyperlink&&this.hyperlink.closeHyperLink(),this.hyperlink=new ThriveComments.views.HyperLink({el:s,input:i,selected_text:ThriveComments.util.formatSelection(i.attr("id"))}),s.show().addClass("dropdown")}}),ThriveComments.views.Labels=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("labels"),events:{"click .tcm-save-labels":"saveLabels","click .tcm-discard-changes":"discardChanges","focus input":"highlightLabel","focusout input":"removeHighlight"},initialize:function(){this.render()},_render:function(){return this.$el.html(this.template({labels:this.collection.get(ThriveComments.tcm_labels_key).get("value")})),this},highlightLabel:function(e){var t=e.currentTarget;jQuery(t).parent().siblings().children("label").css("color","#0dbf9f")},removeHighlight:function(e){var t=e.currentTarget;jQuery(t).parent().siblings().children("label").css("color","#999")},saveLabels:function(e){var t=this.$("input.tcm-label"),i={};return t.each((function(){i[this.getAttribute("data-key")]={default:this.getAttribute("data-default"),text:this.value},this.setAttribute("data-attribute",this.value)})),ThriveComments.util.save_setting_model(ThriveComments.tcm_labels_key,i,this.collection),!1},discardChanges:function(){this.$("input.tcm_label").each((function(){this.value=this.getAttribute("data-attribute")}))}}),ThriveComments.views.BadgeCard=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("badgecard"),events:{"click .tcm-delete-badge-button":"deleteBadge","click .tcm-edit-badge-button":"editBadge"},render:function(){return this.$el.html(this.template({testimonial:this.model})),this},deleteBadge:function(){TVE_Dash.modal(ThriveComments.views.BadgesDeleteModal,{badge:this.model,dismissible:!1})},editBadge:function(){TVE_Dash.modal(ThriveComments.views.BadgeModal,{badge:this.model,"max-width":"40%"})}}),ThriveComments.views.BadgesCards=ThriveComments.views.Base.extend({initialize:function(){this.listenTo(this.collection,"remove",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"reset",this.render),this.render()},renderOne:function(e){var t=new ThriveComments.views.BadgeCard({model:e}).render().$el;this.$el.append(t)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this}}),ThriveComments.views.BadgeModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("badges-modal"),events:{"click .tcm-save-badges":"saveBadges","click .tcm-discard-changes":"discardChanges","click .tcm-upload-badge":"openUploadImage","click .tcm-badge-icon":"selectBadgeImage"},afterOpen:function(){new ThriveComments.views.BadgeImages({el:this.$(".badges-inner"),collection:ThriveComments.objects.BadgeImages,badge:this.badge});var t=e(".tcm-badges-container"),i=e(".selected");void 0!==i.offset()&&t.animate({scrollTop:i.offset().top-t.offset().top+t.scrollTop()-50,scrollLeft:0},300)},saveBadges:function(){var e={},t=ThriveComments.objects.Badges;if(e.id=this.$("#tcm_badge_id").data("id"),e.name=this.$("#tcm_badge_name").val(),e.awarded=this.$("#tcm_badge_awarded").val(),e.awarded_text=this.$("#tcm_badge_awarded option:selected").text(),e.reaches=this.$("#tcm_badge_reaches").val(),e.image=this.$(".tcm-badge-icon.selected").data("name"),e.image_url=this.$(".tcm-badge-icon.selected").data("url"),0==this.validateBadgeInput(e,t.models))return!1;if(e.reaches=parseInt(e.reaches),0==e.id){var i=(new Date).getTime().toString(36);e.id=i,t.create(e)}else t.get(e.id).set(e);return ThriveComments.util.save_setting_model("tcm_badges",t,this.collection),this.close(),!1},openUploadImage:function(){var t=wp.media({title:ThriveComments.translations.choose_testimonial_image,button:{text:ThriveComments.translations.choose_testimonial_image_button},library:{type:"image"},multiple:!1,frame:"select"}),i=null;return t.on("select",(function(){i=t.state().get("selection").first().toJSON();var s={id:ThriveComments.objects.BadgeImages.length+1,name:i.url.substr(i.url.lastIndexOf("/")+1),url:void 0===i.sizes.thumbnail?i.sizes.full.url:i.sizes.thumbnail.url},n=new ThriveComments.models.BadgeImage(s),r=e(".tcm-badges-container");ThriveComments.objects.BadgeImages.add(n),ThriveComments.objects.CustomImagesCollection.push(s.url),ThriveComments.util.save_setting_model("tcm_badges_custom_images",ThriveComments.objects.CustomImagesCollection,this.collection),e(".tcm-badge-icon").removeClass("selected"),e(e('[data-name="'+s.name+'"]')[0]).addClass("selected");var o=e(".selected");void 0!==o.offset()&&r.animate({scrollTop:o.offset().top-r.offset().top+r.scrollTop()-50,scrollLeft:0},300)})),t.open(),!1},selectBadgeImage:function(t){e(".tcm-badge-icon").removeClass("selected"),t.currentTarget.classList.add("selected")},discardChanges:function(){this.$("input.tcm_label").each((function(){this.value=this.getAttribute("data-attribute")}))},validateBadgeInput:function(e,t){if(""===e.name)return TVE_Dash.err(ThriveComments.translations.badge_no_empty_name),!1;var i=e.reaches;return""===i||i!=parseInt(i)||!i.indexOf("0")||i<0?(TVE_Dash.err(ThriveComments.translations.badge_reaches_only_number),!1):void 0===e.image?(TVE_Dash.err(ThriveComments.translations.badge_select_image),!1):void 0===_.find(t,(function(t){return t.get("id")!==e.id&&t.get("reaches")===parseInt(e.reaches)&&t.get("awarded")===e.awarded}))||(TVE_Dash.err(ThriveComments.translations.badge_same_settings),!1)}}),ThriveComments.views.BadgesDeleteModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("badges-delete"),events:{"click .tcm-delete-yes":"yes","keypress .tcm-keywords-delete":"keyAction"},keyboardEvents:{enter:"enterAction"},enterAction:function(e){13==e.which&&(this.yes(),this.close())},yes:function(){this.badge.destroy({data:{id:this.badge.get("id"),name:"tcm_badges"},processData:!0,success:function(){TVE_Dash.success("Badge deleted successfully!")},error:function(){TVE_Dash.err("Error while deleting Badge")}})}}),ThriveComments.views.BadgeImage=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("badgeimage"),initialize:function(e){this.badge=e.badge},render:function(){return this.$el.html(this.template({badge_image:this.model,badge:this.badge})),this}}),ThriveComments.views.BadgeImages=ThriveComments.views.Base.extend({initialize:function(e){this.listenTo(this.collection,"remove",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"reset",this.render),this.badge=e.badge,this.render()},renderOne:function(e){var t=new ThriveComments.views.BadgeImage({model:e,badge:this.badge}).render().$el;this.$el.append(t)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this}}),ThriveComments.views.SignInButton=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("signin-button"),events:{"click .tcm-api-button":"changeStatus"},initialize:function(e){this.settings_api=e.settings_api},render:function(){return this.$el.html(this.template({button:this.model,api_settings:this.settings_api})),this},changeStatus:function(e){var t=e.currentTarget.dataset.name,i=e.currentTarget.dataset.status,s=this.settings_api;if("unset"===i)return!1;s[t]=1-s[t],e.currentTarget.classList.contains("disabled")?(e.currentTarget.classList.remove("disabled"),e.currentTarget.classList.add("enabled"),e.currentTarget.setAttribute("data-label",ThriveComments.translations.label_enabled)):(e.currentTarget.classList.remove("enabled"),e.currentTarget.classList.add("disabled"),e.currentTarget.setAttribute("data-label",ThriveComments.translations.label_disabled)),ThriveComments.util.save_setting_model("tcm_api_status",s,this.settings_api)}}),ThriveComments.views.SignInButtons=ThriveComments.views.Base.extend({initialize:function(e){this.settings_api=e.settings_api,this.render()},renderOne:function(e){var t=new ThriveComments.views.SignInButton({model:e,settings_api:this.settings_api}).render().$el;this.$el.append(t)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this.checkApiStatus(),this},checkApiStatus:function(){var e=this;this.collection.each((function(t){"set"===t.attributes.status?e.settings_api[t.attributes.name.concat("_api")]=1:e.settings_api[t.attributes.name.concat("_api")]=0})),ThriveComments.util.save_setting_model("tcm_api_status",this.settings_api,this.settings_api,{success:"NoMessage",fail:"NoMessage"})}}),ThriveComments.views.LivePreview=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("comments-live-preview"),initialize:function(){this._render(),this.hideAdminBar(),this.collection.on("change",this._render,this)},_render:function(){this.$el.html(this.template({collection:this.collection}))},hideAdminBar:function(){e("#adminmenuwrap, #adminmenuback").hide(),e("#wpcontent").css({margin:0})}}),ThriveComments.views.Keywords=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("keywords"),events:{"click .add-keyword":"addKeyWord"},initialize:function(){this.render(),this.listenTo(this.collection,"remove",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.model,"change",this.render)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this.$el.append(this.template()),this},renderOne:function(e){var t=new ThriveComments.views.KeywordsItem({model:e}).render().$el;this.$el.append(t)},addKeyWord:function(){TVE_Dash.modal(ThriveComments.views.KeywordsModal,{collection:this.collection,keyword:new ThriveComments.models.Keywords({}),dismissible:!1})}}),ThriveComments.views.KeywordsItem=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("keywords-item"),events:{"click .tcm-edit-keyword":"editKeyWord","click .tcm-delete-keyword":"deleteKeyword"},initialize:function(){this.listenTo(this.model,"change",this.render)},_render:function(){return this.$el.html(this.template({keyword:this.model})),this},editKeyWord:function(){TVE_Dash.modal(ThriveComments.views.KeywordsModal,{keyword:this.model,dismissible:!1})},deleteKeyword:function(){TVE_Dash.modal(ThriveComments.views.KeywordsDeleteModal,{keyword:this.model,dismissible:!1})}}),ThriveComments.views.KeywordsModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("keywords-modal"),events:{"click .tcm-save-keyword":"saveKeyword"},keyboardEvents:{enter:"enterAction"},enterAction:function(e){13===e.which&&(this.saveKeyword(event),this.close())},afterRender:function(){this.$(".tvd-skip-modal-save").materialtags(),this.initAutocomplete()},saveKeyword:function(t){var i=this,s="",n=location.href.split("/"),r=this.$("#tcm_link").val(),o=this.$("#tcm_link")[0].getAttribute("data-flag"),a=this.$("#keyword_new_tab").is(":checked"),c=this.$("#keyword_no_follow").is(":checked");if(t.preventDefault(),_.each(e('span[class="tvd-chip"]'),(function(t){var i=e(t).text();i=(i=(i=i.substring(0,i.length-5)).replace(/\s+/g," ")).replace(/^\s+|\s+$/g,""),s+=i+", "})),""===(s=s.substring(0,s.length-2)))return this.$("#keyword-error").show(),!1;if(this.$("#keyword-error").hide(),0!=o)r=n[0]+"//"+n[2]+"?p="+o;else{if(""===(r=ThriveComments.util.addHttp(r))||!ThriveComments.util.isValidUrl(r))return this.$("#link-error").show(),!1;this.$("#link-error").hide()}return this.keyword.set({name:s,value:r,new_tab:a,no_follow:c}),this.keyword.save().done((function(e){i.$el.closeModal(),i.collection?(i.collection.push(i.keyword),TVE_Dash.success(ThriveComments.translations.autolink_added)):TVE_Dash.success(ThriveComments.translations.autolink_changed),i.$el.empty(),i.unbind()})).fail((function(e){TVE_Dash.err(ThriveComments.translations.autolink_error)})),!1},getPostNameById:function(t){var i=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:i,type:"POST",data:{postId:t}}).done((function(t){e("#tcm_link").removeClass("ui-autocomplete-loading")})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)})).always((function(){TVE_Dash.hideLoader()}))},LinkAutocomplete:function(t,i){var s=this;i.autocomplete({delay:50,select:function(e,t){s.$("#link-error").hide(),s.$("#tcm_link").first().attr("data-flag",t.item.id)},source:function(i,n){e.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:t,dataType:"json",data:{q:i.term},type:"POST"}).done((function(e){s.$("#tcm_link").first().attr("data-flag",0),n(e)})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)}))}})},initAutocomplete:function(){var e=ThriveComments.routes.settings+"/redirect_autocomplete",t=this.$(".tcm-autocomplete");this.LinkAutocomplete(e,t)}}),ThriveComments.views.KeywordsDeleteModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("keywords-delete"),events:{"click .tcm-delete-yes":"yes",keydown:"keyAction"},keyboardEvents:{enter:"enterAction",esc:"escapeAction"},enterAction:function(){this.yes(),this.close()},escapeAction:function(){this.close()},yes:function(){this.keyword.destroy({data:{name:"tcm_keywords",value:this.keyword.get("name")},processData:!0,success:function(){TVE_Dash.success("Auto-Link deleted successfully!")},error:function(){TVE_Dash.err("Error while deleting Auto-Link")}})}}),ThriveComments.views.Notifications=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("api-connections"),events:{"change .tcm-email-checkbox":"saveConnection","click .tcm-icon-mode_edit":"editNotifications"},render:function(){return this.$el.html(""),this.$el.html(this.template({collection:this.collection})),this.afterRender(),this},afterRender:function(){var t=this;e(".tcm-inactive-service-label").hide(),e(".tcm-service-label").each((function(){this.classList.contains("active")||(e(this).hide(),e(this).next().show())})),ThriveComments.LocalStorage.on("tve_new_api",(function(e){if(-1!==ThriveComments.email_apis.indexOf(e.key)){var i=[];if(i.key=e.key,i.title=e.name,i.image=document.location.origin+"/wp-content/plugins/thrive-comments/thrive-dashboard/inc/auto-responder/views/images/"+e.key+"_small.jpg",i.active=0,void 0!==ThriveComments.email_services.find((function(t){if(t.key===e.key)return!0})))return!0;ThriveComments.email_services.push(i),t.render()}ThriveComments.LocalStorage.unset("tve_new_api")}))},saveConnection:function(t){var i=e(t.currentTarget).parent().parent().next("p"),s=e(".tcm-service-label.active");if(t.currentTarget.checked){this.$(".tcm-email-checkbox").prop("checked",!1),e(t.currentTarget).prop("checked",!0),s.removeClass("active"),s.hide(),s.next().show(),i.show(),i.addClass("active"),i.next().hide();var n=t.currentTarget.dataset.setting;ThriveComments.util.save_setting_model("tcm_email_service",n,this.collection)}else e(".tcm-service-label").hide(),s.next().show(),ThriveComments.util.save_setting_model("tcm_email_service","",this.collection)},editNotifications:function(e){TVE_Dash.modal(ThriveComments.views.EditNotifications,{collection:this.collection,labels:this.collection.get("tcm_notification_labels").get("value"),view_type:e.target.id,dismissible:!1,className:"tvd-modal tcm-comments-notifications"})}}),ThriveComments.views.EditNotifications=TVE_Dash.views.Modal.extend({events:{"click .tcm-save-labels":"saveLabels","click .tcm-discard-changes":"discardChanges","click .tcm-customize-label":"showInput","keydown .tcm-input-label":"showLabel","click .tvd-modal-content":"hideInput","click .revert_notification_labels":"revertLabels","click .tcm-click-to-copy":"copyInput"},afterInitialize:function(e){this.template=ThriveComments.util.tpl(e.view_type),new ClipboardJS(".tcm-click-to-copy")},hideInput:function(t){if("textarea"!==t.target.type){var i=e(".tvd-modal-content").find(":input").filter(":visible");i.hide(),i.siblings("p").show().text(i.val())}},showLabel:function(t){var i=e(t.currentTarget),s=this.$(".unsubscribe-error-icon"),n=this.$(".button-error-icon");"unsubscribe_text"===t.currentTarget.id&&(""===i.val()?s.show():s.hide()),"unsubscribe-textarea"===t.currentTarget.id&&(""===i.val()?n.show():n.hide()),13===t.which&&(i.hide(),i.siblings("p").show().text(i.val())),27===t.which&&(i.hide(),i.siblings("p").show())},showInput:function(t){var i=e(".tvd-modal-content").find(":input").filter(":visible");return e(".label-customizing-div").removeClass("label-customizing-div"),i.hide(),i.siblings("p").show().text(i.val()),(i=e(t.currentTarget)).parent("div").addClass("label-customizing-div"),"A"===i.prop("nodeName")?(i.siblings("p").hide(),i.siblings("textarea").show().focus()):(i.hide(),i.next("textarea").show().focus()),!1},saveLabels:function(){var e=this.$("textarea.tcm_label"),t=this.labels;return!!this.validateLabels(e)&&(e.each((function(){t[this.dataset.key]={default:this.getAttribute("data-default"),text:this.value},this.setAttribute("data-attribute",this.value)})),ThriveComments.util.save_setting_model("tcm_notification_labels",t,this.collection),this.close(),!1)},validateLabels:function(e){var t=!0,i=this;return e.each((function(){"unsubscribe_text"===this.id&&(""===this.value||this.value.search(/{|}/)>-1)&&(i.$(".unsubscribe-error-icon").show(),t=!1),"unsubscribe-textarea"===this.id&&""===this.value&&(i.$(".button-error-icon").show(),t=!1)})),t},revertLabels:function(){var e=this.$("textarea.tcm_label"),t=this.labels;e.each((function(){t[this.dataset.key]={default:this.getAttribute("data-default"),text:this.getAttribute("data-default")},this.setAttribute("data-attribute",this.getAttribute("data-default"))})),ThriveComments.util.save_setting_model("tcm_notification_labels",t,this.collection),this.close()},copyInput:function(t){var i=e(t.currentTarget).text(),s=e(t.currentTarget);s.text(ThriveComments.translations.copy_input),setTimeout((function(){s.text(i)}),500)}}),ThriveComments.views.HyperLink=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("moderation/hyperlink"),events:{"click .hyperlink-close":"closeHyperLink","click .hyperlink-save":"saveHyperLink"},initialize:function(e){this.parentView=e&&e.commentView?e.commentView:null,this.selected_text=e.selected_text,this.input=e.input,this.render()},render:function(){return this.$el.html(this.template({selected_text:this.selected_text.selectedText})),this.initAutocomplete(),this.disableSave(),this},closeHyperLink:function(){this.viewRemove(),e(".tcm-hyperlink-dropdown").hide().removeClass("dropdown")},disableSave:function(){var t=e("#tcm_hyperlink_url"),i=e(".hyperlink-save");t.bind("change keyup input",(function(){""===t.val()?i.attr("disabled",!0):i.attr("disabled",!1)}))},saveHyperLink:function(){var e=this.$("#hyperlink-error"),t=this.$("#hyperlink-new-tab"),i=this.$("#hyperlink-no-follow"),s=ThriveComments.util.addHttp(this.$("#tcm_hyperlink_url").val()),n=this.$("#tcm_hyperlink_text").val(),r=this.input;if(!ThriveComments.util.isValidUrl(s))return e.show(),!1;e.hide(),""===n&&(n=s);var o='<a href = "'+s+'"';if(t.is(":checked")&&(o+=' target="_blank"'),i.is(":checked")&&(o+=' rel="nofollow"'),o+=">"+n+"</a>",""===this.selected_text.selectedText)ThriveComments.util.insertAtCaret(r,o);else{var a=r.val();r.val(a.substring(0,this.selected_text.startPos)+o+a.substring(this.selected_text.endPos,a.length))}this.closeHyperLink()},getPostNameById:function(t){var i=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:i,type:"POST",data:{postId:t}}).done((function(t){e("#tcm_hyperlink").removeClass("ui-autocomplete-loading")})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)})).always((function(){TVE_Dash.hideLoader()}))},LinkAutocomplete:function(t,i){var s=this,n=location.href.split("/");i.autocomplete({delay:50,select:function(e,t){return s.$("#link-error").hide(),s.$("#tcm_hyperlink_url").val(n[0]+"//"+n[2]+"?p="+t.item.id),s.$("#tcm_hyperlink_text").val(t.item.label),!1},source:function(i,s){e.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:t,dataType:"json",data:{q:i.term},type:"POST"}).done((function(t){e("#hyperlink-error").hide(),s(t)})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)}))}})},initAutocomplete:function(){var e=ThriveComments.routes.settings+"/redirect_autocomplete",t=this.$(".tcm-autocomplete");this.LinkAutocomplete(e,t)},viewRemove:function(){return this.$el.empty(),this.undelegateEvents(),this.unbind(),this}}),ThriveComments.views.Reporting=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/main"),events:{"change .tcm-report-select":"graphSelect","change .tcm-user-per-page":"changePage","click .clear-post-autocomplete":"postCleared","click .tcm-next-page":"nextPage","click .tcm-previous-page":"previousPage","change .tcm-change-users":"changeRows"},initialize:function(){this._render(),this.showCustomRange(),TVE_Dash.materialize(this.$el),e(".tcm-users-list-current-page").text("1"),this.initAutocomplete()},_render:function(){return this.$el.html(this.template({})),this.report=new ThriveComments.views.Report({el:this.$("#tcm-display-report")}),this},graphSelect:function(){switch(this.$("#tcm-report-type option:selected").val()){case"vote_engagements":case"comments_graph":default:this.changeReport();break;case"most_active_commenters":this.changeReport(),void 0!==this.commenters&&this.commenters._render();break;case"most_popular_posts":this.changeReport(),void 0!==this.posts&&this.posts._render();break;case"most_upvoted":this.changeReport(),void 0!==this.upvoted&&this.upvoted._render()}return!1},changeReport:function(){var t=this.$(".custom-range-date"),i=this.$("#tcm-report-type").val(),s=this.$("#tcm_report_autocomplete")[0].getAttribute("post_id"),n=this.$("#tcm_report_autocomplete")[0].getAttribute("tva_term"),r=this.$("#tcm-report-date").val(),o=this.$("#tcm-report-graph").val(),a=this.$("#tcm-report-start-date").val(),c=this.$("#tcm-report-end-date").val(),m=e("#tcm_report_autocomplete").val(),l=e("#tcm-report-type").val(),h=e("#tcm-include-moderators").is(":checked")?1:0;if(c){if("custom_range"===r){if(t.show(),!a||!c)return}else t.hide();var d={name:i,graph_source:s,report_source:m,date_interval:r,date_before:c,date_after:a,graph_interval:o,graph_title:l,tva_term:n,include_moderators:h};this.getReport(d)}},showCustomRange:function(){this.$el.find("#tcm-report-start-date").pickadate({max:!0,format:"yyyy-mm-dd",onStart:function(){var e=new Date;this.set("select",[e.getFullYear(),e.getMonth()+1,e.getDate()-7])}}),this.$el.find("#tcm-report-end-date").pickadate({max:!0,format:"yyyy-mm-dd",onStart:function(){var e=new Date;this.set("select",[e.getFullYear(),e.getMonth()+1,e.getDate()])}})},getReport:function(t){var i=this;this.showOverlay(),e.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},cache:!1,dataType:"JSON",url:ThriveComments.routes.reporting,type:"POST",data:t}).done((function(e,s,n){"comments_graph"===t.name||"vote_engagements"===t.name?i.renderChart(e,t):"most_active_commenters"===t.name?i.activeCommenters(e):"most_popular_posts"===t.name?i.popularPosts(e):"most_upvoted"===t.name&&i.upvotedComments(e),i.hideOverlay()})).fail((function(){}))},activeCommenters:function(t){e(".most_popular_post_header").hide(),e("#most_upvoted").hide(),e(".most_active_commenters_header").show(),e("#tcm-reporting-autocomplete").hide(),e("#tcm-display-report").hide(),e(".tcm-graph-interval").hide(),e(".tcm-reports-pagination").show(),e("#active_commenters_graph").show(),e(".most_upvoted_comments_header").hide(),t.length?(e(".tcm-no-data-report").hide(),e(".tcm-reporting-navigation").show()):(e(".tcm-no-data-report").show(),e(".tcm-reporting-navigation").hide()),this.commenters=new ThriveComments.views.Commenters({el:this.$("#most_active_commenters"),commenters:t}),this.commenters._render()},popularPosts:function(t){e(".most_active_commenters_header").hide(),e("#tcm-reporting-autocomplete").hide(),e("#tcm-display-report").hide(),e(".tcm-graph-interval").hide(),e(".tcm-reports-pagination").show(),e("#active_commenters_graph").show(),e(".most_upvoted_comments_header").hide(),e("#most_upvoted").hide(),e(".most_popular_post_header").show(),t.length?(e(".tcm-no-data-report").hide(),e(".tcm-reporting-navigation").show()):(e(".tcm-no-data-report").show(),e(".tcm-reporting-navigation").hide()),this.posts=new ThriveComments.views.Posts({el:this.$("#most_active_commenters"),posts:t}),this.posts._render()},upvotedComments:function(t){e(".most_popular_post_header").hide(),e(".most_active_commenters_header").hide(),e("#tcm-reporting-autocomplete").hide(),e("#tcm-display-report").hide(),e(".tcm-graph-interval").hide(),e(".tcm-reports-pagination").show(),e("#active_commenters_graph").show(),e(".most_upvoted_comments_header").show(),Object.keys(t).length?(e(".tcm-no-data-report").hide(),e(".tcm-reporting-navigation").show()):(e(".tcm-no-data-report").show(),e(".tcm-reporting-navigation").hide()),this.upvoted=new ThriveComments.views.Upvoted({el:this.$("#most_active_commenters"),comments:t}),this.upvoted._render()},renderChart:function(t,i){e(".most_active_commenters_header").hide(),e(".most_popular_post_header").hide(),e("#tcm-display-report").show(),e(".tcm-no-data-report").show(),e(".tcm-reports-pagination").hide(),e(".tcm-graph-interval").show(),e("#tcm-reporting-autocomplete").show(),e("#active_commenters_graph").hide();var s=[],n=0;e.each(t,(function(t,i){var r={data:[]};r.name=t,e.each(i,(function(e,t){var i=t.date;r.data.push([i,t[r.name]]),n+=t[r.name]})),r.name=r.name.replace("_comments",""),s.push(r)}));var r=s[0].data.length;n?(e(".tcm-no-data-report").hide(),""===i.report_source&&(i.report_source=ThriveComments.translations.entire_website),"vote_engagements"===i.graph_title?i.ytitle=ThriveComments.translations.nr_votes:i.ytitle=ThriveComments.translations.nr_comments,e("#tcm-report-container").highcharts({title:{text:ThriveComments.util.toCamelCase(i.graph_title)},subtitle:{text:"Source: "+i.report_source},yAxis:{title:{text:i.ytitle},min:0},xAxis:{type:"category",tickInterval:r>13?Math.ceil(r/13):1,title:{text:"Date"}},legend:{layout:"vertical",align:"right",verticalAlign:"middle"},plotOptions:{series:{label:{connectorAllowed:!1}}},series:s,responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]}})):e(".tcm-no-data-report").show()},getPostNameById:function(t){var i=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:i,type:"POST",data:{postId:t}}).done((function(t){e("#tcm_link").removeClass("ui-autocomplete-loading")})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)})).always((function(){TVE_Dash.hideLoader()}))},LinkAutocomplete:function(t,i){var s=this;i.autocomplete({delay:50,select:function(t,n){i[0].setAttribute("post_id",n.item.id),!0===n.item.tva_term?i[0].setAttribute("tva_term",n.item.tva_term):i[0].setAttribute("tva_term",!1),e("#tcm_report_autocomplete").val(n.item.value),s.changeReport()},source:function(n,r){s.$(".clear-post-autocomplete").show(),e.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:t,dataType:"json",data:{q:n.term},type:"POST"}).done((function(e){i[0].setAttribute("post_id",0),r(e)})).fail((function(e){TVE_Dash.err(JSON.parse(e.responseText).message)}))}})},initAutocomplete:function(){var e=ThriveComments.routes.settings+"/redirect_autocomplete",t=this.$("#tcm_report_autocomplete");this.LinkAutocomplete(e,t)},postCleared:function(t){t.currentTarget.style.display="none",this.$("#tcm_report_autocomplete").val(""),e("#tcm_report_autocomplete")[0].setAttribute("post_id",0),this.changeReport()},changeRows:function(){e(".tcm-users-list-current-page").text("1"),"most_active_commenters"===e("#tcm-report-type").val()?this.commenters._render():"most_popular_posts"===e("#tcm-report-type").val()?this.posts._render():this.upvoted._render()},nextPage:function(){var t=this.$(".tcm-users-list-current-page"),i=this.$(".tcm-users-list-total-pages");parseInt(t.text())<parseInt(i.text())&&(t.text(parseInt(t.text())+1),"most_active_commenters"===e("#tcm-report-type").val()?this.commenters._render():"most_popular_posts"===e("#tcm-report-type").val()?this.posts._render():this.upvoted._render())},previousPage:function(){var t=this.$(".tcm-users-list-current-page");parseInt(t.text())>1&&(t.text(parseInt(t.text())-1),"most_active_commenters"===e("#tcm-report-type").val()?this.commenters._render():"most_popular_posts"===e("#tcm-report-type").val()?this.posts._render():this.upvoted._render())},showOverlay:function(){this.$(".tcm-reporting-loader").show()},hideOverlay:function(){this.$(".tcm-reporting-loader").hide()}}),ThriveComments.views.Upvoted=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/comment"),events:{},initialize:function(t){this.comments=t.comments,e(".tcm-users-list-current-page").text("1")},_render:function(){var t=Object.keys(this.comments).length,i=parseInt(e("#tcm-user-per-page").val()),s=parseInt(e(".tcm-users-list-current-page").text());s||(e(".tcm-users-list-current-page").text("1"),s=1);var n=(s-1)*i,r=s*i;this.$el.empty();for(var o=n;o<Math.min(r,t);o++){var a=this.comments[o];this.$el.append(this.template({model:a}))}return e(".tcm-users-list-total-pages").text(Math.max(Math.ceil(t/i),1)),this}}),ThriveComments.views.Commenters=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/commenter"),events:{},initialize:function(t){this.commenters=t.commenters,e(".tcm-users-list-current-page").text("1")},_render:function(){var t=this.commenters.length,i=parseInt(e("#tcm-user-per-page").val()),s=parseInt(e(".tcm-users-list-current-page").text());s||(e(".tcm-users-list-current-page").text("1"),s=1);var n=(s-1)*i,r=s*i;this.$el.empty();for(var o=n;o<Math.min(r,t);o++){var a=this.commenters[o];this.$el.append(this.template({model:a}))}return e(".tcm-users-list-total-pages").text(Math.max(Math.ceil(this.commenters.length/i),1)),this}}),ThriveComments.views.Posts=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/post"),events:{},initialize:function(t){this.posts=t.posts,e(".tcm-users-list-current-page").text("1")},_render:function(){var t=this.posts.length,i=parseInt(e("#tcm-user-per-page").val()),s=parseInt(e(".tcm-users-list-current-page").text());s||(e(".tcm-users-list-current-page").text("1"),s=1);var n=(s-1)*i,r=s*i;this.$el.empty();for(var o=n;o<Math.min(r,t);o++){var a=this.posts[o];this.$el.append(this.template({model:a}))}return e(".tcm-users-list-total-pages").text(Math.max(Math.ceil(this.posts.length/i),1)),this}}),ThriveComments.views.Report=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/report"),events:{"change .tcm-report-select":"changeSELECT"},initialize:function(){this._render(),TVE_Dash.materialize(this.$el)},_render:function(){return this.$el.html(this.template({})),this}}),window.ThriveComments=window.ThriveComments||{},ThriveComments.objects=ThriveComments.objects||{},Backbone.emulateHTTP=!0,function(e){var t=Backbone.Router.extend({view:null,$el:e("#tcm-admin-wrapper"),routes:{livePreview:"livePreview",dashboard:"dashboard",reports:"reports"},params:{},initialize:function(){},route:function(e,t,i){var s=this;return i||(i=this[t]),Backbone.Router.prototype.route.call(this,e,t,(function(){i.apply(s,arguments)}))},livePreview:function(){var t=this;!function i(){if(!window.parent.settings_ready)return setTimeout(i,50);t.livePreviewView=new ThriveComments.views.LivePreview({collection:window.parent.ThriveComments.objects.Settings,el:e("#wpcontent")})}()},dashboard:function(){this.view&&(this.$el.empty(),this.unbind()),ThriveComments.objects.Settings=new ThriveComments.collections.Settings,ThriveComments.objects.SettingsModel=new ThriveComments.models.Settings,this.view=new ThriveComments.views.Dashboard({collection:ThriveComments.objects.Settings,el:this.$el}),ThriveComments.objects.Settings.fetch().done((function(){window.settings_ready=1})),this.check_license()},reports:function(){this.view=new ThriveComments.views.Reporting({el:this.$el}),this.check_license()},check_license:function(){ThriveComments.license.gp&&ThriveComments.license.show_lightbox?TVE_Dash.modal(TVE_Dash.views.LicenseModal,{model:{title:"Thrive Comments",license_class:"grace-period",product_class:"tcm",license_link:ThriveComments.license.link,grace_time:ThriveComments.license.grace_time},className:"tvd-modal tvd-license-modal tvd-modal-grace-period",width:"950px","max-width":"950px"}):ThriveComments.license.exp&&!ThriveComments.license.gp&&TVE_Dash.modal(TVE_Dash.views.LicenseModal,{model:{title:"Thrive Comments",license_class:"expired",product_class:"tcm",license_link:ThriveComments.license.link},className:"tvd-modal tvd-license-modal tvd-modal-expired",no_close:!0,width:"950px",dismissible:!1,"max-width":"950px"})}});e((function(){ThriveComments.router=new t,Backbone.history.start({hashchange:!0}),Backbone.history.fragment||ThriveComments.router.navigate("#dashboard",{trigger:!0})}))}(jQuery),(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t={setItem:function(e,t){},getItem:function(e){},removeItem:function(e){}};function i(){this.api=window.localStorage||t,this.listening=!1,this.listeners={}}i.prototype.set=function(t,i){if(!t||null==i)return this;"object"===e(i)&&(i=JSON.stringify(i));try{this.api.setItem(t,i)}catch(e){}return this},i.prototype.get=function(e){if(e){var t=this.api.getItem(e);if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}},i.prototype.unset=function(e){if(!e)return this;try{this.api.removeItem(e)}catch(e){}return this},i.prototype._listen=function(){var e=this,t=function(t){t||(t=window.event);var i=e.listeners[t.key];i&&i.length&&i.forEach((function(e){e(JSON.parse(t.newValue),JSON.parse(t.oldValue))}))};window.addEventListener?window.addEventListener("storage",t,!1):window.attachEvent?window.attachEvent("onstorage",t):window.onstorage=t},i.prototype.on=function(e,t){this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t],!1===this.listening&&(this._listen(),this.listening=!0)},i.prototype.off=function(e,t){var i=listeners[e];i.length>1?i.splice(i.indexOf(t),1):listeners[e]=[]},i.instance=function(){return this._instance||(this._instance=new i),this._instance},ThriveComments.LocalStorage=i.instance()})()})();