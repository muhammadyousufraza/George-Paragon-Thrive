window.ThriveLeads=window.ThriveLeads||{},ThriveLeads.objects={},ThriveLeads.const=ThriveLeadsConst,ThriveLeads.ajaxModal=function(e){if(!e.view&&!e.onLoad)throw new Error("missing view constructor or onLoad property");TVE_Dash.showLoader();var s=_.extend({type:"get"},e);jQuery.ajax(s).done((function(s){if("function"==typeof e.onLoad)return e.onLoad.call(null);var a=TVE_Dash._instantiate(e.view,e);a.template=_.template(s),a.render().open(e)})).always((function(){TVE_Dash.hideLoader()}))},ThriveLeads.resize_thickbox=function(){var e,s=90*jQuery(window).height()/100,a=jQuery("#TB_window"),i=a.find("#TB_ajaxContent"),r=40;i.children().each((function(){var e=jQuery(this);if(e.is("script")||e.is("style")||!e.is(":visible"))return!0;r+=e.outerHeight(!0)})),e=(r=Math.min(r,s-100))+100,i.css("max-height",s-100+"px").animate({height:r},200),a.animate({top:"50%",marginTop:-e/2,height:r+100},200)},ThriveLeads.roundNumber=function(e,s){var a=Math.pow(10,s);return Math.round(e*a)/a},ThriveLeads.conversion_rate=function(e,s,a){if(e=parseInt(e),s=parseInt(s),!e||isNaN(e)||!s||isNaN(s))return"N/A";a=void 0===a?"%":"";var i=ThriveLeads.roundNumber(s/e*100,3).toFixed(2);return i+(a&&!isNaN(i)?" "+a:"")},ThriveLeads.addMessage=function(e,s){ThriveLeads.objects.messages.add(e),s&&s.call(null)},ThriveLeads.addErrorMessage=function(e,s){var a=new ThriveLeads.models.Message({status:"error",text:e});return ThriveLeads.addMessage(a,s)},ThriveLeads.addSuccessMessage=function(e,s){var a=new ThriveLeads.model.Message({status:"success",text:e});return ThriveLeads.addMessage(a,s)},ThriveLeads.addFailCallback=function(e,s){e.fail((function(a){ThriveLeads.addErrorMessage(a.responseText,ThriveLeads.displayMessages),TVE_Dash.hideLoader(),e.failed=!0,void 0!==s&&s.close&&s.close()}))},ThriveLeads.displayMessages=function(){ThriveLeads.objects.messages.each((function(e){TVE_Dash["success"===e.get("status")?"success":"err"](e.get("text"))})),ThriveLeads.objects.messages.reset()},ThriveLeads.errorHandler=function(e,s,a,i){ThriveLeads.addMessage({text:a.responseText,status:"error"}),ThriveLeads.router.navigate(e,{trigger:!0})},ThriveLeads.bindZClip=function(e){TVE_Dash.bindZClip(e)},ThriveLeads.ajaxurl=function(e){return e&&e.length?(e=e.replace(/^(\?|&)/,""),ajaxurl+(-1!==ajaxurl.indexOf("?")?"&":"?")+e):ajaxurl},ThriveLeads.validateInputField=function(e){e.removeClass("tvd-invalid"),""==e.val()&&e.addClass("tvd-invalid")},ThriveLeads.license_warning=function(){ThriveLeads.const.license.gp&&ThriveLeads.const.license.show_lightbox?TVE_Dash.modal(TVE_Dash.views.LicenseModal,{model:{title:"Thrive Leads",license_class:"grace-period",product_class:"tl",license_link:ThriveLeads.const.license.link,grace_time:ThriveLeads.const.license.grace_time},className:"tvd-modal tvd-license-modal tvd-modal-grace-period",width:"950px","max-width":"950px"}):ThriveLeads.const.license.exp&&!ThriveLeads.const.license.gp&&(TVE_Dash.modal(TVE_Dash.views.LicenseModal,{model:{title:"Thrive Leads",license_class:"expired",product_class:"tl",license_link:ThriveLeads.const.license.link},className:"tvd-modal tvd-license-modal tvd-modal-expired",no_close:!0,dismissible:!1,width:"950px","max-width":"950px"}),jQuery("#tl-dashboard-wrapper").replaceWith(jQuery("#tl-dashboard-wrapper").clone()))};