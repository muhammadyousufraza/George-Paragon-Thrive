window.ThriveLeads=window.ThriveLeads||{},jQuery((function(){if(window.TVE_Page_Data){ThriveLeads.objects.titleChanger=new ThriveLeads.models.PageTitle({default_title:document.title}),ThriveLeads.objects.titleChanger.on("title_change",(function(e){document.title=e}));var e=Backbone.Router.extend({routes:{dashboard:"dashboard","form-type/:id":"formTypeEdit","shortcode/:id":"shortcodeEdit","2step-lightbox/:id":"twoStepLightboxEdit","triggers/:form_type_id/:variation_key":"triggerEdit","test/:id(/:completed)":"viewTest","position/:form_type_id/:variation_key":"positionEdit"},dashboard:function(){TVE_Dash.hideLoader(),ThriveLeads.objects.DashboardView||(ThriveLeads.objects.DashboardView=new ThriveLeads.views.Dashboard(TVE_Page_Data)),ThriveLeads.objects.BreadcrumbsCollection.length>2&&ThriveLeads.objects.BreadcrumbsCollection.reset(ThriveLeads.objects.BreadcrumbsCollection.first(2)),ThriveLeads.objects.DashboardView.render(),new ThriveLeads.views.Breadcrumbs({collection:ThriveLeads.objects.BreadcrumbsCollection,el:"#tve-leads-breadcrumbs"}).render()},shortcodeEdit:function(e){e?(TVE_Dash.showLoader(),ThriveLeads.objects.FormTypeView&&ThriveLeads.objects.FormTypeView.undelegateEvents(),ThriveLeads.objects.TwoStepLightboxEditView&&ThriveLeads.objects.TwoStepLightboxEditView.undelegateEvents(),ThriveLeads.objects.Shortcode?(ThriveLeads.objects.ShortcodeEditView.FLAG_skipListener=!0,ThriveLeads.objects.Shortcode.set("ID",e),ThriveLeads.objects.ShortcodeEditView.clear()):(ThriveLeads.objects.Shortcode=new ThriveLeads.models.Shortcode({ID:e}),ThriveLeads.objects.ShortcodeEditView=new ThriveLeads.views.FormTypeEdit({model:ThriveLeads.objects.Shortcode})),ThriveLeads.objects.Shortcode.fetch({error:_.partial(ThriveLeads.errorHandler,"#dashboard")}).always((function(t){ThriveLeads.objects.BreadcrumbsCollection.at(ThriveLeads.objects.BreadcrumbsCollection.length-1).set({last:0}),ThriveLeads.objects.BreadcrumbsCollection.length>2&&ThriveLeads.objects.BreadcrumbsCollection.reset(ThriveLeads.objects.BreadcrumbsCollection.first(2)),ThriveLeads.objects.BreadcrumbsCollection.add({name:"Lead Shortcodes",url:"#shortcode/"+e}),_.isObject(t)&&t.redirect_to&&ThriveLeads.router.navigate(t.redirect_to,{trigger:!0})}))):ThriveLeads.router.navigate("#dashboard",{trigger:!0})},twoStepLightboxEdit:function(e){e?(TVE_Dash.showLoader(),ThriveLeads.objects.FormTypeView&&ThriveLeads.objects.FormTypeView.undelegateEvents(),ThriveLeads.objects.ShortcodeEditView&&ThriveLeads.objects.ShortcodeEditView.undelegateEvents(),ThriveLeads.objects.TwoStepLightbox?(ThriveLeads.objects.TwoStepLightboxEditView.FLAG_skipListener=!0,ThriveLeads.objects.TwoStepLightbox.set("ID",e),ThriveLeads.objects.TwoStepLightboxEditView.clear()):(ThriveLeads.objects.TwoStepLightbox=new ThriveLeads.models.TwoStepLightbox({ID:e}),ThriveLeads.objects.TwoStepLightboxEditView=new ThriveLeads.views.FormTypeEdit({model:ThriveLeads.objects.TwoStepLightbox})),ThriveLeads.objects.TwoStepLightbox.fetch({error:_.partial(ThriveLeads.errorHandler,"#dashboard")}).always((function(t){ThriveLeads.objects.BreadcrumbsCollection.at(ThriveLeads.objects.BreadcrumbsCollection.length-1).set({last:0}),ThriveLeads.objects.BreadcrumbsCollection.length>2&&ThriveLeads.objects.BreadcrumbsCollection.reset(ThriveLeads.objects.BreadcrumbsCollection.first(2)),ThriveLeads.objects.BreadcrumbsCollection.add({name:"ThriveBox",url:"#2step-lightbox/"+e}),_.isObject(t)&&t.redirect_to&&ThriveLeads.router.navigate(t.redirect_to,{trigger:!0})}))):ThriveLeads.router.navigate("#dashboard",{trigger:!0})},formTypeEdit:function(e){e?(TVE_Dash.showLoader(),ThriveLeads.objects.ShortcodeEditView&&ThriveLeads.objects.ShortcodeEditView.undelegateEvents(),ThriveLeads.objects.TwoStepLightboxEditView&&ThriveLeads.objects.TwoStepLightboxEditView.undelegateEvents(),ThriveLeads.objects.FormType?(ThriveLeads.objects.FormTypeView.FLAG_skipListener=!0,ThriveLeads.objects.FormType.set("ID",e),ThriveLeads.objects.FormTypeView.clear()):(ThriveLeads.objects.FormType=new ThriveLeads.models.FormType({ID:e}),ThriveLeads.objects.FormTypeView=new ThriveLeads.views.FormTypeEdit({model:ThriveLeads.objects.FormType})),ThriveLeads.objects.FormType.fetch({error:_.partial(ThriveLeads.errorHandler,"#dashboard")}).always((function(t){ThriveLeads.objects.BreadcrumbsCollection.at(ThriveLeads.objects.BreadcrumbsCollection.length-1).set({last:0}),ThriveLeads.objects.BreadcrumbsCollection.length>2&&ThriveLeads.objects.BreadcrumbsCollection.reset(ThriveLeads.objects.BreadcrumbsCollection.first(2)),ThriveLeads.objects.BreadcrumbsCollection.add({name:t.post_title,url:"#form-type/"+e}),_.isObject(t)&&t.redirect_to&&ThriveLeads.router.navigate(t.redirect_to,{trigger:!0})}))):ThriveLeads.router.navigate("#dashboard",{trigger:!0})},triggerEdit:function(e,t){ThriveLeads.ajaxModal({url:ThriveLeads.const.url.admin+"admin-ajax.php?width=700&height=350&action=thrive_leads_backend_ajax&route=triggerSettings&security="+ThriveLeadsConst.security+"&form_type_id="+e+"&variation_key="+t,"max-width":"45%",view:ThriveLeads.views.TriggerSettings,form_type_id:e,variation_key:t})},positionEdit:function(e,t){ThriveLeads.ajaxModal({url:ThriveLeads.const.url.admin+"admin-ajax.php?width=700&height=350&action=thrive_leads_backend_ajax&route=positionSettings&security="+ThriveLeadsConst.security+"&form_type_id="+e+"&variation_key="+t,view:ThriveLeads.views.PositionSettings,form_type_id:e,variation_key:t})},viewTest:function(e,t){TVE_Dash.showLoader();var r=new ThriveLeads.models.Test({id:parseInt(e)}),i=new ThriveLeads.views.Test({model:r});t&&(i.collection=new ThriveLeads.collections.Tests),r.fetch({success:function(){i.render(),ThriveLeads.objects.BreadcrumbsCollection.at(ThriveLeads.objects.BreadcrumbsCollection.length-1).set({last:0}),ThriveLeads.objects.BreadcrumbsCollection.add({name:i.model.get("title"),url:""}),new ThriveLeads.views.Breadcrumbs({collection:ThriveLeads.objects.BreadcrumbsCollection,el:"#tve-leads-breadcrumbs"}).render(),TVE_Dash.hideLoader()},error:_.partial(ThriveLeads.errorHandler,"#dashboard")})}});ThriveLeads.router=new e,Backbone.history.start({hashChange:!0}),ThriveLeads.license_warning()}}));